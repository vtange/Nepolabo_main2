"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[521],{6521:function(a,b,c){c.r(b),c.d(b,{default:function(){return X}});var d,e,f,g,h=c(4111),i=c(1438),j=c(8029),k=c(1799),l=c(6626),m=c(5893),n=c(7294),o=c(1864),p=c.n(o),q=c(6486),r=c.n(q),s=c(1058),t=c(4845),u=c.n(t),v={src:"/2022/botan/_next/static/media/tile_revealed.ec731302.png",height:160,width:160,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAACVBMVEVMaXEAAAAAAAA+fnncAAAAA3RSTlMACxwNg0FaAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAHElEQVQImWNggANGJjgLIcjABOMwghlwHlwcAgACMwAPMgeDfwAAAABJRU5ErkJggg=="};(f=d||(d={}))[f.NONE=0]="NONE",f[f.MINE=1]="MINE",f[f.QUESTION=2]="QUESTION",(g=e||(e={}))[g.WAITING=0]="WAITING",g[g.RUNNING=1]="RUNNING",g[g.WON=2]="WON",g[g.LOST=3]="LOST";var w=p().join("./","sound_flag.mp3"),x=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).mineId=(0,q.random)(4),d.rockId=(0,q.random)(2),d.handleClick=d.handleClick.bind((0,h.Z)(d)),d.getHiddenImage=d.getHiddenImage.bind((0,h.Z)(d)),d.getRevealedImage=d.getRevealedImage.bind((0,h.Z)(d)),d}var f=c.prototype;return f.cycleFlag=function(a){switch(a){case d.NONE:return d.MINE;case d.MINE:return d.QUESTION;case d.QUESTION:return d.NONE}},f.handleClick=function(a){"click"===a.type?this.props.revealed||this.props.flag!==d.NONE||this.props.reveal():"contextmenu"!==a.type||(a.preventDefault(),this.props.revealed||(new Audio(w).play(),this.props.setFlag(this.cycleFlag(this.props.flag))))},f.getHiddenImage=function(){switch(this.props.flag){case d.NONE:return p().join("./","tile_hidden_".concat(this.rockId,".png"));case d.MINE:return p().join("./","tile_hidden_flag.png");case d.QUESTION:return p().join("./","tile_hidden_question.png")}},f.getRevealedImage=function(){var a=this.props.value;switch(a){case -1:if(this.props.status===e.WON)return p().join("./","tile_revealed_mine_success.png");return p().join("./","tile_revealed_mine_failure_".concat(this.mineId,".png"));case 0:return p().join("./","tile_revealed.png");default:return p().join("./","tile_revealed_".concat(a,".png"))}},f.render=function(){var a=this.props.revealed,b=a?this.getRevealedImage():this.getHiddenImage(),c=a?u().tile_revealed:u().tile_hidden;return(0,m.jsx)("button",{className:c,onClick:this.handleClick,onContextMenu:this.handleClick,children:(0,m.jsx)("div",{className:u().tile_image,children:(0,m.jsx)(s.Z,{src:b,alt:b,width:v.width,height:v.height,layout:"responsive",sizes:" (min-width: 1320px) 5vw, (min-width: 660px) 10vw, (min-width: 330px) 20vw, 30vw "})})})},c}(n.Component),y=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){var a=this,b=this.props.state;return(0,m.jsx)("div",{className:u().board,children:b.values.map(function(c,d){return(0,m.jsx)("div",{className:u().row,children:c.map(function(c,e){return(0,m.jsx)(x,{value:c,revealed:b.revealed[d][e],flag:b.flags[d][e],status:a.props.status,setFlag:function(b){return a.props.setFlag(d,e,b)},reveal:function(){return a.props.reveal(d,e)}},e)})},d)})})},c}(n.Component),z=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state={curTime:Date.now()},d}var d=c.prototype;return d.update=function(){this.setState({curTime:Date.now()})},d.componentDidMount=function(){var a=this;this.timer=setInterval(function(){return a.update()},1e3)},d.componentWillUnmount=function(){clearInterval(this.timer)},d.format=function(a){return Math.trunc(a).toString().padStart(2,"0")},d.render=function(){var a=void 0===this.props.doneTime?this.state.curTime:this.props.doneTime,b=Math.floor(Math.max(void 0===this.props.startTime?0:a-this.props.startTime,0)/1e3);return(0,m.jsxs)("a",{children:[this.format(b/60),":",this.format(b%60)]})},c}(n.Component),A=c(4623),B={file:"state_waiting.png",alt:"Game waiting",data:{src:"/2022/botan/_next/static/media/state_waiting.7dc52bbc.png",height:160,width:160,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEUVFhVaVlVsa2d1cnB9eHMxNChuameDfHiMgn1VU1N1cW4/QzF/fXlhXluDe3ZcWVd2cW51cG2GgHvaKdtPAAAAEnRSTlMBRWCK/BjA/f4zcFGequnlxdqF+49YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAO0lEQVQImRXLSRIAIQgEwULBRmfn/4+dMO8JxBFsc57DDLg8Uw/ELXeV0TJLmZ1WcqkWvCXVt9foaxg/NcUBrFUJPswAAAAASUVORK5CYII="}},C={file:"state_running.png",alt:"Game running",data:{src:"/2022/botan/_next/static/media/state_running.d512512b.png",height:808,width:953,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAaVBMVEVMaXGteCZcVzZLhHMZISdRQz0+bU03gl8+c1ZQUjc7TjUyPi8LGRWfdy4yb0tyfmhKZkp5nWQvMTEqWkKqfx53qW28gRuNfxZvhU+OfDRFYkNJhV4qVD9sczzqnB+hgh5dey9ViGmVjDCWjLyxAAAAGnRSTlMAhjj5JQyw/v7EVHVJqPn9/Gx2eLu7zNyU9mG33JYAAAAJcEhZcwAAdTAAAHUwAd0zcs0AAAA+SURBVAiZBcGFAcAgEACxQx+q1IX6/kM2ATUvo3Zgt++5LwXra8ScNUw57W2IJV4kNCla+iBZjgKcHjpfwQ9fnQLJN8HjTgAAAABJRU5ErkJggg=="}},D={file:"state_fail.png",alt:"Game lost",data:{src:"/2022/botan/_next/static/media/state_fail.cd18c147.png",height:1e3,width:1e3,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAM1BMVEVMaXGskY6BfHehg4mkjIx8fXj2NzifRkaBe3XoRUV4a2VRREFXXlr2Pj56c266QD+HgHknljKNAAAAEHRSTlMAErT6KFMXCP4xtysyUeIsXik4MQAAAAlwSFlzAAB1MAAAdTAB3TNyzQAAADpJREFUCJkdiskNwDAMw5TDlpyr2X/aIuaLIAiAJBKPHSm9sJcnVqtlaLrnXdYkLQAxdMck4D7XF/gBImUBPL8n49wAAAAASUVORK5CYII="}},E={file:"state_success.png",alt:"Game won",data:{src:"/2022/botan/_next/static/media/state_success.1e66b4ba.png",height:730,width:820,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAUVBMVEVKSAD//wD88xKal4ympJTV18Lu5Rbq6Q4yMRTTybtvahqcmo20mQCPj4nCwKyenoXBv6zh38nx9NTp5tDMyrXk2MnNrKna2cL8++H089ravbkL3O4tAAAAF3RSTlMBGympl60cByL9VZAVa8o0e+T8+Lz79/5IOXoAAAAJcEhZcwAAdTAAAHUwAd0zcs0AAAA8SURBVAiZFcpJFoAwCMDQqK3QOk8Fvf9BfWT1FwHGvhMimasSXHIZVJDNvscmhfS2YqvC7qd7ijlfxw0/M8gCBBhdmOoAAAAASUVORK5CYII="}},F=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).makeStatus=d.makeStatus.bind((0,h.Z)(d)),d}var d=c.prototype;return d.makeStatus=function(a){var b=this.context.lang===A.SQ.ENGLISH;switch(a){case e.WAITING:return b?"Waiting":"待ち";case e.RUNNING:return b?"Running":"進行中";case e.LOST:return b?"You Lost!":"負けた！";case e.WON:return b?"You Won!":"勝った！"}},d.getStatusImage=function(a){switch(a){case e.WAITING:return B;case e.RUNNING:return C;case e.LOST:return D;case e.WON:return E}},d.render=function(){var a=this.getStatusImage(this.props.status);return(0,m.jsx)("div",{children:(0,m.jsx)(s.Z,{src:p().join("./",a.file),alt:a.alt,width:a.data.width,height:a.data.height,layout:"responsive",sizes:" (min-width: 1200px) 10vw, (min-width: 600px) 20vw, 30vw "})})},c}(n.Component);F.contextType=A.AZ;var G=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}return c.prototype.render=function(){return(0,m.jsxs)("div",{className:u().stats_bar,children:[(0,m.jsxs)("p",{className:u().mines,children:[this.props.minesLeft,(0,m.jsx)("wbr",{}),"/",this.props.minesTotal]}),(0,m.jsx)(F,{status:this.props.status}),(0,m.jsx)(z,{startTime:this.props.startTime,doneTime:this.props.doneTime})]})},c}(n.Component),H=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(){return(0,i.Z)(this,c),b.apply(this,arguments)}var d=c.prototype;return d.makeText=function(a){switch(a){case e.RUNNING:return null;case e.LOST:return(0,m.jsx)("h1",{className:u().result_lose,children:"You Lost!"});case e.WON:return(0,m.jsx)("h1",{className:u().result_win,children:"You Won!"})}},d.render=function(){var a=this.makeText(this.props.status);return a?(0,m.jsx)("div",{className:u().result,children:a}):(0,m.jsx)("div",{})},c}(n.Component),I="/sweeper",J=p().join(I,"sound_reveal_one.mp3"),K=p().join(I,"sound_reveal_many.mp3"),L=p().join(I,"sound_end_fail.mp3"),M=p().join(I,"sound_end_success.mp3");function N(a,b,c){return Array.from(Array(a),function(){return Array(b).fill(c)})}function O(a,b){return a.map(function(a){return a.map(function(a){return b})})}function P(a){return structuredClone(a)}function Q(a,b){return{row:a,column:b}}var R=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var f;return(0,i.Z)(this,c),(f=b.call(this,a)).state={status:e.WAITING,startTime:void 0,doneTime:void 0,values:N(a.height,a.width,0),revealed:N(a.height,a.width,!1),flags:N(a.height,a.width,d.NONE)},f.setFlag=f.setFlag.bind((0,h.Z)(f)),f.reveal=f.reveal.bind((0,h.Z)(f)),f}var f=c.prototype;return f.setFlag=function(a,b,c){this.setState(function(d){var e=P(d.flags);return e[a][b]=c,{flags:e}})},f.reveal=function(a,b){var c=this;if(-1===this.state.values[a][b]){new Audio(L).play(),this.setState({status:e.LOST,doneTime:Date.now(),revealed:O(this.state.revealed,!0)});return}this.setState(function(f){var g,h,i,j,k,l,m,n=f.status===e.WAITING?(g=c.props.height,h=c.props.width,i=c.props.mines,j=Q(a,b),k=N(g,h,0),l=k.flatMap(function(a,b){return a.map(function(a,c){return Q(b,c)})}).filter(function(a){return a.row!==j.row||a.column!==j.column}),r().sampleSize(l,i).forEach(function(a){k[a.row][a.column]=-1;for(var b=Math.max(0,a.row-1);b<=Math.min(g-1,a.row+1);b++)for(var c=Math.max(0,a.column-1);c<=Math.min(h-1,a.column+1);c++)(b!==a.row||c!==a.column)&& -1!==k[b][c]&&k[b][c]++}),k):f.values,o=P(f.revealed),p=Array.of(Q(a,b));o[a][b]=!0;for(var q=1;p.length>0;){var s=p.pop();if(0===n[s.row][s.column])for(var t=Math.max(0,s.row-1);t<=Math.min(c.props.height-1,s.row+1);t++)for(var u=Math.max(0,s.column-1);u<=Math.min(c.props.width-1,s.column+1);u++)(t!==s.row||u!==s.column)&& !1===o[t][u]&&f.flags[t][u]===d.NONE&& -1!==n[t][u]&&(o[t][u]=!0,q++,p.push(Q(t,u)))}var v=o.every(function(a,b){return a.every(function(a,c){return a|| -1===n[b][c]})}),w=new Audio(1===q?J:K).play();return v&&w.then(function(){return new Audio(M).play()}),{values:n,revealed:v?O(o,!0):o,status:v?e.WON:f.status===e.WAITING?e.RUNNING:f.status,startTime:null!==(m=f.startTime)&& void 0!==m?m:Date.now(),doneTime:v?Date.now():void 0}})},f.render=function(){var a=this.state.flags.flatMap(function(a){return a.map(function(a){return a===d.MINE?1:0})}).reduce(function(a,b){return a+b}),b=this.props.mines-a;return(0,m.jsxs)("div",{className:u().game,children:[(0,m.jsx)(G,{minesTotal:this.props.mines,minesLeft:b,startTime:this.state.startTime,doneTime:this.state.doneTime,status:this.state.status}),(0,m.jsx)(H,{status:this.state.status}),(0,m.jsx)("div",{className:u().board_box,children:(0,m.jsx)(y,{state:this.state,status:this.state.status,setFlag:this.setFlag,reveal:this.reveal})})]})},c}(n.Component),S=c(2345),T=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).inputWidth=n.createRef(),d.inputHeight=n.createRef(),d.inputMines=n.createRef(),d.handleSubmit=d.handleSubmit.bind((0,h.Z)(d)),d}var d=c.prototype;return d.handleSubmit=function(a,b){a.preventDefault(),this.props.newGame({width:this.inputWidth.current.valueAsNumber,height:this.inputHeight.current.valueAsNumber,mines:this.inputMines.current.valueAsNumber}),b()},d.render=function(){var a=this,b=this.context.lang===A.SQ.ENGLISH,c=this.props.current;return(0,m.jsx)(S.Z,{trigger:(0,m.jsx)("button",{className:u().new_game,children:"Custom"}),modal:!0,children:(0,m.jsxs)("form",{className:u().custom,onSubmit:function(b){return a.handleSubmit(b,function(){})},children:[(0,m.jsxs)("label",{children:[b?"Width:":"横幅:",(0,m.jsx)("input",{className:u().config_input,type:"number",ref:this.inputWidth,defaultValue:c.width,min:3,max:40})]}),(0,m.jsxs)("label",{children:[b?"Height:":"高さ:",(0,m.jsx)("input",{className:u().config_input,type:"number",ref:this.inputHeight,defaultValue:c.height,min:3,max:40})]}),(0,m.jsxs)("label",{children:[b?"Mines:":"SSRB民:",(0,m.jsx)("input",{className:u().config_input,type:"number",ref:this.inputMines,defaultValue:c.mines,min:1})]}),(0,m.jsx)("div",{className:u().custom_control,children:(0,m.jsx)("input",{type:"submit",value:b?"New Game":"ニューゲーム"})})]})})},c}(n.Component);T.contextType=A.AZ;var U={width:9,height:9,mines:10},V={width:16,height:16,mines:40},W={width:30,height:16,mines:99},X=function(a){(0,j.Z)(c,a);var b=(0,l.Z)(c);function c(a){var d;return(0,i.Z)(this,c),(d=b.call(this,a)).state=U,d.games=0,d.newGame=d.newGame.bind((0,h.Z)(d)),d}var d=c.prototype;return d.newGame=function(a){if(a.mines>=a.width*a.height){var b,c;console.error("Too many mines!"),a=(b=(0,k.Z)({},a),c={mines:a.width*a.height-1},c=null!=c?c:{},Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(c)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(c,a))}),b)}this.setState(a)},d.render=function(){var a=this;return(0,m.jsxs)("div",{className:u().wrapper,children:[(0,m.jsxs)("div",{className:u().config,children:[(0,m.jsx)("button",{className:u().new_game,onClick:function(b){return a.newGame(U)},children:"Easy"}),(0,m.jsx)("button",{className:u().new_game,onClick:function(b){return a.newGame(V)},children:"Medium"}),(0,m.jsx)("button",{className:u().new_game,onClick:function(b){return a.newGame(W)},children:"Hard"}),(0,m.jsx)(T,{current:this.state,newGame:this.newGame})]}),(0,m.jsx)(R,{height:this.state.height,width:this.state.width,mines:this.state.mines},this.games++)]})},c}(n.Component)}}])