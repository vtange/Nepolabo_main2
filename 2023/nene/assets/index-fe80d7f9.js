function t(t,e){for(var i=0;i<e.length;i++){const s=e[i];if("string"!=typeof s&&!Array.isArray(s))for(const e in s)if("default"!==e&&!(e in t)){const i=Object.getOwnPropertyDescriptor(s,e);i&&Object.defineProperty(t,e,i.get?i:{enumerable:!0,get:()=>s[e]})}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var i={exports:{}},s={},n={exports:{}},r={},o=Symbol.for("react.element"),a=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.iterator;var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function w(t,e,i){this.props=t,this.context=e,this.refs=x,this.updater=i||v}function b(){}function C(t,e,i){this.props=t,this.context=e,this.refs=x,this.updater=i||v}w.prototype.isReactComponent={},w.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},w.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},b.prototype=w.prototype;var S=C.prototype=new b;S.constructor=C,y(S,w.prototype),S.isPureReactComponent=!0;var E=Array.isArray,P=Object.prototype.hasOwnProperty,T={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function k(t,e,i){var s,n={},r=null,a=null;if(null!=e)for(s in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(r=""+e.key),e)P.call(e,s)&&!A.hasOwnProperty(s)&&(n[s]=e[s]);var l=arguments.length-2;if(1===l)n.children=i;else if(1<l){for(var h=Array(l),c=0;c<l;c++)h[c]=arguments[c+2];n.children=h}if(t&&t.defaultProps)for(s in l=t.defaultProps)void 0===n[s]&&(n[s]=l[s]);return{$$typeof:o,type:t,key:r,ref:a,props:n,_owner:T.current}}function R(t){return"object"==typeof t&&null!==t&&t.$$typeof===o}var I=/\/+/g;function D(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function M(t,e,i,s,n){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var l=!1;if(null===t)l=!0;else switch(r){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case o:case a:l=!0}}if(l)return n=n(l=t),t=""===s?"."+D(l,0):s,E(n)?(i="",null!=t&&(i=t.replace(I,"$&/")+"/"),M(n,e,i,"",(function(t){return t}))):null!=n&&(R(n)&&(n=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(n,i+(!n.key||l&&l.key===n.key?"":(""+n.key).replace(I,"$&/")+"/")+t)),e.push(n)),1;if(l=0,s=""===s?".":s+":",E(t))for(var h=0;h<t.length;h++){var c=s+D(r=t[h],h);l+=M(r,e,i,c,n)}else if(c=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=_&&t[_]||t["@@iterator"])?t:null}(t),"function"==typeof c)for(t=c.call(t),h=0;!(r=t.next()).done;)l+=M(r=r.value,e,i,c=s+D(r,h++),n);else if("object"===r)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function F(t,e,i){if(null==t)return t;var s=[],n=0;return M(t,s,"","",(function(t){return e.call(i,t,n++)})),s}function L(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var B={current:null},O={transition:null},z={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:O,ReactCurrentOwner:T};r.Children={map:F,forEach:function(t,e,i){F(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return F(t,(function(){e++})),e},toArray:function(t){return F(t,(function(t){return t}))||[]},only:function(t){if(!R(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},r.Component=w,r.Fragment=l,r.Profiler=c,r.PureComponent=C,r.StrictMode=h,r.Suspense=f,r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,r.cloneElement=function(t,e,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=y({},t.props),n=t.key,r=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(r=e.ref,a=T.current),void 0!==e.key&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)P.call(e,h)&&!A.hasOwnProperty(h)&&(s[h]=void 0===e[h]&&void 0!==l?l[h]:e[h])}var h=arguments.length-2;if(1===h)s.children=i;else if(1<h){l=Array(h);for(var c=0;c<h;c++)l[c]=arguments[c+2];s.children=l}return{$$typeof:o,type:t.type,key:n,ref:r,props:s,_owner:a}},r.createContext=function(t){return(t={$$typeof:d,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:t},t.Consumer=t},r.createElement=k,r.createFactory=function(t){var e=k.bind(null,t);return e.type=t,e},r.createRef=function(){return{current:null}},r.forwardRef=function(t){return{$$typeof:p,render:t}},r.isValidElement=R,r.lazy=function(t){return{$$typeof:m,_payload:{_status:-1,_result:t},_init:L}},r.memo=function(t,e){return{$$typeof:g,type:t,compare:void 0===e?null:e}},r.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},r.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},r.useCallback=function(t,e){return B.current.useCallback(t,e)},r.useContext=function(t){return B.current.useContext(t)},r.useDebugValue=function(){},r.useDeferredValue=function(t){return B.current.useDeferredValue(t)},r.useEffect=function(t,e){return B.current.useEffect(t,e)},r.useId=function(){return B.current.useId()},r.useImperativeHandle=function(t,e,i){return B.current.useImperativeHandle(t,e,i)},r.useInsertionEffect=function(t,e){return B.current.useInsertionEffect(t,e)},r.useLayoutEffect=function(t,e){return B.current.useLayoutEffect(t,e)},r.useMemo=function(t,e){return B.current.useMemo(t,e)},r.useReducer=function(t,e,i){return B.current.useReducer(t,e,i)},r.useRef=function(t){return B.current.useRef(t)},r.useState=function(t){return B.current.useState(t)},r.useSyncExternalStore=function(t,e,i){return B.current.useSyncExternalStore(t,e,i)},r.useTransition=function(){return B.current.useTransition()},r.version="18.2.0",n.exports=r;var N=n.exports;const U=e(N),V=t({__proto__:null,default:U},[N]);
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var H=N,j=Symbol.for("react.element"),W=Symbol.for("react.fragment"),$=Object.prototype.hasOwnProperty,G=H.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q={key:!0,ref:!0,__self:!0,__source:!0};function X(t,e,i){var s,n={},r=null,o=null;for(s in void 0!==i&&(r=""+i),void 0!==e.key&&(r=""+e.key),void 0!==e.ref&&(o=e.ref),e)$.call(e,s)&&!q.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===n[s]&&(n[s]=e[s]);return{$$typeof:j,type:t,key:r,ref:o,props:n,_owner:G.current}}s.Fragment=W,s.jsx=X,s.jsxs=X,i.exports=s;var K=i.exports,Y={},Z={exports:{}},Q={},J={exports:{}},tt={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(t){function e(t,e){var i=t.length;t.push(e);t:for(;0<i;){var s=i-1>>>1,r=t[s];if(!(0<n(r,e)))break t;t[s]=e,t[i]=r,i=s}}function i(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var s=0,r=t.length,o=r>>>1;s<o;){var a=2*(s+1)-1,l=t[a],h=a+1,c=t[h];if(0>n(l,i))h<r&&0>n(c,l)?(t[s]=c,t[h]=i,s=h):(t[s]=l,t[a]=i,s=a);else{if(!(h<r&&0>n(c,i)))break t;t[s]=c,t[h]=i,s=h}}}return e}function n(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],h=[],c=1,u=null,d=3,p=!1,f=!1,g=!1,m="function"==typeof setTimeout?setTimeout:null,_="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function y(t){for(var n=i(h);null!==n;){if(null===n.callback)s(h);else{if(!(n.startTime<=t))break;s(h),n.sortIndex=n.expirationTime,e(l,n)}n=i(h)}}function x(t){if(g=!1,y(t),!f)if(null!==i(l))f=!0,D(w);else{var e=i(h);null!==e&&M(x,e.startTime-t)}}function w(e,n){f=!1,g&&(g=!1,_(E),E=-1),p=!0;var r=d;try{for(y(n),u=i(l);null!==u&&(!(u.expirationTime>n)||e&&!A());){var o=u.callback;if("function"==typeof o){u.callback=null,d=u.priorityLevel;var a=o(u.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?u.callback=a:u===i(l)&&s(l),y(n)}else s(l);u=i(l)}if(null!==u)var c=!0;else{var m=i(h);null!==m&&M(x,m.startTime-n),c=!1}return c}finally{u=null,d=r,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var b,C=!1,S=null,E=-1,P=5,T=-1;function A(){return!(t.unstable_now()-T<P)}function k(){if(null!==S){var e=t.unstable_now();T=e;var i=!0;try{i=S(!0,e)}finally{i?b():(C=!1,S=null)}}else C=!1}if("function"==typeof v)b=function(){v(k)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,I=R.port2;R.port1.onmessage=k,b=function(){I.postMessage(null)}}else b=function(){m(k,0)};function D(t){S=t,C||(C=!0,b())}function M(e,i){E=m((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(t){t.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,D(w))},t.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<t?Math.floor(1e3/t):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var i=d;d=e;try{return t()}finally{d=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=d;d=t;try{return e()}finally{d=i}},t.unstable_scheduleCallback=function(s,n,r){var o=t.unstable_now();switch("object"==typeof r&&null!==r?r="number"==typeof(r=r.delay)&&0<r?o+r:o:r=o,s){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return s={id:c++,callback:n,priorityLevel:s,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>o?(s.sortIndex=r,e(h,s),null===i(l)&&s===i(h)&&(g?(_(E),E=-1):g=!0,M(x,r-o))):(s.sortIndex=a,e(l,s),f||p||(f=!0,D(w))),s},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(t){var e=d;return function(){var i=d;d=e;try{return t.apply(this,arguments)}finally{d=i}}}}(tt),J.exports=tt;var et=J.exports,it=N,st=et;
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function nt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rt=new Set,ot={};function at(t,e){lt(t,e),lt(t+"Capture",e)}function lt(t,e){for(ot[t]=e,t=0;t<e.length;t++)rt.add(e[t])}var ht=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),ct=Object.prototype.hasOwnProperty,ut=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dt={},pt={};function ft(t,e,i,s,n,r,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){gt[t]=new ft(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];gt[e]=new ft(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){gt[t]=new ft(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){gt[t]=new ft(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){gt[t]=new ft(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){gt[t]=new ft(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){gt[t]=new ft(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){gt[t]=new ft(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){gt[t]=new ft(t,5,!1,t.toLowerCase(),null,!1,!1)}));var mt=/[\-:]([a-z])/g;function _t(t){return t[1].toUpperCase()}function vt(t,e,i,s){var n=gt.hasOwnProperty(e)?gt[e]:null;(null!==n?0!==n.type:s||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,i,s){if(null==e||function(t,e,i,s){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!s&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,s))return!0;if(s)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,n,s)&&(i=null),s||null===n?function(t){return!!ct.call(pt,t)||!ct.call(dt,t)&&(ut.test(t)?pt[t]=!0:(dt[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):n.mustUseProperty?t[n.propertyName]=null===i?3!==n.type&&"":i:(e=n.attributeName,s=n.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(n=n.type)||4===n&&!0===i?"":""+i,s?t.setAttributeNS(s,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(mt,_t);gt[e]=new ft(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(mt,_t);gt[e]=new ft(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(mt,_t);gt[e]=new ft(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){gt[t]=new ft(t,1,!1,t.toLowerCase(),null,!1,!1)})),gt.xlinkHref=new ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){gt[t]=new ft(t,1,!1,t.toLowerCase(),null,!0,!0)}));var yt=it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xt=Symbol.for("react.element"),wt=Symbol.for("react.portal"),bt=Symbol.for("react.fragment"),Ct=Symbol.for("react.strict_mode"),St=Symbol.for("react.profiler"),Et=Symbol.for("react.provider"),Pt=Symbol.for("react.context"),Tt=Symbol.for("react.forward_ref"),At=Symbol.for("react.suspense"),kt=Symbol.for("react.suspense_list"),Rt=Symbol.for("react.memo"),It=Symbol.for("react.lazy"),Dt=Symbol.for("react.offscreen"),Mt=Symbol.iterator;function Ft(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=Mt&&t[Mt]||t["@@iterator"])?t:null}var Lt,Bt=Object.assign;function Ot(t){if(void 0===Lt)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);Lt=e&&e[1]||""}return"\n"+Lt+t}var zt=!1;function Nt(t,e){if(!t||zt)return"";zt=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(Jy){var s=Jy}Reflect.construct(t,[],e)}else{try{e.call()}catch(Jy){s=Jy}t.call(e.prototype)}else{try{throw Error()}catch(Jy){s=Jy}t()}}catch(Jy){if(Jy&&s&&"string"==typeof Jy.stack){for(var n=Jy.stack.split("\n"),r=s.stack.split("\n"),o=n.length-1,a=r.length-1;1<=o&&0<=a&&n[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(n[o]!==r[a]){if(1!==o||1!==a)do{if(o--,0>--a||n[o]!==r[a]){var l="\n"+n[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=o&&0<=a);break}}}finally{zt=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?Ot(t):""}function Ut(t){switch(t.tag){case 5:return Ot(t.type);case 16:return Ot("Lazy");case 13:return Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 2:case 15:return t=Nt(t.type,!1);case 11:return t=Nt(t.type.render,!1);case 1:return t=Nt(t.type,!0);default:return""}}function Vt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case bt:return"Fragment";case wt:return"Portal";case St:return"Profiler";case Ct:return"StrictMode";case At:return"Suspense";case kt:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case Pt:return(t.displayName||"Context")+".Consumer";case Et:return(t._context.displayName||"Context")+".Provider";case Tt:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case Rt:return null!==(e=t.displayName||null)?e:Vt(t.type)||"Memo";case It:e=t._payload,t=t._init;try{return Vt(t(e))}catch(i){}}return null}function Ht(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vt(e);case 8:return e===Ct?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e}return null}function jt(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function Wt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function $t(t){t._valueTracker||(t._valueTracker=function(t){var e=Wt(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var n=i.get,r=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(t){s=""+t,r.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return s},setValue:function(t){s=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Gt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),s="";return t&&(s=Wt(t)?t.checked?"true":"false":t.value),(t=s)!==i&&(e.setValue(t),!0)}function qt(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Xt(t,e){var i=e.checked;return Bt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function Kt(t,e){var i=null==e.defaultValue?"":e.defaultValue,s=null!=e.checked?e.checked:e.defaultChecked;i=jt(null!=e.value?e.value:i),t._wrapperState={initialChecked:s,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Yt(t,e){null!=(e=e.checked)&&vt(t,"checked",e,!1)}function Zt(t,e){Yt(t,e);var i=jt(e.value),s=e.type;if(null!=i)"number"===s?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===s||"reset"===s)return void t.removeAttribute("value");e.hasOwnProperty("value")?Jt(t,e.type,i):e.hasOwnProperty("defaultValue")&&Jt(t,e.type,jt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Qt(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!("submit"!==s&&"reset"!==s||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function Jt(t,e,i){"number"===e&&qt(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var te=Array.isArray;function ee(t,e,i,s){if(t=t.options,e){e={};for(var n=0;n<i.length;n++)e["$"+i[n]]=!0;for(i=0;i<t.length;i++)n=e.hasOwnProperty("$"+t[i].value),t[i].selected!==n&&(t[i].selected=n),n&&s&&(t[i].defaultSelected=!0)}else{for(i=""+jt(i),e=null,n=0;n<t.length;n++){if(t[n].value===i)return t[n].selected=!0,void(s&&(t[n].defaultSelected=!0));null!==e||t[n].disabled||(e=t[n])}null!==e&&(e.selected=!0)}}function ie(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(nt(91));return Bt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function se(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(nt(92));if(te(i)){if(1<i.length)throw Error(nt(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:jt(i)}}function ne(t,e){var i=jt(e.value),s=jt(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=s&&(t.defaultValue=""+s)}function re(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function oe(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ae(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?oe(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var le,he,ce=(he=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=le.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,s){MSApp.execUnsafeLocalFunction((function(){return he(t,e)}))}:he);function ue(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function fe(t,e,i){return null==e||"boolean"==typeof e||""===e?"":i||"number"!=typeof e||0===e||de.hasOwnProperty(t)&&de[t]?(""+e).trim():e+"px"}function ge(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var s=0===i.indexOf("--"),n=fe(i,e[i],s);"float"===i&&(i="cssFloat"),s?t.setProperty(i,n):t[i]=n}}Object.keys(de).forEach((function(t){pe.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),de[e]=de[t]}))}));var me=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(t,e){if(e){if(me[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(nt(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(nt(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(nt(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(nt(62))}}function ve(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function xe(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var we=null,be=null,Ce=null;function Se(t){if(t=vr(t)){if("function"!=typeof we)throw Error(nt(280));var e=t.stateNode;e&&(e=xr(e),we(t.stateNode,t.type,e))}}function Ee(t){be?Ce?Ce.push(t):Ce=[t]:be=t}function Pe(){if(be){var t=be,e=Ce;if(Ce=be=null,Se(t),e)for(t=0;t<e.length;t++)Se(e[t])}}function Te(t,e){return t(e)}function Ae(){}var ke=!1;function Re(t,e,i){if(ke)return t(e,i);ke=!0;try{return Te(t,e,i)}finally{ke=!1,(null!==be||null!==Ce)&&(Ae(),Pe())}}function Ie(t,e){var i=t.stateNode;if(null===i)return null;var s=xr(i);if(null===s)return null;i=s[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!s;break t;default:t=!1}if(t)return null;if(i&&"function"!=typeof i)throw Error(nt(231,e,typeof i));return i}var De=!1;if(ht)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(he){De=!1}function Fe(t,e,i,s,n,r,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(i,h)}catch(c){this.onError(c)}}var Le=!1,Be=null,Oe=!1,ze=null,Ne={onError:function(t){Le=!0,Be=t}};function Ue(t,e,i,s,n,r,o,a,l){Le=!1,Be=null,Fe.apply(Ne,arguments)}function Ve(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function He(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function je(t){if(Ve(t)!==t)throw Error(nt(188))}function We(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ve(t)))throw Error(nt(188));return e!==t?null:t}for(var i=t,s=e;;){var n=i.return;if(null===n)break;var r=n.alternate;if(null===r){if(null!==(s=n.return)){i=s;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===i)return je(n),t;if(r===s)return je(n),e;r=r.sibling}throw Error(nt(188))}if(i.return!==s.return)i=n,s=r;else{for(var o=!1,a=n.child;a;){if(a===i){o=!0,i=n,s=r;break}if(a===s){o=!0,s=n,i=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===i){o=!0,i=r,s=n;break}if(a===s){o=!0,s=r,i=n;break}a=a.sibling}if(!o)throw Error(nt(189))}}if(i.alternate!==s)throw Error(nt(190))}if(3!==i.tag)throw Error(nt(188));return i.stateNode.current===i?t:e}(t))?$e(t):null}function $e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=$e(t);if(null!==e)return e;t=t.sibling}return null}var Ge=st.unstable_scheduleCallback,qe=st.unstable_cancelCallback,Xe=st.unstable_shouldYield,Ke=st.unstable_requestPaint,Ye=st.unstable_now,Ze=st.unstable_getCurrentPriorityLevel,Qe=st.unstable_ImmediatePriority,Je=st.unstable_UserBlockingPriority,ti=st.unstable_NormalPriority,ei=st.unstable_LowPriority,ii=st.unstable_IdlePriority,si=null,ni=null;var ri=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(oi(t)/ai|0)|0},oi=Math.log,ai=Math.LN2;var li=64,hi=4194304;function ci(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ui(t,e){var i=t.pendingLanes;if(0===i)return 0;var s=0,n=t.suspendedLanes,r=t.pingedLanes,o=268435455&i;if(0!==o){var a=o&~n;0!==a?s=ci(a):0!==(r&=o)&&(s=ci(r))}else 0!==(o=i&~n)?s=ci(o):0!==r&&(s=ci(r));if(0===s)return 0;if(0!==e&&e!==s&&0==(e&n)&&((n=s&-s)>=(r=e&-e)||16===n&&0!=(4194240&r)))return e;if(0!=(4&s)&&(s|=16&i),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=s;0<e;)n=1<<(i=31-ri(e)),s|=t[i],e&=~n;return s}function di(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pi(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function fi(){var t=li;return 0==(4194240&(li<<=1))&&(li=64),t}function gi(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function mi(t,e,i){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ri(e)]=i}function _i(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var s=31-ri(i),n=1<<s;n&e|t[s]&e&&(t[s]|=e),i&=~n}}var vi=0;function yi(t){return 1<(t&=-t)?4<t?0!=(268435455&t)?16:536870912:4:1}var xi,wi,bi,Ci,Si,Ei=!1,Pi=[],Ti=null,Ai=null,ki=null,Ri=new Map,Ii=new Map,Di=[],Mi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fi(t,e){switch(t){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Ri.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ii.delete(e.pointerId)}}function Li(t,e,i,s,n,r){return null===t||t.nativeEvent!==r?(t={blockedOn:e,domEventName:i,eventSystemFlags:s,nativeEvent:r,targetContainers:[n]},null!==e&&(null!==(e=vr(e))&&wi(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,null!==n&&-1===e.indexOf(n)&&e.push(n),t)}function Bi(t){var e=_r(t.target);if(null!==e){var i=Ve(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=He(i)))return t.blockedOn=e,void Si(t.priority,(function(){bi(i)}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function Oi(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=Xi(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=vr(i))&&wi(e),t.blockedOn=i,!1;var s=new(i=t.nativeEvent).constructor(i.type,i);ye=s,i.target.dispatchEvent(s),ye=null,e.shift()}return!0}function zi(t,e,i){Oi(t)&&i.delete(e)}function Ni(){Ei=!1,null!==Ti&&Oi(Ti)&&(Ti=null),null!==Ai&&Oi(Ai)&&(Ai=null),null!==ki&&Oi(ki)&&(ki=null),Ri.forEach(zi),Ii.forEach(zi)}function Ui(t,e){t.blockedOn===e&&(t.blockedOn=null,Ei||(Ei=!0,st.unstable_scheduleCallback(st.unstable_NormalPriority,Ni)))}function Vi(t){function e(e){return Ui(e,t)}if(0<Pi.length){Ui(Pi[0],t);for(var i=1;i<Pi.length;i++){var s=Pi[i];s.blockedOn===t&&(s.blockedOn=null)}}for(null!==Ti&&Ui(Ti,t),null!==Ai&&Ui(Ai,t),null!==ki&&Ui(ki,t),Ri.forEach(e),Ii.forEach(e),i=0;i<Di.length;i++)(s=Di[i]).blockedOn===t&&(s.blockedOn=null);for(;0<Di.length&&null===(i=Di[0]).blockedOn;)Bi(i),null===i.blockedOn&&Di.shift()}var Hi=yt.ReactCurrentBatchConfig,ji=!0;function Wi(t,e,i,s){var n=vi,r=Hi.transition;Hi.transition=null;try{vi=1,Gi(t,e,i,s)}finally{vi=n,Hi.transition=r}}function $i(t,e,i,s){var n=vi,r=Hi.transition;Hi.transition=null;try{vi=4,Gi(t,e,i,s)}finally{vi=n,Hi.transition=r}}function Gi(t,e,i,s){if(ji){var n=Xi(t,e,i,s);if(null===n)jn(t,e,s,qi,i),Fi(t,s);else if(function(t,e,i,s,n){switch(e){case"focusin":return Ti=Li(Ti,t,e,i,s,n),!0;case"dragenter":return Ai=Li(Ai,t,e,i,s,n),!0;case"mouseover":return ki=Li(ki,t,e,i,s,n),!0;case"pointerover":var r=n.pointerId;return Ri.set(r,Li(Ri.get(r)||null,t,e,i,s,n)),!0;case"gotpointercapture":return r=n.pointerId,Ii.set(r,Li(Ii.get(r)||null,t,e,i,s,n)),!0}return!1}(n,t,e,i,s))s.stopPropagation();else if(Fi(t,s),4&e&&-1<Mi.indexOf(t)){for(;null!==n;){var r=vr(n);if(null!==r&&xi(r),null===(r=Xi(t,e,i,s))&&jn(t,e,s,qi,i),r===n)break;n=r}null!==n&&s.stopPropagation()}else jn(t,e,s,null,i)}}var qi=null;function Xi(t,e,i,s){if(qi=null,null!==(t=_r(t=xe(s))))if(null===(e=Ve(t)))t=null;else if(13===(i=e.tag)){if(null!==(t=He(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qi=t,null}function Ki(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Qe:return 1;case Je:return 4;case ti:case ei:return 16;case ii:return 536870912;default:return 16}default:return 16}}var Yi=null,Zi=null,Qi=null;function Ji(){if(Qi)return Qi;var t,e,i=Zi,s=i.length,n="value"in Yi?Yi.value:Yi.textContent,r=n.length;for(t=0;t<s&&i[t]===n[t];t++);var o=s-t;for(e=1;e<=o&&i[s-e]===n[r-e];e++);return Qi=n.slice(t,1<e?1-e:void 0)}function ts(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function es(){return!0}function is(){return!1}function ss(t){function e(e,i,s,n,r){for(var o in this._reactName=e,this._targetInst=s,this.type=i,this.nativeEvent=n,this.target=r,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(n):n[o]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?es:is,this.isPropagationStopped=is,this}return Bt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=es)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=es)},persist:function(){},isPersistent:es}),e}var ns,rs,os,as={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ls=ss(as),hs=Bt({},as,{view:0,detail:0}),cs=ss(hs),us=Bt({},hs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cs,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==os&&(os&&"mousemove"===t.type?(ns=t.screenX-os.screenX,rs=t.screenY-os.screenY):rs=ns=0,os=t),ns)},movementY:function(t){return"movementY"in t?t.movementY:rs}}),ds=ss(us),ps=ss(Bt({},us,{dataTransfer:0})),fs=ss(Bt({},hs,{relatedTarget:0})),gs=ss(Bt({},as,{animationName:0,elapsedTime:0,pseudoElement:0})),ms=Bt({},as,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_s=ss(ms),vs=ss(Bt({},as,{data:0})),ys={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ws={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bs(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=ws[t])&&!!e[t]}function Cs(){return bs}var Ss=Bt({},hs,{key:function(t){if(t.key){var e=ys[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ts(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?xs[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cs,charCode:function(t){return"keypress"===t.type?ts(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ts(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Es=ss(Ss),Ps=ss(Bt({},us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ts=ss(Bt({},hs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cs})),As=ss(Bt({},as,{propertyName:0,elapsedTime:0,pseudoElement:0})),ks=Bt({},us,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rs=ss(ks),Is=[9,13,27,32],Ds=ht&&"CompositionEvent"in window,Ms=null;ht&&"documentMode"in document&&(Ms=document.documentMode);var Fs=ht&&"TextEvent"in window&&!Ms,Ls=ht&&(!Ds||Ms&&8<Ms&&11>=Ms),Bs=String.fromCharCode(32),Os=!1;function zs(t,e){switch(t){case"keyup":return-1!==Is.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ns(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Us=!1;var Vs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hs(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Vs[t.type]:"textarea"===e}function js(t,e,i,s){Ee(s),0<(e=$n(e,"onChange")).length&&(i=new ls("onChange","change",null,i,s),t.push({event:i,listeners:e}))}var Ws=null,$s=null;function Gs(t){On(t,0)}function qs(t){if(Gt(yr(t)))return t}function Xs(t,e){if("change"===t)return e}var Ks=!1;if(ht){var Ys;if(ht){var Zs="oninput"in document;if(!Zs){var Qs=document.createElement("div");Qs.setAttribute("oninput","return;"),Zs="function"==typeof Qs.oninput}Ys=Zs}else Ys=!1;Ks=Ys&&(!document.documentMode||9<document.documentMode)}function Js(){Ws&&(Ws.detachEvent("onpropertychange",tn),$s=Ws=null)}function tn(t){if("value"===t.propertyName&&qs($s)){var e=[];js(e,$s,t,xe(t)),Re(Gs,e)}}function en(t,e,i){"focusin"===t?(Js(),$s=i,(Ws=e).attachEvent("onpropertychange",tn)):"focusout"===t&&Js()}function sn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return qs($s)}function nn(t,e){if("click"===t)return qs(e)}function rn(t,e){if("input"===t||"change"===t)return qs(e)}var on="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e};function an(t,e){if(on(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(s=0;s<i.length;s++){var n=i[s];if(!ct.call(e,n)||!on(t[n],e[n]))return!1}return!0}function ln(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hn(t,e){var i,s=ln(t);for(t=0;s;){if(3===s.nodeType){if(i=t+s.textContent.length,t<=e&&i>=e)return{node:s,offset:e-t};t=i}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=ln(s)}}function cn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?cn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function un(){for(var t=window,e=qt();e instanceof t.HTMLIFrameElement;){try{var i="string"==typeof e.contentWindow.location.href}catch(s){i=!1}if(!i)break;e=qt((t=e.contentWindow).document)}return e}function dn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pn(t){var e=un(),i=t.focusedElem,s=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&cn(i.ownerDocument.documentElement,i)){if(null!==s&&dn(i))if(e=s.start,void 0===(t=s.end)&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if((t=(e=i.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var n=i.textContent.length,r=Math.min(s.start,n);s=void 0===s.end?r:Math.min(s.end,n),!t.extend&&r>s&&(n=s,s=r,r=n),n=hn(i,r);var o=hn(i,s);n&&o&&(1!==t.rangeCount||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(n.node,n.offset),t.removeAllRanges(),r>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=i;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"==typeof i.focus&&i.focus(),i=0;i<e.length;i++)(t=e[i]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fn=ht&&"documentMode"in document&&11>=document.documentMode,gn=null,mn=null,_n=null,vn=!1;function yn(t,e,i){var s=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;vn||null==gn||gn!==qt(s)||("selectionStart"in(s=gn)&&dn(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},_n&&an(_n,s)||(_n=s,0<(s=$n(mn,"onSelect")).length&&(e=new ls("onSelect","select",null,e,i),t.push({event:e,listeners:s}),e.target=gn)))}function xn(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var wn={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionend:xn("Transition","TransitionEnd")},bn={},Cn={};function Sn(t){if(bn[t])return bn[t];if(!wn[t])return t;var e,i=wn[t];for(e in i)if(i.hasOwnProperty(e)&&e in Cn)return bn[t]=i[e];return t}ht&&(Cn=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var En=Sn("animationend"),Pn=Sn("animationiteration"),Tn=Sn("animationstart"),An=Sn("transitionend"),kn=new Map,Rn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(t,e){kn.set(t,e),at(e,[t])}for(var Dn=0;Dn<Rn.length;Dn++){var Mn=Rn[Dn];In(Mn.toLowerCase(),"on"+(Mn[0].toUpperCase()+Mn.slice(1)))}In(En,"onAnimationEnd"),In(Pn,"onAnimationIteration"),In(Tn,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(An,"onTransitionEnd"),lt("onMouseEnter",["mouseout","mouseover"]),lt("onMouseLeave",["mouseout","mouseover"]),lt("onPointerEnter",["pointerout","pointerover"]),lt("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fn));function Bn(t,e,i){var s=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,s,n,r,o,a,l){if(Ue.apply(this,arguments),Le){if(!Le)throw Error(nt(198));var h=Be;Le=!1,Be=null,Oe||(Oe=!0,ze=h)}}(s,e,void 0,t),t.currentTarget=null}function On(t,e){e=0!=(4&e);for(var i=0;i<t.length;i++){var s=t[i],n=s.event;s=s.listeners;t:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==r&&n.isPropagationStopped())break t;Bn(n,a,h),r=l}else for(o=0;o<s.length;o++){if(l=(a=s[o]).instance,h=a.currentTarget,a=a.listener,l!==r&&n.isPropagationStopped())break t;Bn(n,a,h),r=l}}}if(Oe)throw t=ze,Oe=!1,ze=null,t}function zn(t,e){var i=e[fr];void 0===i&&(i=e[fr]=new Set);var s=t+"__bubble";i.has(s)||(Hn(e,t,2,!1),i.add(s))}function Nn(t,e,i){var s=0;e&&(s|=4),Hn(i,t,s,e)}var Un="_reactListening"+Math.random().toString(36).slice(2);function Vn(t){if(!t[Un]){t[Un]=!0,rt.forEach((function(e){"selectionchange"!==e&&(Ln.has(e)||Nn(e,!1,t),Nn(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Un]||(e[Un]=!0,Nn("selectionchange",!1,e))}}function Hn(t,e,i,s){switch(Ki(e)){case 1:var n=Wi;break;case 4:n=$i;break;default:n=Gi}i=n.bind(null,e,i,t),n=void 0,!De||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(n=!0),s?void 0!==n?t.addEventListener(e,i,{capture:!0,passive:n}):t.addEventListener(e,i,!0):void 0!==n?t.addEventListener(e,i,{passive:n}):t.addEventListener(e,i,!1)}function jn(t,e,i,s,n){var r=s;if(0==(1&e)&&0==(2&e)&&null!==s)t:for(;;){if(null===s)return;var o=s.tag;if(3===o||4===o){var a=s.stateNode.containerInfo;if(a===n||8===a.nodeType&&a.parentNode===n)break;if(4===o)for(o=s.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;o=o.return}for(;null!==a;){if(null===(o=_r(a)))return;if(5===(l=o.tag)||6===l){s=r=o;continue t}a=a.parentNode}}s=s.return}Re((function(){var s=r,n=xe(i),o=[];t:{var a=kn.get(t);if(void 0!==a){var l=ls,h=t;switch(t){case"keypress":if(0===ts(i))break t;case"keydown":case"keyup":l=Es;break;case"focusin":h="focus",l=fs;break;case"focusout":h="blur",l=fs;break;case"beforeblur":case"afterblur":l=fs;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ds;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=ps;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ts;break;case En:case Pn:case Tn:l=gs;break;case An:l=As;break;case"scroll":l=cs;break;case"wheel":l=Rs;break;case"copy":case"cut":case"paste":l=_s;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ps}var c=0!=(4&e),u=!c&&"scroll"===t,d=c?null!==a?a+"Capture":null:a;c=[];for(var p,f=s;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==d&&(null!=(g=Ie(f,d))&&c.push(Wn(f,g,p)))),u)break;f=f.return}0<c.length&&(a=new l(a,h,null,i,n),o.push({event:a,listeners:c}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||i===ye||!(h=i.relatedTarget||i.fromElement)||!_r(h)&&!h[pr])&&(l||a)&&(a=n.window===n?n:(a=n.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=s,null!==(h=(h=i.relatedTarget||i.toElement)?_r(h):null)&&(h!==(u=Ve(h))||5!==h.tag&&6!==h.tag)&&(h=null)):(l=null,h=s),l!==h)){if(c=ds,g="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(c=Ps,g="onPointerLeave",d="onPointerEnter",f="pointer"),u=null==l?a:yr(l),p=null==h?a:yr(h),(a=new c(g,f+"leave",l,i,n)).target=u,a.relatedTarget=p,g=null,_r(n)===s&&((c=new c(d,f+"enter",h,i,n)).target=p,c.relatedTarget=u,g=c),u=g,l&&h)t:{for(d=h,f=0,p=c=l;p;p=Gn(p))f++;for(p=0,g=d;g;g=Gn(g))p++;for(;0<f-p;)c=Gn(c),f--;for(;0<p-f;)d=Gn(d),p--;for(;f--;){if(c===d||null!==d&&c===d.alternate)break t;c=Gn(c),d=Gn(d)}c=null}else c=null;null!==l&&qn(o,a,l,c,!1),null!==h&&null!==u&&qn(o,u,h,c,!0)}if("select"===(l=(a=s?yr(s):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Xs;else if(Hs(a))if(Ks)m=rn;else{m=sn;var _=en}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=nn);switch(m&&(m=m(t,s))?js(o,m,i,n):(_&&_(t,a,s),"focusout"===t&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&Jt(a,"number",a.value)),_=s?yr(s):window,t){case"focusin":(Hs(_)||"true"===_.contentEditable)&&(gn=_,mn=s,_n=null);break;case"focusout":_n=mn=gn=null;break;case"mousedown":vn=!0;break;case"contextmenu":case"mouseup":case"dragend":vn=!1,yn(o,i,n);break;case"selectionchange":if(fn)break;case"keydown":case"keyup":yn(o,i,n)}var v;if(Ds)t:{switch(t){case"compositionstart":var y="onCompositionStart";break t;case"compositionend":y="onCompositionEnd";break t;case"compositionupdate":y="onCompositionUpdate";break t}y=void 0}else Us?zs(t,i)&&(y="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(y="onCompositionStart");y&&(Ls&&"ko"!==i.locale&&(Us||"onCompositionStart"!==y?"onCompositionEnd"===y&&Us&&(v=Ji()):(Zi="value"in(Yi=n)?Yi.value:Yi.textContent,Us=!0)),0<(_=$n(s,y)).length&&(y=new vs(y,t,null,i,n),o.push({event:y,listeners:_}),v?y.data=v:null!==(v=Ns(i))&&(y.data=v))),(v=Fs?function(t,e){switch(t){case"compositionend":return Ns(e);case"keypress":return 32!==e.which?null:(Os=!0,Bs);case"textInput":return(t=e.data)===Bs&&Os?null:t;default:return null}}(t,i):function(t,e){if(Us)return"compositionend"===t||!Ds&&zs(t,e)?(t=Ji(),Qi=Zi=Yi=null,Us=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ls&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(s=$n(s,"onBeforeInput")).length&&(n=new vs("onBeforeInput","beforeinput",null,i,n),o.push({event:n,listeners:s}),n.data=v))}On(o,e)}))}function Wn(t,e,i){return{instance:t,listener:e,currentTarget:i}}function $n(t,e){for(var i=e+"Capture",s=[];null!==t;){var n=t,r=n.stateNode;5===n.tag&&null!==r&&(n=r,null!=(r=Ie(t,i))&&s.unshift(Wn(t,r,n)),null!=(r=Ie(t,e))&&s.push(Wn(t,r,n))),t=t.return}return s}function Gn(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function qn(t,e,i,s,n){for(var r=e._reactName,o=[];null!==i&&i!==s;){var a=i,l=a.alternate,h=a.stateNode;if(null!==l&&l===s)break;5===a.tag&&null!==h&&(a=h,n?null!=(l=Ie(i,r))&&o.unshift(Wn(i,l,a)):n||null!=(l=Ie(i,r))&&o.push(Wn(i,l,a))),i=i.return}0!==o.length&&t.push({event:e,listeners:o})}var Xn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Yn(t){return("string"==typeof t?t:""+t).replace(Xn,"\n").replace(Kn,"")}function Zn(t,e,i){if(e=Yn(e),Yn(t)!==e&&i)throw Error(nt(425))}function Qn(){}var Jn=null,tr=null;function er(t,e){return"textarea"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"==typeof setTimeout?setTimeout:void 0,sr="function"==typeof clearTimeout?clearTimeout:void 0,nr="function"==typeof Promise?Promise:void 0,rr="function"==typeof queueMicrotask?queueMicrotask:void 0!==nr?function(t){return nr.resolve(null).then(t).catch(or)}:ir;function or(t){setTimeout((function(){throw t}))}function ar(t,e){var i=e,s=0;do{var n=i.nextSibling;if(t.removeChild(i),n&&8===n.nodeType)if("/$"===(i=n.data)){if(0===s)return t.removeChild(n),void Vi(e);s--}else"$"!==i&&"$?"!==i&&"$!"!==i||s++;i=n}while(i);Vi(e)}function lr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function hr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var cr=Math.random().toString(36).slice(2),ur="__reactFiber$"+cr,dr="__reactProps$"+cr,pr="__reactContainer$"+cr,fr="__reactEvents$"+cr,gr="__reactListeners$"+cr,mr="__reactHandles$"+cr;function _r(t){var e=t[ur];if(e)return e;for(var i=t.parentNode;i;){if(e=i[pr]||i[ur]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=hr(t);null!==t;){if(i=t[ur])return i;t=hr(t)}return e}i=(t=i).parentNode}return null}function vr(t){return!(t=t[ur]||t[pr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function yr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(nt(33))}function xr(t){return t[dr]||null}var wr=[],br=-1;function Cr(t){return{current:t}}function Sr(t){0>br||(t.current=wr[br],wr[br]=null,br--)}function Er(t,e){br++,wr[br]=t.current,t.current=e}var Pr={},Tr=Cr(Pr),Ar=Cr(!1),kr=Pr;function Rr(t,e){var i=t.type.contextTypes;if(!i)return Pr;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n,r={};for(n in i)r[n]=e[n];return s&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ir(t){return null!=(t=t.childContextTypes)}function Dr(){Sr(Ar),Sr(Tr)}function Mr(t,e,i){if(Tr.current!==Pr)throw Error(nt(168));Er(Tr,e),Er(Ar,i)}function Fr(t,e,i){var s=t.stateNode;if(e=e.childContextTypes,"function"!=typeof s.getChildContext)return i;for(var n in s=s.getChildContext())if(!(n in e))throw Error(nt(108,Ht(t)||"Unknown",n));return Bt({},i,s)}function Lr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Pr,kr=Tr.current,Er(Tr,t),Er(Ar,Ar.current),!0}function Br(t,e,i){var s=t.stateNode;if(!s)throw Error(nt(169));i?(t=Fr(t,e,kr),s.__reactInternalMemoizedMergedChildContext=t,Sr(Ar),Sr(Tr),Er(Tr,t)):Sr(Ar),Er(Ar,i)}var Or=null,zr=!1,Nr=!1;function Ur(t){null===Or?Or=[t]:Or.push(t)}function Vr(){if(!Nr&&null!==Or){Nr=!0;var t=0,e=vi;try{var i=Or;for(vi=1;t<i.length;t++){var s=i[t];do{s=s(!0)}while(null!==s)}Or=null,zr=!1}catch(Yy){throw null!==Or&&(Or=Or.slice(t+1)),Ge(Qe,Vr),Yy}finally{vi=e,Nr=!1}}return null}var Hr=[],jr=0,Wr=null,$r=0,Gr=[],qr=0,Xr=null,Kr=1,Yr="";function Zr(t,e){Hr[jr++]=$r,Hr[jr++]=Wr,Wr=t,$r=e}function Qr(t,e,i){Gr[qr++]=Kr,Gr[qr++]=Yr,Gr[qr++]=Xr,Xr=t;var s=Kr;t=Yr;var n=32-ri(s)-1;s&=~(1<<n),i+=1;var r=32-ri(e)+n;if(30<r){var o=n-n%5;r=(s&(1<<o)-1).toString(32),s>>=o,n-=o,Kr=1<<32-ri(e)+n|i<<n|s,Yr=r+t}else Kr=1<<r|i<<n|s,Yr=t}function Jr(t){null!==t.return&&(Zr(t,1),Qr(t,1,0))}function to(t){for(;t===Wr;)Wr=Hr[--jr],Hr[jr]=null,$r=Hr[--jr],Hr[jr]=null;for(;t===Xr;)Xr=Gr[--qr],Gr[qr]=null,Yr=Gr[--qr],Gr[qr]=null,Kr=Gr[--qr],Gr[qr]=null}var eo=null,io=null,so=!1,no=null;function ro(t,e){var i=Ic(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,null===(e=t.deletions)?(t.deletions=[i],t.flags|=16):e.push(i)}function oo(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,eo=t,io=lr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,eo=t,io=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(i=null!==Xr?{id:Kr,overflow:Yr}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},(i=Ic(18,null,null,0)).stateNode=e,i.return=t,t.child=i,eo=t,io=null,!0);default:return!1}}function ao(t){return 0!=(1&t.mode)&&0==(128&t.flags)}function lo(t){if(so){var e=io;if(e){var i=e;if(!oo(t,e)){if(ao(t))throw Error(nt(418));e=lr(i.nextSibling);var s=eo;e&&oo(t,e)?ro(s,i):(t.flags=-4097&t.flags|2,so=!1,eo=t)}}else{if(ao(t))throw Error(nt(418));t.flags=-4097&t.flags|2,so=!1,eo=t}}}function ho(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;eo=t}function co(t){if(t!==eo)return!1;if(!so)return ho(t),so=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!er(t.type,t.memoizedProps)),e&&(e=io)){if(ao(t))throw uo(),Error(nt(418));for(;e;)ro(t,e),e=lr(e.nextSibling)}if(ho(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(nt(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){io=lr(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}io=null}}else io=eo?lr(t.stateNode.nextSibling):null;return!0}function uo(){for(var t=io;t;)t=lr(t.nextSibling)}function po(){io=eo=null,so=!1}function fo(t){null===no?no=[t]:no.push(t)}var go=yt.ReactCurrentBatchConfig;function mo(t,e){if(t&&t.defaultProps){for(var i in e=Bt({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}var _o=Cr(null),vo=null,yo=null,xo=null;function wo(){xo=yo=vo=null}function bo(t){var e=_o.current;Sr(_o),t._currentValue=e}function Co(t,e,i){for(;null!==t;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==s&&(s.childLanes|=e)):null!==s&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===i)break;t=t.return}}function So(t,e){vo=t,xo=yo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(yl=!0),t.firstContext=null)}function Eo(t){var e=t._currentValue;if(xo!==t)if(t={context:t,memoizedValue:e,next:null},null===yo){if(null===vo)throw Error(nt(308));yo=t,vo.dependencies={lanes:0,firstContext:t}}else yo=yo.next=t;return e}var Po=null;function To(t){null===Po?Po=[t]:Po.push(t)}function Ao(t,e,i,s){var n=e.interleaved;return null===n?(i.next=i,To(e)):(i.next=n.next,n.next=i),e.interleaved=i,ko(t,s)}function ko(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}var Ro=!1;function Io(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Do(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fo(t,e,i){var s=t.updateQueue;if(null===s)return null;if(s=s.shared,0!=(2&Ah)){var n=s.pending;return null===n?e.next=e:(e.next=n.next,n.next=e),s.pending=e,ko(t,i)}return null===(n=s.interleaved)?(e.next=e,To(s)):(e.next=n.next,n.next=e),s.interleaved=e,ko(t,i)}function Lo(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!=(4194240&i))){var s=e.lanes;i|=s&=t.pendingLanes,e.lanes=i,_i(t,i)}}function Bo(t,e){var i=t.updateQueue,s=t.alternate;if(null!==s&&i===(s=s.updateQueue)){var n=null,r=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===r?n=r=o:r=r.next=o,i=i.next}while(null!==i);null===r?n=r=e:r=r.next=e}else n=r=e;return i={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:s.shared,effects:s.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Oo(t,e,i,s){var n=t.updateQueue;Ro=!1;var r=n.firstBaseUpdate,o=n.lastBaseUpdate,a=n.shared.pending;if(null!==a){n.shared.pending=null;var l=a,h=l.next;l.next=null,null===o?r=h:o.next=h,o=l;var c=t.alternate;null!==c&&((a=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===a?c.firstBaseUpdate=h:a.next=h,c.lastBaseUpdate=l))}if(null!==r){var u=n.baseState;for(o=0,c=h=l=null,a=r;;){var d=a.lane,p=a.eventTime;if((s&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var f=t,g=a;switch(d=e,p=i,g.tag){case 1:if("function"==typeof(f=g.payload)){u=f.call(p,u,d);break t}u=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=g.payload)?f.call(p,u,d):f))break t;u=Bt({},u,d);break t;case 2:Ro=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(d=n.effects)?n.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(h=c=p,l=u):c=c.next=p,o|=d;if(null===(a=a.next)){if(null===(a=n.shared.pending))break;a=(d=a).next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}if(null===c&&(l=u),n.baseState=l,n.firstBaseUpdate=h,n.lastBaseUpdate=c,null!==(e=n.shared.interleaved)){n=e;do{o|=n.lane,n=n.next}while(n!==e)}else null===r&&(n.shared.lanes=0);Bh|=o,t.lanes=o,t.memoizedState=u}}function zo(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(null!==n){if(s.callback=null,s=i,"function"!=typeof n)throw Error(nt(191,n));n.call(s)}}}var No=(new it.Component).refs;function Uo(t,e,i,s){i=null==(i=i(s,e=t.memoizedState))?e:Bt({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var Vo={isMounted:function(t){return!!(t=t._reactInternals)&&Ve(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var s=tc(),n=ec(t),r=Mo(s,n);r.payload=e,null!=i&&(r.callback=i),null!==(e=Fo(t,r,n))&&(ic(e,t,n,s),Lo(e,t,n))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var s=tc(),n=ec(t),r=Mo(s,n);r.tag=1,r.payload=e,null!=i&&(r.callback=i),null!==(e=Fo(t,r,n))&&(ic(e,t,n,s),Lo(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=tc(),s=ec(t),n=Mo(i,s);n.tag=2,null!=e&&(n.callback=e),null!==(e=Fo(t,n,s))&&(ic(e,t,s,i),Lo(e,t,s))}};function Ho(t,e,i,s,n,r,o){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(s,r,o):!e.prototype||!e.prototype.isPureReactComponent||(!an(i,s)||!an(n,r))}function jo(t,e,i){var s=!1,n=Pr,r=e.contextType;return"object"==typeof r&&null!==r?r=Eo(r):(n=Ir(e)?kr:Tr.current,r=(s=null!=(s=e.contextTypes))?Rr(t,n):Pr),e=new e(i,r),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Vo,t.stateNode=e,e._reactInternals=t,s&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=r),e}function Wo(t,e,i,s){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,s),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,s),e.state!==t&&Vo.enqueueReplaceState(e,e.state,null)}function $o(t,e,i,s){var n=t.stateNode;n.props=i,n.state=t.memoizedState,n.refs=No,Io(t);var r=e.contextType;"object"==typeof r&&null!==r?n.context=Eo(r):(r=Ir(e)?kr:Tr.current,n.context=Rr(t,r)),n.state=t.memoizedState,"function"==typeof(r=e.getDerivedStateFromProps)&&(Uo(t,e,r,i),n.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(e=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),e!==n.state&&Vo.enqueueReplaceState(n,n.state,null),Oo(t,i,n,s),n.state=t.memoizedState),"function"==typeof n.componentDidMount&&(t.flags|=4194308)}function Go(t,e,i){if(null!==(t=i.ref)&&"function"!=typeof t&&"object"!=typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(nt(309));var s=i.stateNode}if(!s)throw Error(nt(147,t));var n=s,r=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===r?e.ref:((e=function(t){var e=n.refs;e===No&&(e=n.refs={}),null===t?delete e[r]:e[r]=t})._stringRef=r,e)}if("string"!=typeof t)throw Error(nt(284));if(!i._owner)throw Error(nt(290,t))}return t}function qo(t,e){throw t=Object.prototype.toString.call(e),Error(nt(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xo(t){return(0,t._init)(t._payload)}function Ko(t){function e(e,i){if(t){var s=e.deletions;null===s?(e.deletions=[i],e.flags|=16):s.push(i)}}function i(i,s){if(!t)return null;for(;null!==s;)e(i,s),s=s.sibling;return null}function s(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(t,e){return(t=Mc(t,e)).index=0,t.sibling=null,t}function r(e,i,s){return e.index=s,t?null!==(s=e.alternate)?(s=s.index)<i?(e.flags|=2,i):s:(e.flags|=2,i):(e.flags|=1048576,i)}function o(e){return t&&null===e.alternate&&(e.flags|=2),e}function a(t,e,i,s){return null===e||6!==e.tag?((e=Oc(i,t.mode,s)).return=t,e):((e=n(e,i)).return=t,e)}function l(t,e,i,s){var r=i.type;return r===bt?c(t,e,i.props.children,s,i.key):null!==e&&(e.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===It&&Xo(r)===e.type)?((s=n(e,i.props)).ref=Go(t,e,i),s.return=t,s):((s=Fc(i.type,i.key,i.props,null,t.mode,s)).ref=Go(t,e,i),s.return=t,s)}function h(t,e,i,s){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=zc(i,t.mode,s)).return=t,e):((e=n(e,i.children||[])).return=t,e)}function c(t,e,i,s,r){return null===e||7!==e.tag?((e=Lc(i,t.mode,s,r)).return=t,e):((e=n(e,i)).return=t,e)}function u(t,e,i){if("string"==typeof e&&""!==e||"number"==typeof e)return(e=Oc(""+e,t.mode,i)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case xt:return(i=Fc(e.type,e.key,e.props,null,t.mode,i)).ref=Go(t,null,e),i.return=t,i;case wt:return(e=zc(e,t.mode,i)).return=t,e;case It:return u(t,(0,e._init)(e._payload),i)}if(te(e)||Ft(e))return(e=Lc(e,t.mode,i,null)).return=t,e;qo(t,e)}return null}function d(t,e,i,s){var n=null!==e?e.key:null;if("string"==typeof i&&""!==i||"number"==typeof i)return null!==n?null:a(t,e,""+i,s);if("object"==typeof i&&null!==i){switch(i.$$typeof){case xt:return i.key===n?l(t,e,i,s):null;case wt:return i.key===n?h(t,e,i,s):null;case It:return d(t,e,(n=i._init)(i._payload),s)}if(te(i)||Ft(i))return null!==n?null:c(t,e,i,s,null);qo(t,i)}return null}function p(t,e,i,s,n){if("string"==typeof s&&""!==s||"number"==typeof s)return a(e,t=t.get(i)||null,""+s,n);if("object"==typeof s&&null!==s){switch(s.$$typeof){case xt:return l(e,t=t.get(null===s.key?i:s.key)||null,s,n);case wt:return h(e,t=t.get(null===s.key?i:s.key)||null,s,n);case It:return p(t,e,i,(0,s._init)(s._payload),n)}if(te(s)||Ft(s))return c(e,t=t.get(i)||null,s,n,null);qo(e,s)}return null}return function a(l,h,c,f){if("object"==typeof c&&null!==c&&c.type===bt&&null===c.key&&(c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case xt:t:{for(var g=c.key,m=h;null!==m;){if(m.key===g){if((g=c.type)===bt){if(7===m.tag){i(l,m.sibling),(h=n(m,c.props.children)).return=l,l=h;break t}}else if(m.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===It&&Xo(g)===m.type){i(l,m.sibling),(h=n(m,c.props)).ref=Go(l,m,c),h.return=l,l=h;break t}i(l,m);break}e(l,m),m=m.sibling}c.type===bt?((h=Lc(c.props.children,l.mode,f,c.key)).return=l,l=h):((f=Fc(c.type,c.key,c.props,null,l.mode,f)).ref=Go(l,h,c),f.return=l,l=f)}return o(l);case wt:t:{for(m=c.key;null!==h;){if(h.key===m){if(4===h.tag&&h.stateNode.containerInfo===c.containerInfo&&h.stateNode.implementation===c.implementation){i(l,h.sibling),(h=n(h,c.children||[])).return=l,l=h;break t}i(l,h);break}e(l,h),h=h.sibling}(h=zc(c,l.mode,f)).return=l,l=h}return o(l);case It:return a(l,h,(m=c._init)(c._payload),f)}if(te(c))return function(n,o,a,l){for(var h=null,c=null,f=o,g=o=0,m=null;null!==f&&g<a.length;g++){f.index>g?(m=f,f=null):m=f.sibling;var _=d(n,f,a[g],l);if(null===_){null===f&&(f=m);break}t&&f&&null===_.alternate&&e(n,f),o=r(_,o,g),null===c?h=_:c.sibling=_,c=_,f=m}if(g===a.length)return i(n,f),so&&Zr(n,g),h;if(null===f){for(;g<a.length;g++)null!==(f=u(n,a[g],l))&&(o=r(f,o,g),null===c?h=f:c.sibling=f,c=f);return so&&Zr(n,g),h}for(f=s(n,f);g<a.length;g++)null!==(m=p(f,n,g,a[g],l))&&(t&&null!==m.alternate&&f.delete(null===m.key?g:m.key),o=r(m,o,g),null===c?h=m:c.sibling=m,c=m);return t&&f.forEach((function(t){return e(n,t)})),so&&Zr(n,g),h}(l,h,c,f);if(Ft(c))return function(n,o,a,l){var h=Ft(a);if("function"!=typeof h)throw Error(nt(150));if(null==(a=h.call(a)))throw Error(nt(151));for(var c=h=null,f=o,g=o=0,m=null,_=a.next();null!==f&&!_.done;g++,_=a.next()){f.index>g?(m=f,f=null):m=f.sibling;var v=d(n,f,_.value,l);if(null===v){null===f&&(f=m);break}t&&f&&null===v.alternate&&e(n,f),o=r(v,o,g),null===c?h=v:c.sibling=v,c=v,f=m}if(_.done)return i(n,f),so&&Zr(n,g),h;if(null===f){for(;!_.done;g++,_=a.next())null!==(_=u(n,_.value,l))&&(o=r(_,o,g),null===c?h=_:c.sibling=_,c=_);return so&&Zr(n,g),h}for(f=s(n,f);!_.done;g++,_=a.next())null!==(_=p(f,n,g,_.value,l))&&(t&&null!==_.alternate&&f.delete(null===_.key?g:_.key),o=r(_,o,g),null===c?h=_:c.sibling=_,c=_);return t&&f.forEach((function(t){return e(n,t)})),so&&Zr(n,g),h}(l,h,c,f);qo(l,c)}return"string"==typeof c&&""!==c||"number"==typeof c?(c=""+c,null!==h&&6===h.tag?(i(l,h.sibling),(h=n(h,c)).return=l,l=h):(i(l,h),(h=Oc(c,l.mode,f)).return=l,l=h),o(l)):i(l,h)}}var Yo=Ko(!0),Zo=Ko(!1),Qo={},Jo=Cr(Qo),ta=Cr(Qo),ea=Cr(Qo);function ia(t){if(t===Qo)throw Error(nt(174));return t}function sa(t,e){switch(Er(ea,e),Er(ta,t),Er(Jo,Qo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ae(null,"");break;default:e=ae(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Sr(Jo),Er(Jo,e)}function na(){Sr(Jo),Sr(ta),Sr(ea)}function ra(t){ia(ea.current);var e=ia(Jo.current),i=ae(e,t.type);e!==i&&(Er(ta,t),Er(Jo,i))}function oa(t){ta.current===t&&(Sr(Jo),Sr(ta))}var aa=Cr(0);function la(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ha=[];function ca(){for(var t=0;t<ha.length;t++)ha[t]._workInProgressVersionPrimary=null;ha.length=0}var ua=yt.ReactCurrentDispatcher,da=yt.ReactCurrentBatchConfig,pa=0,fa=null,ga=null,ma=null,_a=!1,va=!1,ya=0,xa=0;function wa(){throw Error(nt(321))}function ba(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!on(t[i],e[i]))return!1;return!0}function Ca(t,e,i,s,n,r){if(pa=r,fa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ua.current=null===t||null===t.memoizedState?ol:al,t=i(s,n),va){r=0;do{if(va=!1,ya=0,25<=r)throw Error(nt(301));r+=1,ma=ga=null,e.updateQueue=null,ua.current=ll,t=i(s,n)}while(va)}if(ua.current=rl,e=null!==ga&&null!==ga.next,pa=0,ma=ga=fa=null,_a=!1,e)throw Error(nt(300));return t}function Sa(){var t=0!==ya;return ya=0,t}function Ea(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?fa.memoizedState=ma=t:ma=ma.next=t,ma}function Pa(){if(null===ga){var t=fa.alternate;t=null!==t?t.memoizedState:null}else t=ga.next;var e=null===ma?fa.memoizedState:ma.next;if(null!==e)ma=e,ga=t;else{if(null===t)throw Error(nt(310));t={memoizedState:(ga=t).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ma?fa.memoizedState=ma=t:ma=ma.next=t}return ma}function Ta(t,e){return"function"==typeof e?e(t):e}function Aa(t){var e=Pa(),i=e.queue;if(null===i)throw Error(nt(311));i.lastRenderedReducer=t;var s=ga,n=s.baseQueue,r=i.pending;if(null!==r){if(null!==n){var o=n.next;n.next=r.next,r.next=o}s.baseQueue=n=r,i.pending=null}if(null!==n){r=n.next,s=s.baseState;var a=o=null,l=null,h=r;do{var c=h.lane;if((pa&c)===c)null!==l&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),s=h.hasEagerState?h.eagerState:t(s,h.action);else{var u={lane:c,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};null===l?(a=l=u,o=s):l=l.next=u,fa.lanes|=c,Bh|=c}h=h.next}while(null!==h&&h!==r);null===l?o=s:l.next=a,on(s,e.memoizedState)||(yl=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,i.lastRenderedState=s}if(null!==(t=i.interleaved)){n=t;do{r=n.lane,fa.lanes|=r,Bh|=r,n=n.next}while(n!==t)}else null===n&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function ka(t){var e=Pa(),i=e.queue;if(null===i)throw Error(nt(311));i.lastRenderedReducer=t;var s=i.dispatch,n=i.pending,r=e.memoizedState;if(null!==n){i.pending=null;var o=n=n.next;do{r=t(r,o.action),o=o.next}while(o!==n);on(r,e.memoizedState)||(yl=!0),e.memoizedState=r,null===e.baseQueue&&(e.baseState=r),i.lastRenderedState=r}return[r,s]}function Ra(){}function Ia(t,e){var i=fa,s=Pa(),n=e(),r=!on(s.memoizedState,n);if(r&&(s.memoizedState=n,yl=!0),s=s.queue,ja(Fa.bind(null,i,s,t),[t]),s.getSnapshot!==e||r||null!==ma&&1&ma.memoizedState.tag){if(i.flags|=2048,za(9,Ma.bind(null,i,s,n,e),void 0,null),null===kh)throw Error(nt(349));0!=(30&pa)||Da(i,e,n)}return n}function Da(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=fa.updateQueue)?(e={lastEffect:null,stores:null},fa.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function Ma(t,e,i,s){e.value=i,e.getSnapshot=s,La(e)&&Ba(t)}function Fa(t,e,i){return i((function(){La(e)&&Ba(t)}))}function La(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!on(t,i)}catch(s){return!0}}function Ba(t){var e=ko(t,1);null!==e&&ic(e,t,1,-1)}function Oa(t){var e=Ea();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ta,lastRenderedState:t},e.queue=t,t=t.dispatch=el.bind(null,fa,t),[e.memoizedState,t]}function za(t,e,i,s){return t={tag:t,create:e,destroy:i,deps:s,next:null},null===(e=fa.updateQueue)?(e={lastEffect:null,stores:null},fa.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(s=i.next,i.next=t,t.next=s,e.lastEffect=t),t}function Na(){return Pa().memoizedState}function Ua(t,e,i,s){var n=Ea();fa.flags|=t,n.memoizedState=za(1|e,i,void 0,void 0===s?null:s)}function Va(t,e,i,s){var n=Pa();s=void 0===s?null:s;var r=void 0;if(null!==ga){var o=ga.memoizedState;if(r=o.destroy,null!==s&&ba(s,o.deps))return void(n.memoizedState=za(e,i,r,s))}fa.flags|=t,n.memoizedState=za(1|e,i,r,s)}function Ha(t,e){return Ua(8390656,8,t,e)}function ja(t,e){return Va(2048,8,t,e)}function Wa(t,e){return Va(4,2,t,e)}function $a(t,e){return Va(4,4,t,e)}function Ga(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function qa(t,e,i){return i=null!=i?i.concat([t]):null,Va(4,4,Ga.bind(null,e,t),i)}function Xa(){}function Ka(t,e){var i=Pa();e=void 0===e?null:e;var s=i.memoizedState;return null!==s&&null!==e&&ba(e,s[1])?s[0]:(i.memoizedState=[t,e],t)}function Ya(t,e){var i=Pa();e=void 0===e?null:e;var s=i.memoizedState;return null!==s&&null!==e&&ba(e,s[1])?s[0]:(t=t(),i.memoizedState=[t,e],t)}function Za(t,e,i){return 0==(21&pa)?(t.baseState&&(t.baseState=!1,yl=!0),t.memoizedState=i):(on(i,e)||(i=fi(),fa.lanes|=i,Bh|=i,t.baseState=!0),e)}function Qa(t,e){var i=vi;vi=0!==i&&4>i?i:4,t(!0);var s=da.transition;da.transition={};try{t(!1),e()}finally{vi=i,da.transition=s}}function Ja(){return Pa().memoizedState}function tl(t,e,i){var s=ec(t);if(i={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null},il(t))sl(e,i);else if(null!==(i=Ao(t,e,i,s))){ic(i,t,s,tc()),nl(i,e,s)}}function el(t,e,i){var s=ec(t),n={lane:s,action:i,hasEagerState:!1,eagerState:null,next:null};if(il(t))sl(e,n);else{var r=t.alternate;if(0===t.lanes&&(null===r||0===r.lanes)&&null!==(r=e.lastRenderedReducer))try{var o=e.lastRenderedState,a=r(o,i);if(n.hasEagerState=!0,n.eagerState=a,on(a,o)){var l=e.interleaved;return null===l?(n.next=n,To(e)):(n.next=l.next,l.next=n),void(e.interleaved=n)}}catch(Jy){}null!==(i=Ao(t,e,n,s))&&(ic(i,t,s,n=tc()),nl(i,e,s))}}function il(t){var e=t.alternate;return t===fa||null!==e&&e===fa}function sl(t,e){va=_a=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function nl(t,e,i){if(0!=(4194240&i)){var s=e.lanes;i|=s&=t.pendingLanes,e.lanes=i,_i(t,i)}}var rl={readContext:Eo,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useInsertionEffect:wa,useLayoutEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useMutableSource:wa,useSyncExternalStore:wa,useId:wa,unstable_isNewReconciler:!1},ol={readContext:Eo,useCallback:function(t,e){return Ea().memoizedState=[t,void 0===e?null:e],t},useContext:Eo,useEffect:Ha,useImperativeHandle:function(t,e,i){return i=null!=i?i.concat([t]):null,Ua(4194308,4,Ga.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Ua(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ua(4,2,t,e)},useMemo:function(t,e){var i=Ea();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var s=Ea();return e=void 0!==i?i(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=tl.bind(null,fa,t),[s.memoizedState,t]},useRef:function(t){return t={current:t},Ea().memoizedState=t},useState:Oa,useDebugValue:Xa,useDeferredValue:function(t){return Ea().memoizedState=t},useTransition:function(){var t=Oa(!1),e=t[0];return t=Qa.bind(null,t[1]),Ea().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var s=fa,n=Ea();if(so){if(void 0===i)throw Error(nt(407));i=i()}else{if(i=e(),null===kh)throw Error(nt(349));0!=(30&pa)||Da(s,e,i)}n.memoizedState=i;var r={value:i,getSnapshot:e};return n.queue=r,Ha(Fa.bind(null,s,r,t),[t]),s.flags|=2048,za(9,Ma.bind(null,s,r,i,e),void 0,null),i},useId:function(){var t=Ea(),e=kh.identifierPrefix;if(so){var i=Yr;e=":"+e+"R"+(i=(Kr&~(1<<32-ri(Kr)-1)).toString(32)+i),0<(i=ya++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=xa++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},al={readContext:Eo,useCallback:Ka,useContext:Eo,useEffect:ja,useImperativeHandle:qa,useInsertionEffect:Wa,useLayoutEffect:$a,useMemo:Ya,useReducer:Aa,useRef:Na,useState:function(){return Aa(Ta)},useDebugValue:Xa,useDeferredValue:function(t){return Za(Pa(),ga.memoizedState,t)},useTransition:function(){return[Aa(Ta)[0],Pa().memoizedState]},useMutableSource:Ra,useSyncExternalStore:Ia,useId:Ja,unstable_isNewReconciler:!1},ll={readContext:Eo,useCallback:Ka,useContext:Eo,useEffect:ja,useImperativeHandle:qa,useInsertionEffect:Wa,useLayoutEffect:$a,useMemo:Ya,useReducer:ka,useRef:Na,useState:function(){return ka(Ta)},useDebugValue:Xa,useDeferredValue:function(t){var e=Pa();return null===ga?e.memoizedState=t:Za(e,ga.memoizedState,t)},useTransition:function(){return[ka(Ta)[0],Pa().memoizedState]},useMutableSource:Ra,useSyncExternalStore:Ia,useId:Ja,unstable_isNewReconciler:!1};function hl(t,e){try{var i="",s=e;do{i+=Ut(s),s=s.return}while(s);var n=i}catch(r){n="\nError generating stack: "+r.message+"\n"+r.stack}return{value:t,source:e,stack:n,digest:null}}function cl(t,e,i){return{value:t,source:null,stack:null!=i?i:null,digest:null!=e?e:null}}function ul(t,e){try{console.error(e.value)}catch(i){setTimeout((function(){throw i}))}}var dl="function"==typeof WeakMap?WeakMap:Map;function pl(t,e,i){(i=Mo(-1,i)).tag=3,i.payload={element:null};var s=e.value;return i.callback=function(){Wh||(Wh=!0,$h=s),ul(0,e)},i}function fl(t,e,i){(i=Mo(-1,i)).tag=3;var s=t.type.getDerivedStateFromError;if("function"==typeof s){var n=e.value;i.payload=function(){return s(n)},i.callback=function(){ul(0,e)}}var r=t.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(i.callback=function(){ul(0,e),"function"!=typeof s&&(null===Gh?Gh=new Set([this]):Gh.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}function gl(t,e,i){var s=t.pingCache;if(null===s){s=t.pingCache=new dl;var n=new Set;s.set(e,n)}else void 0===(n=s.get(e))&&(n=new Set,s.set(e,n));n.has(i)||(n.add(i),t=Ec.bind(null,t,e,i),e.then(t,t))}function ml(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function _l(t,e,i,s,n){return 0==(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((e=Mo(-1,1)).tag=2,Fo(i,e,1))),i.lanes|=1),t):(t.flags|=65536,t.lanes=n,t)}var vl=yt.ReactCurrentOwner,yl=!1;function xl(t,e,i,s){e.child=null===t?Zo(e,null,i,s):Yo(e,t.child,i,s)}function wl(t,e,i,s,n){i=i.render;var r=e.ref;return So(e,n),s=Ca(t,e,i,s,r,n),i=Sa(),null===t||yl?(so&&i&&Jr(e),e.flags|=1,xl(t,e,s,n),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,Wl(t,e,n))}function bl(t,e,i,s,n){if(null===t){var r=i.type;return"function"!=typeof r||Dc(r)||void 0!==r.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Fc(i.type,null,s,e,e.mode,n)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=r,Cl(t,e,r,s,n))}if(r=t.child,0==(t.lanes&n)){var o=r.memoizedProps;if((i=null!==(i=i.compare)?i:an)(o,s)&&t.ref===e.ref)return Wl(t,e,n)}return e.flags|=1,(t=Mc(r,s)).ref=e.ref,t.return=e,e.child=t}function Cl(t,e,i,s,n){if(null!==t){var r=t.memoizedProps;if(an(r,s)&&t.ref===e.ref){if(yl=!1,e.pendingProps=s=r,0==(t.lanes&n))return e.lanes=t.lanes,Wl(t,e,n);0!=(131072&t.flags)&&(yl=!0)}}return Pl(t,e,i,s,n)}function Sl(t,e,i){var s=e.pendingProps,n=s.children,r=null!==t?t.memoizedState:null;if("hidden"===s.mode)if(0==(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Mh,Dh),Dh|=i;else{if(0==(1073741824&i))return t=null!==r?r.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Er(Mh,Dh),Dh|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=null!==r?r.baseLanes:i,Er(Mh,Dh),Dh|=s}else null!==r?(s=r.baseLanes|i,e.memoizedState=null):s=i,Er(Mh,Dh),Dh|=s;return xl(t,e,n,i),e.child}function El(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Pl(t,e,i,s,n){var r=Ir(i)?kr:Tr.current;return r=Rr(e,r),So(e,n),i=Ca(t,e,i,s,r,n),s=Sa(),null===t||yl?(so&&s&&Jr(e),e.flags|=1,xl(t,e,i,n),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,Wl(t,e,n))}function Tl(t,e,i,s,n){if(Ir(i)){var r=!0;Lr(e)}else r=!1;if(So(e,n),null===e.stateNode)jl(t,e),jo(e,i,s),$o(e,i,s,n),s=!0;else if(null===t){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=i.contextType;"object"==typeof h&&null!==h?h=Eo(h):h=Rr(e,h=Ir(i)?kr:Tr.current);var c=i.getDerivedStateFromProps,u="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==s||l!==h)&&Wo(e,o,s,h),Ro=!1;var d=e.memoizedState;o.state=d,Oo(e,s,o,n),l=e.memoizedState,a!==s||d!==l||Ar.current||Ro?("function"==typeof c&&(Uo(e,i,c,s),l=e.memoizedState),(a=Ro||Ho(e,i,a,s,d,l,h))?(u||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(e.flags|=4194308)):("function"==typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=h,s=a):("function"==typeof o.componentDidMount&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,Do(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:mo(e.type,a),o.props=h,u=e.pendingProps,d=o.context,"object"==typeof(l=i.contextType)&&null!==l?l=Eo(l):l=Rr(e,l=Ir(i)?kr:Tr.current);var p=i.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==u||d!==l)&&Wo(e,o,s,l),Ro=!1,d=e.memoizedState,o.state=d,Oo(e,s,o,n);var f=e.memoizedState;a!==u||d!==f||Ar.current||Ro?("function"==typeof p&&(Uo(e,i,p,s),f=e.memoizedState),(h=Ro||Ho(e,i,h,s,d,f,l)||!1)?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(s,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(s,f,l)),"function"==typeof o.componentDidUpdate&&(e.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=f),o.props=s,o.state=f,o.context=l,s=h):("function"!=typeof o.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),s=!1)}return Al(t,e,i,s,r,n)}function Al(t,e,i,s,n,r){El(t,e);var o=0!=(128&e.flags);if(!s&&!o)return n&&Br(e,i,!1),Wl(t,e,r);s=e.stateNode,vl.current=e;var a=o&&"function"!=typeof i.getDerivedStateFromError?null:s.render();return e.flags|=1,null!==t&&o?(e.child=Yo(e,t.child,null,r),e.child=Yo(e,null,a,r)):xl(t,e,a,r),e.memoizedState=s.state,n&&Br(e,i,!0),e.child}function kl(t){var e=t.stateNode;e.pendingContext?Mr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Mr(0,e.context,!1),sa(t,e.containerInfo)}function Rl(t,e,i,s,n){return po(),fo(n),e.flags|=256,xl(t,e,i,s),e.child}var Il,Dl,Ml,Fl,Ll={dehydrated:null,treeContext:null,retryLane:0};function Bl(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ol(t,e,i){var s,n=e.pendingProps,r=aa.current,o=!1,a=0!=(128&e.flags);if((s=a)||(s=(null===t||null!==t.memoizedState)&&0!=(2&r)),s?(o=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(r|=1),Er(aa,1&r),null===t)return lo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0==(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(a=n.children,t=n.fallback,o?(n=e.mode,o=e.child,a={mode:"hidden",children:a},0==(1&n)&&null!==o?(o.childLanes=0,o.pendingProps=a):o=Bc(a,n,0,null),t=Lc(t,n,i,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Bl(i),e.memoizedState=Ll,t):zl(e,a));if(null!==(r=t.memoizedState)&&null!==(s=r.dehydrated))return function(t,e,i,s,n,r,o){if(i)return 256&e.flags?(e.flags&=-257,Nl(t,e,o,s=cl(Error(nt(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(r=s.fallback,n=e.mode,s=Bc({mode:"visible",children:s.children},n,0,null),(r=Lc(r,n,o,null)).flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,0!=(1&e.mode)&&Yo(e,t.child,null,o),e.child.memoizedState=Bl(o),e.memoizedState=Ll,r);if(0==(1&e.mode))return Nl(t,e,o,null);if("$!"===n.data){if(s=n.nextSibling&&n.nextSibling.dataset)var a=s.dgst;return s=a,Nl(t,e,o,s=cl(r=Error(nt(419)),s,void 0))}if(a=0!=(o&t.childLanes),yl||a){if(null!==(s=kh)){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!=(n&(s.suspendedLanes|o))?0:n)&&n!==r.retryLane&&(r.retryLane=n,ko(t,n),ic(s,t,n,-1))}return gc(),Nl(t,e,o,s=cl(Error(nt(421))))}return"$?"===n.data?(e.flags|=128,e.child=t.child,e=Tc.bind(null,t),n._reactRetry=e,null):(t=r.treeContext,io=lr(n.nextSibling),eo=e,so=!0,no=null,null!==t&&(Gr[qr++]=Kr,Gr[qr++]=Yr,Gr[qr++]=Xr,Kr=t.id,Yr=t.overflow,Xr=e),e=zl(e,s.children),e.flags|=4096,e)}(t,e,a,n,s,r,i);if(o){o=n.fallback,a=e.mode,s=(r=t.child).sibling;var l={mode:"hidden",children:n.children};return 0==(1&a)&&e.child!==r?((n=e.child).childLanes=0,n.pendingProps=l,e.deletions=null):(n=Mc(r,l)).subtreeFlags=14680064&r.subtreeFlags,null!==s?o=Mc(s,o):(o=Lc(o,a,i,null)).flags|=2,o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,a=null===(a=t.child.memoizedState)?Bl(i):{baseLanes:a.baseLanes|i,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~i,e.memoizedState=Ll,n}return t=(o=t.child).sibling,n=Mc(o,{mode:"visible",children:n.children}),0==(1&e.mode)&&(n.lanes=i),n.return=e,n.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=n,e.memoizedState=null,n}function zl(t,e){return(e=Bc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Nl(t,e,i,s){return null!==s&&fo(s),Yo(e,t.child,null,i),(t=zl(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Ul(t,e,i){t.lanes|=e;var s=t.alternate;null!==s&&(s.lanes|=e),Co(t.return,e,i)}function Vl(t,e,i,s,n){var r=t.memoizedState;null===r?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:i,tailMode:n}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=i,r.tailMode=n)}function Hl(t,e,i){var s=e.pendingProps,n=s.revealOrder,r=s.tail;if(xl(t,e,s.children,i),0!=(2&(s=aa.current)))s=1&s|2,e.flags|=128;else{if(null!==t&&0!=(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ul(t,i,e);else if(19===t.tag)Ul(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Er(aa,s),0==(1&e.mode))e.memoizedState=null;else switch(n){case"forwards":for(i=e.child,n=null;null!==i;)null!==(t=i.alternate)&&null===la(t)&&(n=i),i=i.sibling;null===(i=n)?(n=e.child,e.child=null):(n=i.sibling,i.sibling=null),Vl(e,!1,n,i,r);break;case"backwards":for(i=null,n=e.child,e.child=null;null!==n;){if(null!==(t=n.alternate)&&null===la(t)){e.child=n;break}t=n.sibling,n.sibling=i,i=n,n=t}Vl(e,!0,i,null,r);break;case"together":Vl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jl(t,e){0==(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wl(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Bh|=e.lanes,0==(i&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(nt(153));if(null!==e.child){for(i=Mc(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Mc(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function $l(t,e){if(!so)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var s=null;null!==i;)null!==i.alternate&&(s=i),i=i.sibling;null===s?e||null===t.tail?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Gl(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,s=0;if(e)for(var n=t.child;null!==n;)i|=n.lanes|n.childLanes,s|=14680064&n.subtreeFlags,s|=14680064&n.flags,n.return=t,n=n.sibling;else for(n=t.child;null!==n;)i|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=s,t.childLanes=i,e}function ql(t,e,i){var s=e.pendingProps;switch(to(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gl(e),null;case 1:case 17:return Ir(e.type)&&Dr(),Gl(e),null;case 3:return s=e.stateNode,na(),Sr(Ar),Sr(Tr),ca(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==t&&null!==t.child||(co(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0==(256&e.flags)||(e.flags|=1024,null!==no&&(oc(no),no=null))),Dl(t,e),Gl(e),null;case 5:oa(e);var n=ia(ea.current);if(i=e.type,null!==t&&null!=e.stateNode)Ml(t,e,i,s,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(null===e.stateNode)throw Error(nt(166));return Gl(e),null}if(t=ia(Jo.current),co(e)){s=e.stateNode,i=e.type;var r=e.memoizedProps;switch(s[ur]=e,s[dr]=r,t=0!=(1&e.mode),i){case"dialog":zn("cancel",s),zn("close",s);break;case"iframe":case"object":case"embed":zn("load",s);break;case"video":case"audio":for(n=0;n<Fn.length;n++)zn(Fn[n],s);break;case"source":zn("error",s);break;case"img":case"image":case"link":zn("error",s),zn("load",s);break;case"details":zn("toggle",s);break;case"input":Kt(s,r),zn("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},zn("invalid",s);break;case"textarea":se(s,r),zn("invalid",s)}for(var o in _e(i,r),n=null,r)if(r.hasOwnProperty(o)){var a=r[o];"children"===o?"string"==typeof a?s.textContent!==a&&(!0!==r.suppressHydrationWarning&&Zn(s.textContent,a,t),n=["children",a]):"number"==typeof a&&s.textContent!==""+a&&(!0!==r.suppressHydrationWarning&&Zn(s.textContent,a,t),n=["children",""+a]):ot.hasOwnProperty(o)&&null!=a&&"onScroll"===o&&zn("scroll",s)}switch(i){case"input":$t(s),Qt(s,r,!0);break;case"textarea":$t(s),re(s);break;case"select":case"option":break;default:"function"==typeof r.onClick&&(s.onclick=Qn)}s=n,e.updateQueue=s,null!==s&&(e.flags|=4)}else{o=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=oe(i)),"http://www.w3.org/1999/xhtml"===t?"script"===i?((t=o.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof s.is?t=o.createElement(i,{is:s.is}):(t=o.createElement(i),"select"===i&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,i),t[ur]=e,t[dr]=s,Il(t,e,!1,!1),e.stateNode=t;t:{switch(o=ve(i,s),i){case"dialog":zn("cancel",t),zn("close",t),n=s;break;case"iframe":case"object":case"embed":zn("load",t),n=s;break;case"video":case"audio":for(n=0;n<Fn.length;n++)zn(Fn[n],t);n=s;break;case"source":zn("error",t),n=s;break;case"img":case"image":case"link":zn("error",t),zn("load",t),n=s;break;case"details":zn("toggle",t),n=s;break;case"input":Kt(t,s),n=Xt(t,s),zn("invalid",t);break;case"option":default:n=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=Bt({},s,{value:void 0}),zn("invalid",t);break;case"textarea":se(t,s),n=ie(t,s),zn("invalid",t)}for(r in _e(i,n),a=n)if(a.hasOwnProperty(r)){var l=a[r];"style"===r?ge(t,l):"dangerouslySetInnerHTML"===r?null!=(l=l?l.__html:void 0)&&ce(t,l):"children"===r?"string"==typeof l?("textarea"!==i||""!==l)&&ue(t,l):"number"==typeof l&&ue(t,""+l):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(ot.hasOwnProperty(r)?null!=l&&"onScroll"===r&&zn("scroll",t):null!=l&&vt(t,r,l,o))}switch(i){case"input":$t(t),Qt(t,s,!1);break;case"textarea":$t(t),re(t);break;case"option":null!=s.value&&t.setAttribute("value",""+jt(s.value));break;case"select":t.multiple=!!s.multiple,null!=(r=s.value)?ee(t,!!s.multiple,r,!1):null!=s.defaultValue&&ee(t,!!s.multiple,s.defaultValue,!0);break;default:"function"==typeof n.onClick&&(t.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}}s&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Gl(e),null;case 6:if(t&&null!=e.stateNode)Fl(t,e,t.memoizedProps,s);else{if("string"!=typeof s&&null===e.stateNode)throw Error(nt(166));if(i=ia(ea.current),ia(Jo.current),co(e)){if(s=e.stateNode,i=e.memoizedProps,s[ur]=e,(r=s.nodeValue!==i)&&null!==(t=eo))switch(t.tag){case 3:Zn(s.nodeValue,i,0!=(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Zn(s.nodeValue,i,0!=(1&t.mode))}r&&(e.flags|=4)}else(s=(9===i.nodeType?i:i.ownerDocument).createTextNode(s))[ur]=e,e.stateNode=s}return Gl(e),null;case 13:if(Sr(aa),s=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(so&&null!==io&&0!=(1&e.mode)&&0==(128&e.flags))uo(),po(),e.flags|=98560,r=!1;else if(r=co(e),null!==s&&null!==s.dehydrated){if(null===t){if(!r)throw Error(nt(318));if(!(r=null!==(r=e.memoizedState)?r.dehydrated:null))throw Error(nt(317));r[ur]=e}else po(),0==(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Gl(e),r=!1}else null!==no&&(oc(no),no=null),r=!0;if(!r)return 65536&e.flags?e:null}return 0!=(128&e.flags)?(e.lanes=i,e):((s=null!==s)!==(null!==t&&null!==t.memoizedState)&&s&&(e.child.flags|=8192,0!=(1&e.mode)&&(null===t||0!=(1&aa.current)?0===Fh&&(Fh=3):gc())),null!==e.updateQueue&&(e.flags|=4),Gl(e),null);case 4:return na(),Dl(t,e),null===t&&Vn(e.stateNode.containerInfo),Gl(e),null;case 10:return bo(e.type._context),Gl(e),null;case 19:if(Sr(aa),null===(r=e.memoizedState))return Gl(e),null;if(s=0!=(128&e.flags),null===(o=r.rendering))if(s)$l(r,!1);else{if(0!==Fh||null!==t&&0!=(128&t.flags))for(t=e.child;null!==t;){if(null!==(o=la(t))){for(e.flags|=128,$l(r,!1),null!==(s=o.updateQueue)&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=i,i=e.child;null!==i;)t=s,(r=i).flags&=14680066,null===(o=r.alternate)?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,t=o.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Er(aa,1&aa.current|2),e.child}t=t.sibling}null!==r.tail&&Ye()>Hh&&(e.flags|=128,s=!0,$l(r,!1),e.lanes=4194304)}else{if(!s)if(null!==(t=la(o))){if(e.flags|=128,s=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),$l(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!so)return Gl(e),null}else 2*Ye()-r.renderingStartTime>Hh&&1073741824!==i&&(e.flags|=128,s=!0,$l(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(null!==(i=r.last)?i.sibling=o:e.child=o,r.last=o)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ye(),e.sibling=null,i=aa.current,Er(aa,s?1&i|2:1&i),e):(Gl(e),null);case 22:case 23:return uc(),s=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==s&&(e.flags|=8192),s&&0!=(1&e.mode)?0!=(1073741824&Dh)&&(Gl(e),6&e.subtreeFlags&&(e.flags|=8192)):Gl(e),null;case 24:case 25:return null}throw Error(nt(156,e.tag))}function Xl(t,e){switch(to(e),e.tag){case 1:return Ir(e.type)&&Dr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return na(),Sr(Ar),Sr(Tr),ca(),0!=(65536&(t=e.flags))&&0==(128&t)?(e.flags=-65537&t|128,e):null;case 5:return oa(e),null;case 13:if(Sr(aa),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(nt(340));po()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Sr(aa),null;case 4:return na(),null;case 10:return bo(e.type._context),null;case 22:case 23:return uc(),null;default:return null}}Il=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Dl=function(){},Ml=function(t,e,i,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,ia(Jo.current);var r,o=null;switch(i){case"input":n=Xt(t,n),s=Xt(t,s),o=[];break;case"select":n=Bt({},n,{value:void 0}),s=Bt({},s,{value:void 0}),o=[];break;case"textarea":n=ie(t,n),s=ie(t,s),o=[];break;default:"function"!=typeof n.onClick&&"function"==typeof s.onClick&&(t.onclick=Qn)}for(h in _e(i,s),i=null,n)if(!s.hasOwnProperty(h)&&n.hasOwnProperty(h)&&null!=n[h])if("style"===h){var a=n[h];for(r in a)a.hasOwnProperty(r)&&(i||(i={}),i[r]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(ot.hasOwnProperty(h)?o||(o=[]):(o=o||[]).push(h,null));for(h in s){var l=s[h];if(a=null!=n?n[h]:void 0,s.hasOwnProperty(h)&&l!==a&&(null!=l||null!=a))if("style"===h)if(a){for(r in a)!a.hasOwnProperty(r)||l&&l.hasOwnProperty(r)||(i||(i={}),i[r]="");for(r in l)l.hasOwnProperty(r)&&a[r]!==l[r]&&(i||(i={}),i[r]=l[r])}else i||(o||(o=[]),o.push(h,i)),i=l;else"dangerouslySetInnerHTML"===h?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(o=o||[]).push(h,l)):"children"===h?"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(h,""+l):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(ot.hasOwnProperty(h)?(null!=l&&"onScroll"===h&&zn("scroll",t),o||a===l||(o=[])):(o=o||[]).push(h,l))}i&&(o=o||[]).push("style",i);var h=o;(e.updateQueue=h)&&(e.flags|=4)}},Fl=function(t,e,i,s){i!==s&&(e.flags|=4)};var Kl=!1,Yl=!1,Zl="function"==typeof WeakSet?WeakSet:Set,Ql=null;function Jl(t,e){var i=t.ref;if(null!==i)if("function"==typeof i)try{i(null)}catch(s){Sc(t,e,s)}else i.current=null}function th(t,e,i){try{i()}catch(s){Sc(t,e,s)}}var eh=!1;function ih(t,e,i){var s=e.updateQueue;if(null!==(s=null!==s?s.lastEffect:null)){var n=s=s.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,void 0!==r&&th(e,i,r)}n=n.next}while(n!==s)}}function sh(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var i=e=e.next;do{if((i.tag&t)===t){var s=i.create;i.destroy=s()}i=i.next}while(i!==e)}}function nh(t){var e=t.ref;if(null!==e){var i=t.stateNode;t.tag,t=i,"function"==typeof e?e(t):e.current=t}}function rh(t){var e=t.alternate;null!==e&&(t.alternate=null,rh(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[ur],delete e[dr],delete e[fr],delete e[gr],delete e[mr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oh(t){return 5===t.tag||3===t.tag||4===t.tag}function ah(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||oh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function lh(t,e,i){var s=t.tag;if(5===s||6===s)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!=(i=i._reactRootContainer)||null!==e.onclick||(e.onclick=Qn));else if(4!==s&&null!==(t=t.child))for(lh(t,e,i),t=t.sibling;null!==t;)lh(t,e,i),t=t.sibling}function hh(t,e,i){var s=t.tag;if(5===s||6===s)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==s&&null!==(t=t.child))for(hh(t,e,i),t=t.sibling;null!==t;)hh(t,e,i),t=t.sibling}var ch=null,uh=!1;function dh(t,e,i){for(i=i.child;null!==i;)ph(t,e,i),i=i.sibling}function ph(t,e,i){if(ni&&"function"==typeof ni.onCommitFiberUnmount)try{ni.onCommitFiberUnmount(si,i)}catch(a){}switch(i.tag){case 5:Yl||Jl(i,e);case 6:var s=ch,n=uh;ch=null,dh(t,e,i),uh=n,null!==(ch=s)&&(uh?(t=ch,i=i.stateNode,8===t.nodeType?t.parentNode.removeChild(i):t.removeChild(i)):ch.removeChild(i.stateNode));break;case 18:null!==ch&&(uh?(t=ch,i=i.stateNode,8===t.nodeType?ar(t.parentNode,i):1===t.nodeType&&ar(t,i),Vi(t)):ar(ch,i.stateNode));break;case 4:s=ch,n=uh,ch=i.stateNode.containerInfo,uh=!0,dh(t,e,i),ch=s,uh=n;break;case 0:case 11:case 14:case 15:if(!Yl&&(null!==(s=i.updateQueue)&&null!==(s=s.lastEffect))){n=s=s.next;do{var r=n,o=r.destroy;r=r.tag,void 0!==o&&(0!=(2&r)||0!=(4&r))&&th(i,e,o),n=n.next}while(n!==s)}dh(t,e,i);break;case 1:if(!Yl&&(Jl(i,e),"function"==typeof(s=i.stateNode).componentWillUnmount))try{s.props=i.memoizedProps,s.state=i.memoizedState,s.componentWillUnmount()}catch(a){Sc(i,e,a)}dh(t,e,i);break;case 21:dh(t,e,i);break;case 22:1&i.mode?(Yl=(s=Yl)||null!==i.memoizedState,dh(t,e,i),Yl=s):dh(t,e,i);break;default:dh(t,e,i)}}function fh(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Zl),e.forEach((function(e){var s=Ac.bind(null,t,e);i.has(e)||(i.add(e),e.then(s,s))}))}}function gh(t,e){var i=e.deletions;if(null!==i)for(var s=0;s<i.length;s++){var n=i[s];try{var r=t,o=e,a=o;t:for(;null!==a;){switch(a.tag){case 5:ch=a.stateNode,uh=!1;break t;case 3:case 4:ch=a.stateNode.containerInfo,uh=!0;break t}a=a.return}if(null===ch)throw Error(nt(160));ph(r,o,n),ch=null,uh=!1;var l=n.alternate;null!==l&&(l.return=null),n.return=null}catch(Jy){Sc(n,e,Jy)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)mh(e,t),e=e.sibling}function mh(t,e){var i=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gh(e,t),_h(t),4&s){try{ih(3,t,t.return),sh(3,t)}catch(Zy){Sc(t,t.return,Zy)}try{ih(5,t,t.return)}catch(Zy){Sc(t,t.return,Zy)}}break;case 1:gh(e,t),_h(t),512&s&&null!==i&&Jl(i,i.return);break;case 5:if(gh(e,t),_h(t),512&s&&null!==i&&Jl(i,i.return),32&t.flags){var n=t.stateNode;try{ue(n,"")}catch(Zy){Sc(t,t.return,Zy)}}if(4&s&&null!=(n=t.stateNode)){var r=t.memoizedProps,o=null!==i?i.memoizedProps:r,a=t.type,l=t.updateQueue;if(t.updateQueue=null,null!==l)try{"input"===a&&"radio"===r.type&&null!=r.name&&Yt(n,r),ve(a,o);var h=ve(a,r);for(o=0;o<l.length;o+=2){var c=l[o],u=l[o+1];"style"===c?ge(n,u):"dangerouslySetInnerHTML"===c?ce(n,u):"children"===c?ue(n,u):vt(n,c,u,h)}switch(a){case"input":Zt(n,r);break;case"textarea":ne(n,r);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!r.multiple;var p=r.value;null!=p?ee(n,!!r.multiple,p,!1):d!==!!r.multiple&&(null!=r.defaultValue?ee(n,!!r.multiple,r.defaultValue,!0):ee(n,!!r.multiple,r.multiple?[]:"",!1))}n[dr]=r}catch(Zy){Sc(t,t.return,Zy)}}break;case 6:if(gh(e,t),_h(t),4&s){if(null===t.stateNode)throw Error(nt(162));n=t.stateNode,r=t.memoizedProps;try{n.nodeValue=r}catch(Zy){Sc(t,t.return,Zy)}}break;case 3:if(gh(e,t),_h(t),4&s&&null!==i&&i.memoizedState.isDehydrated)try{Vi(e.containerInfo)}catch(Zy){Sc(t,t.return,Zy)}break;case 4:default:gh(e,t),_h(t);break;case 13:gh(e,t),_h(t),8192&(n=t.child).flags&&(r=null!==n.memoizedState,n.stateNode.isHidden=r,!r||null!==n.alternate&&null!==n.alternate.memoizedState||(Vh=Ye())),4&s&&fh(t);break;case 22:if(c=null!==i&&null!==i.memoizedState,1&t.mode?(Yl=(h=Yl)||c,gh(e,t),Yl=h):gh(e,t),_h(t),8192&s){if(h=null!==t.memoizedState,(t.stateNode.isHidden=h)&&!c&&0!=(1&t.mode))for(Ql=t,c=t.child;null!==c;){for(u=Ql=c;null!==Ql;){switch(p=(d=Ql).child,d.tag){case 0:case 11:case 14:case 15:ih(4,d,d.return);break;case 1:Jl(d,d.return);var f=d.stateNode;if("function"==typeof f.componentWillUnmount){s=d,i=d.return;try{e=s,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(Zy){Sc(s,i,Zy)}}break;case 5:Jl(d,d.return);break;case 22:if(null!==d.memoizedState){wh(u);continue}}null!==p?(p.return=d,Ql=p):wh(u)}c=c.sibling}t:for(c=null,u=t;;){if(5===u.tag){if(null===c){c=u;try{n=u.stateNode,h?"function"==typeof(r=n.style).setProperty?r.setProperty("display","none","important"):r.display="none":(a=u.stateNode,o=null!=(l=u.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,a.style.display=fe("display",o))}catch(Zy){Sc(t,t.return,Zy)}}}else if(6===u.tag){if(null===c)try{u.stateNode.nodeValue=h?"":u.memoizedProps}catch(Zy){Sc(t,t.return,Zy)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===t)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===t)break t;for(;null===u.sibling;){if(null===u.return||u.return===t)break t;c===u&&(c=null),u=u.return}c===u&&(c=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:gh(e,t),_h(t),4&s&&fh(t);case 21:}}function _h(t){var e=t.flags;if(2&e){try{t:{for(var i=t.return;null!==i;){if(oh(i)){var s=i;break t}i=i.return}throw Error(nt(160))}switch(s.tag){case 5:var n=s.stateNode;32&s.flags&&(ue(n,""),s.flags&=-33),hh(t,ah(t),n);break;case 3:case 4:var r=s.stateNode.containerInfo;lh(t,ah(t),r);break;default:throw Error(nt(161))}}catch(o){Sc(t,t.return,o)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vh(t,e,i){Ql=t,yh(t)}function yh(t,e,i){for(var s=0!=(1&t.mode);null!==Ql;){var n=Ql,r=n.child;if(22===n.tag&&s){var o=null!==n.memoizedState||Kl;if(!o){var a=n.alternate,l=null!==a&&null!==a.memoizedState||Yl;a=Kl;var h=Yl;if(Kl=o,(Yl=l)&&!h)for(Ql=n;null!==Ql;)l=(o=Ql).child,22===o.tag&&null!==o.memoizedState?bh(n):null!==l?(l.return=o,Ql=l):bh(n);for(;null!==r;)Ql=r,yh(r),r=r.sibling;Ql=n,Kl=a,Yl=h}xh(t)}else 0!=(8772&n.subtreeFlags)&&null!==r?(r.return=n,Ql=r):xh(t)}}function xh(t){for(;null!==Ql;){var e=Ql;if(0!=(8772&e.flags)){var i=e.alternate;try{if(0!=(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Yl||sh(5,e);break;case 1:var s=e.stateNode;if(4&e.flags&&!Yl)if(null===i)s.componentDidMount();else{var n=e.elementType===e.type?i.memoizedProps:mo(e.type,i.memoizedProps);s.componentDidUpdate(n,i.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;null!==r&&zo(e,r,s);break;case 3:var o=e.updateQueue;if(null!==o){if(i=null,null!==e.child)switch(e.child.tag){case 5:case 1:i=e.child.stateNode}zo(e,o,i)}break;case 5:var a=e.stateNode;if(null===i&&4&e.flags){i=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var h=e.alternate;if(null!==h){var c=h.memoizedState;if(null!==c){var u=c.dehydrated;null!==u&&Vi(u)}}}break;default:throw Error(nt(163))}Yl||512&e.flags&&nh(e)}catch(Qy){Sc(e,e.return,Qy)}}if(e===t){Ql=null;break}if(null!==(i=e.sibling)){i.return=e.return,Ql=i;break}Ql=e.return}}function wh(t){for(;null!==Ql;){var e=Ql;if(e===t){Ql=null;break}var i=e.sibling;if(null!==i){i.return=e.return,Ql=i;break}Ql=e.return}}function bh(t){for(;null!==Ql;){var e=Ql;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{sh(4,e)}catch(l){Sc(e,i,l)}break;case 1:var s=e.stateNode;if("function"==typeof s.componentDidMount){var n=e.return;try{s.componentDidMount()}catch(l){Sc(e,n,l)}}var r=e.return;try{nh(e)}catch(l){Sc(e,r,l)}break;case 5:var o=e.return;try{nh(e)}catch(l){Sc(e,o,l)}}}catch(l){Sc(e,e.return,l)}if(e===t){Ql=null;break}var a=e.sibling;if(null!==a){a.return=e.return,Ql=a;break}Ql=e.return}}var Ch,Sh=Math.ceil,Eh=yt.ReactCurrentDispatcher,Ph=yt.ReactCurrentOwner,Th=yt.ReactCurrentBatchConfig,Ah=0,kh=null,Rh=null,Ih=0,Dh=0,Mh=Cr(0),Fh=0,Lh=null,Bh=0,Oh=0,zh=0,Nh=null,Uh=null,Vh=0,Hh=1/0,jh=null,Wh=!1,$h=null,Gh=null,qh=!1,Xh=null,Kh=0,Yh=0,Zh=null,Qh=-1,Jh=0;function tc(){return 0!=(6&Ah)?Ye():-1!==Qh?Qh:Qh=Ye()}function ec(t){return 0==(1&t.mode)?1:0!=(2&Ah)&&0!==Ih?Ih&-Ih:null!==go.transition?(0===Jh&&(Jh=fi()),Jh):0!==(t=vi)?t:t=void 0===(t=window.event)?16:Ki(t.type)}function ic(t,e,i,s){if(50<Yh)throw Yh=0,Zh=null,Error(nt(185));mi(t,i,s),0!=(2&Ah)&&t===kh||(t===kh&&(0==(2&Ah)&&(Oh|=i),4===Fh&&ac(t,Ih)),sc(t,s),1===i&&0===Ah&&0==(1&e.mode)&&(Hh=Ye()+500,zr&&Vr()))}function sc(t,e){var i=t.callbackNode;!function(t,e){for(var i=t.suspendedLanes,s=t.pingedLanes,n=t.expirationTimes,r=t.pendingLanes;0<r;){var o=31-ri(r),a=1<<o,l=n[o];-1===l?0!=(a&i)&&0==(a&s)||(n[o]=di(a,e)):l<=e&&(t.expiredLanes|=a),r&=~a}}(t,e);var s=ui(t,t===kh?Ih:0);if(0===s)null!==i&&qe(i),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(null!=i&&qe(i),1===e)0===t.tag?function(t){zr=!0,Ur(t)}(lc.bind(null,t)):Ur(lc.bind(null,t)),rr((function(){0==(6&Ah)&&Vr()})),i=null;else{switch(yi(s)){case 1:i=Qe;break;case 4:i=Je;break;case 16:default:i=ti;break;case 536870912:i=ii}i=kc(i,nc.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function nc(t,e){if(Qh=-1,Jh=0,0!=(6&Ah))throw Error(nt(327));var i=t.callbackNode;if(bc()&&t.callbackNode!==i)return null;var s=ui(t,t===kh?Ih:0);if(0===s)return null;if(0!=(30&s)||0!=(s&t.expiredLanes)||e)e=mc(t,s);else{e=s;var n=Ah;Ah|=2;var r=fc();for(kh===t&&Ih===e||(jh=null,Hh=Ye()+500,dc(t,e));;)try{vc();break}catch(a){pc(t,a)}wo(),Eh.current=r,Ah=n,null!==Rh?e=0:(kh=null,Ih=0,e=Fh)}if(0!==e){if(2===e&&(0!==(n=pi(t))&&(s=n,e=rc(t,n))),1===e)throw i=Lh,dc(t,0),ac(t,s),sc(t,Ye()),i;if(6===e)ac(t,s);else{if(n=t.current.alternate,0==(30&s)&&!function(t){for(var e=t;;){if(16384&e.flags){var i=e.updateQueue;if(null!==i&&null!==(i=i.stores))for(var s=0;s<i.length;s++){var n=i[s],r=n.getSnapshot;n=n.value;try{if(!on(r(),n))return!1}catch(o){return!1}}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(n)&&(2===(e=mc(t,s))&&(0!==(r=pi(t))&&(s=r,e=rc(t,r))),1===e))throw i=Lh,dc(t,0),ac(t,s),sc(t,Ye()),i;switch(t.finishedWork=n,t.finishedLanes=s,e){case 0:case 1:throw Error(nt(345));case 2:case 5:wc(t,Uh,jh);break;case 3:if(ac(t,s),(130023424&s)===s&&10<(e=Vh+500-Ye())){if(0!==ui(t,0))break;if(((n=t.suspendedLanes)&s)!==s){tc(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=ir(wc.bind(null,t,Uh,jh),e);break}wc(t,Uh,jh);break;case 4:if(ac(t,s),(4194240&s)===s)break;for(e=t.eventTimes,n=-1;0<s;){var o=31-ri(s);r=1<<o,(o=e[o])>n&&(n=o),s&=~r}if(s=n,10<(s=(120>(s=Ye()-s)?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Sh(s/1960))-s)){t.timeoutHandle=ir(wc.bind(null,t,Uh,jh),s);break}wc(t,Uh,jh);break;default:throw Error(nt(329))}}}return sc(t,Ye()),t.callbackNode===i?nc.bind(null,t):null}function rc(t,e){var i=Nh;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=mc(t,e))&&(e=Uh,Uh=i,null!==e&&oc(e)),t}function oc(t){null===Uh?Uh=t:Uh.push.apply(Uh,t)}function ac(t,e){for(e&=~zh,e&=~Oh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-ri(e),s=1<<i;t[i]=-1,e&=~s}}function lc(t){if(0!=(6&Ah))throw Error(nt(327));bc();var e=ui(t,0);if(0==(1&e))return sc(t,Ye()),null;var i=mc(t,e);if(0!==t.tag&&2===i){var s=pi(t);0!==s&&(e=s,i=rc(t,s))}if(1===i)throw i=Lh,dc(t,0),ac(t,e),sc(t,Ye()),i;if(6===i)throw Error(nt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wc(t,Uh,jh),sc(t,Ye()),null}function hc(t,e){var i=Ah;Ah|=1;try{return t(e)}finally{0===(Ah=i)&&(Hh=Ye()+500,zr&&Vr())}}function cc(t){null!==Xh&&0===Xh.tag&&0==(6&Ah)&&bc();var e=Ah;Ah|=1;var i=Th.transition,s=vi;try{if(Th.transition=null,vi=1,t)return t()}finally{vi=s,Th.transition=i,0==(6&(Ah=e))&&Vr()}}function uc(){Dh=Mh.current,Sr(Mh)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,sr(i)),null!==Rh)for(i=Rh.return;null!==i;){var s=i;switch(to(s),s.tag){case 1:null!=(s=s.type.childContextTypes)&&Dr();break;case 3:na(),Sr(Ar),Sr(Tr),ca();break;case 5:oa(s);break;case 4:na();break;case 13:case 19:Sr(aa);break;case 10:bo(s.type._context);break;case 22:case 23:uc()}i=i.return}if(kh=t,Rh=t=Mc(t.current,null),Ih=Dh=e,Fh=0,Lh=null,zh=Oh=Bh=0,Uh=Nh=null,null!==Po){for(e=0;e<Po.length;e++)if(null!==(s=(i=Po[e]).interleaved)){i.interleaved=null;var n=s.next,r=i.pending;if(null!==r){var o=r.next;r.next=n,s.next=o}i.pending=s}Po=null}return t}function pc(t,e){for(;;){var i=Rh;try{if(wo(),ua.current=rl,_a){for(var s=fa.memoizedState;null!==s;){var n=s.queue;null!==n&&(n.pending=null),s=s.next}_a=!1}if(pa=0,ma=ga=fa=null,va=!1,ya=0,Ph.current=null,null===i||null===i.return){Fh=1,Lh=e,Rh=null;break}t:{var r=t,o=i.return,a=i,l=e;if(e=Ih,a.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var h=l,c=a,u=c.tag;if(0==(1&c.mode)&&(0===u||11===u||15===u)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=ml(o);if(null!==p){p.flags&=-257,_l(p,o,a,0,e),1&p.mode&&gl(r,h,e),l=h;var f=(e=p).updateQueue;if(null===f){var g=new Set;g.add(l),e.updateQueue=g}else f.add(l);break t}if(0==(1&e)){gl(r,h,e),gc();break t}l=Error(nt(426))}else if(so&&1&a.mode){var m=ml(o);if(null!==m){0==(65536&m.flags)&&(m.flags|=256),_l(m,o,a,0,e),fo(hl(l,a));break t}}r=l=hl(l,a),4!==Fh&&(Fh=2),null===Nh?Nh=[r]:Nh.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e,Bo(r,pl(0,l,e));break t;case 1:a=l;var _=r.type,v=r.stateNode;if(0==(128&r.flags)&&("function"==typeof _.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===Gh||!Gh.has(v)))){r.flags|=65536,e&=-e,r.lanes|=e,Bo(r,fl(r,a,e));break t}}r=r.return}while(null!==r)}xc(i)}catch(y){e=y,Rh===i&&null!==i&&(Rh=i=i.return);continue}break}}function fc(){var t=Eh.current;return Eh.current=rl,null===t?rl:t}function gc(){0!==Fh&&3!==Fh&&2!==Fh||(Fh=4),null===kh||0==(268435455&Bh)&&0==(268435455&Oh)||ac(kh,Ih)}function mc(t,e){var i=Ah;Ah|=2;var s=fc();for(kh===t&&Ih===e||(jh=null,dc(t,e));;)try{_c();break}catch(Yy){pc(t,Yy)}if(wo(),Ah=i,Eh.current=s,null!==Rh)throw Error(nt(261));return kh=null,Ih=0,Fh}function _c(){for(;null!==Rh;)yc(Rh)}function vc(){for(;null!==Rh&&!Xe();)yc(Rh)}function yc(t){var e=Ch(t.alternate,t,Dh);t.memoizedProps=t.pendingProps,null===e?xc(t):Rh=e,Ph.current=null}function xc(t){var e=t;do{var i=e.alternate;if(t=e.return,0==(32768&e.flags)){if(null!==(i=ql(i,e,Dh)))return void(Rh=i)}else{if(null!==(i=Xl(i,e)))return i.flags&=32767,void(Rh=i);if(null===t)return Fh=6,void(Rh=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Rh=e);Rh=e=t}while(null!==e);0===Fh&&(Fh=5)}function wc(t,e,i){var s=vi,n=Th.transition;try{Th.transition=null,vi=1,function(t,e,i,s){do{bc()}while(null!==Xh);if(0!=(6&Ah))throw Error(nt(327));i=t.finishedWork;var n=t.finishedLanes;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(nt(177));t.callbackNode=null,t.callbackPriority=0;var r=i.lanes|i.childLanes;if(function(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<i;){var n=31-ri(i),r=1<<n;e[n]=0,s[n]=-1,t[n]=-1,i&=~r}}(t,r),t===kh&&(Rh=kh=null,Ih=0),0==(2064&i.subtreeFlags)&&0==(2064&i.flags)||qh||(qh=!0,kc(ti,(function(){return bc(),null}))),r=0!=(15990&i.flags),0!=(15990&i.subtreeFlags)||r){r=Th.transition,Th.transition=null;var o=vi;vi=1;var a=Ah;Ah|=4,Ph.current=null,function(t,e){if(Jn=ji,dn(t=un())){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var s=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(s&&0!==s.rangeCount){i=s.anchorNode;var n=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{i.nodeType,r.nodeType}catch(x){i=null;break t}var o=0,a=-1,l=-1,h=0,c=0,u=t,d=null;e:for(;;){for(var p;u!==i||0!==n&&3!==u.nodeType||(a=o+n),u!==r||0!==s&&3!==u.nodeType||(l=o+s),3===u.nodeType&&(o+=u.nodeValue.length),null!==(p=u.firstChild);)d=u,u=p;for(;;){if(u===t)break e;if(d===i&&++h===n&&(a=o),d===r&&++c===s&&(l=o),null!==(p=u.nextSibling))break;d=(u=d).parentNode}u=p}i=-1===a||-1===l?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(tr={focusedElem:t,selectionRange:i},ji=!1,Ql=e;null!==Ql;)if(t=(e=Ql).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,Ql=t;else for(;null!==Ql;){e=Ql;try{var f=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,m=f.memoizedState,_=e.stateNode,v=_.getSnapshotBeforeUpdate(e.elementType===e.type?g:mo(e.type,g),m);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=e.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(nt(163))}}catch(x){Sc(e,e.return,x)}if(null!==(t=e.sibling)){t.return=e.return,Ql=t;break}Ql=e.return}f=eh,eh=!1}(t,i),mh(i,t),pn(tr),ji=!!Jn,tr=Jn=null,t.current=i,vh(i),Ke(),Ah=a,vi=o,Th.transition=r}else t.current=i;if(qh&&(qh=!1,Xh=t,Kh=n),r=t.pendingLanes,0===r&&(Gh=null),function(t){if(ni&&"function"==typeof ni.onCommitFiberRoot)try{ni.onCommitFiberRoot(si,t,void 0,128==(128&t.current.flags))}catch(e){}}(i.stateNode),sc(t,Ye()),null!==e)for(s=t.onRecoverableError,i=0;i<e.length;i++)n=e[i],s(n.value,{componentStack:n.stack,digest:n.digest});if(Wh)throw Wh=!1,t=$h,$h=null,t;0!=(1&Kh)&&0!==t.tag&&bc(),r=t.pendingLanes,0!=(1&r)?t===Zh?Yh++:(Yh=0,Zh=t):Yh=0,Vr()}(t,e,i,s)}finally{Th.transition=n,vi=s}return null}function bc(){if(null!==Xh){var t=yi(Kh),e=Th.transition,i=vi;try{if(Th.transition=null,vi=16>t?16:t,null===Xh)var s=!1;else{if(t=Xh,Xh=null,Kh=0,0!=(6&Ah))throw Error(nt(331));var n=Ah;for(Ah|=4,Ql=t.current;null!==Ql;){var r=Ql,o=r.child;if(0!=(16&Ql.flags)){var a=r.deletions;if(null!==a){for(var l=0;l<a.length;l++){var h=a[l];for(Ql=h;null!==Ql;){var c=Ql;switch(c.tag){case 0:case 11:case 15:ih(8,c,r)}var u=c.child;if(null!==u)u.return=c,Ql=u;else for(;null!==Ql;){var d=(c=Ql).sibling,p=c.return;if(rh(c),c===h){Ql=null;break}if(null!==d){d.return=p,Ql=d;break}Ql=p}}}var f=r.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Ql=r}}if(0!=(2064&r.subtreeFlags)&&null!==o)o.return=r,Ql=o;else t:for(;null!==Ql;){if(0!=(2048&(r=Ql).flags))switch(r.tag){case 0:case 11:case 15:ih(9,r,r.return)}var _=r.sibling;if(null!==_){_.return=r.return,Ql=_;break t}Ql=r.return}}var v=t.current;for(Ql=v;null!==Ql;){var y=(o=Ql).child;if(0!=(2064&o.subtreeFlags)&&null!==y)y.return=o,Ql=y;else t:for(o=v;null!==Ql;){if(0!=(2048&(a=Ql).flags))try{switch(a.tag){case 0:case 11:case 15:sh(9,a)}}catch(w){Sc(a,a.return,w)}if(a===o){Ql=null;break t}var x=a.sibling;if(null!==x){x.return=a.return,Ql=x;break t}Ql=a.return}}if(Ah=n,Vr(),ni&&"function"==typeof ni.onPostCommitFiberRoot)try{ni.onPostCommitFiberRoot(si,t)}catch(w){}s=!0}return s}finally{vi=i,Th.transition=e}}return!1}function Cc(t,e,i){t=Fo(t,e=pl(0,e=hl(i,e),1),1),e=tc(),null!==t&&(mi(t,1,e),sc(t,e))}function Sc(t,e,i){if(3===t.tag)Cc(t,t,i);else for(;null!==e;){if(3===e.tag){Cc(e,t,i);break}if(1===e.tag){var s=e.stateNode;if("function"==typeof e.type.getDerivedStateFromError||"function"==typeof s.componentDidCatch&&(null===Gh||!Gh.has(s))){e=Fo(e,t=fl(e,t=hl(i,t),1),1),t=tc(),null!==e&&(mi(e,1,t),sc(e,t));break}}e=e.return}}function Ec(t,e,i){var s=t.pingCache;null!==s&&s.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&i,kh===t&&(Ih&i)===i&&(4===Fh||3===Fh&&(130023424&Ih)===Ih&&500>Ye()-Vh?dc(t,0):zh|=i),sc(t,e)}function Pc(t,e){0===e&&(0==(1&t.mode)?e=1:(e=hi,0==(130023424&(hi<<=1))&&(hi=4194304)));var i=tc();null!==(t=ko(t,e))&&(mi(t,e,i),sc(t,i))}function Tc(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),Pc(t,i)}function Ac(t,e){var i=0;switch(t.tag){case 13:var s=t.stateNode,n=t.memoizedState;null!==n&&(i=n.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(nt(314))}null!==s&&s.delete(e),Pc(t,i)}function kc(t,e){return Ge(t,e)}function Rc(t,e,i,s){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(t,e,i,s){return new Rc(t,e,i,s)}function Dc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Mc(t,e){var i=t.alternate;return null===i?((i=Ic(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Fc(t,e,i,s,n,r){var o=2;if(s=t,"function"==typeof t)Dc(t)&&(o=1);else if("string"==typeof t)o=5;else t:switch(t){case bt:return Lc(i.children,n,r,e);case Ct:o=8,n|=8;break;case St:return(t=Ic(12,i,e,2|n)).elementType=St,t.lanes=r,t;case At:return(t=Ic(13,i,e,n)).elementType=At,t.lanes=r,t;case kt:return(t=Ic(19,i,e,n)).elementType=kt,t.lanes=r,t;case Dt:return Bc(i,n,r,e);default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case Et:o=10;break t;case Pt:o=9;break t;case Tt:o=11;break t;case Rt:o=14;break t;case It:o=16,s=null;break t}throw Error(nt(130,null==t?t:typeof t,""))}return(e=Ic(o,i,e,n)).elementType=t,e.type=s,e.lanes=r,e}function Lc(t,e,i,s){return(t=Ic(7,t,s,e)).lanes=i,t}function Bc(t,e,i,s){return(t=Ic(22,t,s,e)).elementType=Dt,t.lanes=i,t.stateNode={isHidden:!1},t}function Oc(t,e,i){return(t=Ic(6,t,null,e)).lanes=i,t}function zc(t,e,i){return(e=Ic(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Nc(t,e,i,s,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gi(0),this.expirationTimes=gi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gi(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Uc(t,e,i,s,n,r,o,a,l){return t=new Nc(t,e,i,a,l),1===e?(e=1,!0===r&&(e|=8)):e=0,r=Ic(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:s,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Io(r),t}function Vc(t){if(!t)return Pr;t:{if(Ve(t=t._reactInternals)!==t||1!==t.tag)throw Error(nt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ir(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(nt(171))}if(1===t.tag){var i=t.type;if(Ir(i))return Fr(t,i,e)}return e}function Hc(t,e,i,s,n,r,o,a,l){return(t=Uc(i,s,!0,t,0,r,0,a,l)).context=Vc(null),i=t.current,(r=Mo(s=tc(),n=ec(i))).callback=null!=e?e:null,Fo(i,r,n),t.current.lanes=n,mi(t,n,s),sc(t,s),t}function jc(t,e,i,s){var n=e.current,r=tc(),o=ec(n);return i=Vc(i),null===e.context?e.context=i:e.pendingContext=i,(e=Mo(r,o)).payload={element:t},null!==(s=void 0===s?null:s)&&(e.callback=s),null!==(t=Fo(n,e,o))&&(ic(t,n,o,r),Lo(t,n,o)),o}function Wc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function $c(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function Gc(t,e){$c(t,e),(t=t.alternate)&&$c(t,e)}Ch=function(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ar.current)yl=!0;else{if(0==(t.lanes&i)&&0==(128&e.flags))return yl=!1,function(t,e,i){switch(e.tag){case 3:kl(e),po();break;case 5:ra(e);break;case 1:Ir(e.type)&&Lr(e);break;case 4:sa(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,n=e.memoizedProps.value;Er(_o,s._currentValue),s._currentValue=n;break;case 13:if(null!==(s=e.memoizedState))return null!==s.dehydrated?(Er(aa,1&aa.current),e.flags|=128,null):0!=(i&e.child.childLanes)?Ol(t,e,i):(Er(aa,1&aa.current),null!==(t=Wl(t,e,i))?t.sibling:null);Er(aa,1&aa.current);break;case 19:if(s=0!=(i&e.childLanes),0!=(128&t.flags)){if(s)return Hl(t,e,i);e.flags|=128}if(null!==(n=e.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Er(aa,aa.current),s)break;return null;case 22:case 23:return e.lanes=0,Sl(t,e,i)}return Wl(t,e,i)}(t,e,i);yl=0!=(131072&t.flags)}else yl=!1,so&&0!=(1048576&e.flags)&&Qr(e,$r,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;jl(t,e),t=e.pendingProps;var n=Rr(e,Tr.current);So(e,i),n=Ca(null,e,s,t,n,i);var r=Sa();return e.flags|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ir(s)?(r=!0,Lr(e)):r=!1,e.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Io(e),n.updater=Vo,e.stateNode=n,n._reactInternals=e,$o(e,s,t,i),e=Al(null,e,s,!0,r,i)):(e.tag=0,so&&r&&Jr(e),xl(null,e,n,i),e=e.child),e;case 16:s=e.elementType;t:{switch(jl(t,e),t=e.pendingProps,s=(n=s._init)(s._payload),e.type=s,n=e.tag=function(t){if("function"==typeof t)return Dc(t)?1:0;if(null!=t){if((t=t.$$typeof)===Tt)return 11;if(t===Rt)return 14}return 2}(s),t=mo(s,t),n){case 0:e=Pl(null,e,s,t,i);break t;case 1:e=Tl(null,e,s,t,i);break t;case 11:e=wl(null,e,s,t,i);break t;case 14:e=bl(null,e,s,mo(s.type,t),i);break t}throw Error(nt(306,s,""))}return e;case 0:return s=e.type,n=e.pendingProps,Pl(t,e,s,n=e.elementType===s?n:mo(s,n),i);case 1:return s=e.type,n=e.pendingProps,Tl(t,e,s,n=e.elementType===s?n:mo(s,n),i);case 3:t:{if(kl(e),null===t)throw Error(nt(387));s=e.pendingProps,n=(r=e.memoizedState).element,Do(t,e),Oo(e,s,null,i);var o=e.memoizedState;if(s=o.element,r.isDehydrated){if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,256&e.flags){e=Rl(t,e,s,i,n=hl(Error(nt(423)),e));break t}if(s!==n){e=Rl(t,e,s,i,n=hl(Error(nt(424)),e));break t}for(io=lr(e.stateNode.containerInfo.firstChild),eo=e,so=!0,no=null,i=Zo(e,null,s,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(po(),s===n){e=Wl(t,e,i);break t}xl(t,e,s,i)}e=e.child}return e;case 5:return ra(e),null===t&&lo(e),s=e.type,n=e.pendingProps,r=null!==t?t.memoizedProps:null,o=n.children,er(s,n)?o=null:null!==r&&er(s,r)&&(e.flags|=32),El(t,e),xl(t,e,o,i),e.child;case 6:return null===t&&lo(e),null;case 13:return Ol(t,e,i);case 4:return sa(e,e.stateNode.containerInfo),s=e.pendingProps,null===t?e.child=Yo(e,null,s,i):xl(t,e,s,i),e.child;case 11:return s=e.type,n=e.pendingProps,wl(t,e,s,n=e.elementType===s?n:mo(s,n),i);case 7:return xl(t,e,e.pendingProps,i),e.child;case 8:case 12:return xl(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(s=e.type._context,n=e.pendingProps,r=e.memoizedProps,o=n.value,Er(_o,s._currentValue),s._currentValue=o,null!==r)if(on(r.value,o)){if(r.children===n.children&&!Ar.current){e=Wl(t,e,i);break t}}else for(null!==(r=e.child)&&(r.return=e);null!==r;){var a=r.dependencies;if(null!==a){o=r.child;for(var l=a.firstContext;null!==l;){if(l.context===s){if(1===r.tag){(l=Mo(-1,i&-i)).tag=2;var h=r.updateQueue;if(null!==h){var c=(h=h.shared).pending;null===c?l.next=l:(l.next=c.next,c.next=l),h.pending=l}}r.lanes|=i,null!==(l=r.alternate)&&(l.lanes|=i),Co(r.return,i,e),a.lanes|=i;break}l=l.next}}else if(10===r.tag)o=r.type===e.type?null:r.child;else if(18===r.tag){if(null===(o=r.return))throw Error(nt(341));o.lanes|=i,null!==(a=o.alternate)&&(a.lanes|=i),Co(o,i,e),o=r.sibling}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}xl(t,e,n.children,i),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps.children,So(e,i),s=s(n=Eo(n)),e.flags|=1,xl(t,e,s,i),e.child;case 14:return n=mo(s=e.type,e.pendingProps),bl(t,e,s,n=mo(s.type,n),i);case 15:return Cl(t,e,e.type,e.pendingProps,i);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:mo(s,n),jl(t,e),e.tag=1,Ir(s)?(t=!0,Lr(e)):t=!1,So(e,i),jo(e,s,n),$o(e,s,n,i),Al(null,e,s,!0,t,i);case 19:return Hl(t,e,i);case 22:return Sl(t,e,i)}throw Error(nt(156,e.tag))};var qc="function"==typeof reportError?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}function Kc(t){this._internalRoot=t}function Yc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Zc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qc(){}function Jc(t,e,i,s,n){var r=i._reactRootContainer;if(r){var o=r;if("function"==typeof n){var a=n;n=function(){var t=Wc(o);a.call(t)}}jc(e,o,t,n)}else o=function(t,e,i,s,n){if(n){if("function"==typeof s){var r=s;s=function(){var t=Wc(o);r.call(t)}}var o=Hc(e,s,t,0,null,!1,0,"",Qc);return t._reactRootContainer=o,t[pr]=o.current,Vn(8===t.nodeType?t.parentNode:t),cc(),o}for(;n=t.lastChild;)t.removeChild(n);if("function"==typeof s){var a=s;s=function(){var t=Wc(l);a.call(t)}}var l=Uc(t,0,!1,null,0,!1,0,"",Qc);return t._reactRootContainer=l,t[pr]=l.current,Vn(8===t.nodeType?t.parentNode:t),cc((function(){jc(e,l,i,s)})),l}(i,e,t,n,s);return Wc(o)}Kc.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(nt(409));jc(t,e,null,null)},Kc.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;cc((function(){jc(null,t,null,null)})),e[pr]=null}},Kc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ci();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Di.length&&0!==e&&e<Di[i].priority;i++);Di.splice(i,0,t),0===i&&Bi(t)}},xi=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=ci(e.pendingLanes);0!==i&&(_i(e,1|i),sc(e,Ye()),0==(6&Ah)&&(Hh=Ye()+500,Vr()))}break;case 13:cc((function(){var e=ko(t,1);if(null!==e){var i=tc();ic(e,t,1,i)}})),Gc(t,1)}},wi=function(t){if(13===t.tag){var e=ko(t,134217728);if(null!==e)ic(e,t,134217728,tc());Gc(t,134217728)}},bi=function(t){if(13===t.tag){var e=ec(t),i=ko(t,e);if(null!==i)ic(i,t,e,tc());Gc(t,e)}},Ci=function(){return vi},Si=function(t,e){var i=vi;try{return vi=t,e()}finally{vi=i}},we=function(t,e,i){switch(e){case"input":if(Zt(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var s=i[e];if(s!==t&&s.form===t.form){var n=xr(s);if(!n)throw Error(nt(90));Gt(s),Zt(s,n)}}}break;case"textarea":ne(t,i);break;case"select":null!=(e=i.value)&&ee(t,!!i.multiple,e,!1)}},Te=hc,Ae=cc;var tu={usingClientEntryPoint:!1,Events:[vr,yr,xr,Ee,Pe,hc]},eu={findFiberByHostInstance:_r,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yt.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=We(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{si=su.inject(iu),ni=su}catch(he){}}Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,Q.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(e))throw Error(nt(200));return function(t,e,i){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wt,key:null==s?null:""+s,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},Q.createRoot=function(t,e){if(!Yc(t))throw Error(nt(299));var i=!1,s="",n=qc;return null!=e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(s=e.identifierPrefix),void 0!==e.onRecoverableError&&(n=e.onRecoverableError)),e=Uc(t,1,!1,null,0,i,0,s,n),t[pr]=e.current,Vn(8===t.nodeType?t.parentNode:t),new Xc(e)},Q.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(nt(188));throw t=Object.keys(t).join(","),Error(nt(268,t))}return t=null===(t=We(e))?null:t.stateNode},Q.flushSync=function(t){return cc(t)},Q.hydrate=function(t,e,i){if(!Zc(e))throw Error(nt(200));return Jc(null,t,e,!0,i)},Q.hydrateRoot=function(t,e,i){if(!Yc(t))throw Error(nt(405));var s=null!=i&&i.hydratedSources||null,n=!1,r="",o=qc;if(null!=i&&(!0===i.unstable_strictMode&&(n=!0),void 0!==i.identifierPrefix&&(r=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),e=Hc(e,null,t,1,null!=i?i:null,n,0,r,o),t[pr]=e.current,Vn(t),s)for(t=0;t<s.length;t++)n=(n=(i=s[t])._getVersion)(i._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[i,n]:e.mutableSourceEagerHydrationData.push(i,n);return new Kc(e)},Q.render=function(t,e,i){if(!Zc(e))throw Error(nt(200));return Jc(null,t,e,!1,i)},Q.unmountComponentAtNode=function(t){if(!Zc(t))throw Error(nt(40));return!!t._reactRootContainer&&(cc((function(){Jc(null,null,t,!1,(function(){t._reactRootContainer=null,t[pr]=null}))})),!0)},Q.unstable_batchedUpdates=hc,Q.unstable_renderSubtreeIntoContainer=function(t,e,i,s){if(!Zc(i))throw Error(nt(200));if(null==t||void 0===t._reactInternals)throw Error(nt(38));return Jc(t,e,i,!1,s)},Q.version="18.2.0-next-9e3b772b8-20220608",function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),Z.exports=Q;var nu,ru,ou=Z.exports,au=ou;
/**
 * @remix-run/router v1.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function lu(){return lu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},lu.apply(this,arguments)}Y.createRoot=au.createRoot,Y.hydrateRoot=au.hydrateRoot,(ru=nu||(nu={})).Pop="POP",ru.Push="PUSH",ru.Replace="REPLACE";const hu="popstate";function cu(t){return void 0===t&&(t={}),function(t,e,i,s){void 0===s&&(s={});let{window:n=document.defaultView,v5Compat:r=!1}=s,o=n.history,a=nu.Pop,l=null,h=c();null==h&&(h=0,o.replaceState(lu({},o.state,{idx:h}),""));function c(){return(o.state||{idx:null}).idx}function u(){a=nu.Pop;let t=c(),e=null==t?null:t-h;h=t,l&&l({action:a,location:g.location,delta:e})}function d(t,e){a=nu.Push;let s=fu(g.location,t,e);i&&i(s,t),h=c()+1;let u=pu(s,h),d=g.createHref(s);try{o.pushState(u,"",d)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;n.location.assign(d)}r&&l&&l({action:a,location:g.location,delta:1})}function p(t,e){a=nu.Replace;let s=fu(g.location,t,e);i&&i(s,t),h=c();let n=pu(s,h),u=g.createHref(s);o.replaceState(n,"",u),r&&l&&l({action:a,location:g.location,delta:0})}function f(t){let e="null"!==n.location.origin?n.location.origin:n.location.href,i="string"==typeof t?t:gu(t);return uu(e,"No window.location.(origin|href) available to create URL for href: "+i),new URL(i,e)}let g={get action(){return a},get location(){return t(n,o)},listen(t){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(hu,u),l=t,()=>{n.removeEventListener(hu,u),l=null}},createHref:t=>e(n,t),createURL:f,encodeLocation(t){let e=f(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:d,replace:p,go:t=>o.go(t)};return g}((function(t,e){let{pathname:i,search:s,hash:n}=t.location;return fu("",{pathname:i,search:s,hash:n},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"==typeof e?e:gu(e)}),null,t)}function uu(t,e){if(!1===t||null==t)throw new Error(e)}function du(t,e){if(!t){"undefined"!=typeof console&&console.warn(e);try{throw new Error(e)}catch(Yy){}}}function pu(t,e){return{usr:t.state,key:t.key,idx:e}}function fu(t,e,i,s){return void 0===i&&(i=null),lu({pathname:"string"==typeof t?t:t.pathname,search:"",hash:""},"string"==typeof e?mu(e):e,{state:i,key:e&&e.key||s||Math.random().toString(36).substr(2,8)})}function gu(t){let{pathname:e="/",search:i="",hash:s=""}=t;return i&&"?"!==i&&(e+="?"===i.charAt(0)?i:"?"+i),s&&"#"!==s&&(e+="#"===s.charAt(0)?s:"#"+s),e}function mu(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}var _u,vu;function yu(t,e,i){void 0===i&&(i="/");let s=Mu(("string"==typeof e?mu(e):e).pathname||"/",i);if(null==s)return null;let n=xu(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let i=t.length===e.length&&t.slice(0,-1).every(((t,i)=>t===e[i]));return i?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(n);let r=null;for(let o=0;null==r&&o<n.length;++o)r=Ru(n[o],Du(s));return r}function xu(t,e,i,s){void 0===e&&(e=[]),void 0===i&&(i=[]),void 0===s&&(s="");let n=(t,n,r)=>{let o={relativePath:void 0===r?t.path||"":r,caseSensitive:!0===t.caseSensitive,childrenIndex:n,route:t};o.relativePath.startsWith("/")&&(uu(o.relativePath.startsWith(s),'Absolute route path "'+o.relativePath+'" nested under path "'+s+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(s.length));let a=Fu([s,o.relativePath]),l=i.concat(o);t.children&&t.children.length>0&&(uu(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),xu(t.children,e,l,a)),(null!=t.path||t.index)&&e.push({path:a,score:ku(a,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var i;if(""!==t.path&&null!=(i=t.path)&&i.includes("?"))for(let s of wu(t.path))n(t,e,s);else n(t,e)})),e}function wu(t){let e=t.split("/");if(0===e.length)return[];let[i,...s]=e,n=i.endsWith("?"),r=i.replace(/\?$/,"");if(0===s.length)return n?[r,""]:[r];let o=wu(s.join("/")),a=[];return a.push(...o.map((t=>""===t?r:[r,t].join("/")))),n&&a.push(...o),a.map((e=>t.startsWith("/")&&""===e?"/":e))}(vu=_u||(_u={})).data="data",vu.deferred="deferred",vu.redirect="redirect",vu.error="error";const bu=/^:\w+$/,Cu=3,Su=2,Eu=1,Pu=10,Tu=-2,Au=t=>"*"===t;function ku(t,e){let i=t.split("/"),s=i.length;return i.some(Au)&&(s+=Tu),e&&(s+=Su),i.filter((t=>!Au(t))).reduce(((t,e)=>t+(bu.test(e)?Cu:""===e?Eu:Pu)),s)}function Ru(t,e){let{routesMeta:i}=t,s={},n="/",r=[];for(let o=0;o<i.length;++o){let t=i[o],a=o===i.length-1,l="/"===n?e:e.slice(n.length)||"/",h=Iu({path:t.relativePath,caseSensitive:t.caseSensitive,end:a},l);if(!h)return null;Object.assign(s,h.params);let c=t.route;r.push({params:s,pathname:Fu([n,h.pathname]),pathnameBase:Lu(Fu([n,h.pathnameBase])),route:c}),"/"!==h.pathnameBase&&(n=Fu([n,h.pathnameBase]))}return r}function Iu(t,e){"string"==typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[i,s]=function(t,e,i){void 0===e&&(e=!1);void 0===i&&(i=!0);du("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let s=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,((t,e)=>(s.push(e),"/([^\\/]+)")));t.endsWith("*")?(s.push("*"),n+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?n+="\\/*$":""!==t&&"/"!==t&&(n+="(?:(?=\\/|$))");let r=new RegExp(n,e?void 0:"i");return[r,s]}(t.path,t.caseSensitive,t.end),n=e.match(i);if(!n)return null;let r=n[0],o=r.replace(/(.)\/+$/,"$1"),a=n.slice(1);return{params:s.reduce(((t,e,i)=>{if("*"===e){let t=a[i]||"";o=r.slice(0,r.length-t.length).replace(/(.)\/+$/,"$1")}return t[e]=function(t,e){try{return decodeURIComponent(t)}catch(i){return du(!1,'The value for the URL param "'+e+'" will not be decoded because the string "'+t+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+i+")."),t}}(a[i]||"",e),t}),{}),pathname:r,pathnameBase:o,pattern:t}}function Du(t){try{return decodeURI(t)}catch(e){return du(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function Mu(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=t.charAt(i);return s&&"/"!==s?null:t.slice(i)||"/"}const Fu=t=>t.join("/").replace(/\/\/+/g,"/"),Lu=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/");const Bu=["post","put","patch","delete"];new Set(Bu);const Ou=["get",...Bu];
/**
 * React Router v6.14.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function zu(){return zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},zu.apply(this,arguments)}new Set(Ou);const Nu=N.createContext(null),Uu=N.createContext(null),Vu=N.createContext(null),Hu=N.createContext(null),ju=N.createContext({outlet:null,matches:[],isDataRoute:!1}),Wu=N.createContext(null);function $u(){return null!=N.useContext(Hu)}function Gu(){return $u()||uu(!1),N.useContext(Hu).location}function qu(t,e){return function(t,e,i){$u()||uu(!1);let{navigator:s}=N.useContext(Vu),{matches:n}=N.useContext(ju),r=n[n.length-1],o=r?r.params:{};!r||r.pathname;let a=r?r.pathnameBase:"/";r&&r.route;let l,h=Gu();if(e){var c;let t="string"==typeof e?mu(e):e;"/"===a||(null==(c=t.pathname)?void 0:c.startsWith(a))||uu(!1),l=t}else l=h;let u=l.pathname||"/",d="/"===a?u:u.slice(a.length)||"/",p=yu(t,{pathname:d}),f=function(t,e,i){var s,n;void 0===e&&(e=[]);void 0===i&&(i=null);if(null==t){if(null==(n=i)||!n.errors)return null;t=i.matches}let r=t,o=null==(s=i)?void 0:s.errors;if(null!=o){let t=r.findIndex((t=>t.route.id&&(null==o?void 0:o[t.route.id])));t>=0||uu(!1),r=r.slice(0,Math.min(r.length,t+1))}return r.reduceRight(((t,s,n)=>{let a=s.route.id?null==o?void 0:o[s.route.id]:null,l=null;i&&(l=s.route.errorElement||Ku);let h=e.concat(r.slice(0,n+1)),c=()=>{let e;return e=a?l:s.route.Component?N.createElement(s.route.Component,null):s.route.element?s.route.element:t,N.createElement(Zu,{match:s,routeContext:{outlet:t,matches:h,isDataRoute:null!=i},children:e})};return i&&(s.route.ErrorBoundary||s.route.errorElement||0===n)?N.createElement(Yu,{location:i.location,revalidation:i.revalidation,component:l,error:a,children:c(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):c()}),null)}(p&&p.map((t=>Object.assign({},t,{params:Object.assign({},o,t.params),pathname:Fu([a,s.encodeLocation?s.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?a:Fu([a,s.encodeLocation?s.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),n,i);if(e&&f)return N.createElement(Hu.Provider,{value:{location:zu({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:nu.Pop}},f);return f}(t,e)}function Xu(){let t=function(){var t;let e=N.useContext(Wu),i=function(t){let e=N.useContext(Uu);return e||uu(!1),e}(td.UseRouteError),s=function(t){let e=function(t){let e=N.useContext(ju);return e||uu(!1),e}(),i=e.matches[e.matches.length-1];return i.route.id||uu(!1),i.route.id}(td.UseRouteError);if(e)return e;return null==(t=i.errors)?void 0:t[s]}(),e=function(t){return null!=t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"boolean"==typeof t.internal&&"data"in t}(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),i?N.createElement("pre",{style:s},i):null,null)}const Ku=N.createElement(Xu,null);class Yu extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error?N.createElement(ju.Provider,{value:this.props.routeContext},N.createElement(Wu.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Zu(t){let{routeContext:e,match:i,children:s}=t,n=N.useContext(Nu);return n&&n.static&&n.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=i.route.id),N.createElement(ju.Provider,{value:e},s)}var Qu,Ju,td,ed,id,sd;function nd(t){uu(!1)}function rd(t){let{basename:e="/",children:i=null,location:s,navigationType:n=nu.Pop,navigator:r,static:o=!1}=t;$u()&&uu(!1);let a=e.replace(/^\/*/,"/"),l=N.useMemo((()=>({basename:a,navigator:r,static:o})),[a,r,o]);"string"==typeof s&&(s=mu(s));let{pathname:h="/",search:c="",hash:u="",state:d=null,key:p="default"}=s,f=N.useMemo((()=>{let t=Mu(h,a);return null==t?null:{location:{pathname:t,search:c,hash:u,state:d,key:p},navigationType:n}}),[a,h,c,u,d,p,n]);return null==f?null:N.createElement(Vu.Provider,{value:l},N.createElement(Hu.Provider,{children:i,value:f}))}function od(t){let{children:e,location:i}=t;return qu(ad(e),i)}function ad(t,e){void 0===e&&(e=[]);let i=[];return N.Children.forEach(t,((t,s)=>{if(!N.isValidElement(t))return;let n=[...e,s];if(t.type===N.Fragment)return void i.push.apply(i,ad(t.props.children,n));t.type!==nd&&uu(!1),t.props.index&&t.props.children&&uu(!1);let r={id:t.props.id||n.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(r.children=ad(t.props.children,n)),i.push(r)})),i}
/**
 * React Router DOM v6.14.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */(Ju=Qu||(Qu={})).UseBlocker="useBlocker",Ju.UseRevalidator="useRevalidator",Ju.UseNavigateStable="useNavigate",(ed=td||(td={})).UseBlocker="useBlocker",ed.UseLoaderData="useLoaderData",ed.UseActionData="useActionData",ed.UseRouteError="useRouteError",ed.UseNavigation="useNavigation",ed.UseRouteLoaderData="useRouteLoaderData",ed.UseMatches="useMatches",ed.UseRevalidator="useRevalidator",ed.UseNavigateStable="useNavigate",ed.UseRouteId="useRouteId",(sd=id||(id={}))[sd.pending=0]="pending",sd[sd.success=1]="success",sd[sd.error=2]="error",new Promise((()=>{}));const ld=V.startTransition;function hd(t){let{basename:e,children:i,future:s,window:n}=t,r=N.useRef();null==r.current&&(r.current=cu({window:n,v5Compat:!0}));let o=r.current,[a,l]=N.useState({action:o.action,location:o.location}),{v7_startTransition:h}=s||{},c=N.useCallback((t=>{h&&ld?ld((()=>l(t))):l(t)}),[l,h]);return N.useLayoutEffect((()=>o.listen(c)),[o,c]),N.createElement(rd,{basename:e,children:i,location:a.location,navigationType:a.action,navigator:o})}var cd,ud;!function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"}(cd||(cd={})),function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(ud||(ud={}));const dd={},pd=N.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),fd=N.createContext({}),gd=N.createContext(null),md="undefined"!=typeof document,_d=md?N.useLayoutEffect:N.useEffect,vd=N.createContext({strict:!1});function yd(t){return"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function xd(t){return"string"==typeof t||Array.isArray(t)}function wd(t){return"object"==typeof t&&"function"==typeof t.start}const bd=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Cd=["initial",...bd];function Sd(t){return wd(t.animate)||Cd.some((e=>xd(t[e])))}function Ed(t){return Boolean(Sd(t)||t.variants)}function Pd(t){const{initial:e,animate:i}=function(t,e){if(Sd(t)){const{initial:e,animate:i}=t;return{initial:!1===e||xd(e)?e:void 0,animate:xd(i)?i:void 0}}return!1!==t.inherit?e:{}}(t,N.useContext(fd));return N.useMemo((()=>({initial:e,animate:i})),[Td(e),Td(i)])}function Td(t){return Array.isArray(t)?t.join(" "):t}const Ad={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},kd={};for(const vb in Ad)kd[vb]={isEnabled:t=>Ad[vb].some((e=>!!t[e]))};const Rd=N.createContext({}),Id=N.createContext({}),Dd=Symbol.for("motionComponentSymbol");function Md({preloadedFeatures:t,createVisualElement:e,useRender:i,useVisualState:s,Component:n}){t&&function(t){for(const e in t)kd[e]={...kd[e],...t[e]}}(t);const r=N.forwardRef((function(r,o){let a;const l={...N.useContext(pd),...r,layoutId:Fd(r)},{isStatic:h}=l,c=Pd(r),u=s(r,h);if(!h&&md){c.visualElement=function(t,e,i,s){const{visualElement:n}=N.useContext(fd),r=N.useContext(vd),o=N.useContext(gd),a=N.useContext(pd).reducedMotion,l=N.useRef();s=s||r.renderer,!l.current&&s&&(l.current=s(t,{visualState:e,parent:n,props:i,presenceContext:o,blockInitialAnimation:!!o&&!1===o.initial,reducedMotionConfig:a}));const h=l.current;return N.useInsertionEffect((()=>{h&&h.update(i,o)})),_d((()=>{h&&h.render()})),N.useEffect((()=>{h&&h.updateFeatures()})),(window.HandoffAppearAnimations?_d:N.useEffect)((()=>{h&&h.animationState&&h.animationState.animateChanges()})),h}(n,u,l,e);const i=N.useContext(Id),s=N.useContext(vd).strict;c.visualElement&&(a=c.visualElement.loadFeatures(l,s,t,i))}return N.createElement(fd.Provider,{value:c},a&&c.visualElement?N.createElement(a,{visualElement:c.visualElement,...l}):null,i(n,r,function(t,e,i){return N.useCallback((s=>{s&&t.mount&&t.mount(s),e&&(s?e.mount(s):e.unmount()),i&&("function"==typeof i?i(s):yd(i)&&(i.current=s))}),[e])}(u,c.visualElement,o),u,h,c.visualElement))}));return r[Dd]=n,r}function Fd({layoutId:t}){const e=N.useContext(Rd).id;return e&&void 0!==t?e+"-"+t:t}function Ld(t){function e(e,i={}){return Md(t(e,i))}if("undefined"==typeof Proxy)return e;const i=new Map;return new Proxy(e,{get:(t,s)=>(i.has(s)||i.set(s,e(s)),i.get(s))})}const Bd=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Od(t){return"string"==typeof t&&!t.includes("-")&&!!(Bd.indexOf(t)>-1||/[A-Z]/.test(t))}const zd={};const Nd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ud=new Set(Nd);function Vd(t,{layout:e,layoutId:i}){return Ud.has(t)||t.startsWith("origin")||(e||void 0!==i)&&(!!zd[t]||"opacity"===t)}const Hd=t=>Boolean(t&&t.getVelocity),jd={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Wd=Nd.length;const $d=t=>e=>"string"==typeof e&&e.startsWith(t),Gd=$d("--"),qd=$d("var(--"),Xd=(t,e)=>e&&"number"==typeof t?e.transform(t):t,Kd=(t,e,i)=>Math.min(Math.max(i,t),e),Yd={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},Zd={...Yd,transform:t=>Kd(0,1,t)},Qd={...Yd,default:1},Jd=t=>Math.round(1e5*t)/1e5,tp=/(-)?([\d]*\.?[\d])+/g,ep=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,ip=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function sp(t){return"string"==typeof t}const np=t=>({test:e=>sp(e)&&e.endsWith(t)&&1===e.split(" ").length,parse:parseFloat,transform:e=>`${e}${t}`}),rp=np("deg"),op=np("%"),ap=np("px"),lp=np("vh"),hp=np("vw"),cp={...op,parse:t=>op.parse(t)/100,transform:t=>op.transform(100*t)},up={...Yd,transform:Math.round},dp={borderWidth:ap,borderTopWidth:ap,borderRightWidth:ap,borderBottomWidth:ap,borderLeftWidth:ap,borderRadius:ap,radius:ap,borderTopLeftRadius:ap,borderTopRightRadius:ap,borderBottomRightRadius:ap,borderBottomLeftRadius:ap,width:ap,maxWidth:ap,height:ap,maxHeight:ap,size:ap,top:ap,right:ap,bottom:ap,left:ap,padding:ap,paddingTop:ap,paddingRight:ap,paddingBottom:ap,paddingLeft:ap,margin:ap,marginTop:ap,marginRight:ap,marginBottom:ap,marginLeft:ap,rotate:rp,rotateX:rp,rotateY:rp,rotateZ:rp,scale:Qd,scaleX:Qd,scaleY:Qd,scaleZ:Qd,skew:rp,skewX:rp,skewY:rp,distance:ap,translateX:ap,translateY:ap,translateZ:ap,x:ap,y:ap,z:ap,perspective:ap,transformPerspective:ap,opacity:Zd,originX:cp,originY:cp,originZ:ap,zIndex:up,fillOpacity:Zd,strokeOpacity:Zd,numOctaves:up};function pp(t,e,i,s){const{style:n,vars:r,transform:o,transformOrigin:a}=t;let l=!1,h=!1,c=!0;for(const u in e){const t=e[u];if(Gd(u)){r[u]=t;continue}const i=dp[u],s=Xd(t,i);if(Ud.has(u)){if(l=!0,o[u]=s,!c)continue;t!==(i.default||0)&&(c=!1)}else u.startsWith("origin")?(h=!0,a[u]=s):n[u]=s}if(e.transform||(l||s?n.transform=function(t,{enableHardwareAcceleration:e=!0,allowTransformNone:i=!0},s,n){let r="";for(let o=0;o<Wd;o++){const e=Nd[o];void 0!==t[e]&&(r+=`${jd[e]||e}(${t[e]}) `)}return e&&!t.z&&(r+="translateZ(0)"),r=r.trim(),n?r=n(t,s?"":r):i&&s&&(r="none"),r}(t.transform,i,c,s):n.transform&&(n.transform="none")),h){const{originX:t="50%",originY:e="50%",originZ:i=0}=a;n.transformOrigin=`${t} ${e} ${i}`}}const fp=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function gp(t,e,i){for(const s in e)Hd(e[s])||Vd(s,i)||(t[s]=e[s])}function mp(t,e,i){const s={};return gp(s,t.style||{},t),Object.assign(s,function({transformTemplate:t},e,i){return N.useMemo((()=>{const s=fp();return pp(s,e,{enableHardwareAcceleration:!i},t),Object.assign({},s.vars,s.style)}),[e])}(t,e,i)),t.transformValues?t.transformValues(s):s}function _p(t,e,i){const s={},n=mp(t,e,i);return t.drag&&!1!==t.dragListener&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===t.drag?"none":"pan-"+("x"===t.drag?"y":"x")),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}const vp=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function yp(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||vp.has(t)}let xp=t=>!yp(t);try{(wp=require("@emotion/is-prop-valid").default)&&(xp=t=>t.startsWith("on")?!yp(t):wp(t))}catch(_b){}var wp;function bp(t,e,i){return"string"==typeof t?t:ap.transform(e+i*t)}const Cp={offset:"stroke-dashoffset",array:"stroke-dasharray"},Sp={offset:"strokeDashoffset",array:"strokeDasharray"};function Ep(t,{attrX:e,attrY:i,attrScale:s,originX:n,originY:r,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...h},c,u,d){if(pp(t,h,c,d),u)return void(t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox));t.attrs=t.style,t.style={};const{attrs:p,style:f,dimensions:g}=t;p.transform&&(g&&(f.transform=p.transform),delete p.transform),g&&(void 0!==n||void 0!==r||f.transform)&&(f.transformOrigin=function(t,e,i){return`${bp(e,t.x,t.width)} ${bp(i,t.y,t.height)}`}(g,void 0!==n?n:.5,void 0!==r?r:.5)),void 0!==e&&(p.x=e),void 0!==i&&(p.y=i),void 0!==s&&(p.scale=s),void 0!==o&&function(t,e,i=1,s=0,n=!0){t.pathLength=1;const r=n?Cp:Sp;t[r.offset]=ap.transform(-s);const o=ap.transform(e),a=ap.transform(i);t[r.array]=`${o} ${a}`}(p,o,a,l,!1)}const Pp=()=>({...fp(),attrs:{}}),Tp=t=>"string"==typeof t&&"svg"===t.toLowerCase();function Ap(t,e,i,s){const n=N.useMemo((()=>{const i=Pp();return Ep(i,e,{enableHardwareAcceleration:!1},Tp(s),t.transformTemplate),{...i.attrs,style:{...i.style}}}),[e]);if(t.style){const e={};gp(e,t.style,t),n.style={...e,...n.style}}return n}function kp(t=!1){return(e,i,s,{latestValues:n},r)=>{const o=(Od(e)?Ap:_p)(i,n,r,e),a=function(t,e,i){const s={};for(const n in t)"values"===n&&"object"==typeof t.values||(xp(n)||!0===i&&yp(n)||!e&&!yp(n)||t.draggable&&n.startsWith("onDrag"))&&(s[n]=t[n]);return s}(i,"string"==typeof e,t),l={...a,...o,ref:s},{children:h}=i,c=N.useMemo((()=>Hd(h)?h.get():h),[h]);return N.createElement(e,{...l,children:c})}}const Rp=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function Ip(t,{style:e,vars:i},s,n){Object.assign(t.style,e,n&&n.getProjectionStyles(s));for(const r in i)t.style.setProperty(r,i[r])}const Dp=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Mp(t,e,i,s){Ip(t,e,void 0,s);for(const n in e.attrs)t.setAttribute(Dp.has(n)?n:Rp(n),e.attrs[n])}function Fp(t,e){const{style:i}=t,s={};for(const n in i)(Hd(i[n])||e.style&&Hd(e.style[n])||Vd(n,t))&&(s[n]=i[n]);return s}function Lp(t,e){const i=Fp(t,e);for(const s in t)if(Hd(t[s])||Hd(e[s])){i[-1!==Nd.indexOf(s)?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s]=t[s]}return i}function Bp(t,e,i,s={},n={}){return"function"==typeof e&&(e=e(void 0!==i?i:t.custom,s,n)),"string"==typeof e&&(e=t.variants&&t.variants[e]),"function"==typeof e&&(e=e(void 0!==i?i:t.custom,s,n)),e}function Op(t){const e=N.useRef(null);return null===e.current&&(e.current=t()),e.current}const zp=t=>Array.isArray(t),Np=t=>Boolean(t&&"object"==typeof t&&t.mix&&t.toValue),Up=t=>zp(t)?t[t.length-1]||0:t;function Vp(t){const e=Hd(t)?t.get():t;return Np(e)?e.toValue():e}const Hp=t=>(e,i)=>{const s=N.useContext(fd),n=N.useContext(gd),r=()=>function({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:i},s,n,r){const o={latestValues:jp(s,n,r,t),renderState:e()};return i&&(o.mount=t=>i(s,t,o)),o}(t,e,s,n);return i?r():Op(r)};function jp(t,e,i,s){const n={},r=s(t,{});for(const d in r)n[d]=Vp(r[d]);let{initial:o,animate:a}=t;const l=Sd(t),h=Ed(t);e&&h&&!l&&!1!==t.inherit&&(void 0===o&&(o=e.initial),void 0===a&&(a=e.animate));let c=!!i&&!1===i.initial;c=c||!1===o;const u=c?a:o;if(u&&"boolean"!=typeof u&&!wd(u)){(Array.isArray(u)?u:[u]).forEach((e=>{const i=Bp(t,e);if(!i)return;const{transitionEnd:s,transition:r,...o}=i;for(const t in o){let e=o[t];if(Array.isArray(e)){e=e[c?e.length-1:0]}null!==e&&(n[t]=e)}for(const t in s)n[t]=s[t]}))}return n}const Wp={useVisualState:Hp({scrapeMotionValuesFromProps:Lp,createRenderState:Pp,onMount:(t,e,{renderState:i,latestValues:s})=>{try{i.dimensions="function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}catch(Yy){i.dimensions={x:0,y:0,width:0,height:0}}Ep(i,s,{enableHardwareAcceleration:!1},Tp(e.tagName),t.transformTemplate),Mp(e,i)}})},$p={useVisualState:Hp({scrapeMotionValuesFromProps:Fp,createRenderState:fp})};function Gp(t,e,i,s={passive:!0}){return t.addEventListener(e,i,s),()=>t.removeEventListener(e,i)}const qp=t=>"mouse"===t.pointerType?"number"!=typeof t.button||t.button<=0:!1!==t.isPrimary;function Xp(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Kp=t=>e=>qp(e)&&t(e,Xp(e));function Yp(t,e,i,s){return Gp(t,e,Kp(i),s)}const Zp=(t,e)=>i=>e(t(i)),Qp=(...t)=>t.reduce(Zp);function Jp(t){let e=null;return()=>{const i=()=>{e=null};return null===e&&(e=t,i)}}const tf=Jp("dragHorizontal"),ef=Jp("dragVertical");function sf(t){let e=!1;if("y"===t)e=ef();else if("x"===t)e=tf();else{const t=tf(),i=ef();t&&i?e=()=>{t(),i()}:(t&&t(),i&&i())}return e}function nf(){const t=sf(!0);return!t||(t(),!1)}class rf{constructor(t){this.isMounted=!1,this.node=t}update(){}}const of={delta:0,timestamp:0,isProcessing:!1};let af=!0,lf=!1;const hf=["read","update","preRender","render","postRender"],cf=hf.reduce(((t,e)=>(t[e]=function(t){let e=[],i=[],s=0,n=!1,r=!1;const o=new WeakSet,a={schedule:(t,r=!1,a=!1)=>{const l=a&&n,h=l?e:i;return r&&o.add(t),-1===h.indexOf(t)&&(h.push(t),l&&n&&(s=e.length)),t},cancel:t=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1),o.delete(t)},process:l=>{if(n)r=!0;else{if(n=!0,[e,i]=[i,e],i.length=0,s=e.length,s)for(let i=0;i<s;i++){const s=e[i];s(l),o.has(s)&&(a.schedule(s),t())}n=!1,r&&(r=!1,a.process(l))}}};return a}((()=>lf=!0)),t)),{}),uf=t=>cf[t].process(of),df=t=>{lf=!1,of.delta=af?1e3/60:Math.max(Math.min(t-of.timestamp,40),1),of.timestamp=t,of.isProcessing=!0,hf.forEach(uf),of.isProcessing=!1,lf&&(af=!1,requestAnimationFrame(df))},pf=hf.reduce(((t,e)=>{const i=cf[e];return t[e]=(t,e=!1,s=!1)=>(lf||(lf=!0,af=!0,of.isProcessing||requestAnimationFrame(df)),i.schedule(t,e,s)),t}),{});function ff(t){hf.forEach((e=>cf[e].cancel(t)))}function gf(t,e){const i="pointer"+(e?"enter":"leave"),s="onHover"+(e?"Start":"End");return Yp(t.current,i,((i,n)=>{if("touch"===i.type||nf())return;const r=t.getProps();t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",e),r[s]&&pf.update((()=>r[s](i,n)))}),{passive:!t.getProps()[s]})}const mf=(t,e)=>!!e&&(t===e||mf(t,e.parentElement)),_f=t=>t;function vf(t,e){if(!e)return;const i=new PointerEvent("pointer"+t);e(i,Xp(i))}const yf=new WeakMap,xf=new WeakMap,wf=t=>{const e=yf.get(t.target);e&&e(t)},bf=t=>{t.forEach(wf)};function Cf(t,e,i){const s=function({root:t,...e}){const i=t||document;xf.has(i)||xf.set(i,{});const s=xf.get(i),n=JSON.stringify(e);return s[n]||(s[n]=new IntersectionObserver(bf,{root:t,...e})),s[n]}(e);return yf.set(t,i),s.observe(t),()=>{yf.delete(t),s.unobserve(t)}}const Sf={some:0,all:1};const Ef={inView:{Feature:class extends rf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:i,amount:s="some",once:n}=t,r={root:e?e.current:void 0,rootMargin:i,threshold:"number"==typeof s?s:Sf[s]};return Cf(this.node.current,r,(t=>{const{isIntersecting:e}=t;if(this.isInView===e)return;if(this.isInView=e,n&&!e&&this.hasEnteredView)return;e&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",e);const{onViewportEnter:i,onViewportLeave:s}=this.node.getProps(),r=e?i:s;r&&r(t)}))}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(function({viewport:t={}},{viewport:e={}}={}){return i=>t[i]!==e[i]}(t,e))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends rf{constructor(){super(...arguments),this.removeStartListeners=_f,this.removeEndListeners=_f,this.removeAccessibleListeners=_f,this.startPointerPress=(t,e)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=Yp(window,"pointerup",((t,e)=>{if(!this.checkPressEnd())return;const{onTap:i,onTapCancel:s}=this.node.getProps();pf.update((()=>{mf(this.node.current,t.target)?i&&i(t,e):s&&s(t,e)}))}),{passive:!(i.onTap||i.onPointerUp)}),n=Yp(window,"pointercancel",((t,e)=>this.cancelPress(t,e)),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=Qp(s,n),this.startPress(t,e)},this.startAccessiblePress=()=>{const t=Gp(this.node.current,"keydown",(t=>{if("Enter"!==t.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=Gp(this.node.current,"keyup",(t=>{"Enter"===t.key&&this.checkPressEnd()&&vf("up",((t,e)=>{const{onTap:i}=this.node.getProps();i&&pf.update((()=>i(t,e)))}))})),vf("down",((t,e)=>{this.startPress(t,e)}))})),e=Gp(this.node.current,"blur",(()=>{this.isPressing&&vf("cancel",((t,e)=>this.cancelPress(t,e)))}));this.removeAccessibleListeners=Qp(t,e)}}startPress(t,e){this.isPressing=!0;const{onTapStart:i,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&pf.update((()=>i(t,e)))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!nf()}cancelPress(t,e){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&pf.update((()=>i(t,e)))}mount(){const t=this.node.getProps(),e=Yp(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),i=Gp(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Qp(e,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends rf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch(Yy){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Qp(Gp(this.node.current,"focus",(()=>this.onFocus())),Gp(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends rf{mount(){this.unmount=Qp(gf(this.node,!0),gf(this.node,!1))}unmount(){}}}};function Pf(t,e){if(!Array.isArray(e))return!1;const i=e.length;if(i!==t.length)return!1;for(let s=0;s<i;s++)if(e[s]!==t[s])return!1;return!0}function Tf(t,e,i){const s=t.getProps();return Bp(s,e,void 0!==i?i:s.custom,function(t){const e={};return t.values.forEach(((t,i)=>e[i]=t.get())),e}(t),function(t){const e={};return t.values.forEach(((t,i)=>e[i]=t.getVelocity())),e}(t))}const Af="data-"+Rp("framerAppearId");let kf=_f,Rf=_f;const If=t=>1e3*t,Df=t=>t/1e3,Mf=!1,Ff=t=>Array.isArray(t)&&"number"==typeof t[0];function Lf(t){return Boolean(!t||"string"==typeof t&&Of[t]||Ff(t)||Array.isArray(t)&&t.every(Lf))}const Bf=([t,e,i,s])=>`cubic-bezier(${t}, ${e}, ${i}, ${s})`,Of={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Bf([0,.65,.55,1]),circOut:Bf([.55,0,1,.45]),backIn:Bf([.31,.01,.66,-.59]),backOut:Bf([.33,1.53,.69,.99])};function zf(t){if(t)return Ff(t)?Bf(t):Array.isArray(t)?t.map(zf):Of[t]}const Nf={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},Uf={},Vf={};for(const vb in Nf)Vf[vb]=()=>(void 0===Uf[vb]&&(Uf[vb]=Nf[vb]()),Uf[vb]);const Hf=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t,jf=1e-7,Wf=12;function $f(t,e,i,s){if(t===e&&i===s)return _f;const n=e=>function(t,e,i,s,n){let r,o,a=0;do{o=e+(i-e)/2,r=Hf(o,s,n)-t,r>0?i=o:e=o}while(Math.abs(r)>jf&&++a<Wf);return o}(e,0,1,t,i);return t=>0===t||1===t?t:Hf(n(t),e,s)}const Gf=$f(.42,0,1,1),qf=$f(0,0,.58,1),Xf=$f(.42,0,.58,1),Kf=t=>Array.isArray(t)&&"number"!=typeof t[0],Yf=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Zf=t=>e=>1-t(1-e),Qf=t=>1-Math.sin(Math.acos(t)),Jf=Zf(Qf),tg=Yf(Jf),eg=$f(.33,1.53,.69,.99),ig=Zf(eg),sg=Yf(ig),ng={linear:_f,easeIn:Gf,easeInOut:Xf,easeOut:qf,circIn:Qf,circInOut:tg,circOut:Jf,backIn:ig,backInOut:sg,backOut:eg,anticipate:t=>(t*=2)<1?.5*ig(t):.5*(2-Math.pow(2,-10*(t-1)))},rg=t=>{if(Array.isArray(t)){Rf(4===t.length);const[e,i,s,n]=t;return $f(e,i,s,n)}return"string"==typeof t?ng[t]:t},og=(t,e)=>i=>Boolean(sp(i)&&ip.test(i)&&i.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(i,e)),ag=(t,e,i)=>s=>{if(!sp(s))return s;const[n,r,o,a]=s.match(tp);return{[t]:parseFloat(n),[e]:parseFloat(r),[i]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},lg={...Yd,transform:t=>Math.round((t=>Kd(0,255,t))(t))},hg={test:og("rgb","red"),parse:ag("red","green","blue"),transform:({red:t,green:e,blue:i,alpha:s=1})=>"rgba("+lg.transform(t)+", "+lg.transform(e)+", "+lg.transform(i)+", "+Jd(Zd.transform(s))+")"};const cg={test:og("#"),parse:function(t){let e="",i="",s="",n="";return t.length>5?(e=t.substring(1,3),i=t.substring(3,5),s=t.substring(5,7),n=t.substring(7,9)):(e=t.substring(1,2),i=t.substring(2,3),s=t.substring(3,4),n=t.substring(4,5),e+=e,i+=i,s+=s,n+=n),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}},transform:hg.transform},ug={test:og("hsl","hue"),parse:ag("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:i,alpha:s=1})=>"hsla("+Math.round(t)+", "+op.transform(Jd(e))+", "+op.transform(Jd(i))+", "+Jd(Zd.transform(s))+")"},dg={test:t=>hg.test(t)||cg.test(t)||ug.test(t),parse:t=>hg.test(t)?hg.parse(t):ug.test(t)?ug.parse(t):cg.parse(t),transform:t=>sp(t)?t:t.hasOwnProperty("red")?hg.transform(t):ug.transform(t)},pg=(t,e,i)=>-i*t+i*e+t;function fg(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}const gg=(t,e,i)=>{const s=t*t;return Math.sqrt(Math.max(0,i*(e*e-s)+s))},mg=[cg,hg,ug];function _g(t){const e=(i=t,mg.find((t=>t.test(i))));var i;let s=e.parse(t);return e===ug&&(s=function({hue:t,saturation:e,lightness:i,alpha:s}){t/=360,i/=100;let n=0,r=0,o=0;if(e/=100){const s=i<.5?i*(1+e):i+e-i*e,a=2*i-s;n=fg(a,s,t+1/3),r=fg(a,s,t),o=fg(a,s,t-1/3)}else n=r=o=i;return{red:Math.round(255*n),green:Math.round(255*r),blue:Math.round(255*o),alpha:s}}(s)),s}const vg=(t,e)=>{const i=_g(t),s=_g(e),n={...i};return t=>(n.red=gg(i.red,s.red,t),n.green=gg(i.green,s.green,t),n.blue=gg(i.blue,s.blue,t),n.alpha=pg(i.alpha,s.alpha,t),hg.transform(n))};const yg={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:_f},xg={regex:ep,countKey:"Colors",token:"${c}",parse:dg.parse},wg={regex:tp,countKey:"Numbers",token:"${n}",parse:Yd.parse};function bg(t,{regex:e,countKey:i,token:s,parse:n}){const r=t.tokenised.match(e);r&&(t["num"+i]=r.length,t.tokenised=t.tokenised.replace(e,s),t.values.push(...r.map(n)))}function Cg(t){const e=t.toString(),i={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return i.value.includes("var(--")&&bg(i,yg),bg(i,xg),bg(i,wg),i}function Sg(t){return Cg(t).values}function Eg(t){const{values:e,numColors:i,numVars:s,tokenised:n}=Cg(t),r=e.length;return t=>{let e=n;for(let n=0;n<r;n++)e=n<s?e.replace(yg.token,t[n]):n<s+i?e.replace(xg.token,dg.transform(t[n])):e.replace(wg.token,Jd(t[n]));return e}}const Pg=t=>"number"==typeof t?0:t;const Tg={test:function(t){var e,i;return isNaN(t)&&sp(t)&&((null===(e=t.match(tp))||void 0===e?void 0:e.length)||0)+((null===(i=t.match(ep))||void 0===i?void 0:i.length)||0)>0},parse:Sg,createTransformer:Eg,getAnimatableNone:function(t){const e=Sg(t);return Eg(t)(e.map(Pg))}},Ag=(t,e)=>i=>`${i>0?e:t}`;function kg(t,e){return"number"==typeof t?i=>pg(t,e,i):dg.test(t)?vg(t,e):t.startsWith("var(")?Ag(t,e):Dg(t,e)}const Rg=(t,e)=>{const i=[...t],s=i.length,n=t.map(((t,i)=>kg(t,e[i])));return t=>{for(let e=0;e<s;e++)i[e]=n[e](t);return i}},Ig=(t,e)=>{const i={...t,...e},s={};for(const n in i)void 0!==t[n]&&void 0!==e[n]&&(s[n]=kg(t[n],e[n]));return t=>{for(const e in s)i[e]=s[e](t);return i}},Dg=(t,e)=>{const i=Tg.createTransformer(e),s=Cg(t),n=Cg(e);return s.numVars===n.numVars&&s.numColors===n.numColors&&s.numNumbers>=n.numNumbers?Qp(Rg(s.values,n.values),i):Ag(t,e)},Mg=(t,e,i)=>{const s=e-t;return 0===s?1:(i-t)/s},Fg=(t,e)=>i=>pg(t,e,i);function Lg(t,e,i){const s=[],n=i||("number"==typeof(r=t[0])?Fg:"string"==typeof r?dg.test(r)?vg:Dg:Array.isArray(r)?Rg:"object"==typeof r?Ig:Fg);var r;const o=t.length-1;for(let a=0;a<o;a++){let i=n(t[a],t[a+1]);if(e){const t=Array.isArray(e)?e[a]||_f:e;i=Qp(t,i)}s.push(i)}return s}function Bg(t,e,{clamp:i=!0,ease:s,mixer:n}={}){const r=t.length;if(Rf(r===e.length),1===r)return()=>e[0];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Lg(e,s,n),a=o.length,l=e=>{let i=0;if(a>1)for(;i<t.length-2&&!(e<t[i+1]);i++);const s=Mg(t[i],t[i+1],e);return o[i](s)};return i?e=>l(Kd(t[0],t[r-1],e)):l}function Og(t){const e=[0];return function(t,e){const i=t[t.length-1];for(let s=1;s<=e;s++){const n=Mg(0,e,s);t.push(pg(i,1,n))}}(e,t.length-1),e}function zg({duration:t=300,keyframes:e,times:i,ease:s="easeInOut"}){const n=Kf(s)?s.map(rg):rg(s),r={done:!1,value:e[0]},o=function(t,e){return t.map((t=>t*e))}(i&&i.length===e.length?i:Og(e),t),a=Bg(o,e,{ease:Array.isArray(n)?n:(l=e,h=n,l.map((()=>h||Xf)).splice(0,l.length-1))});var l,h;return{calculatedDuration:t,next:e=>(r.value=a(e),r.done=e>=t,r)}}function Ng(t,e){return e?t*(1e3/e):0}const Ug=5;function Vg(t,e,i){const s=Math.max(e-Ug,0);return Ng(i-t(s),e-s)}const Hg=.001,jg=.01,Wg=10,$g=.05,Gg=1;function qg({duration:t=800,bounce:e=.25,velocity:i=0,mass:s=1}){let n,r;kf(t<=If(Wg));let o=1-e;o=Kd($g,Gg,o),t=Kd(jg,Wg,Df(t)),o<1?(n=e=>{const s=e*o,n=s*t,r=s-i,a=Kg(e,o),l=Math.exp(-n);return Hg-r/a*l},r=e=>{const s=e*o*t,r=s*i+i,a=Math.pow(o,2)*Math.pow(e,2)*t,l=Math.exp(-s),h=Kg(Math.pow(e,2),o);return(-n(e)+Hg>0?-1:1)*((r-a)*l)/h}):(n=e=>Math.exp(-e*t)*((e-i)*t+1)-Hg,r=e=>Math.exp(-e*t)*(t*t*(i-e)));const a=function(t,e,i){let s=i;for(let n=1;n<Xg;n++)s-=t(s)/e(s);return s}(n,r,5/t);if(t=If(t),isNaN(a))return{stiffness:100,damping:10,duration:t};{const e=Math.pow(a,2)*s;return{stiffness:e,damping:2*o*Math.sqrt(s*e),duration:t}}}const Xg=12;function Kg(t,e){return t*Math.sqrt(1-e*e)}const Yg=["duration","bounce"],Zg=["stiffness","damping","mass"];function Qg(t,e){return e.some((e=>void 0!==t[e]))}function Jg({keyframes:t,restDelta:e,restSpeed:i,...s}){const n=t[0],r=t[t.length-1],o={done:!1,value:n},{stiffness:a,damping:l,mass:h,velocity:c,duration:u,isResolvedFromDuration:d}=function(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!Qg(t,Zg)&&Qg(t,Yg)){const i=qg(t);e={...e,...i,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}(s),p=c?-Df(c):0,f=l/(2*Math.sqrt(a*h)),g=r-n,m=Df(Math.sqrt(a/h)),_=Math.abs(g)<5;let v;if(i||(i=_?.01:2),e||(e=_?.005:.5),f<1){const t=Kg(m,f);v=e=>{const i=Math.exp(-f*m*e);return r-i*((p+f*m*g)/t*Math.sin(t*e)+g*Math.cos(t*e))}}else if(1===f)v=t=>r-Math.exp(-m*t)*(g+(p+m*g)*t);else{const t=m*Math.sqrt(f*f-1);v=e=>{const i=Math.exp(-f*m*e),s=Math.min(t*e,300);return r-i*((p+f*m*g)*Math.sinh(s)+t*g*Math.cosh(s))/t}}return{calculatedDuration:d&&u||null,next:t=>{const s=v(t);if(d)o.done=t>=u;else{let n=p;0!==t&&(n=f<1?Vg(v,t,s):0);const a=Math.abs(n)<=i,l=Math.abs(r-s)<=e;o.done=a&&l}return o.value=o.done?r:s,o}}}function tm({keyframes:t,velocity:e=0,power:i=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:l,restDelta:h=.5,restSpeed:c}){const u=t[0],d={done:!1,value:u},p=t=>void 0===a?l:void 0===l||Math.abs(a-t)<Math.abs(l-t)?a:l;let f=i*e;const g=u+f,m=void 0===o?g:o(g);m!==g&&(f=m-u);const _=t=>-f*Math.exp(-t/s),v=t=>m+_(t),y=t=>{const e=_(t),i=v(t);d.done=Math.abs(e)<=h,d.value=d.done?m:i};let x,w;const b=t=>{var e;(e=d.value,void 0!==a&&e<a||void 0!==l&&e>l)&&(x=t,w=Jg({keyframes:[d.value,p(d.value)],velocity:Vg(v,t,d.value),damping:n,stiffness:r,restDelta:h,restSpeed:c}))};return b(0),{calculatedDuration:null,next:t=>{let e=!1;return w||void 0!==x||(e=!0,y(t),b(t)),void 0!==x&&t>x?w.next(t-x):(!e&&y(t),d)}}}const em=t=>{const e=({timestamp:e})=>t(e);return{start:()=>pf.update(e,!0),stop:()=>ff(e),now:()=>of.isProcessing?of.timestamp:performance.now()}},im=2e4;function sm(t){let e=0;let i=t.next(e);for(;!i.done&&e<im;)e+=50,i=t.next(e);return e>=im?1/0:e}const nm={decay:tm,inertia:tm,tween:zg,keyframes:zg,spring:Jg};function rm({autoplay:t=!0,delay:e=0,driver:i=em,keyframes:s,type:n="keyframes",repeat:r=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:h,onComplete:c,onUpdate:u,...d}){let p,f,g=1,m=!1;const _=()=>{p&&p(),f=new Promise((t=>{p=t}))};let v;_();const y=nm[n]||zg;let x;y!==zg&&"number"!=typeof s[0]&&(x=Bg([0,100],s,{clamp:!1}),s=[0,100]);const w=y({...d,keyframes:s});let b;"mirror"===a&&(b=y({...d,keyframes:[...s].reverse(),velocity:-(d.velocity||0)}));let C="idle",S=null,E=null,P=null;null===w.calculatedDuration&&r&&(w.calculatedDuration=sm(w));const{calculatedDuration:T}=w;let A=1/0,k=1/0;null!==T&&(A=T+o,k=A*(r+1)-o);let R=0;const I=t=>{if(null===E)return;g>0&&(E=Math.min(E,t)),g<0&&(E=Math.min(t-k/g,E)),R=null!==S?S:Math.round(t-E)*g;const i=R-e*(g>=0?1:-1),n=g>=0?i<0:i>k;R=Math.max(i,0),"finished"===C&&null===S&&(R=k);let l=R,h=w;if(r){const t=R/A;let e=Math.floor(t),i=t%1;!i&&t>=1&&(i=1),1===i&&e--,e=Math.min(e,r+1);const s=Boolean(e%2);s&&("reverse"===a?(i=1-i,o&&(i-=o/A)):"mirror"===a&&(h=b));let n=Kd(0,1,i);R>k&&(n="reverse"===a&&s?1:0),l=n*A}const c=n?{done:!1,value:s[0]}:h.next(l);x&&(c.value=x(c.value));let{done:d}=c;n||null===T||(d=g>=0?R>=k:R<=0);const p=null===S&&("finished"===C||"running"===C&&d);return u&&u(c.value),p&&F(),c},D=()=>{v&&v.stop(),v=void 0},M=()=>{C="idle",D(),_(),E=P=null},F=()=>{C="finished",c&&c(),D(),_()},L=()=>{if(m)return;v||(v=i(I));const t=v.now();l&&l(),null!==S?E=t-S:E&&"finished"!==C||(E=t),P=E,S=null,C="running",v.start()};t&&L();const B={then:(t,e)=>f.then(t,e),get time(){return Df(R)},set time(t){t=If(t),R=t,null===S&&v&&0!==g?E=v.now()-t/g:S=t},get duration(){const t=null===w.calculatedDuration?sm(w):w.calculatedDuration;return Df(t)},get speed(){return g},set speed(t){t!==g&&v&&(g=t,B.time=Df(R))},get state(){return C},play:L,pause:()=>{C="paused",S=R},stop:()=>{m=!0,"idle"!==C&&(C="idle",h&&h(),M())},cancel:()=>{null!==P&&I(P),M()},complete:()=>{C="finished"},sample:t=>(E=0,I(t))};return B}const om=new Set(["opacity","clipPath","filter","transform","backgroundColor"]);function am(t,e,{onUpdate:i,onComplete:s,...n}){if(!(Vf.waapi()&&om.has(e)&&!n.repeatDelay&&"mirror"!==n.repeatType&&0!==n.damping&&"inertia"!==n.type))return!1;let r,o,a=!1;const l=()=>{o=new Promise((t=>{r=t}))};l();let{keyframes:h,duration:c=300,ease:u,times:d}=n;if(((t,e)=>"spring"===e.type||"backgroundColor"===t||!Lf(e.ease))(e,n)){const t=rm({...n,repeat:0,delay:0});let e={done:!1,value:h[0]};const i=[];let s=0;for(;!e.done&&s<2e4;)e=t.sample(s),i.push(e.value),s+=10;d=void 0,h=i,c=s-10,u="linear"}const p=function(t,e,i,{delay:s=0,duration:n,repeat:r=0,repeatType:o="loop",ease:a,times:l}={}){const h={[e]:i};l&&(h.offset=l);const c=zf(a);return Array.isArray(c)&&(h.easing=c),t.animate(h,{delay:s,duration:n,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:r+1,direction:"reverse"===o?"alternate":"normal"})}(t.owner.current,e,h,{...n,duration:c,ease:u,times:d}),f=()=>p.cancel(),g=()=>{pf.update(f),r(),l()};return p.onfinish=()=>{t.set(function(t,{repeat:e,repeatType:i="loop"}){return t[e&&"loop"!==i&&e%2==1?0:t.length-1]}(h,n)),s&&s(),g()},{then:(t,e)=>o.then(t,e),get time(){return Df(p.currentTime||0)},set time(t){p.currentTime=If(t)},get speed(){return p.playbackRate},set speed(t){p.playbackRate=t},get duration(){return Df(c)},play:()=>{a||(p.play(),ff(f))},pause:()=>p.pause(),stop:()=>{if(a=!0,"idle"===p.playState)return;const{currentTime:e}=p;if(e){const i=rm({...n,autoplay:!1});t.setWithVelocity(i.sample(e-10).value,i.sample(e).value,10)}g()},complete:()=>p.finish(),cancel:g}}const lm={type:"spring",stiffness:500,damping:25,restSpeed:10},hm={type:"keyframes",duration:.8},cm={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},um=(t,{keyframes:e})=>e.length>2?hm:Ud.has(t)?t.startsWith("scale")?{type:"spring",stiffness:550,damping:0===e[1]?2*Math.sqrt(550):30,restSpeed:10}:lm:cm,dm=(t,e)=>"zIndex"!==t&&(!("number"!=typeof e&&!Array.isArray(e))||!("string"!=typeof e||!Tg.test(e)&&"0"!==e||e.startsWith("url("))),pm=new Set(["brightness","contrast","saturate","opacity"]);function fm(t){const[e,i]=t.slice(0,-1).split("(");if("drop-shadow"===e)return t;const[s]=i.match(tp)||[];if(!s)return t;const n=i.replace(s,"");let r=pm.has(e)?1:0;return s!==i&&(r*=100),e+"("+r+n+")"}const gm=/([a-z-]*)\(.*?\)/g,mm={...Tg,getAnimatableNone:t=>{const e=t.match(gm);return e?e.map(fm).join(" "):t}},_m={...dp,color:dg,backgroundColor:dg,outlineColor:dg,fill:dg,stroke:dg,borderColor:dg,borderTopColor:dg,borderRightColor:dg,borderBottomColor:dg,borderLeftColor:dg,filter:mm,WebkitFilter:mm},vm=t=>_m[t];function ym(t,e){let i=vm(t);return i!==mm&&(i=Tg),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const xm=t=>/^0[^.\s]+$/.test(t);function wm(t){return"number"==typeof t?0===t:null!==t?"none"===t||"0"===t||xm(t):void 0}function bm(t,e){return t[e]||t.default||t}const Cm=(t,e,i,s={})=>n=>{const r=bm(s,t)||{},o=r.delay||s.delay||0;let{elapsed:a=0}=s;a-=If(o);const l=function(t,e,i,s){const n=dm(e,i);let r;r=Array.isArray(i)?[...i]:[null,i];const o=void 0!==s.from?s.from:t.get();let a;const l=[];for(let h=0;h<r.length;h++)null===r[h]&&(r[h]=0===h?o:r[h-1]),wm(r[h])&&l.push(h),"string"==typeof r[h]&&"none"!==r[h]&&"0"!==r[h]&&(a=r[h]);if(n&&l.length&&a)for(let h=0;h<l.length;h++)r[l[h]]=ym(e,a);return r}(e,t,i,r),h=l[0],c=l[l.length-1],u=dm(t,h),d=dm(t,c);let p={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...r,delay:-a,onUpdate:t=>{e.set(t),r.onUpdate&&r.onUpdate(t)},onComplete:()=>{n(),r.onComplete&&r.onComplete()}};if(function({when:t,delay:e,delayChildren:i,staggerChildren:s,staggerDirection:n,repeat:r,repeatType:o,repeatDelay:a,from:l,elapsed:h,...c}){return!!Object.keys(c).length}(r)||(p={...p,...um(t,p)}),p.duration&&(p.duration=If(p.duration)),p.repeatDelay&&(p.repeatDelay=If(p.repeatDelay)),!u||!d||Mf||!1===r.type)return function({keyframes:t,delay:e,onUpdate:i,onComplete:s}){const n=()=>(i&&i(t[t.length-1]),s&&s(),{time:0,speed:1,duration:0,play:_f,pause:_f,stop:_f,then:t=>(t(),Promise.resolve()),cancel:_f,complete:_f});return e?rm({keyframes:[0,1],duration:0,delay:e,onComplete:n}):n()}(p);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const i=am(e,t,p);if(i)return i}return rm(p)};function Sm(t){return Boolean(Hd(t)&&t.add)}function Em(t,e){-1===t.indexOf(e)&&t.push(e)}function Pm(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class Tm{constructor(){this.subscriptions=[]}add(t){return Em(this.subscriptions,t),()=>Pm(this.subscriptions,t)}notify(t,e,i){const s=this.subscriptions.length;if(s)if(1===s)this.subscriptions[0](t,e,i);else for(let n=0;n<s;n++){const s=this.subscriptions[n];s&&s(t,e,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}class Am{constructor(t,e={}){var i;this.version="10.12.17",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(t,e=!0)=>{this.prev=this.current,this.current=t;const{delta:i,timestamp:s}=of;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,pf.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),e&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>pf.postRender(this.velocityCheck),this.velocityCheck=({timestamp:t})=>{t!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=(i=this.current,!isNaN(parseFloat(i))),this.owner=e.owner}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new Tm);const i=this.events[t].add(e);return"change"===t?()=>{i(),pf.read((()=>{this.events.change.getSize()||this.stop()}))}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){e&&this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t,e)}setWithVelocity(t,e,i){this.set(e),this.prev=t,this.timeDelta=i}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Ng(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise((e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function km(t,e){return new Am(t,e)}const Rm=t=>e=>e.test(t),Im=[Yd,ap,op,rp,hp,lp,{test:t=>"auto"===t,parse:t=>t}],Dm=t=>Im.find(Rm(t)),Mm=[...Im,dg,Tg],Fm=t=>Mm.find(Rm(t));function Lm(t,e,i){t.hasValue(e)?t.getValue(e).set(i):t.addValue(e,km(i))}function Bm(t,e){if(!e)return;return(e[t]||e.default||e).from}function Om({protectedKeys:t,needsAnimating:e},i){const s=t.hasOwnProperty(i)&&!0!==e[i];return e[i]=!1,s}function zm(t,e,{delay:i=0,transitionOverride:s,type:n}={}){let{transition:r=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");s&&(r=s);const h=[],c=n&&t.animationState&&t.animationState.getState()[n];for(const u in a){const e=t.getValue(u),s=a[u];if(!e||void 0===s||c&&Om(c,u))continue;const n={delay:i,elapsed:0,...r};if(window.HandoffAppearAnimations&&!e.hasAnimated){const i=t.getProps()[Af];i&&(n.elapsed=window.HandoffAppearAnimations(i,u,e,pf))}e.start(Cm(u,e,s,t.shouldReduceMotion&&Ud.has(u)?{type:!1}:n));const o=e.animation;Sm(l)&&(l.add(u),o.then((()=>l.remove(u)))),h.push(o)}return o&&Promise.all(h).then((()=>{o&&function(t,e){const i=Tf(t,e);let{transitionEnd:s={},transition:n={},...r}=i?t.makeTargetAnimatable(i,!1):{};r={...r,...s};for(const o in r)Lm(t,o,Up(r[o]))}(t,o)})),h}function Nm(t,e,i={}){const s=Tf(t,e,i.custom);let{transition:n=t.getDefaultTransition()||{}}=s||{};i.transitionOverride&&(n=i.transitionOverride);const r=s?()=>Promise.all(zm(t,s,i)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(s=0)=>{const{delayChildren:r=0,staggerChildren:o,staggerDirection:a}=n;return function(t,e,i=0,s=0,n=1,r){const o=[],a=(t.variantChildren.size-1)*s,l=1===n?(t=0)=>t*s:(t=0)=>a-t*s;return Array.from(t.variantChildren).sort(Um).forEach(((t,s)=>{t.notify("AnimationStart",e),o.push(Nm(t,e,{...r,delay:i+l(s)}).then((()=>t.notify("AnimationComplete",e))))})),Promise.all(o)}(t,e,r+s,o,a,i)}:()=>Promise.resolve(),{when:a}=n;if(a){const[t,e]="beforeChildren"===a?[r,o]:[o,r];return t().then((()=>e()))}return Promise.all([r(),o(i.delay)])}function Um(t,e){return t.sortNodePosition(e)}const Vm=[...bd].reverse(),Hm=bd.length;function jm(t){return e=>Promise.all(e.map((({animation:e,options:i})=>function(t,e,i={}){let s;if(t.notify("AnimationStart",e),Array.isArray(e)){const n=e.map((e=>Nm(t,e,i)));s=Promise.all(n)}else if("string"==typeof e)s=Nm(t,e,i);else{const n="function"==typeof e?Tf(t,e,i.custom):e;s=Promise.all(zm(t,n,i))}return s.then((()=>t.notify("AnimationComplete",e)))}(t,e,i))))}function Wm(t){let e=jm(t);const i={animate:Gm(!0),whileInView:Gm(),whileHover:Gm(),whileTap:Gm(),whileDrag:Gm(),whileFocus:Gm(),exit:Gm()};let s=!0;const n=(e,i)=>{const s=Tf(t,i);if(s){const{transition:t,transitionEnd:i,...n}=s;e={...e,...n,...i}}return e};function r(r,o){const a=t.getProps(),l=t.getVariantContext(!0)||{},h=[],c=new Set;let u={},d=1/0;for(let e=0;e<Hm;e++){const p=Vm[e],f=i[p],g=void 0!==a[p]?a[p]:l[p],m=xd(g),_=p===o?f.isActive:null;!1===_&&(d=e);let v=g===l[p]&&g!==a[p]&&m;if(v&&s&&t.manuallyAnimateOnMount&&(v=!1),f.protectedKeys={...u},!f.isActive&&null===_||!g&&!f.prevProp||wd(g)||"boolean"==typeof g)continue;const y=$m(f.prevProp,g);let x=y||p===o&&f.isActive&&!v&&m||e>d&&m;const w=Array.isArray(g)?g:[g];let b=w.reduce(n,{});!1===_&&(b={});const{prevResolvedValues:C={}}=f,S={...C,...b},E=t=>{x=!0,c.delete(t),f.needsAnimating[t]=!0};for(const t in S){const e=b[t],i=C[t];u.hasOwnProperty(t)||(e!==i?zp(e)&&zp(i)?!Pf(e,i)||y?E(t):f.protectedKeys[t]=!0:void 0!==e?E(t):c.add(t):void 0!==e&&c.has(t)?E(t):f.protectedKeys[t]=!0)}f.prevProp=g,f.prevResolvedValues=b,f.isActive&&(u={...u,...b}),s&&t.blockInitialAnimation&&(x=!1),x&&!v&&h.push(...w.map((t=>({animation:t,options:{type:p,...r}}))))}if(c.size){const e={};c.forEach((i=>{const s=t.getBaseTarget(i);void 0!==s&&(e[i]=s)})),h.push({animation:e})}let p=Boolean(h.length);return s&&!1===a.initial&&!t.manuallyAnimateOnMount&&(p=!1),s=!1,p?e(h):Promise.resolve()}return{animateChanges:r,setActive:function(e,s,n){var o;if(i[e].isActive===s)return Promise.resolve();null===(o=t.variantChildren)||void 0===o||o.forEach((t=>{var i;return null===(i=t.animationState)||void 0===i?void 0:i.setActive(e,s)})),i[e].isActive=s;const a=r(n,e);for(const t in i)i[t].protectedKeys={};return a},setAnimateFunction:function(i){e=i(t)},getState:()=>i}}function $m(t,e){return"string"==typeof e?e!==t:!!Array.isArray(e)&&!Pf(e,t)}function Gm(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let qm=0;const Xm={animation:{Feature:class extends rf{constructor(t){super(t),t.animationState||(t.animationState=Wm(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),wd(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends rf{constructor(){super(...arguments),this.id=qm++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e,custom:i}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const n=this.node.animationState.setActive("exit",!t,{custom:null!=i?i:this.node.getProps().custom});e&&!t&&n.then((()=>e(this.id)))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}}},Km=(t,e)=>Math.abs(t-e);class Ym{constructor(t,e,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=Jm(this.lastMoveEventInfo,this.history),e=null!==this.startEvent,i=function(t,e){const i=Km(t.x,e.x),s=Km(t.y,e.y);return Math.sqrt(i**2+s**2)}(t.offset,{x:0,y:0})>=3;if(!e&&!i)return;const{point:s}=t,{timestamp:n}=of;this.history.push({...s,timestamp:n});const{onStart:r,onMove:o}=this.handlers;e||(r&&r(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,t)},this.handlePointerMove=(t,e)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=Zm(e,this.transformPagePoint),pf.update(this.updatePoint,!0)},this.handlePointerUp=(t,e)=>{if(this.end(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const{onEnd:i,onSessionEnd:s}=this.handlers,n=Jm("pointercancel"===t.type?this.lastMoveEventInfo:Zm(e,this.transformPagePoint),this.history);this.startEvent&&i&&i(t,n),s&&s(t,n)},!qp(t))return;this.handlers=e,this.transformPagePoint=i;const s=Zm(Xp(t),this.transformPagePoint),{point:n}=s,{timestamp:r}=of;this.history=[{...n,timestamp:r}];const{onSessionStart:o}=e;o&&o(t,Jm(s,this.history)),this.removeListeners=Qp(Yp(window,"pointermove",this.handlePointerMove),Yp(window,"pointerup",this.handlePointerUp),Yp(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ff(this.updatePoint)}}function Zm(t,e){return e?{point:e(t.point)}:t}function Qm(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Jm({point:t},e){return{point:t,delta:Qm(t,e_(e)),offset:Qm(t,t_(e)),velocity:i_(e,.1)}}function t_(t){return t[0]}function e_(t){return t[t.length-1]}function i_(t,e){if(t.length<2)return{x:0,y:0};let i=t.length-1,s=null;const n=e_(t);for(;i>=0&&(s=t[i],!(n.timestamp-s.timestamp>If(e)));)i--;if(!s)return{x:0,y:0};const r=Df(n.timestamp-s.timestamp);if(0===r)return{x:0,y:0};const o={x:(n.x-s.x)/r,y:(n.y-s.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function s_(t){return t.max-t.min}function n_(t,e=0,i=.01){return Math.abs(t-e)<=i}function r_(t,e,i,s=.5){t.origin=s,t.originPoint=pg(e.min,e.max,t.origin),t.scale=s_(i)/s_(e),(n_(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=pg(i.min,i.max,t.origin)-t.originPoint,(n_(t.translate)||isNaN(t.translate))&&(t.translate=0)}function o_(t,e,i,s){r_(t.x,e.x,i.x,s?s.originX:void 0),r_(t.y,e.y,i.y,s?s.originY:void 0)}function a_(t,e,i){t.min=i.min+e.min,t.max=t.min+s_(e)}function l_(t,e,i){t.min=e.min-i.min,t.max=t.min+s_(e)}function h_(t,e,i){l_(t.x,e.x,i.x),l_(t.y,e.y,i.y)}function c_(t,e,i){return{min:void 0!==e?t.min+e:void 0,max:void 0!==i?t.max+i-(t.max-t.min):void 0}}function u_(t,e){let i=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([i,s]=[s,i]),{min:i,max:s}}const d_=.35;function p_(t,e,i){return{min:f_(t,e),max:f_(t,i)}}function f_(t,e){return"number"==typeof t?t:t[e]||0}const g_=()=>({x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}),m_=()=>({x:{min:0,max:0},y:{min:0,max:0}});function __(t){return[t("x"),t("y")]}function v_({top:t,left:e,right:i,bottom:s}){return{x:{min:e,max:i},y:{min:t,max:s}}}function y_(t){return void 0===t||1===t}function x_({scale:t,scaleX:e,scaleY:i}){return!y_(t)||!y_(e)||!y_(i)}function w_(t){return x_(t)||b_(t)||t.z||t.rotate||t.rotateX||t.rotateY}function b_(t){return C_(t.x)||C_(t.y)}function C_(t){return t&&"0%"!==t}function S_(t,e,i){return i+e*(t-i)}function E_(t,e,i,s,n){return void 0!==n&&(t=S_(t,n,s)),S_(t,i,s)+e}function P_(t,e=0,i=1,s,n){t.min=E_(t.min,e,i,s,n),t.max=E_(t.max,e,i,s,n)}function T_(t,{x:e,y:i}){P_(t.x,e.translate,e.scale,e.originPoint),P_(t.y,i.translate,i.scale,i.originPoint)}function A_(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function k_(t,e){t.min=t.min+e,t.max=t.max+e}function R_(t,e,[i,s,n]){const r=void 0!==e[n]?e[n]:.5,o=pg(t.min,t.max,r);P_(t,e[i],e[s],o,e.scale)}const I_=["x","scaleX","originX"],D_=["y","scaleY","originY"];function M_(t,e){R_(t.x,e,I_),R_(t.y,e,D_)}function F_(t,e){return v_(function(t,e){if(!e)return t;const i=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:i.y,left:i.x,bottom:s.y,right:s.x}}(t.getBoundingClientRect(),e))}const L_=new WeakMap;class B_{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=m_(),this.visualElement=t}start(t,{snapToCursor:e=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&!1===i.isPresent)return;this.panSession=new Ym(t,{onSessionStart:t=>{this.stopAnimation(),e&&this.snapToCursor(Xp(t,"page").point)},onStart:(t,e)=>{const{drag:i,dragPropagation:s,onDragStart:n}=this.getProps();if(i&&!s&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=sf(i),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),__((t=>{let e=this.getAxisMotionValue(t).get()||0;if(op.test(e)){const{projection:i}=this.visualElement;if(i&&i.layout){const s=i.layout.layoutBox[t];if(s){e=s_(s)*(parseFloat(e)/100)}}}this.originPoint[t]=e})),n&&pf.update((()=>n(t,e)),!1,!0);const{animationState:r}=this.visualElement;r&&r.setActive("whileDrag",!0)},onMove:(t,e)=>{const{dragPropagation:i,dragDirectionLock:s,onDirectionLock:n,onDrag:r}=this.getProps();if(!i&&!this.openGlobalLock)return;const{offset:o}=e;if(s&&null===this.currentDirection)return this.currentDirection=function(t,e=10){let i=null;Math.abs(t.y)>e?i="y":Math.abs(t.x)>e&&(i="x");return i}(o),void(null!==this.currentDirection&&n&&n(this.currentDirection));this.updateAxis("x",e.point,o),this.updateAxis("y",e.point,o),this.visualElement.render(),r&&r(t,e)},onSessionEnd:(t,e)=>this.stop(t,e)},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,e){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:s}=e;this.startAnimation(s);const{onDragEnd:n}=this.getProps();n&&pf.update((()=>n(t,e)))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,i){const{drag:s}=this.getProps();if(!i||!O_(t,s,this.currentDirection))return;const n=this.getAxisMotionValue(t);let r=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(r=function(t,{min:e,max:i},s){return void 0!==e&&t<e?t=s?pg(e,t,s.min):Math.max(t,e):void 0!==i&&t>i&&(t=s?pg(i,t,s.max):Math.min(t,i)),t}(r,this.constraints[t],this.elastic[t])),n.set(r)}resolveConstraints(){const{dragConstraints:t,dragElastic:e}=this.getProps(),{layout:i}=this.visualElement.projection||{},s=this.constraints;t&&yd(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!i)&&function(t,{top:e,left:i,bottom:s,right:n}){return{x:c_(t.x,i,n),y:c_(t.y,e,s)}}(i.layoutBox,t),this.elastic=function(t=d_){return!1===t?t=0:!0===t&&(t=d_),{x:p_(t,"left","right"),y:p_(t,"top","bottom")}}(e),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&__((t=>{this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,e){const i={};return void 0!==e.min&&(i.min=e.min-t.min),void 0!==e.max&&(i.max=e.max-t.min),i}(i.layoutBox[t],this.constraints[t]))}))}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!yd(t))return!1;const i=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const n=function(t,e,i){const s=F_(t,i),{scroll:n}=e;return n&&(k_(s.x,n.offset.x),k_(s.y,n.offset.y)),s}(i,s.root,this.visualElement.getTransformPagePoint());let r=function(t,e){return{x:u_(t.x,e.x),y:u_(t.y,e.y)}}(s.layout.layoutBox,n);if(e){const t=e(function({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}(r));this.hasMutatedConstraints=!!t,t&&(r=v_(t))}return r}startAnimation(t){const{drag:e,dragMomentum:i,dragElastic:s,dragTransition:n,dragSnapToOrigin:r,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},l=__((o=>{if(!O_(o,e,this.currentDirection))return;let l=a&&a[o]||{};r&&(l={min:0,max:0});const h=s?200:1e6,c=s?40:1e7,u={type:"inertia",velocity:i?t[o]:0,bounceStiffness:h,bounceDamping:c,timeConstant:750,restDelta:1,restSpeed:10,...n,...l};return this.startAxisValueAnimation(o,u)}));return Promise.all(l).then(o)}startAxisValueAnimation(t,e){const i=this.getAxisMotionValue(t);return i.start(Cm(t,i,0,e))}stopAnimation(){__((t=>this.getAxisMotionValue(t).stop()))}getAxisMotionValue(t){const e="_drag"+t.toUpperCase(),i=this.visualElement.getProps(),s=i[e];return s||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){__((e=>{const{drag:i}=this.getProps();if(!O_(e,i,this.currentDirection))return;const{projection:s}=this.visualElement,n=this.getAxisMotionValue(e);if(s&&s.layout){const{min:i,max:r}=s.layout.layoutBox[e];n.set(t[e]-pg(i,r,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:i}=this.visualElement;if(!yd(e)||!i||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};__((t=>{const e=this.getAxisMotionValue(t);if(e){const i=e.get();s[t]=function(t,e){let i=.5;const s=s_(t),n=s_(e);return n>s?i=Mg(e.min,e.max-s,t.min):s>n&&(i=Mg(t.min,t.max-n,e.min)),Kd(0,1,i)}({min:i,max:i},this.constraints[t])}}));const{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),__((e=>{if(!O_(e,t,null))return;const i=this.getAxisMotionValue(e),{min:n,max:r}=this.constraints[e];i.set(pg(n,r,s[e]))}))}addListeners(){if(!this.visualElement.current)return;L_.set(this.visualElement,this);const t=Yp(this.visualElement.current,"pointerdown",(t=>{const{drag:e,dragListener:i=!0}=this.getProps();e&&i&&this.start(t)})),e=()=>{const{dragConstraints:t}=this.getProps();yd(t)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",e);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),e();const n=Gp(window,"resize",(()=>this.scalePositionWithinConstraints())),r=i.addEventListener("didUpdate",(({delta:t,hasLayoutChanged:e})=>{this.isDragging&&e&&(__((e=>{const i=this.getAxisMotionValue(e);i&&(this.originPoint[e]+=t[e].translate,i.set(i.get()+t[e].translate))})),this.visualElement.render())}));return()=>{n(),t(),s(),r&&r()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:i=!1,dragPropagation:s=!1,dragConstraints:n=!1,dragElastic:r=d_,dragMomentum:o=!0}=t;return{...t,drag:e,dragDirectionLock:i,dragPropagation:s,dragConstraints:n,dragElastic:r,dragMomentum:o}}}function O_(t,e,i){return!(!0!==e&&e!==t||null!==i&&i!==t)}const z_=t=>(e,i)=>{t&&pf.update((()=>t(e,i)))};const N_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function U_(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const V_={correct:(t,e)=>{if(!e.target)return t;if("string"==typeof t){if(!ap.test(t))return t;t=parseFloat(t)}return`${U_(t,e.target.x)}% ${U_(t,e.target.y)}%`}},H_={correct:(t,{treeScale:e,projectionDelta:i})=>{const s=t,n=Tg.parse(t);if(n.length>5)return s;const r=Tg.createTransformer(t),o="number"!=typeof n[0]?1:0,a=i.x.scale*e.x,l=i.y.scale*e.y;n[0+o]/=a,n[1+o]/=l;const h=pg(a,l,.5);return"number"==typeof n[2+o]&&(n[2+o]/=h),"number"==typeof n[3+o]&&(n[3+o]/=h),r(n)}};class j_ extends U.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:i,layoutId:s}=this.props,{projection:n}=t;var r;r=$_,Object.assign(zd,r),n&&(e.group&&e.group.add(n),i&&i.register&&s&&i.register(n),n.root.didUpdate(),n.addEventListener("animationComplete",(()=>{this.safeToRemove()})),n.setOptions({...n.options,onExitComplete:()=>this.safeToRemove()})),N_.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:i,drag:s,isPresent:n}=this.props,r=i.projection;return r?(r.isPresent=n,s||t.layoutDependency!==e||void 0===e?r.willUpdate():this.safeToRemove(),t.isPresent!==n&&(n?r.promote():r.relegate()||pf.postRender((()=>{const t=r.getStack();t&&t.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask((()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:i}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(s),i&&i.deregister&&i.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function W_(t){const[e,i]=function(){const t=N.useContext(gd);if(null===t)return[!0,null];const{isPresent:e,onExitComplete:i,register:s}=t,n=N.useId();return N.useEffect((()=>s(n)),[]),!e&&i?[!1,()=>i&&i(n)]:[!0]}(),s=N.useContext(Rd);return U.createElement(j_,{...t,layoutGroup:s,switchLayoutGroup:N.useContext(Id),isPresent:e,safeToRemove:i})}const $_={borderRadius:{...V_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:V_,borderTopRightRadius:V_,borderBottomLeftRadius:V_,borderBottomRightRadius:V_,boxShadow:H_},G_=["TopLeft","TopRight","BottomLeft","BottomRight"],q_=G_.length,X_=t=>"string"==typeof t?parseFloat(t):t,K_=t=>"number"==typeof t||ap.test(t);function Y_(t,e){return void 0!==t[e]?t[e]:t.borderRadius}const Z_=J_(0,.5,Jf),Q_=J_(.5,.95,_f);function J_(t,e,i){return s=>s<t?0:s>e?1:i(Mg(t,e,s))}function tv(t,e){t.min=e.min,t.max=e.max}function ev(t,e){tv(t.x,e.x),tv(t.y,e.y)}function iv(t,e,i,s,n){return t=S_(t-=e,1/i,s),void 0!==n&&(t=S_(t,1/n,s)),t}function sv(t,e,[i,s,n],r,o){!function(t,e=0,i=1,s=.5,n,r=t,o=t){op.test(e)&&(e=parseFloat(e),e=pg(o.min,o.max,e/100)-o.min);if("number"!=typeof e)return;let a=pg(r.min,r.max,s);t===r&&(a-=e),t.min=iv(t.min,e,i,a,n),t.max=iv(t.max,e,i,a,n)}(t,e[i],e[s],e[n],e.scale,r,o)}const nv=["x","scaleX","originX"],rv=["y","scaleY","originY"];function ov(t,e,i,s){sv(t.x,e,nv,i?i.x:void 0,s?s.x:void 0),sv(t.y,e,rv,i?i.y:void 0,s?s.y:void 0)}function av(t){return 0===t.translate&&1===t.scale}function lv(t){return av(t.x)&&av(t.y)}function hv(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function cv(t){return s_(t.x)/s_(t.y)}class uv{constructor(){this.members=[]}add(t){Em(this.members,t),t.scheduleRender()}remove(t){if(Pm(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(t){const e=this.members.findIndex((e=>t===e));if(0===e)return!1;let i;for(let s=e;s>=0;s--){const t=this.members[s];if(!1!==t.isPresent){i=t;break}}return!!i&&(this.promote(i),!0)}promote(t,e){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,e&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;!1===s&&i.hide()}}exitAnimationComplete(){this.members.forEach((t=>{const{options:e,resumingFrom:i}=t;e.onExitComplete&&e.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()}))}scheduleRender(){this.members.forEach((t=>{t.instance&&t.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function dv(t,e,i){let s="";const n=t.x.translate/e.x,r=t.y.translate/e.y;if((n||r)&&(s=`translate3d(${n}px, ${r}px, 0) `),1===e.x&&1===e.y||(s+=`scale(${1/e.x}, ${1/e.y}) `),i){const{rotate:t,rotateX:e,rotateY:n}=i;t&&(s+=`rotate(${t}deg) `),e&&(s+=`rotateX(${e}deg) `),n&&(s+=`rotateY(${n}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return 1===o&&1===a||(s+=`scale(${o}, ${a})`),s||"none"}const pv=(t,e)=>t.depth-e.depth;class fv{constructor(){this.children=[],this.isDirty=!1}add(t){Em(this.children,t),this.isDirty=!0}remove(t){Pm(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(pv),this.isDirty=!1,this.children.forEach(t)}}const gv=["","X","Y","Z"];let mv=0;const _v={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function vv({attachResizeListener:t,defaultParent:e,measureScroll:i,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(t={},i=(null==e?void 0:e())){this.id=mv++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{var t;_v.totalNodes=_v.resolvedTargetDeltas=_v.recalculatedProjection=0,this.nodes.forEach(wv),this.nodes.forEach(Av),this.nodes.forEach(kv),this.nodes.forEach(bv),t=_v,window.MotionDebug&&window.MotionDebug.record(t)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=t,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new fv)}addEventListener(t,e){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new Tm),this.eventHandlers.get(t).add(e)}notifyListeners(t,...e){const i=this.eventHandlers.get(t);i&&i.notify(...e)}hasListeners(t){return this.eventHandlers.has(t)}mount(e,i=this.root.hasTreeAnimated){if(this.instance)return;var s;this.isSVG=(s=e)instanceof SVGElement&&"svg"!==s.tagName,this.instance=e;const{layoutId:n,layout:r,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(r||n)&&(this.isLayoutDirty=!0),t){let i;const s=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,i&&i(),i=function(t,e){const i=performance.now(),s=({timestamp:n})=>{const r=n-i;r>=e&&(ff(s),t(r-e))};return pf.read(s,!0),()=>ff(s)}(s,250),N_.hasAnimatedSinceResize&&(N_.hasAnimatedSinceResize=!1,this.nodes.forEach(Tv))}))}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&o&&(n||r)&&this.addEventListener("didUpdate",(({delta:t,hasLayoutChanged:e,hasRelativeTargetChanged:i,layout:s})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const n=this.options.transition||o.getDefaultTransition()||Lv,{onLayoutAnimationStart:r,onLayoutAnimationComplete:a}=o.getProps(),l=!this.targetLayout||!hv(this.targetLayout,s)||i,h=!e&&i;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||h||e&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,h);const e={...bm(n,"layout"),onPlay:r,onComplete:a};(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else e||Tv(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=s}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const t=this.getStack();t&&t.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ff(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Rv),this.animationId++)}getTransformTemplate(){const{visualElement:t}=this.options;return t&&t.getProps().transformTemplate}willUpdate(t=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let n=0;n<this.path.length;n++){const t=this.path[n];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}const{layoutId:e,layout:i}=this.options;if(void 0===e&&!i)return;const s=this.getTransformTemplate();this.prevTransformTemplateValue=s?s(this.latestValues,""):void 0,this.updateSnapshot(),t&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Sv);this.isUpdating||this.nodes.forEach(Ev),this.isUpdating=!1,this.nodes.forEach(Pv),this.nodes.forEach(yv),this.nodes.forEach(xv),this.clearAllSnapshots();const t=performance.now();of.delta=Kd(0,1e3/60,t-of.timestamp),of.timestamp=t,of.isProcessing=!0,cf.update.process(of),cf.preRender.process(of),cf.render.process(of),of.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask((()=>this.update())))}clearAllSnapshots(){this.nodes.forEach(Cv),this.sharedNodes.forEach(Iv)}scheduleUpdateProjection(){pf.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){pf.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let i=0;i<this.path.length;i++){this.path[i].updateScroll()}const t=this.layout;this.layout=this.measure(!1),this.layoutCorrected=m_(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:e}=this.options;e&&e.notify("LayoutMeasure",this.layout.layoutBox,t?t.layoutBox:void 0)}updateScroll(t="measure"){let e=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===t&&(e=!1),e&&(this.scroll={animationId:this.root.animationId,phase:t,isRoot:s(this.instance),offset:i(this.instance)})}resetTransform(){if(!n)return;const t=this.isLayoutDirty||this.shouldResetTransform,e=this.projectionDelta&&!lv(this.projectionDelta),i=this.getTransformTemplate(),s=i?i(this.latestValues,""):void 0,r=s!==this.prevTransformTemplateValue;t&&(e||w_(this.latestValues)||r)&&(n(this.instance,s),this.shouldResetTransform=!1,this.scheduleRender())}measure(t=!0){const e=this.measurePageBox();let i=this.removeElementScroll(e);var s;return t&&(i=this.removeTransform(i)),Bv((s=i).x),Bv(s.y),{animationId:this.root.animationId,measuredBox:e,layoutBox:i,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:t}=this.options;if(!t)return m_();const e=t.measureViewportBox(),{scroll:i}=this.root;return i&&(k_(e.x,i.offset.x),k_(e.y,i.offset.y)),e}removeElementScroll(t){const e=m_();ev(e,t);for(let i=0;i<this.path.length;i++){const s=this.path[i],{scroll:n,options:r}=s;if(s!==this.root&&n&&r.layoutScroll){if(n.isRoot){ev(e,t);const{scroll:i}=this.root;i&&(k_(e.x,-i.offset.x),k_(e.y,-i.offset.y))}k_(e.x,n.offset.x),k_(e.y,n.offset.y)}}return e}applyTransform(t,e=!1){const i=m_();ev(i,t);for(let s=0;s<this.path.length;s++){const t=this.path[s];!e&&t.options.layoutScroll&&t.scroll&&t!==t.root&&M_(i,{x:-t.scroll.offset.x,y:-t.scroll.offset.y}),w_(t.latestValues)&&M_(i,t.latestValues)}return w_(this.latestValues)&&M_(i,this.latestValues),i}removeTransform(t){const e=m_();ev(e,t);for(let i=0;i<this.path.length;i++){const t=this.path[i];if(!t.instance)continue;if(!w_(t.latestValues))continue;x_(t.latestValues)&&t.updateSnapshot();const s=m_();ev(s,t.measurePageBox()),ov(e,t.latestValues,t.snapshot?t.snapshot.layoutBox:void 0,s)}return w_(this.latestValues)&&ov(e,this.latestValues),e}setTargetDelta(t){this.targetDelta=t,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(t){this.options={...this.options,...t,crossfade:void 0===t.crossfade||t.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==of.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(t=!1){var e;const i=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=i.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=i.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=i.isSharedProjectionDirty);const s=Boolean(this.resumingFrom)||this!==i;if(!(t||s&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:n,layoutId:r}=this.options;if(this.layout&&(n||r)){if(this.resolvedRelativeTargetAt=of.timestamp,!this.targetDelta&&!this.relativeTarget){const t=this.getClosestProjectingParent();t&&t.layout&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=m_(),this.relativeTargetOrigin=m_(),h_(this.relativeTargetOrigin,this.layout.layoutBox,t.layout.layoutBox),ev(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,a,l;if(this.target||(this.target=m_(),this.targetWithTransforms=m_()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,a=this.relativeTarget,l=this.relativeParent.target,a_(o.x,a.x,l.x),a_(o.y,a.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):ev(this.target,this.layout.layoutBox),T_(this.target,this.targetDelta)):ev(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const t=this.getClosestProjectingParent();t&&Boolean(t.resumingFrom)===Boolean(this.resumingFrom)&&!t.options.layoutScroll&&t.target&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=m_(),this.relativeTargetOrigin=m_(),h_(this.relativeTargetOrigin,this.target,t.target),ev(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}_v.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!x_(this.parent.latestValues)&&!b_(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var t;const e=this.getLead(),i=Boolean(this.resumingFrom)||this!==e;let s=!0;if((this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty))&&(s=!1),i&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(s=!1),this.resolvedRelativeTargetAt===of.timestamp&&(s=!1),s)return;const{layout:n,layoutId:r}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!n&&!r)return;ev(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;!function(t,e,i,s=!1){const n=i.length;if(!n)return;let r,o;e.x=e.y=1;for(let a=0;a<n;a++){r=i[a],o=r.projectionDelta;const n=r.instance;n&&n.style&&"contents"===n.style.display||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&M_(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,T_(t,o)),s&&w_(r.latestValues)&&M_(t,r.latestValues))}e.x=A_(e.x),e.y=A_(e.y)}(this.layoutCorrected,this.treeScale,this.path,i),!e.layout||e.target||1===this.treeScale.x&&1===this.treeScale.y||(e.target=e.layout.layoutBox);const{target:l}=e;if(!l)return void(this.projectionTransform&&(this.projectionDelta=g_(),this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta=g_(),this.projectionDeltaWithTransform=g_());const h=this.projectionTransform;o_(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.projectionTransform=dv(this.projectionDelta,this.treeScale),this.projectionTransform===h&&this.treeScale.x===o&&this.treeScale.y===a||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),_v.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(t=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),t){const t=this.getStack();t&&t.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(t,e=!1){const i=this.snapshot,s=i?i.latestValues:{},n={...this.latestValues},r=g_();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!e;const o=m_(),a=(i?i.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),h=!l||l.members.length<=1,c=Boolean(a&&!h&&!0===this.options.crossfade&&!this.path.some(Fv));let u;this.animationProgress=0,this.mixTargetDelta=e=>{const i=e/1e3;var l,d,p,f;Dv(r.x,t.x,i),Dv(r.y,t.y,i),this.setTargetDelta(r),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(h_(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),l=this.relativeTarget,d=this.relativeTargetOrigin,p=o,f=i,Mv(l.x,d.x,p.x,f),Mv(l.y,d.y,p.y,f),u&&hv(this.relativeTarget,u)&&(this.isProjectionDirty=!1),u||(u=m_()),ev(u,this.relativeTarget)),a&&(this.animationValues=n,function(t,e,i,s,n,r){n?(t.opacity=pg(0,void 0!==i.opacity?i.opacity:1,Z_(s)),t.opacityExit=pg(void 0!==e.opacity?e.opacity:1,0,Q_(s))):r&&(t.opacity=pg(void 0!==e.opacity?e.opacity:1,void 0!==i.opacity?i.opacity:1,s));for(let o=0;o<q_;o++){const n=`border${G_[o]}Radius`;let r=Y_(e,n),a=Y_(i,n);void 0===r&&void 0===a||(r||(r=0),a||(a=0),0===r||0===a||K_(r)===K_(a)?(t[n]=Math.max(pg(X_(r),X_(a),s),0),(op.test(a)||op.test(r))&&(t[n]+="%")):t[n]=a)}(e.rotate||i.rotate)&&(t.rotate=pg(e.rotate||0,i.rotate||0,s))}(n,s,this.latestValues,i,c,h)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=i},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(t){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ff(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pf.update((()=>{N_.hasAnimatedSinceResize=!0,this.currentAnimation=function(t,e,i){const s=Hd(t)?t:km(t);return s.start(Cm("",s,e,i)),s.animation}(0,1e3,{...t,onUpdate:e=>{this.mixTargetDelta(e),t.onUpdate&&t.onUpdate(e)},onComplete:()=>{t.onComplete&&t.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const t=this.getStack();t&&t.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const t=this.getLead();let{targetWithTransforms:e,target:i,layout:s,latestValues:n}=t;if(e&&i&&s){if(this!==t&&this.layout&&s&&Ov(this.options.animationType,this.layout.layoutBox,s.layoutBox)){i=this.target||m_();const e=s_(this.layout.layoutBox.x);i.x.min=t.target.x.min,i.x.max=i.x.min+e;const s=s_(this.layout.layoutBox.y);i.y.min=t.target.y.min,i.y.max=i.y.min+s}ev(e,i),M_(e,n),o_(this.projectionDeltaWithTransform,this.layoutCorrected,e,n)}}registerSharedNode(t,e){this.sharedNodes.has(t)||this.sharedNodes.set(t,new uv);this.sharedNodes.get(t).add(e);const i=e.options.initialPromotionConfig;e.promote({transition:i?i.transition:void 0,preserveFollowOpacity:i&&i.shouldPreserveFollowOpacity?i.shouldPreserveFollowOpacity(e):void 0})}isLead(){const t=this.getStack();return!t||t.lead===this}getLead(){var t;const{layoutId:e}=this.options;return e&&(null===(t=this.getStack())||void 0===t?void 0:t.lead)||this}getPrevLead(){var t;const{layoutId:e}=this.options;return e?null===(t=this.getStack())||void 0===t?void 0:t.prevLead:void 0}getStack(){const{layoutId:t}=this.options;if(t)return this.root.sharedNodes.get(t)}promote({needsReset:t,transition:e,preserveFollowOpacity:i}={}){const s=this.getStack();s&&s.promote(this,i),t&&(this.projectionDelta=void 0,this.needsReset=!0),e&&this.setOptions({transition:e})}relegate(){const t=this.getStack();return!!t&&t.relegate(this)}resetRotation(){const{visualElement:t}=this.options;if(!t)return;let e=!1;const{latestValues:i}=t;if((i.rotate||i.rotateX||i.rotateY||i.rotateZ)&&(e=!0),!e)return;const s={};for(let n=0;n<gv.length;n++){const e="rotate"+gv[n];i[e]&&(s[e]=i[e],t.setStaticValue(e,0))}t.render();for(const n in s)t.setStaticValue(n,s[n]);t.scheduleRender()}getProjectionStyles(t={}){var e,i;const s={};if(!this.instance||this.isSVG)return s;if(!this.isVisible)return{visibility:"hidden"};s.visibility="";const n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,s.opacity="",s.pointerEvents=Vp(t.pointerEvents)||"",s.transform=n?n(this.latestValues,""):"none",s;const r=this.getLead();if(!this.projectionDelta||!this.layout||!r.target){const e={};return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Vp(t.pointerEvents)||""),this.hasProjected&&!w_(this.latestValues)&&(e.transform=n?n({},""):"none",this.hasProjected=!1),e}const o=r.animationValues||r.latestValues;this.applyTransformsToTarget(),s.transform=dv(this.projectionDeltaWithTransform,this.treeScale,o),n&&(s.transform=n(o,s.transform));const{x:a,y:l}=this.projectionDelta;s.transformOrigin=`${100*a.origin}% ${100*l.origin}% 0`,r.animationValues?s.opacity=r===this?null!==(i=null!==(e=o.opacity)&&void 0!==e?e:this.latestValues.opacity)&&void 0!==i?i:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:s.opacity=r===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const h in zd){if(void 0===o[h])continue;const{correct:t,applyTo:e}=zd[h],i="none"===s.transform?o[h]:t(o[h],r);if(e){const t=e.length;for(let n=0;n<t;n++)s[e[n]]=i}else s[h]=i}return this.options.layoutId&&(s.pointerEvents=r===this?Vp(t.pointerEvents)||"":"none"),s}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((t=>{var e;return null===(e=t.currentAnimation)||void 0===e?void 0:e.stop()})),this.root.nodes.forEach(Sv),this.root.sharedNodes.clear()}}}function yv(t){t.updateLayout()}function xv(t){var e;const i=(null===(e=t.resumeFrom)||void 0===e?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&i&&t.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:s}=t.layout,{animationType:n}=t.options,r=i.source!==t.layout.source;"size"===n?__((t=>{const s=r?i.measuredBox[t]:i.layoutBox[t],n=s_(s);s.min=e[t].min,s.max=s.min+n})):Ov(n,i.layoutBox,e)&&__((s=>{const n=r?i.measuredBox[s]:i.layoutBox[s],o=s_(e[s]);n.max=n.min+o,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[s].max=t.relativeTarget[s].min+o)}));const o=g_();o_(o,e,i.layoutBox);const a=g_();r?o_(a,t.applyTransform(s,!0),i.measuredBox):o_(a,e,i.layoutBox);const l=!lv(o);let h=!1;if(!t.resumeFrom){const s=t.getClosestProjectingParent();if(s&&!s.resumeFrom){const{snapshot:n,layout:r}=s;if(n&&r){const o=m_();h_(o,i.layoutBox,n.layoutBox);const a=m_();h_(a,e,r.layoutBox),hv(o,a)||(h=!0),s.options.layoutRoot&&(t.relativeTarget=a,t.relativeTargetOrigin=o,t.relativeParent=s)}}}t.notifyListeners("didUpdate",{layout:e,snapshot:i,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:e}=t.options;e&&e()}t.options.transition=void 0}function wv(t){_v.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=Boolean(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function bv(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Cv(t){t.clearSnapshot()}function Sv(t){t.clearMeasurements()}function Ev(t){t.isLayoutDirty=!1}function Pv(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Tv(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Av(t){t.resolveTargetDelta()}function kv(t){t.calcProjection()}function Rv(t){t.resetRotation()}function Iv(t){t.removeLeadSnapshot()}function Dv(t,e,i){t.translate=pg(e.translate,0,i),t.scale=pg(e.scale,1,i),t.origin=e.origin,t.originPoint=e.originPoint}function Mv(t,e,i,s){t.min=pg(e.min,i.min,s),t.max=pg(e.max,i.max,s)}function Fv(t){return t.animationValues&&void 0!==t.animationValues.opacityExit}const Lv={duration:.45,ease:[.4,0,.1,1]};function Bv(t){t.min=Math.round(t.min),t.max=Math.round(t.max)}function Ov(t,e,i){return"position"===t||"preserve-aspect"===t&&!n_(cv(e),cv(i),.2)}const zv=vv({attachResizeListener:(t,e)=>Gp(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Nv={current:void 0},Uv=vv({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Nv.current){const t=new zv({});t.mount(window),t.setOptions({layoutScroll:!0}),Nv.current=t}return Nv.current},resetTransform:(t,e)=>{t.style.transform=void 0!==e?e:"none"},checkIsScrollRoot:t=>Boolean("fixed"===window.getComputedStyle(t).position)}),Vv={pan:{Feature:class extends rf{constructor(){super(...arguments),this.removePointerDownListener=_f}onPointerDown(t){this.session=new Ym(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:i,onPanEnd:s}=this.node.getProps();return{onSessionStart:z_(t),onStart:z_(e),onMove:i,onEnd:(t,e)=>{delete this.session,s&&pf.update((()=>s(t,e)))}}}mount(){this.removePointerDownListener=Yp(this.node.current,"pointerdown",(t=>this.onPointerDown(t)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends rf{constructor(t){super(t),this.removeGroupControls=_f,this.removeListeners=_f,this.controls=new B_(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||_f}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:Uv,MeasureLayout:W_}},Hv=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function jv(t,e,i=1){const[s,n]=function(t){const e=Hv.exec(t);if(!e)return[,];const[,i,s]=e;return[i,s]}(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);return r?r.trim():qd(n)?jv(n,e,i+1):n}const Wv=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),$v=t=>Wv.has(t),Gv=t=>t===Yd||t===ap,qv=(t,e)=>parseFloat(t.split(", ")[e]),Xv=(t,e)=>(i,{transform:s})=>{if("none"===s||!s)return 0;const n=s.match(/^matrix3d\((.+)\)$/);if(n)return qv(n[1],e);{const e=s.match(/^matrix\((.+)\)$/);return e?qv(e[1],t):0}},Kv=new Set(["x","y","z"]),Yv=Nd.filter((t=>!Kv.has(t)));const Zv={width:({x:t},{paddingLeft:e="0",paddingRight:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),height:({y:t},{paddingTop:e="0",paddingBottom:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Xv(4,13),y:Xv(5,14)},Qv=(t,e,i={},s={})=>{e={...e},s={...s};const n=Object.keys(e).filter($v);let r=[],o=!1;const a=[];if(n.forEach((n=>{const l=t.getValue(n);if(!t.hasValue(n))return;let h=i[n],c=Dm(h);const u=e[n];let d;if(zp(u)){const t=u.length,e=null===u[0]?1:0;h=u[e],c=Dm(h);for(let i=e;i<t&&null!==u[i];i++)d?Rf(Dm(u[i])===d):d=Dm(u[i])}else d=Dm(u);if(c!==d)if(Gv(c)&&Gv(d)){const t=l.get();"string"==typeof t&&l.set(parseFloat(t)),"string"==typeof u?e[n]=parseFloat(u):Array.isArray(u)&&d===ap&&(e[n]=u.map(parseFloat))}else(null==c?void 0:c.transform)&&(null==d?void 0:d.transform)&&(0===h||0===u)?0===h?l.set(d.transform(h)):e[n]=c.transform(u):(o||(r=function(t){const e=[];return Yv.forEach((i=>{const s=t.getValue(i);void 0!==s&&(e.push([i,s.get()]),s.set(i.startsWith("scale")?1:0))})),e.length&&t.render(),e}(t),o=!0),a.push(n),s[n]=void 0!==s[n]?s[n]:e[n],l.jump(u))})),a.length){const i=a.indexOf("height")>=0?window.pageYOffset:null,n=((t,e,i)=>{const s=e.measureViewportBox(),n=e.current,r=getComputedStyle(n),{display:o}=r,a={};"none"===o&&e.setStaticValue("display",t.display||"block"),i.forEach((t=>{a[t]=Zv[t](s,r)})),e.render();const l=e.measureViewportBox();return i.forEach((i=>{const s=e.getValue(i);s&&s.jump(a[i]),t[i]=Zv[i](l,r)})),t})(e,t,a);return r.length&&r.forEach((([e,i])=>{t.getValue(e).set(i)})),t.render(),md&&null!==i&&window.scrollTo({top:i}),{target:n,transitionEnd:s}}return{target:e,transitionEnd:s}};function Jv(t,e,i,s){return(t=>Object.keys(t).some($v))(e)?Qv(t,e,i,s):{target:e,transitionEnd:s}}const ty=(t,e,i,s)=>{const n=function(t,{...e},i){const s=t.current;if(!(s instanceof Element))return{target:e,transitionEnd:i};i&&(i={...i}),t.values.forEach((t=>{const e=t.get();if(!qd(e))return;const i=jv(e,s);i&&t.set(i)}));for(const n in e){const t=e[n];if(!qd(t))continue;const r=jv(t,s);r&&(e[n]=r,i||(i={}),void 0===i[n]&&(i[n]=t))}return{target:e,transitionEnd:i}}(t,e,s);return Jv(t,e=n.target,i,s=n.transitionEnd)},ey={current:null},iy={current:!1};const sy=new WeakMap,ny=Object.keys(kd),ry=ny.length,oy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],ay=Cd.length;class ly{constructor({parent:t,props:e,presenceContext:i,reducedMotionConfig:s,visualState:n},r={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>pf.render(this.render,!1,!0);const{latestValues:o,renderState:a}=n;this.latestValues=o,this.baseTarget={...o},this.initialValues=e.initial?{...o}:{},this.renderState=a,this.parent=t,this.props=e,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=r,this.isControllingVariants=Sd(e),this.isVariantNode=Ed(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const{willChange:l,...h}=this.scrapeMotionValuesFromProps(e,{});for(const c in h){const t=h[c];void 0!==o[c]&&Hd(t)&&(t.set(o[c],!1),Sm(l)&&l.add(c))}}scrapeMotionValuesFromProps(t,e){return{}}mount(t){this.current=t,sy.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((t,e)=>this.bindToMotionValue(e,t))),iy.current||function(){if(iy.current=!0,md)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>ey.current=t.matches;t.addListener(e),e()}else ey.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||ey.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){sy.delete(this.current),this.projection&&this.projection.unmount(),ff(this.notifyUpdate),ff(this.render),this.valueSubscriptions.forEach((t=>t())),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,e){const i=Ud.has(t),s=e.on("change",(e=>{this.latestValues[t]=e,this.props.onUpdate&&pf.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)})),n=e.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,(()=>{s(),n()}))}sortNodePosition(t){return this.current&&this.sortInstanceNodePosition&&this.type===t.type?this.sortInstanceNodePosition(this.current,t.current):0}loadFeatures({children:t,...e},i,s,n){let r,o;for(let a=0;a<ry;a++){const t=ny[a],{isEnabled:i,Feature:s,ProjectionNode:n,MeasureLayout:l}=kd[t];n&&(r=n),i(e)&&(!this.features[t]&&s&&(this.features[t]=new s(this)),l&&(o=l))}if(!this.projection&&r){this.projection=new r(this.latestValues,this.parent&&this.parent.projection);const{layoutId:t,layout:i,drag:s,dragConstraints:o,layoutScroll:a,layoutRoot:l}=e;this.projection.setOptions({layoutId:t,layout:i,alwaysMeasureLayout:Boolean(s)||o&&yd(o),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"==typeof i?i:"both",initialPromotionConfig:n,layoutScroll:a,layoutRoot:l})}return o}updateFeatures(){for(const t in this.features){const e=this.features[t];e.isMounted?e.update():(e.mount(),e.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):m_()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}makeTargetAnimatable(t,e=!0){return this.makeTargetAnimatableFromInstance(t,this.props,e)}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let i=0;i<oy.length;i++){const e=oy[i];this.propEventSubscriptions[e]&&(this.propEventSubscriptions[e](),delete this.propEventSubscriptions[e]);const s=t["on"+e];s&&(this.propEventSubscriptions[e]=this.on(e,s))}this.prevMotionValues=function(t,e,i){const{willChange:s}=e;for(const n in e){const r=e[n],o=i[n];if(Hd(r))t.addValue(n,r),Sm(s)&&s.add(n);else if(Hd(o))t.addValue(n,km(r,{owner:t})),Sm(s)&&s.remove(n);else if(o!==r)if(t.hasValue(n)){const e=t.getValue(n);!e.hasAnimated&&e.set(r)}else{const e=t.getStaticValue(n);t.addValue(n,km(void 0!==e?e:r,{owner:t}))}}for(const n in i)void 0===e[n]&&t.removeValue(n);return e}(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const t=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(t.initial=this.props.initial),t}const e={};for(let i=0;i<ay;i++){const t=Cd[i],s=this.props[t];(xd(s)||!1===s)&&(e[t]=s)}return e}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){e!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,e)),this.values.set(t,e),this.latestValues[t]=e.get()}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return void 0===i&&void 0!==e&&(i=km(e,{owner:this}),this.addValue(t,i)),i}readValue(t){return void 0===this.latestValues[t]&&this.current?this.readValueFromInstance(this.current,t,this.options):this.latestValues[t]}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var e;const{initial:i}=this.props,s="string"==typeof i||"object"==typeof i?null===(e=Bp(this.props,i))||void 0===e?void 0:e[t]:void 0;if(i&&void 0!==s)return s;const n=this.getBaseTargetFromProps(this.props,t);return void 0===n||Hd(n)?void 0!==this.initialValues[t]&&void 0===s?void 0:this.baseTarget[t]:n}on(t,e){return this.events[t]||(this.events[t]=new Tm),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}class hy extends ly{sortInstanceNodePosition(t,e){return 2&t.compareDocumentPosition(e)?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:i}){delete e[t],delete i[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:e,...i},{transformValues:s},n){let r=function(t,e,i){const s={};for(const n in t){const t=Bm(n,e);if(void 0!==t)s[n]=t;else{const t=i.getValue(n);t&&(s[n]=t.get())}}return s}(i,t||{},this);if(s&&(e&&(e=s(e)),i&&(i=s(i)),r&&(r=s(r))),n){!function(t,e,i){var s,n;const r=Object.keys(e).filter((e=>!t.hasValue(e))),o=r.length;if(o)for(let a=0;a<o;a++){const o=r[a],l=e[o];let h=null;Array.isArray(l)&&(h=l[0]),null===h&&(h=null!==(n=null!==(s=i[o])&&void 0!==s?s:t.readValue(o))&&void 0!==n?n:e[o]),null!=h&&("string"==typeof h&&(/^\-?\d*\.?\d+$/.test(h)||xm(h))?h=parseFloat(h):!Fm(h)&&Tg.test(l)&&(h=ym(o,l)),t.addValue(o,km(h,{owner:t})),void 0===i[o]&&(i[o]=h),null!==h&&t.setBaseTarget(o,h))}}(this,i,r);const t=ty(this,i,r,e);e=t.transitionEnd,i=t.target}return{transition:t,transitionEnd:e,...i}}}class cy extends hy{readValueFromInstance(t,e){if(Ud.has(e)){const t=vm(e);return t&&t.default||0}{const s=(i=t,window.getComputedStyle(i)),n=(Gd(e)?s.getPropertyValue(e):s[e])||0;return"string"==typeof n?n.trim():n}var i}measureInstanceViewportBox(t,{transformPagePoint:e}){return F_(t,e)}build(t,e,i,s){pp(t,e,i,s.transformTemplate)}scrapeMotionValuesFromProps(t,e){return Fp(t,e)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Hd(t)&&(this.childSubscription=t.on("change",(t=>{this.current&&(this.current.textContent=`${t}`)})))}renderInstance(t,e,i,s){Ip(t,e,i,s)}}class uy extends hy{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Ud.has(e)){const t=vm(e);return t&&t.default||0}return e=Dp.has(e)?e:Rp(e),t.getAttribute(e)}measureInstanceViewportBox(){return m_()}scrapeMotionValuesFromProps(t,e){return Lp(t,e)}build(t,e,i,s){Ep(t,e,i,this.isSVGTag,s.transformTemplate)}renderInstance(t,e,i,s){Mp(t,e,0,s)}mount(t){this.isSVGTag=Tp(t.tagName),super.mount(t)}}const dy=(t,e)=>Od(t)?new uy(e,{enableHardwareAcceleration:!1}):new cy(e,{enableHardwareAcceleration:!0}),py={...Xm,...Ef,...Vv,...{layout:{ProjectionNode:Uv,MeasureLayout:W_}}},fy=Ld(((t,e)=>function(t,{forwardMotionProps:e=!1},i,s){return{...Od(t)?Wp:$p,preloadedFeatures:i,useRender:kp(e),createVisualElement:s,Component:t}}(t,e,py,dy)));function gy(){const t=N.useRef(!1);return _d((()=>(t.current=!0,()=>{t.current=!1})),[]),t}class my extends N.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent){const t=this.props.sizeRef.current;t.height=e.offsetHeight||0,t.width=e.offsetWidth||0,t.top=e.offsetTop,t.left=e.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function _y({children:t,isPresent:e}){const i=N.useId(),s=N.useRef(null),n=N.useRef({width:0,height:0,top:0,left:0});return N.useInsertionEffect((()=>{const{width:t,height:r,top:o,left:a}=n.current;if(e||!s.current||!t||!r)return;s.current.dataset.motionPopId=i;const l=document.createElement("style");return document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`\n          [data-motion-pop-id="${i}"] {\n            position: absolute !important;\n            width: ${t}px !important;\n            height: ${r}px !important;\n            top: ${o}px !important;\n            left: ${a}px !important;\n          }\n        `),()=>{document.head.removeChild(l)}}),[e]),N.createElement(my,{isPresent:e,childRef:s,sizeRef:n},N.cloneElement(t,{ref:s}))}const vy=({children:t,initial:e,isPresent:i,onExitComplete:s,custom:n,presenceAffectsLayout:r,mode:o})=>{const a=Op(yy),l=N.useId(),h=N.useMemo((()=>({id:l,initial:e,isPresent:i,custom:n,onExitComplete:t=>{a.set(t,!0);for(const e of a.values())if(!e)return;s&&s()},register:t=>(a.set(t,!1),()=>a.delete(t))})),r?void 0:[i]);return N.useMemo((()=>{a.forEach(((t,e)=>a.set(e,!1)))}),[i]),N.useEffect((()=>{!i&&!a.size&&s&&s()}),[i]),"popLayout"===o&&(t=N.createElement(_y,{isPresent:i},t)),N.createElement(gd.Provider,{value:h},t)};function yy(){return new Map}const xy=t=>t.key||"";const wy=({children:t,custom:e,initial:i=!0,onExitComplete:s,exitBeforeEnter:n,presenceAffectsLayout:r=!0,mode:o="sync"})=>{const a=N.useContext(Rd).forceRender||function(){const t=gy(),[e,i]=N.useState(0),s=N.useCallback((()=>{t.current&&i(e+1)}),[e]);return[N.useCallback((()=>pf.postRender(s)),[s]),e]}()[0],l=gy(),h=function(t){const e=[];return N.Children.forEach(t,(t=>{N.isValidElement(t)&&e.push(t)})),e}(t);let c=h;const u=N.useRef(new Map).current,d=N.useRef(c),p=N.useRef(new Map).current,f=N.useRef(!0);var g;if(_d((()=>{f.current=!1,function(t,e){t.forEach((t=>{const i=xy(t);e.set(i,t)}))}(h,p),d.current=c})),g=()=>{f.current=!0,p.clear(),u.clear()},N.useEffect((()=>()=>g()),[]),f.current)return N.createElement(N.Fragment,null,c.map((t=>N.createElement(vy,{key:xy(t),isPresent:!0,initial:!!i&&void 0,presenceAffectsLayout:r,mode:o},t))));c=[...c];const m=d.current.map(xy),_=h.map(xy),v=m.length;for(let y=0;y<v;y++){const t=m[y];-1!==_.indexOf(t)||u.has(t)||u.set(t,void 0)}return"wait"===o&&u.size&&(c=[]),u.forEach(((t,i)=>{if(-1!==_.indexOf(i))return;const n=p.get(i);if(!n)return;const f=m.indexOf(i);let g=t;if(!g){const t=()=>{p.delete(i),u.delete(i);const t=d.current.findIndex((t=>t.key===i));if(d.current.splice(t,1),!u.size){if(d.current=h,!1===l.current)return;a(),s&&s()}};g=N.createElement(vy,{key:xy(n),isPresent:!1,onExitComplete:t,custom:e,presenceAffectsLayout:r,mode:o},n),u.set(i,g)}c.splice(f,0,g)})),c=c.map((t=>{const e=t.key;return u.has(e)?t:N.createElement(vy,{key:xy(t),isPresent:!0,presenceAffectsLayout:r,mode:o},t)})),N.createElement(N.Fragment,null,u.size?c:c.map((t=>N.cloneElement(t))))};let by,Cy,Sy,Ey={data:""},Py=t=>"object"==typeof window?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Ey,Ty=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ay=/\/\*[^]*?\*\/|  +/g,ky=/\n+/g,Ry=(t,e)=>{let i="",s="",n="";for(let r in t){let o=t[r];"@"==r[0]?"i"==r[1]?i=r+" "+o+";":s+="f"==r[1]?Ry(o,r):r+"{"+Ry(o,"k"==r[1]?"":e)+"}":"object"==typeof o?s+=Ry(o,e?e.replace(/([^,])+/g,(t=>r.replace(/(^:.*)|([^,])+/g,(e=>/&/.test(e)?e.replace(/&/g,t):t?t+" "+e:e)))):r):null!=o&&(r=/^--/.test(r)?r:r.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Ry.p?Ry.p(r,o):r+":"+o+";")}return i+(e&&n?e+"{"+n+"}":n)+s},Iy={},Dy=t=>{if("object"==typeof t){let e="";for(let i in t)e+=i+Dy(t[i]);return e}return t},My=(t,e,i,s,n)=>{let r=Dy(t),o=Iy[r]||(Iy[r]=(t=>{let e=0,i=11;for(;e<t.length;)i=101*i+t.charCodeAt(e++)>>>0;return"go"+i})(r));if(!Iy[o]){let e=r!==t?t:(t=>{let e,i,s=[{}];for(;e=Ty.exec(t.replace(Ay,""));)e[4]?s.shift():e[3]?(i=e[3].replace(ky," ").trim(),s.unshift(s[0][i]=s[0][i]||{})):s[0][e[1]]=e[2].replace(ky," ").trim();return s[0]})(t);Iy[o]=Ry(n?{["@keyframes "+o]:e}:e,i?"":"."+o)}let a=i&&Iy.g?Iy.g:null;return i&&(Iy.g=Iy[o]),l=Iy[o],h=e,c=s,(u=a)?h.data=h.data.replace(u,l):-1===h.data.indexOf(l)&&(h.data=c?l+h.data:h.data+l),o;var l,h,c,u},Fy=(t,e,i)=>t.reduce(((t,s,n)=>{let r=e[n];if(r&&r.call){let t=r(i),e=t&&t.props&&t.props.className||/^go/.test(t)&&t;r=e?"."+e:t&&"object"==typeof t?t.props?"":Ry(t,""):!1===t?"":t}return t+s+(null==r?"":r)}),"");function Ly(t){let e=this||{},i=t.call?t(e.p):t;return My(i.unshift?i.raw?Fy(i,[].slice.call(arguments,1),e.p):i.reduce(((t,i)=>Object.assign(t,i&&i.call?i(e.p):i)),{}):i,Py(e.target),e.g,e.o,e.k)}Ly.bind({g:1});let By=Ly.bind({k:1});function Oy(t,e){let i=this||{};return function(){let s=arguments;function n(r,o){let a=Object.assign({},r),l=a.className||n.className;i.p=Object.assign({theme:Cy&&Cy()},a),i.o=/ *go\d+/.test(l),a.className=Ly.apply(i,s)+(l?" "+l:""),e&&(a.ref=o);let h=t;return t[0]&&(h=a.as||t,delete a.as),Sy&&h[0]&&Sy(a),by(h,a)}return e?e(n):n}}var zy=(t,e)=>(t=>"function"==typeof t)(t)?t(e):t,Ny=(()=>{let t=0;return()=>(++t).toString()})(),Uy=(()=>{let t;return()=>{if(void 0===t&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Vy=new Map,Hy=t=>{if(Vy.has(t))return;let e=setTimeout((()=>{Vy.delete(t),Gy({type:4,toastId:t})}),1e3);Vy.set(t,e)},jy=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,20)};case 1:return e.toast.id&&(t=>{let e=Vy.get(t);e&&clearTimeout(e)})(e.toast.id),{...t,toasts:t.toasts.map((t=>t.id===e.toast.id?{...t,...e.toast}:t))};case 2:let{toast:i}=e;return t.toasts.find((t=>t.id===i.id))?jy(t,{type:1,toast:i}):jy(t,{type:0,toast:i});case 3:let{toastId:s}=e;return s?Hy(s):t.toasts.forEach((t=>{Hy(t.id)})),{...t,toasts:t.toasts.map((t=>t.id===s||void 0===s?{...t,visible:!1}:t))};case 4:return void 0===e.toastId?{...t,toasts:[]}:{...t,toasts:t.toasts.filter((t=>t.id!==e.toastId))};case 5:return{...t,pausedAt:e.time};case 6:let n=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map((t=>({...t,pauseDuration:t.pauseDuration+n})))}}},Wy=[],$y={toasts:[],pausedAt:void 0},Gy=t=>{$y=jy($y,t),Wy.forEach((t=>{t($y)}))},qy={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Xy=t=>(e,i)=>{let s=((t,e="blank",i)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...i,id:(null==i?void 0:i.id)||Ny()}))(e,t,i);return Gy({type:2,toast:s}),s.id},Ky=(t,e)=>Xy("blank")(t,e);Ky.error=Xy("error"),Ky.success=Xy("success"),Ky.loading=Xy("loading"),Ky.custom=Xy("custom"),Ky.dismiss=t=>{Gy({type:3,toastId:t})},Ky.remove=t=>Gy({type:4,toastId:t}),Ky.promise=(t,e,i)=>{let s=Ky.loading(e.loading,{...i,...null==i?void 0:i.loading});return t.then((t=>(Ky.success(zy(e.success,t),{id:s,...i,...null==i?void 0:i.success}),t))).catch((t=>{Ky.error(zy(e.error,t),{id:s,...i,...null==i?void 0:i.error})})),t};var Yy,Zy,Qy,Jy,tx=(t,e)=>{Gy({type:1,toast:{id:t,height:e}})},ex=()=>{Gy({type:5,time:Date.now()})},ix=t=>{let{toasts:e,pausedAt:i}=((t={})=>{let[e,i]=N.useState($y);N.useEffect((()=>(Wy.push(i),()=>{let t=Wy.indexOf(i);t>-1&&Wy.splice(t,1)})),[e]);let s=e.toasts.map((e=>{var i,s;return{...t,...t[e.type],...e,duration:e.duration||(null==(i=t[e.type])?void 0:i.duration)||(null==t?void 0:t.duration)||qy[e.type],style:{...t.style,...null==(s=t[e.type])?void 0:s.style,...e.style}}}));return{...e,toasts:s}})(t);N.useEffect((()=>{if(i)return;let t=Date.now(),s=e.map((e=>{if(e.duration===1/0)return;let i=(e.duration||0)+e.pauseDuration-(t-e.createdAt);if(!(i<0))return setTimeout((()=>Ky.dismiss(e.id)),i);e.visible&&Ky.dismiss(e.id)}));return()=>{s.forEach((t=>t&&clearTimeout(t)))}}),[e,i]);let s=N.useCallback((()=>{i&&Gy({type:6,time:Date.now()})}),[i]),n=N.useCallback(((t,i)=>{let{reverseOrder:s=!1,gutter:n=8,defaultPosition:r}=i||{},o=e.filter((e=>(e.position||r)===(t.position||r)&&e.height)),a=o.findIndex((e=>e.id===t.id)),l=o.filter(((t,e)=>e<a&&t.visible)).length;return o.filter((t=>t.visible)).slice(...s?[l+1]:[0,l]).reduce(((t,e)=>t+(e.height||0)+n),0)}),[e]);return{toasts:e,handlers:{updateHeight:tx,startPause:ex,endPause:s,calculateOffset:n}}},sx=By`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,nx=By`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,rx=By`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ox=Oy("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sx} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${nx} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${rx} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ax=By`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lx=Oy("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${ax} 1s linear infinite;
`,hx=By`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,cx=By`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ux=Oy("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${hx} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${cx} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,dx=Oy("div")`
  position: absolute;
`,px=Oy("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,fx=By`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gx=Oy("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${fx} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,mx=({toast:t})=>{let{icon:e,type:i,iconTheme:s}=t;return void 0!==e?"string"==typeof e?N.createElement(gx,null,e):e:"blank"===i?null:N.createElement(px,null,N.createElement(lx,{...s}),"loading"!==i&&N.createElement(dx,null,"error"===i?N.createElement(ox,{...s}):N.createElement(ux,{...s})))},_x=t=>`\n0% {transform: translate3d(0,${-200*t}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,vx=t=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*t}%,-1px) scale(.6); opacity:0;}\n`,yx=Oy("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xx=Oy("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,wx=N.memo((({toast:t,position:e,style:i,children:s})=>{let n=t.height?((t,e)=>{let i=t.includes("top")?1:-1,[s,n]=Uy()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[_x(i),vx(i)];return{animation:e?`${By(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${By(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||e||"top-center",t.visible):{opacity:0},r=N.createElement(mx,{toast:t}),o=N.createElement(xx,{...t.ariaProps},zy(t.message,t));return N.createElement(yx,{className:t.className,style:{...n,...i,...t.style}},"function"==typeof s?s({icon:r,message:o}):N.createElement(N.Fragment,null,r,o))}));Yy=N.createElement,Ry.p=Zy,by=Yy,Cy=Qy,Sy=Jy;var bx=({id:t,className:e,style:i,onHeightUpdate:s,children:n})=>{let r=N.useCallback((e=>{if(e){let i=()=>{let i=e.getBoundingClientRect().height;s(t,i)};i(),new MutationObserver(i).observe(e,{subtree:!0,childList:!0,characterData:!0})}}),[t,s]);return N.createElement("div",{ref:r,className:e,style:i},n)},Cx=Ly`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Sx=({reverseOrder:t,position:e="top-center",toastOptions:i,gutter:s,children:n,containerStyle:r,containerClassName:o})=>{let{toasts:a,handlers:l}=ix(i);return N.createElement("div",{style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...r},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map((i=>{let r=i.position||e,o=((t,e)=>{let i=t.includes("top"),s=i?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Uy()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(i?1:-1)}px)`,...s,...n}})(r,l.calculateOffset(i,{reverseOrder:t,gutter:s,defaultPosition:e}));return N.createElement(bx,{id:i.id,key:i.id,onHeightUpdate:l.updateHeight,className:i.visible?Cx:"",style:o},"custom"===i.type?zy(i.message,i):n?n(i):N.createElement(wx,{toast:i,position:r}))})))},Ex=Ky;const Px={};function Tx(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];"string"==typeof e[0]&&Px[e[0]]||("string"==typeof e[0]&&(Px[e[0]]=new Date),function(){if(console&&console.warn){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];"string"==typeof e[0]&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}(...e))}const Ax=(t,e)=>()=>{if(t.isInitialized)e();else{const i=()=>{setTimeout((()=>{t.off("initialized",i)}),0),e()};t.on("initialized",i)}};function kx(t,e,i){t.loadNamespaces(e,Ax(t,i))}function Rx(t,e,i,s){"string"==typeof i&&(i=[i]),i.forEach((e=>{t.options.ns.indexOf(e)<0&&t.options.ns.push(e)})),t.loadLanguages(e,Ax(t,s))}const Ix=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Dx={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Mx=t=>Dx[t];let Fx,Lx={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:t=>t.replace(Ix,Mx)};const Bx={type:"3rdParty",init(t){!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Lx={...Lx,...t}}(t.options.react),function(t){Fx=t}(t)}},Ox=N.createContext();class zx{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach((t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)}))}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Nx=(t,e)=>{const i=N.useRef();return N.useEffect((()=>{i.current=e?i.current:t}),[t,e]),i.current};function Ux(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{i18n:i}=e,{i18n:s,defaultNS:n}=N.useContext(Ox)||{},r=i||s||Fx;if(r&&!r.reportNamespaces&&(r.reportNamespaces=new zx),!r){Tx("You will need to pass in an i18next instance by using initReactI18next");const t=(t,e)=>"string"==typeof e?e:e&&"object"==typeof e&&"string"==typeof e.defaultValue?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,e=[t,{},!1];return e.t=t,e.i18n={},e.ready=!1,e}r.options.react&&void 0!==r.options.react.wait&&Tx("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...Lx,...r.options.react,...e},{useSuspense:a,keyPrefix:l}=o;let h=t||n||r.options&&r.options.defaultNS;h="string"==typeof h?[h]:h||["translation"],r.reportNamespaces.addUsedNamespaces&&r.reportNamespaces.addUsedNamespaces(h);const c=(r.isInitialized||r.initializedStoreOnce)&&h.every((t=>function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.languages&&e.languages.length?void 0!==e.options.ignoreJSONStructure?e.hasLoadedNamespace(t,{lng:i.lng,precheck:(e,s)=>{if(i.bindI18n&&i.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!s(e.isLanguageChangingTo,t))return!1}}):function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.languages[0],n=!!e.options&&e.options.fallbackLng,r=e.languages[e.languages.length-1];if("cimode"===s.toLowerCase())return!0;const o=(t,i)=>{const s=e.services.backendConnector.state[`${t}|${i}`];return-1===s||2===s};return!(i.bindI18n&&i.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!o(e.isLanguageChangingTo,t)||!e.hasResourceBundle(s,t)&&e.services.backendConnector.backend&&(!e.options.resources||e.options.partialBundledLanguages)&&(!o(s,t)||n&&!o(r,t)))}(t,e,i):(Tx("i18n.languages were undefined or empty",e.languages),!0)}(t,r,o)));function u(){return r.getFixedT(e.lng||null,"fallback"===o.nsMode?h:h[0],l)}const[d,p]=N.useState(u);let f=h.join();e.lng&&(f=`${e.lng}${f}`);const g=Nx(f),m=N.useRef(!0);N.useEffect((()=>{const{bindI18n:t,bindI18nStore:i}=o;function s(){m.current&&p(u)}return m.current=!0,c||a||(e.lng?Rx(r,e.lng,h,(()=>{m.current&&p(u)})):kx(r,h,(()=>{m.current&&p(u)}))),c&&g&&g!==f&&m.current&&p(u),t&&r&&r.on(t,s),i&&r&&r.store.on(i,s),()=>{m.current=!1,t&&r&&t.split(" ").forEach((t=>r.off(t,s))),i&&r&&i.split(" ").forEach((t=>r.store.off(t,s)))}}),[r,f]);const _=N.useRef(!0);N.useEffect((()=>{m.current&&!_.current&&p(u),_.current=!1}),[r,l]);const v=[d,r,c];if(v.t=d,v.i18n=r,v.ready=c,c)return v;if(!c&&!a)return v;throw new Promise((t=>{e.lng?Rx(r,e.lng,h,(()=>t())):kx(r,h,(()=>t()))}))}let Vx=[],Hx=(t,e)=>{let i=[],s={get:()=>(s.lc||s.listen((()=>{}))(),s.value),l:e||0,lc:0,listen:(t,e)=>(s.lc=i.push(t,e||s.l)/2,()=>{let e=i.indexOf(t);~e&&(i.splice(e,2),s.lc--,s.lc||s.off())}),notify(t){let e=!Vx.length;for(let n=0;n<i.length;n+=2)Vx.push(i[n],s.value,t,i[n+1]);if(e){for(let t=0;t<Vx.length;t+=4){let e=!1;for(let i=t+7;i<Vx.length;i+=4)if(Vx[i]<Vx[t+3]){e=!0;break}e?Vx.push(Vx[t],Vx[t+1],Vx[t+2],Vx[t+3]):Vx[t](Vx[t+1],Vx[t+2])}Vx.length=0}},off(){},set(t){s.value!==t&&(s.value=t,s.notify())},subscribe(t,e){let i=s.listen(t,e);return t(s.value),i},value:t};return s};function jx(t,e={}){let i=N.useCallback((i=>e.keys?function(t,e,i){let s=new Set([...e,void 0]);return t.listen(((t,e)=>{s.has(e)&&i(t,e)}))}(t,e.keys,i):t.listen(i)),[e.keys,t]),s=t.get.bind(t);return N.useSyncExternalStore(i,s,s)}
/*!
 * excalibur - 0.28.0 - 2023-8-10
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2023 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */var Wx={4662:(t,e,i)=>{i(3430);var s=i(8791);t.exports=s("Array","sort")},8343:(t,e,i)=>{i(4769);var s=i(9276);t.exports=s.Object.keys},7111:(t,e,i)=>{var s=i(6733),n=i(9821),r=TypeError;t.exports=function(t){if(s(t))return t;throw r(n(t)+" is not a function")}},1176:(t,e,i)=>{var s=i(5052),n=String,r=TypeError;t.exports=function(t){if(s(t))return t;throw r(n(t)+" is not an object")}},9540:(t,e,i)=>{var s=i(905),n=i(3231),r=i(9646),o=function(t){return function(e,i,o){var a,l=s(e),h=r(l),c=n(o,h);if(t&&i!=i){for(;h>c;)if((a=l[c++])!=a)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},6038:(t,e,i)=>{var s=i(4229);t.exports=function(t,e){var i=[][t];return!!i&&s((function(){i.call(null,e||function(){return 1},1)}))}},9794:(t,e,i)=>{var s=i(3231),n=i(9646),r=i(2324),o=Array,a=Math.max;t.exports=function(t,e,i){for(var l=n(t),h=s(e,l),c=s(void 0===i?l:i,l),u=o(a(c-h,0)),d=0;h<c;h++,d++)r(u,d,t[h]);return u.length=d,u}},3867:(t,e,i)=>{var s=i(9794),n=Math.floor,r=function(t,e){var i=t.length,l=n(i/2);return i<8?o(t,e):a(t,r(s(t,0,l),e),r(s(t,l),e),e)},o=function(t,e){for(var i,s,n=t.length,r=1;r<n;){for(s=r,i=t[r];s&&e(t[s-1],i)>0;)t[s]=t[--s];s!==r++&&(t[s]=i)}return t},a=function(t,e,i,s){for(var n=e.length,r=i.length,o=0,a=0;o<n||a<r;)t[o+a]=o<n&&a<r?s(e[o],i[a])<=0?e[o++]:i[a++]:o<n?e[o++]:i[a++];return t};t.exports=r},7079:(t,e,i)=>{var s=i(5968),n=s({}.toString),r=s("".slice);t.exports=function(t){return r(n(t),8,-1)}},1589:(t,e,i)=>{var s=i(1601),n=i(6733),r=i(7079),o=i(95)("toStringTag"),a=Object,l="Arguments"==r(function(){return arguments}());t.exports=s?r:function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(i){}}(e=a(t),o))?i:l?r(e):"Object"==(s=r(e))&&n(e.callee)?"Arguments":s}},7081:(t,e,i)=>{var s=i(8270),n=i(4826),r=i(7933),o=i(1787);t.exports=function(t,e,i){for(var a=n(e),l=o.f,h=r.f,c=0;c<a.length;c++){var u=a[c];s(t,u)||i&&s(i,u)||l(t,u,h(e,u))}}},5762:(t,e,i)=>{var s=i(7400),n=i(1787),r=i(5358);t.exports=s?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},5358:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2324:(t,e,i)=>{var s=i(9310),n=i(1787),r=i(5358);t.exports=function(t,e,i){var o=s(e);o in t?n.f(t,o,r(0,i)):t[o]=i}},4768:(t,e,i)=>{var s=i(6733),n=i(1787),r=i(6039),o=i(8400);t.exports=function(t,e,i,a){a||(a={});var l=a.enumerable,h=void 0!==a.name?a.name:e;if(s(i)&&r(i,h,a),a.global)l?t[e]=i:o(e,i);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(c){}l?t[e]=i:n.f(t,e,{value:i,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},8400:(t,e,i)=>{var s=i(9859),n=Object.defineProperty;t.exports=function(t,e){try{n(s,t,{value:e,configurable:!0,writable:!0})}catch(i){s[t]=e}return e}},9563:(t,e,i)=>{var s=i(9821),n=TypeError;t.exports=function(t,e){if(!delete t[e])throw n("Cannot delete property "+s(e)+" of "+s(t))}},7400:(t,e,i)=>{var s=i(4229);t.exports=!s((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3777:t=>{var e="object"==typeof document&&document.all,i=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:i}},2635:(t,e,i)=>{var s=i(9859),n=i(5052),r=s.document,o=n(r)&&n(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},2671:(t,e,i)=>{var s=i(598).match(/firefox\/(\d+)/i);t.exports=!!s&&+s[1]},8506:(t,e,i)=>{var s=i(598);t.exports=/MSIE|Trident/.test(s)},598:t=>{t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},5884:(t,e,i)=>{var s,n,r=i(9859),o=i(598),a=r.process,l=r.Deno,h=a&&a.versions||l&&l.version,c=h&&h.v8;c&&(n=(s=c.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!n&&o&&(!(s=o.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=o.match(/Chrome\/(\d+)/))&&(n=+s[1]),t.exports=n},9811:(t,e,i)=>{var s=i(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!s&&+s[1]},8791:(t,e,i)=>{var s=i(9859),n=i(5968);t.exports=function(t,e){return n(s[t].prototype[e])}},3837:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:(t,e,i)=>{var s=i(9859),n=i(7933).f,r=i(5762),o=i(4768),a=i(8400),l=i(7081),h=i(6541);t.exports=function(t,e){var i,c,u,d,p,f=t.target,g=t.global,m=t.stat;if(i=g?s:m?s[f]||a(f,{}):(s[f]||{}).prototype)for(c in e){if(d=e[c],u=t.dontCallGetSet?(p=n(i,c))&&p.value:i[c],!h(g?c:f+(m?".":"#")+c,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;l(d,u)}(t.sham||u&&u.sham)&&r(d,"sham",!0),o(i,c,d,t)}}},4229:t=>{t.exports=function(t){try{return!!t()}catch(e){return!0}}},7188:(t,e,i)=>{var s=i(4229);t.exports=!s((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},266:(t,e,i)=>{var s=i(7188),n=Function.prototype.call;t.exports=s?n.bind(n):function(){return n.apply(n,arguments)}},1805:(t,e,i)=>{var s=i(7400),n=i(8270),r=Function.prototype,o=s&&Object.getOwnPropertyDescriptor,a=n(r,"name"),l=a&&"something"===function(){}.name,h=a&&(!s||s&&o(r,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:h}},5968:(t,e,i)=>{var s=i(7188),n=Function.prototype,r=n.call,o=s&&n.bind.bind(r,r);t.exports=s?o:function(t){return function(){return r.apply(t,arguments)}}},1333:(t,e,i)=>{var s=i(9859),n=i(6733);t.exports=function(t,e){return arguments.length<2?(i=s[t],n(i)?i:void 0):s[t]&&s[t][e];var i}},5300:(t,e,i)=>{var s=i(7111),n=i(9650);t.exports=function(t,e){var i=t[e];return n(i)?void 0:s(i)}},9859:function(t,e,i){var s=function(t){return t&&t.Math==Math&&t};t.exports=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof i.g&&i.g)||function(){return this}()||this||Function("return this")()},8270:(t,e,i)=>{var s=i(5968),n=i(2991),r=s({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(n(t),e)}},5977:t=>{t.exports={}},4394:(t,e,i)=>{var s=i(7400),n=i(4229),r=i(2635);t.exports=!s&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},9337:(t,e,i)=>{var s=i(5968),n=i(4229),r=i(7079),o=Object,a=s("".split);t.exports=n((function(){return!o("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?a(t,""):o(t)}:o},8511:(t,e,i)=>{var s=i(5968),n=i(6733),r=i(5353),o=s(Function.toString);n(r.inspectSource)||(r.inspectSource=function(t){return o(t)}),t.exports=r.inspectSource},6407:(t,e,i)=>{var s,n,r,o=i(1180),a=i(9859),l=i(5052),h=i(5762),c=i(8270),u=i(5353),d=i(4399),p=i(5977),f="Object already initialized",g=a.TypeError,m=a.WeakMap;if(o||u.state){var _=u.state||(u.state=new m);_.get=_.get,_.has=_.has,_.set=_.set,s=function(t,e){if(_.has(t))throw g(f);return e.facade=t,_.set(t,e),e},n=function(t){return _.get(t)||{}},r=function(t){return _.has(t)}}else{var v=d("state");p[v]=!0,s=function(t,e){if(c(t,v))throw g(f);return e.facade=t,h(t,v,e),e},n=function(t){return c(t,v)?t[v]:{}},r=function(t){return c(t,v)}}t.exports={set:s,get:n,has:r,enforce:function(t){return r(t)?n(t):s(t,{})},getterFor:function(t){return function(e){var i;if(!l(e)||(i=n(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return i}}}},6733:(t,e,i)=>{var s=i(3777),n=s.all;t.exports=s.IS_HTMLDDA?function(t){return"function"==typeof t||t===n}:function(t){return"function"==typeof t}},6541:(t,e,i)=>{var s=i(4229),n=i(6733),r=/#|\.prototype\./,o=function(t,e){var i=l[a(t)];return i==c||i!=h&&(n(e)?s(e):!!e)},a=o.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=o.data={},h=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},9650:t=>{t.exports=function(t){return null==t}},5052:(t,e,i)=>{var s=i(6733),n=i(3777),r=n.all;t.exports=n.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:s(t)||t===r}:function(t){return"object"==typeof t?null!==t:s(t)}},4231:t=>{t.exports=!1},9395:(t,e,i)=>{var s=i(1333),n=i(6733),r=i(1321),o=i(6969),a=Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=s("Symbol");return n(e)&&r(e.prototype,a(t))}},9646:(t,e,i)=>{var s=i(4237);t.exports=function(t){return s(t.length)}},6039:(t,e,i)=>{var s=i(5968),n=i(4229),r=i(6733),o=i(8270),a=i(7400),l=i(1805).CONFIGURABLE,h=i(8511),c=i(6407),u=c.enforce,d=c.get,p=String,f=Object.defineProperty,g=s("".slice),m=s("".replace),_=s([].join),v=a&&!n((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),x=t.exports=function(t,e,i){"Symbol("===g(p(e),0,7)&&(e="["+m(p(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!o(t,"name")||l&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),v&&i&&o(i,"arity")&&t.length!==i.arity&&f(t,"length",{value:i.arity});try{i&&o(i,"constructor")&&i.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(n){}var s=u(t);return o(s,"source")||(s.source=_(y,"string"==typeof e?e:"")),t};Function.prototype.toString=x((function(){return r(this)&&d(this).source||h(this)}),"toString")},917:t=>{var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var s=+t;return(s>0?i:e)(s)}},1787:(t,e,i)=>{var s=i(7400),n=i(4394),r=i(7137),o=i(1176),a=i(9310),l=TypeError,h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",p="writable";e.f=s?r?function(t,e,i){if(o(t),e=a(e),o(i),"function"==typeof t&&"prototype"===e&&"value"in i&&p in i&&!i[p]){var s=c(t,e);s&&s[p]&&(t[e]=i.value,i={configurable:d in i?i[d]:s[d],enumerable:u in i?i[u]:s[u],writable:!1})}return h(t,e,i)}:h:function(t,e,i){if(o(t),e=a(e),o(i),n)try{return h(t,e,i)}catch(s){}if("get"in i||"set"in i)throw l("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},7933:(t,e,i)=>{var s=i(7400),n=i(266),r=i(9195),o=i(5358),a=i(905),l=i(9310),h=i(8270),c=i(4394),u=Object.getOwnPropertyDescriptor;e.f=s?u:function(t,e){if(t=a(t),e=l(e),c)try{return u(t,e)}catch(i){}if(h(t,e))return o(!n(r.f,t,e),t[e])}},8151:(t,e,i)=>{var s=i(140),n=i(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return s(t,n)}},894:(t,e)=>{e.f=Object.getOwnPropertySymbols},1321:(t,e,i)=>{var s=i(5968);t.exports=s({}.isPrototypeOf)},140:(t,e,i)=>{var s=i(5968),n=i(8270),r=i(905),o=i(9540).indexOf,a=i(5977),l=s([].push);t.exports=function(t,e){var i,s=r(t),h=0,c=[];for(i in s)!n(a,i)&&n(s,i)&&l(c,i);for(;e.length>h;)n(s,i=e[h++])&&(~o(c,i)||l(c,i));return c}},5632:(t,e,i)=>{var s=i(140),n=i(3837);t.exports=Object.keys||function(t){return s(t,n)}},9195:(t,e)=>{var i={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!i.call({1:2},1);e.f=n?function(t){var e=s(this,t);return!!e&&e.enumerable}:i},2914:(t,e,i)=>{var s=i(266),n=i(6733),r=i(5052),o=TypeError;t.exports=function(t,e){var i,a;if("string"===e&&n(i=t.toString)&&!r(a=s(i,t)))return a;if(n(i=t.valueOf)&&!r(a=s(i,t)))return a;if("string"!==e&&n(i=t.toString)&&!r(a=s(i,t)))return a;throw o("Can't convert object to primitive value")}},4826:(t,e,i)=>{var s=i(1333),n=i(5968),r=i(8151),o=i(894),a=i(1176),l=n([].concat);t.exports=s("Reflect","ownKeys")||function(t){var e=r.f(a(t)),i=o.f;return i?l(e,i(t)):e}},9276:(t,e,i)=>{var s=i(9859);t.exports=s},8885:(t,e,i)=>{var s=i(9650),n=TypeError;t.exports=function(t){if(s(t))throw n("Can't call method on "+t);return t}},4399:(t,e,i)=>{var s=i(3036),n=i(1441),r=s("keys");t.exports=function(t){return r[t]||(r[t]=n(t))}},5353:(t,e,i)=>{var s=i(9859),n=i(8400),r="__core-js_shared__",o=s[r]||n(r,{});t.exports=o},3036:(t,e,i)=>{var s=i(4231),n=i(5353);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.32.0",mode:s?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.0/LICENSE",source:"https://github.com/zloirock/core-js"})},4860:(t,e,i)=>{var s=i(5884),n=i(4229),r=i(9859).String;t.exports=!!Object.getOwnPropertySymbols&&!n((function(){var t=Symbol();return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},3231:(t,e,i)=>{var s=i(3329),n=Math.max,r=Math.min;t.exports=function(t,e){var i=s(t);return i<0?n(i+e,0):r(i,e)}},905:(t,e,i)=>{var s=i(9337),n=i(8885);t.exports=function(t){return s(n(t))}},3329:(t,e,i)=>{var s=i(917);t.exports=function(t){var e=+t;return e!=e||0===e?0:s(e)}},4237:(t,e,i)=>{var s=i(3329),n=Math.min;t.exports=function(t){return t>0?n(s(t),9007199254740991):0}},2991:(t,e,i)=>{var s=i(8885),n=Object;t.exports=function(t){return n(s(t))}},2066:(t,e,i)=>{var s=i(266),n=i(5052),r=i(9395),o=i(5300),a=i(2914),l=i(95),h=TypeError,c=l("toPrimitive");t.exports=function(t,e){if(!n(t)||r(t))return t;var i,l=o(t,c);if(l){if(void 0===e&&(e="default"),i=s(l,t,e),!n(i)||r(i))return i;throw h("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},9310:(t,e,i)=>{var s=i(2066),n=i(9395);t.exports=function(t){var e=s(t,"string");return n(e)?e:e+""}},1601:(t,e,i)=>{var s={};s[i(95)("toStringTag")]="z",t.exports="[object z]"===String(s)},3326:(t,e,i)=>{var s=i(1589),n=String;t.exports=function(t){if("Symbol"===s(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},9821:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(i){return"Object"}}},1441:(t,e,i)=>{var s=i(5968),n=0,r=Math.random(),o=s(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++n+r,36)}},6969:(t,e,i)=>{var s=i(4860);t.exports=s&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7137:(t,e,i)=>{var s=i(7400),n=i(4229);t.exports=s&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1180:(t,e,i)=>{var s=i(9859),n=i(6733),r=s.WeakMap;t.exports=n(r)&&/native code/.test(String(r))},95:(t,e,i)=>{var s=i(9859),n=i(3036),r=i(8270),o=i(1441),a=i(4860),l=i(6969),h=s.Symbol,c=n("wks"),u=l?h.for||h:h&&h.withoutSetter||o;t.exports=function(t){return r(c,t)||(c[t]=a&&r(h,t)?h[t]:u("Symbol."+t)),c[t]}},3430:(t,e,i)=>{var s=i(3103),n=i(5968),r=i(7111),o=i(2991),a=i(9646),l=i(9563),h=i(3326),c=i(4229),u=i(3867),d=i(6038),p=i(2671),f=i(8506),g=i(5884),m=i(9811),_=[],v=n(_.sort),y=n(_.push),x=c((function(){_.sort(void 0)})),w=c((function(){_.sort(null)})),b=d("sort"),C=!c((function(){if(g)return g<70;if(!(p&&p>3)){if(f)return!0;if(m)return m<603;var t,e,i,s,n="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(s=0;s<47;s++)_.push({k:e+s,v:i})}for(_.sort((function(t,e){return e.v-t.v})),s=0;s<_.length;s++)e=_[s].k.charAt(0),n.charAt(n.length-1)!==e&&(n+=e);return"DGBEFHACIJK"!==n}}));s({target:"Array",proto:!0,forced:x||!w||!b||!C},{sort:function(t){void 0!==t&&r(t);var e=o(this);if(C)return void 0===t?v(e):v(e,t);var i,s,n=[],c=a(e);for(s=0;s<c;s++)s in e&&y(n,e[s]);for(u(n,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:h(e)>h(i)?1:-1}}(t)),i=a(n),s=0;s<i;)e[s]=n[s++];for(;s<c;)l(e,s++);return e}})},4769:(t,e,i)=>{var s=i(3103),n=i(2991),r=i(5632);s({target:"Object",stat:!0,forced:i(4229)((function(){r(1)}))},{keys:function(t){return r(n(t))}})},1388:(t,e,i)=>{i.d(e,{Z:()=>a});var s=i(272),n=i.n(s),r=i(2609),o=i.n(r)()(n());o.push([t.id,"/* Buttons styles start */\n\nbutton#excalibur-play {\n  display: inline-block;\n  position: relative;\n  z-index: 999;\n  border-radius: 6px;\n  border: none;\n  /*border: 3px solid;\n    border-color: white;\n    box-shadow: 0 0 10px #ccc;*/\n  padding: 1rem 1.5rem 1rem 4rem;\n  margin: 0;\n  text-decoration: none;\n  background: #00b233;\n  color: #ffffff;\n  font-family: sans-serif;\n  font-size: 2rem;\n  white-space: nowrap;\n  line-height: 1;\n  cursor: pointer;\n  text-align: center;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\n  animation: excalibur-button-fadein 200ms;\n}\n\n/*\nbutton#excalibur-play {\n  display: none;\n}*/\n\nbutton#excalibur-play:after {\n  position: absolute;\n  content: '';\n  border: 8px solid;\n  border-color: transparent transparent transparent white;\n  left: 35px;\n  top: 24px;\n  width: 0;\n  height: 0;\n}\n\nbutton#excalibur-play:before {\n  position: absolute;\n  content: '';\n  border: 3px solid;\n  left: 19px;\n  top: 14px;\n  border-radius: 20px;\n  width: 30px;\n  height: 30px;\n}\n\nbutton#excalibur-play:hover,\nbutton#excalibur-play:focus {\n  background: #00982c;\n}\n\nbutton#excalibur-play:focus {\n  outline: 1px solid #fff;\n  outline-offset: -4px;\n}\n\nbutton#excalibur-play:active {\n  transform: scale(0.99);\n}\n\n@keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Firefox < 16 */\n@-moz-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Safari, Chrome and Opera > 12.1 */\n@-webkit-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Internet Explorer */\n@-ms-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Opera < 12.1 */\n@-o-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);const a=o},7379:(t,e,i)=>{i.d(e,{Z:()=>a});var s=i(272),n=i.n(s),r=i(2609),o=i.n(r)()(n());o.push([t.id,"\n#ex-toast-container {\n  position: absolute;\n  height: 0;\n  min-width: 50%;\n  left: 50%;\n  top: 0;\n}\n\n.ex-toast-message {\n  left: -50%;\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n\n\n  padding: 10px;\n  margin-top: 5px;\n  font-size: 18px;\n  font-family: sans-serif;\n  border-radius: 6px;\n  border: 3px solid #b7b779;\n  background-color: rgb(253, 253, 192);\n}\n\n\n.ex-toast-message button {\n  align-self: flex-start;\n}","",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:["\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}"],sourceRoot:""}]);const a=o},2609:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,n,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);s&&o[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),e.push(c))}},e}},272:t=>{t.exports=function(t){var e=t[1],i=t[3];if(!i)return e;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),r="/*# ".concat(n," */");return[e].concat([r]).join("\n")}return[e].join("\n")}}},$x={};function Gx(t){var e=$x[t];if(void 0!==e)return e.exports;var i=$x[t]={id:t,exports:{}};return Wx[t].call(i.exports,i,i.exports,Gx),i.exports}Gx.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return Gx.d(e,{a:e}),e},Gx.d=(t,e)=>{for(var i in e)Gx.o(e,i)&&!Gx.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},Gx.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(Yy){if("object"==typeof window)return window}}(),Gx.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Gx.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var qx={};(()=>{Gx.d(qx,{fWn:()=>Os,Ia8:()=>as,rqv:()=>Ur,hLI:()=>zs,yyv:()=>Kn,tX5:()=>Y,vtX:()=>js,r7K:()=>qi,lCh:()=>gn,cE4:()=>Nt,fwF:()=>Bn,sce:()=>In,AQ6:()=>Ln,_c7:()=>Mn,KUs:()=>Tn,Ajp:()=>Ie,dkO:()=>l,RDh:()=>Js,_H9:()=>vs,mxs:()=>Is,OmD:()=>Gi,kBf:()=>Rt,C4F:()=>hi,NQt:()=>cr,JjN:()=>ur,EK_:()=>o,V1s:()=>ln,xHm:()=>an,Xz7:()=>Ue,Cdc:()=>ns,FKn:()=>Bi,SUY:()=>Pr,ab2:()=>Fi,GfZ:()=>Li,YMS:()=>Ii,oyv:()=>ji,aUb:()=>Oi,SdD:()=>X,JUv:()=>Si,jEj:()=>Hr,TFq:()=>Ni,HDU:()=>G,R_y:()=>$,ydN:()=>ai,t50:()=>q,s$$:()=>Rn,v2G:()=>ti,Ilk:()=>St,s9i:()=>or,dxL:()=>ir,LLX:()=>rr,wA2:()=>yi,R_p:()=>Di,IQ$:()=>zn,I5F:()=>rt,X8$:()=>An,FR6:()=>W,U8o:()=>j,kbG:()=>pi,iS_:()=>Z,cGG:()=>ar,RPN:()=>Xs,skb:()=>qn,SLU:()=>te,RdJ:()=>Wi,cNu:()=>Ms,gU7:()=>Je,LSk:()=>Fs,Nmp:()=>bs,d1Y:()=>Te,xrL:()=>Ai,sRW:()=>Ri,cmV:()=>oo,qWz:()=>Rs,N0Q:()=>ks,q8b:()=>os,ynB:()=>Ui,jT9:()=>nn,wAz:()=>Nn,D4V:()=>Lr,NLr:()=>Dr,N6H:()=>tt,W1A:()=>J,JHW:()=>Qi,ZZ$:()=>Zi,v2K:()=>yn,pBf:()=>Br,vpe:()=>x,GMl:()=>n,zW2:()=>t,B0K:()=>Ve,Nv7:()=>Pe,C_p:()=>Ce,MUA:()=>et,xqU:()=>Q,pTp:()=>Ds,vUK:()=>v,j9l:()=>Ls,Zxw:()=>Vs,v51:()=>Us,Hdx:()=>xs,Z$d:()=>fs,iqV:()=>Er,o$7:()=>lr,olM:()=>It,Zm$:()=>w,$QH:()=>E,i78:()=>P,nJg:()=>st,h6u:()=>z,hts:()=>O,j88:()=>L,VME:()=>B,fy2:()=>it,nt:()=>Zr,Ukr:()=>dr,zsu:()=>Gt,oA6:()=>is,TVh:()=>On,TwZ:()=>ts,GTT:()=>es,xxj:()=>Gn,XdK:()=>U,Jmb:()=>Xt,cXo:()=>Zt,Dm5:()=>K,IIB:()=>s,ebW:()=>Ir,zI0:()=>ui,LYD:()=>Yn,cEG:()=>Zn,SEl:()=>Nr,t9V:()=>zr,ez5:()=>lt,N1d:()=>ht,R8U:()=>d,SKZ:()=>b,__J:()=>Or,RI$:()=>on,x12:()=>io,ccz:()=>Mi,aNw:()=>Ze,XrL:()=>Ye,xwn:()=>sn,dNK:()=>en,ini:()=>c,YdH:()=>nt,F5T:()=>ye,y3G:()=>zt,l57:()=>At,xn0:()=>We,t2V:()=>Bs,uxB:()=>Ci,cpd:()=>Pn,fiy:()=>cs,$XZ:()=>us,UG6:()=>vr,uqK:()=>$e,STE:()=>Ge,y$z:()=>wi,mAD:()=>Qn,sOq:()=>Ei,hUw:()=>qs,_0G:()=>Vr,Sqs:()=>eo,hpZ:()=>Wn,Vol:()=>$n,vYX:()=>Vn,wIZ:()=>gi,cBi:()=>hr,c30:()=>Jn,MPV:()=>xr,RFv:()=>rs,Ux6:()=>pr,rxy:()=>Sr,I$c:()=>f,kfC:()=>Xn,VjY:()=>br,mgq:()=>so,YVA:()=>Vi,Kgp:()=>_e,HH$:()=>H,M_d:()=>R,rgh:()=>A,Ra6:()=>F,KhR:()=>S,BS5:()=>D,xhz:()=>V,xOq:()=>k,a9j:()=>T,bHk:()=>M,CgK:()=>C,cuY:()=>I,kvE:()=>Pi,SBu:()=>pe,AE_:()=>wn,ctO:()=>bn,OLH:()=>rn,kky:()=>ut,nSF:()=>Ne,zHn:()=>ki,zwx:()=>kn,AeJ:()=>ss,hLz:()=>Ki,D9g:()=>_n,wA:()=>ls,jhr:()=>hs,GVs:()=>ke,_zO:()=>jt,LXZ:()=>Ht,w6$:()=>Es,mhV:()=>Ss,MOD:()=>ds,kwd:()=>Ts,Lmr:()=>Ps,xsS:()=>er,K5l:()=>tr,lLr:()=>Re,Z$r:()=>ot,IXb:()=>$s,SGH:()=>nr,SMj:()=>Mr,L34:()=>ro,exe:()=>oe,bnF:()=>Hi,MFA:()=>Pt,$uU:()=>Ke,Sap:()=>Xe,jyi:()=>qt,E03:()=>Jt,V6q:()=>Qt,rg2:()=>Tr,DVW:()=>He,nVo:()=>Qs,F6N:()=>to,xP7:()=>fn,Odq:()=>Cn,Zif:()=>dn,ZGJ:()=>xi,MJk:()=>Ar,xvT:()=>Hs,PHM:()=>ms,dpR:()=>Yt,n9L:()=>Zs,KwO:()=>Ys,SxM:()=>Ks,B7y:()=>Gs,x7r:()=>Rr,wx7:()=>vi,Uvn:()=>bi,OFT:()=>Ti,xzN:()=>un,CcZ:()=>hn,M5Z:()=>dt,ZrN:()=>m,OWs:()=>bt,dF9:()=>mi,oZy:()=>ae,rD2:()=>le,VHo:()=>N,ohE:()=>De,R$E:()=>je,xQN:()=>mr,AdJ:()=>fr,q3I:()=>Sn,Pab:()=>mt,uZ5:()=>gt,McK:()=>y,F9c:()=>pt,k0b:()=>Ji,hnT:()=>Wr,RSJ:()=>Xr,Mku:()=>Gr,h90:()=>Yr,rms:()=>Kr,ErP:()=>jr,aVg:()=>qr,lPc:()=>$r,Z8E:()=>Xi,_N2:()=>mn,yFn:()=>vn,lNv:()=>Yi,cu9:()=>Ws,MZQ:()=>ii,FUM:()=>oi,BxR:()=>we,vdf:()=>xt,iaL:()=>wt,w6H:()=>yt,Q4c:()=>ni,Xxe:()=>ft,Uxb:()=>_t,Yr5:()=>vt,Bhw:()=>Ct,yOA:()=>e});var t={};Gx.r(t),Gx.d(t,{ActivateEvent:()=>Y,CollisionEndEvent:()=>X,CollisionPostSolveEvent:()=>G,CollisionPreSolveEvent:()=>$,CollisionStartEvent:()=>q,ContactEndEvent:()=>W,ContactStartEvent:()=>j,DeactivateEvent:()=>Z,EnterTriggerEvent:()=>tt,EnterViewPortEvent:()=>J,EventTypes:()=>n,ExitTriggerEvent:()=>et,ExitViewPortEvent:()=>Q,GameEvent:()=>w,GameStartEvent:()=>E,GameStopEvent:()=>P,GamepadAxisEvent:()=>z,GamepadButtonEvent:()=>O,GamepadConnectEvent:()=>L,GamepadDisconnectEvent:()=>B,HiddenEvent:()=>U,InitializeEvent:()=>K,KillEvent:()=>b,PostCollisionEvent:()=>H,PostDebugDrawEvent:()=>R,PostDrawEvent:()=>A,PostFrameEvent:()=>F,PostKillEvent:()=>S,PostUpdateEvent:()=>D,PreCollisionEvent:()=>V,PreDebugDrawEvent:()=>k,PreDrawEvent:()=>T,PreFrameEvent:()=>M,PreKillEvent:()=>C,PreUpdateEvent:()=>I,VisibleEvent:()=>N});var e={};Gx.r(e),Gx.d(e,{getAttributeComponentSize:()=>ne,getAttributePointerType:()=>re,getGlTypeSizeBytes:()=>se});var i={};Gx.r(i),Gx.d(i,{circle:()=>Oe,line:()=>Me,point:()=>Fe,roundRect:()=>Be,vector:()=>Le});var s={};Gx.r(s),Gx.d(s,{Axes:()=>l,Buttons:()=>o,Gamepad:()=>st,Gamepads:()=>it,KeyEvent:()=>lt,Keyboard:()=>ht,Keys:()=>d,NativePointerButton:()=>vr,PointerButton:()=>xr,PointerComponent:()=>rs,PointerEvent:()=>pr,PointerEventReceiver:()=>Sr,PointerScope:()=>f,PointerSystem:()=>Xn,PointerType:()=>br,WheelDeltaMode:()=>mr,WheelEvent:()=>fr});var n,r,o,a,l,h,c,u,d,p,f,g,m={};function _(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){const t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){return new Promise(((i,s)=>{t.call(this,e,i,s)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}Gx.r(m),Gx.d(m,{ConsoleAppender:()=>rt,DrawUtil:()=>i,EasingFunctions:()=>os,LogLevel:()=>c,Logger:()=>nt,Observable:()=>wi,ScreenAppender:()=>ot,addItemToArray:()=>Mt,contains:()=>Lt,delay:()=>Ot,fail:()=>Bt,getPosition:()=>Dt,removeItemFromArray:()=>Ft}),Gx(4662),Gx(8343);class v{static useCanvasGraphicsContext(){v.enable("use-canvas-context")}static freeze(){v._FROZEN=!0}static _reset(){v._FROZEN=!1,v._FLAGS={}}static enable(t){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");v._FLAGS[t]=!0}static disable(t){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");v._FLAGS[t]=!1}static isEnabled(t){return!!v._FLAGS[t]}static show(){return Object.keys(v._FLAGS)}}function y(t,e){return{type:t,value:e}}v._FROZEN=!1,v._FLAGS={};class x{constructor(){this._paused=!1,this._listeners={},this._listenersOnce={},this._pipes=[]}clear(){this._listeners={},this._listenersOnce={},this._pipes.length=0}on(t,e){var i;return this._listeners[t]=null!==(i=this._listeners[t])&&void 0!==i?i:[],this._listeners[t].push(e),{close:()=>this.off(t,e)}}once(t,e){var i;return this._listenersOnce[t]=null!==(i=this._listenersOnce[t])&&void 0!==i?i:[],this._listenersOnce[t].push(e),{close:()=>this.off(t,e)}}off(t,e){var i,s,n,r;if(e){const o=null===(i=this._listeners[t])||void 0===i?void 0:i.indexOf(e);o>-1&&(null===(s=this._listeners[t])||void 0===s||s.splice(o,1));const a=null===(n=this._listenersOnce[t])||void 0===n?void 0:n.indexOf(e);a>-1&&(null===(r=this._listenersOnce[t])||void 0===r||r.splice(a,1))}else delete this._listeners[t]}emit(t,e){var i;if(this._paused)return;null===(i=this._listeners[t])||void 0===i||i.forEach((t=>t(e)));const s=this._listenersOnce[t];this._listenersOnce[t]=[],s&&s.forEach((t=>t(e))),this._pipes.forEach((i=>{i.emit(t,e)}))}pipe(t){if(this===t)throw Error("Cannot pipe to self");return this._pipes.push(t),{close:()=>{const e=this._pipes.indexOf(t);e>-1&&this._pipes.splice(e,1)}}}unpipe(t){const e=this._pipes.indexOf(t);e>-1&&this._pipes.splice(e,1)}pause(){this._paused=!0}unpause(){this._paused=!1}}(r=n||(n={})).Kill="kill",r.PreKill="prekill",r.PostKill="postkill",r.PreDraw="predraw",r.PostDraw="postdraw",r.PreDebugDraw="predebugdraw",r.PostDebugDraw="postdebugdraw",r.PreUpdate="preupdate",r.PostUpdate="postupdate",r.PreFrame="preframe",r.PostFrame="postframe",r.PreCollision="precollision",r.CollisionStart="collisionstart",r.CollisionEnd="collisionend",r.PostCollision="postcollision",r.Initialize="initialize",r.Activate="activate",r.Deactivate="deactivate",r.ExitViewport="exitviewport",r.EnterViewport="enterviewport",r.ExitTrigger="exit",r.EnterTrigger="enter",r.Connect="connect",r.Disconnect="disconnect",r.Button="button",r.Axis="axis",r.Visible="visible",r.Hidden="hidden",r.Start="start",r.Stop="stop",r.PointerUp="pointerup",r.PointerDown="pointerdown",r.PointerMove="pointermove",r.PointerEnter="pointerenter",r.PointerLeave="pointerleave",r.PointerCancel="pointercancel",r.PointerWheel="pointerwheel",r.Up="up",r.Down="down",r.Move="move",r.Enter="enter",r.Leave="leave",r.Cancel="cancel",r.Wheel="wheel",r.Press="press",r.Release="release",r.Hold="hold",r.PointerDragStart="pointerdragstart",r.PointerDragEnd="pointerdragend",r.PointerDragEnter="pointerdragenter",r.PointerDragLeave="pointerdragleave",r.PointerDragMove="pointerdragmove";class w{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(t){this._bubbles=t}stopPropagation(){this.bubbles=!1}}class b extends w{constructor(t){super(),this.target=t}}class C extends w{constructor(t){super(),this.target=t}}class S extends w{constructor(t){super(),this.target=t}}class E extends w{constructor(t){super(),this.target=t}}class P extends w{constructor(t){super(),this.target=t}}class T extends w{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class A extends w{constructor(t,e,i){super(),this.ctx=t,this.delta=e,this.target=i}}class k extends w{constructor(t,e){super(),this.ctx=t,this.target=e}}class R extends w{constructor(t,e){super(),this.ctx=t,this.target=e}}class I extends w{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class D extends w{constructor(t,e,i){super(),this.engine=t,this.delta=e,this.target=i}}class M extends w{constructor(t,e){super(),this.engine=t,this.prevStats=e,this.target=t}}class F extends w{constructor(t,e){super(),this.engine=t,this.stats=e,this.target=t}}class L extends w{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class B extends w{constructor(t,e){super(),this.index=t,this.gamepad=e,this.target=e}}class O extends w{constructor(t,e,i){super(),this.button=t,this.value=e,this.target=i}}class z extends w{constructor(t,e,i){super(),this.axis=t,this.value=e,this.target=i}}class N extends w{constructor(t){super(),this.target=t}}class U extends w{constructor(t){super(),this.target=t}}class V extends w{constructor(t,e,i,s){super(),this.other=e,this.side=i,this.intersection=s,this.target=t}}class H extends w{constructor(t,e,i,s){super(),this.other=e,this.side=i,this.intersection=s,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class j{constructor(t,e,i){this.target=t,this.other=e,this.contact=i}}class W{constructor(t,e){this.target=t,this.other=e}}class ${constructor(t,e,i,s,n){this.target=t,this.other=e,this.side=i,this.intersection=s,this.contact=n}}class G{constructor(t,e,i,s,n){this.target=t,this.other=e,this.side=i,this.intersection=s,this.contact=n}}class q extends w{constructor(t,e,i){super(),this.other=e,this.contact=i,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class X extends w{constructor(t,e){super(),this.other=e,this.target=t}get actor(){return this.target}set actor(t){this.target=t}}class K extends w{constructor(t,e){super(),this.engine=t,this.target=e}}class Y extends w{constructor(t,e){super(),this.context=t,this.target=e}}class Z extends w{constructor(t,e){super(),this.context=t,this.target=e}}class Q extends w{constructor(t){super(),this.target=t}}class J extends w{constructor(t){super(),this.target=t}}class tt extends w{constructor(t,e){super(),this.target=t,this.actor=e}}class et extends w{constructor(t,e){super(),this.target=t,this.actor=e}}class it{constructor(){this.events=new x,this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}setMinimumGamepadConfiguration(t){this._enableAndUpdate(),this._minimumConfiguration=t}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;const e=t.axes.filter((t=>void 0!==typeof t)).length,i=t.buttons.filter((t=>void 0!==typeof t)).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected}emit(t,e){this.events.emit(t,e)}on(t,e){return this._enableAndUpdate(),this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this._enableAndUpdate(),this.events.off(t,e)}update(){if(!this.enabled||!this.supported)return;this.init();const t=this._navigator.getGamepads();for(let e=0;e<t.length;e++){if(!t[e]){const t=this.at(e);t.connected&&this.events.emit("disconnect",new B(e,t)),t.connected=!1;continue}if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.events.emit("connect",new L(e,this.at(e))),this.at(e).connected=!0,this.at(e).update(),t[e].timestamp&&t[e].timestamp===this._gamePadTimeStamps[e])continue;let i,s,n,r,a;for(i in this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e],o)s=o[i],"number"==typeof s&&t[e].buttons[s]&&(a=t[e].buttons[s].value,a!==this._oldPads[e].getButton(s)&&(t[e].buttons[s].pressed?(this.at(e).updateButton(s,a),this.at(e).events.emit("button",new O(s,a,this.at(e)))):this.at(e).updateButton(s,0)));for(n in l)r=l[n],"number"==typeof r&&(a=t[e].axes[r],a!==this._oldPads[e].getAxes(r)&&(this.at(e).updateAxes(r,a),this.at(e).events.emit("axis",new z(r,a,this.at(e)))));this._oldPads[e]=this._clonePad(t[e])}}at(t){if(this._enableAndUpdate(),t>=this._pads.length)for(let e=this._pads.length-1,i=t;e<i;e++)this._pads.push(new st),this._oldPads.push(new st);return this._pads[t]}getValidGamepads(){this._enableAndUpdate();const t=[];for(let e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}count(){return this._pads.filter((t=>t.connected)).length}_clonePads(t){const e=[];for(let i=0,s=t.length;i<s;i++)e.push(this._clonePad(t[i]));return e}_clonePad(t){let e,i;const s=new st;if(!t)return s;for(e=0,i=t.buttons.length;e<i;e++)t.buttons[e]&&s.updateButton(e,t.buttons[e].value);for(e=0,i=t.axes.length;e<i;e++)s.updateAxes(e,t.axes[e]);return s}}it.MinAxisMoveThreshold=.05;class st{constructor(){this.events=new x,this.connected=!1,this._axes=new Array(4),this._buttons=new Array(16),this._buttonsUp=new Array(16),this._buttonsDown=new Array(16);for(let t=0;t<this._buttons.length;t++)this._buttons[t]=0;for(let t=0;t<this._axes.length;t++)this._axes[t]=0}update(){this._buttonsDown=new Array(16),this._buttonsUp=new Array(16)}isButtonPressed(t,e=1){return this._buttons[t]>=e}isButtonHeld(t,e=1){return this._buttons[t]>=e}wasButtonPressed(t,e=1){return this._buttonsDown[t]>=e}wasButtonReleased(t){return Boolean(this._buttonsUp[t])}getButton(t){return this._buttons[t]}getAxes(t){const e=this._axes[t];return Math.abs(e)<it.MinAxisMoveThreshold?0:e}updateButton(t,e){0===e&&this._buttons[t]?this._buttonsUp[t]=1:this._buttonsDown[t]=e,this._buttons[t]=e}updateAxes(t,e){this._axes[t]=e}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}(a=o||(o={}))[a.Face1=0]="Face1",a[a.Face2=1]="Face2",a[a.Face3=2]="Face3",a[a.Face4=3]="Face4",a[a.LeftBumper=4]="LeftBumper",a[a.RightBumper=5]="RightBumper",a[a.LeftTrigger=6]="LeftTrigger",a[a.RightTrigger=7]="RightTrigger",a[a.Select=8]="Select",a[a.Start=9]="Start",a[a.LeftStick=10]="LeftStick",a[a.RightStick=11]="RightStick",a[a.DpadUp=12]="DpadUp",a[a.DpadDown=13]="DpadDown",a[a.DpadLeft=14]="DpadLeft",a[a.DpadRight=15]="DpadRight",(h=l||(l={}))[h.LeftStickX=0]="LeftStickX",h[h.LeftStickY=1]="LeftStickY",h[h.RightStickX=2]="RightStickX",h[h.RightStickY=3]="RightStickY",(u=c||(c={}))[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warn=2]="Warn",u[u.Error=3]="Error",u[u.Fatal=4]="Fatal";class nt{constructor(){if(this._appenders=[],this.defaultLevel=c.Info,nt._INSTANCE)throw new Error("Logger is a singleton");return nt._INSTANCE=this,nt._INSTANCE.addAppender(new rt),nt._INSTANCE}static getInstance(){return null==nt._INSTANCE&&(nt._INSTANCE=new nt),nt._INSTANCE}addAppender(t){this._appenders.push(t)}clearAppenders(){this._appenders.length=0}_log(t,e){null==t&&(t=this.defaultLevel);const i=this._appenders.length;for(let s=0;s<i;s++)t>=this.defaultLevel&&this._appenders[s].log(t,e)}debug(...t){this._log(c.Debug,t)}info(...t){this._log(c.Info,t)}warn(...t){this._log(c.Warn,t)}error(...t){this._log(c.Error,t)}fatal(...t){this._log(c.Fatal,t)}}nt._INSTANCE=null;class rt{log(t,e){if(!console&&!console.log&&console.warn&&console.error)return;const i=[];i.unshift.apply(i,e),i.unshift("["+c[t]+"] : "),t<c.Warn?console.log.apply?console.log.apply(console,i):console.log(i.join(" ")):t<c.Error?console.warn.apply?console.warn.apply(console,i):console.warn(i.join(" ")):console.error.apply?console.error.apply(console,i):console.error(i.join(" "))}}class ot{constructor(t,e){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=t||window.innerWidth,this._canvas.height=e||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}log(t,e){const i=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+c[t]+"] : "+i);let s=10,n=1;for(let r=0;r<this._messages.length;r++)this._ctx.fillStyle="rgba(255,255,255,"+n.toFixed(2)+")",this._ctx.fillText(this._messages[r],200,s),s+=10,n=n>0?n-.05:0}}function at(){try{const t=()=>{};window.top.addEventListener("blur",t),window.top.removeEventListener("blur",t)}catch(_b){return!0}return!1}(p=d||(d={})).Num0="Numpad0",p.Num1="Numpad1",p.Num2="Numpad2",p.Num3="Numpad3",p.Num4="Numpad4",p.Num5="Numpad5",p.Num6="Numpad6",p.Num7="Numpad7",p.Num8="Numpad8",p.Num9="Numpad9",p.NumAdd="NumpadAdd",p.NumSubtract="NumpadSubtract",p.NumMultiply="NumpadMultiply",p.NumDivide="NumpadDivide",p.NumDecimal="NumpadDecimal",p.Numpad0="Numpad0",p.Numpad1="Numpad1",p.Numpad2="Numpad2",p.Numpad3="Numpad3",p.Numpad4="Numpad4",p.Numpad5="Numpad5",p.Numpad6="Numpad6",p.Numpad7="Numpad7",p.Numpad8="Numpad8",p.Numpad9="Numpad9",p.NumpadAdd="NumpadAdd",p.NumpadSubtract="NumpadSubtract",p.NumpadMultiply="NumpadMultiply",p.NumpadDivide="NumpadDivide",p.NumpadDecimal="NumpadDecimal",p.NumLock="NumLock",p.ShiftLeft="ShiftLeft",p.ShiftRight="ShiftRight",p.AltLeft="AltLeft",p.AltRight="AltRight",p.ControlLeft="ControlLeft",p.ControlRight="ControlRight",p.MetaLeft="MetaLeft",p.MetaRight="MetaRight",p.Key0="Digit0",p.Key1="Digit1",p.Key2="Digit2",p.Key3="Digit3",p.Key4="Digit4",p.Key5="Digit5",p.Key6="Digit6",p.Key7="Digit7",p.Key8="Digit8",p.Key9="Digit9",p.Digit0="Digit0",p.Digit1="Digit1",p.Digit2="Digit2",p.Digit3="Digit3",p.Digit4="Digit4",p.Digit5="Digit5",p.Digit6="Digit6",p.Digit7="Digit7",p.Digit8="Digit8",p.Digit9="Digit9",p.F1="F1",p.F2="F2",p.F3="F3",p.F4="F4",p.F5="F5",p.F6="F6",p.F7="F7",p.F8="F8",p.F9="F9",p.F10="F10",p.F11="F11",p.F12="F12",p.A="KeyA",p.B="KeyB",p.C="KeyC",p.D="KeyD",p.E="KeyE",p.F="KeyF",p.G="KeyG",p.H="KeyH",p.I="KeyI",p.J="KeyJ",p.K="KeyK",p.L="KeyL",p.M="KeyM",p.N="KeyN",p.O="KeyO",p.P="KeyP",p.Q="KeyQ",p.R="KeyR",p.S="KeyS",p.T="KeyT",p.U="KeyU",p.V="KeyV",p.W="KeyW",p.X="KeyX",p.Y="KeyY",p.Z="KeyZ",p.KeyA="KeyA",p.KeyB="KeyB",p.KeyC="KeyC",p.KeyD="KeyD",p.KeyE="KeyE",p.KeyF="KeyF",p.KeyG="KeyG",p.KeyH="KeyH",p.KeyI="KeyI",p.KeyJ="KeyJ",p.KeyK="KeyK",p.KeyL="KeyL",p.KeyM="KeyM",p.KeyN="KeyN",p.KeyO="KeyO",p.KeyP="KeyP",p.KeyQ="KeyQ",p.KeyR="KeyR",p.KeyS="KeyS",p.KeyT="KeyT",p.KeyU="KeyU",p.KeyV="KeyV",p.KeyW="KeyW",p.KeyX="KeyX",p.KeyY="KeyY",p.KeyZ="KeyZ",p.Semicolon="Semicolon",p.Quote="Quote",p.Comma="Comma",p.Minus="Minus",p.Period="Period",p.Slash="Slash",p.Equal="Equal",p.BracketLeft="BracketLeft",p.Backslash="Backslash",p.BracketRight="BracketRight",p.Backquote="Backquote",p.Up="ArrowUp",p.Down="ArrowDown",p.Left="ArrowLeft",p.Right="ArrowRight",p.ArrowUp="ArrowUp",p.ArrowDown="ArrowDown",p.ArrowLeft="ArrowLeft",p.ArrowRight="ArrowRight",p.Space="Space",p.Backspace="Backspace",p.Delete="Delete",p.Esc="Escape",p.Escape="Escape",p.Enter="Enter",p.NumpadEnter="NumpadEnter",p.ContextMenu="ContextMenu";class lt extends w{constructor(t,e,i){super(),this.key=t,this.value=e,this.originalEvent=i}}class ht{constructor(){this.events=new x,this._keys=[],this._keysUp=[],this._keysDown=[],this._releaseAllKeys=t=>{for(const e of this._keys){const i=new lt(e,t.key,t);this.events.emit("up",i),this.events.emit("release",i)}this._keysUp=Array.from(new Set(this._keys.concat(this._keysUp))),this._keys.length=0},this._handleKeyDown=t=>{t.metaKey||!this._keys.includes(d.MetaLeft)&&!this._keys.includes(d.MetaRight)||this._releaseAllKeys(t);const e=t.code;if(-1===this._keys.indexOf(e)){this._keys.push(e),this._keysDown.push(e);const i=new lt(e,t.key,t);this.events.emit("down",i),this.events.emit("press",i)}},this._handleKeyUp=t=>{const e=t.code,i=this._keys.indexOf(e);this._keys.splice(i,1),this._keysUp.push(e);const s=new lt(e,t.key,t);this.events.emit("up",s),this.events.emit("release",s),"Meta"===t.key&&this._releaseAllKeys(t)}}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}init(t){let{global:e}=t;const{grabWindowFocus:i}=t;e||(at()?(e=window,i&&window.focus(),nt.getInstance().warn("Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus")):e=window.top),e.addEventListener("blur",(()=>{this._keys.length=0})),e.addEventListener("keyup",this._handleKeyUp),e.addEventListener("keydown",this._handleKeyDown)}update(){this._keysDown.length=0,this._keysUp.length=0;for(let t=0;t<this._keys.length;t++)this.events.emit("hold",new lt(this._keys[t]))}getKeys(){return this._keys}wasPressed(t){return this._keysDown.indexOf(t)>-1}isHeld(t){return this._keys.indexOf(t)>-1}wasReleased(t){return this._keysUp.indexOf(t)>-1}triggerEvent(t,e,i){"down"===t&&this._handleKeyDown(new KeyboardEvent("keydown",{code:e,key:null!=i?i:null})),"up"===t&&this._handleKeyUp(new KeyboardEvent("keyup",{code:e,key:null!=i?i:null}))}}(g=f||(f={})).Canvas="Canvas",g.Document="Document";const ct=4294967295;class ut{constructor(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(let e=1;e<this._n;e++){const t=this._mt[e-1]^this._mt[e-1]>>>this._w-2;this._mt[e]=(this._f*((4294901760&t)>>>16)<<16)+this._f*(65535&t)+e>>>0}this._index=this._n}_twist(){const t=[0,this._a];let e=0,i=0;for(;i<this._n-this._m;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^e>>>1^t[1&e]&ct;for(;i<this._n-1;i++)e=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^e>>>1^t[1&e]&ct;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&ct,this._index=0}nextInt(){this._index>=this._n&&this._twist();let t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,t^=t>>>this._l,t>>>0}next(){return this.nextInt()*(1/4294967296)}floating(t,e){return(e-t)*this.next()+t}integer(t,e){return Math.floor((e-t+1)*this.next()+t)}bool(t=.5){return this.next()<=t}pickOne(t){return t[this.integer(0,t.length-1)]}pickSet(t,e,i=!1){return i?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}_pickSetWithoutDuplicates(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;const i=new Array(e);let s=0;const n=t.slice(0);for(;s<e;){const t=this.integer(0,n.length-1);i[s++]=n[t],n.splice(t,1)}return i}_pickSetWithDuplicates(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const i=new Array(e);for(let s=0;s<e;s++)i[s]=this.pickOne(t);return i}shuffle(t){const e=t.slice(0);let i=null;for(let s=0;s<e.length-2;s++){const t=this.integer(s,e.length-1);i=e[s],e[s]=e[t],e[t]=i}return e}range(t,e,i){const s=new Array(t);for(let n=0;n<t;n++)s[n]=this.integer(e,i);return s}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const dt=2*Math.PI;function pt(t){return t>=0?t-Math.floor(t):t-Math.ceil(t)}function ft(t){return 0===t?0:t<0?-1:1}function gt(t,e,i){return Math.min(Math.max(e,t),i)}function mt(t){let e=t;if(t>dt)for(;e>dt;)e-=dt;if(t<0)for(;e<0;)e+=dt;return e}function _t(t){return 180/Math.PI*t}function vt(t){return t/180*Math.PI}const yt=(t,e)=>Array.from(new Array(e-t+1),((e,i)=>i+t));function xt(t,e,i=new ut){return i?i.floating(t,e):t+Math.random()*(e-t)}function wt(t,e,i=new ut){return i?i.integer(t,e):Math.round(xt(t,e))}class bt{static get Zero(){return new bt(0,0)}static get One(){return new bt(1,1)}static get Half(){return new bt(.5,.5)}static get Up(){return new bt(0,-1)}static get Down(){return new bt(0,1)}static get Left(){return new bt(-1,0)}static get Right(){return new bt(1,0)}static fromAngle(t){return new bt(Math.cos(t),Math.sin(t))}static isValid(t){return null!=t&&(!isNaN(t.x)&&!isNaN(t.y)&&(t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0))}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static min(t,e){return new bt(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new bt(Math.max(t.x,e.x),Math.max(t.y,e.y))}constructor(t,e){this._x=0,this._y=0,this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}setTo(t,e){this.x=t,this.y=e}equals(t,e=.001){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}distance(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}squareDistance(t){t||(t=bt.Zero);const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}clampMagnitude(t){const e=gt(this.size,0,t);return this.size=e,this}get size(){return this.distance()}set size(t){const e=this.normalize().scale(t);this.setTo(e.x,e.y)}normalize(){const t=this.distance();return t>0?new bt(this.x/t,this.y/t):new bt(0,1)}average(t){return this.add(t).scale(.5)}scale(t,e){const i=e||new bt(0,0);return t instanceof bt?(i.x=this.x*t.x,i.y=this.y*t.y):(i.x=this.x*t,i.y=this.y*t),i}add(t,e){return e?(e.x=this.x+t.x,e.y=this.y+t.y,e):new bt(this.x+t.x,this.y+t.y)}sub(t){return new bt(this.x-t.x,this.y-t.y)}addEqual(t){return this.setTo(this.x+t.x,this.y+t.y),this}subEqual(t){return this.setTo(this.x-t.x,this.y-t.y),this}scaleEqual(t){return this.setTo(this.x*t,this.y*t),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return t instanceof bt?this.x*t.y-this.y*t.x:"number"==typeof t?new bt(t*this.y,-t*this.x):void 0}static cross(t,e){return new bt(-t*e.y,t*e.x)}perpendicular(){return new bt(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return Math.atan2(this.y,this.x)}rotate(t,e){e||(e=new bt(0,0));const i=Math.sin(t),s=Math.cos(t),n=s*(this.x-e.x)-i*(this.y-e.y)+e.x,r=i*(this.x-e.x)+s*(this.y-e.y)+e.y;return new bt(n,r)}clone(t){const e=null!=t?t:new bt(0,0);return e.x=this.x,e.y=this.y,e}toString(t){return t?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`}}function Ct(t,e){return new bt(t,e)}class St{constructor(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=null!=s?s:1}static fromRGB(t,e,i,s){return new St(t,e,i,s)}static fromRGBString(t){let e=null;if(e=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){const t=parseInt(e[1],10),i=parseInt(e[2],10),s=parseInt(e[3],10);let n=1;return e[4]&&(n=parseFloat(e[4])),new St(t,i,s,n)}throw new Error("Invalid rgb/a string: "+t)}static fromHex(t){let e=null;if(e=t.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){const t=parseInt(e[1],16),i=parseInt(e[2],16),s=parseInt(e[3],16);let n=1;return e[4]&&(n=parseInt(e[4],16)/255),new St(t,i,s,n)}throw new Error("Invalid hex string: "+t)}static fromHSL(t,e,i,s=1){return new Et(t,e,i,s).toRGBA()}lighten(t=.1){const e=Et.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}darken(t=.1){const e=Et.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}saturate(t=.1){const e=Et.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}desaturate(t=.1){const e=Et.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}multiply(t){const e=t.r/255*this.r/255*255,i=t.g/255*this.g/255*255,s=t.b/255*this.b/255*255,n=t.a*this.a;return new St(e,i,s,n)}screen(t){const e=t.invert(),i=t.invert();return e.multiply(i).invert()}invert(){return new St(255-this.r,255-this.g,255-this.b,1-this.a)}average(t){const e=(t.r+this.r)/2,i=(t.g+this.g)/2,s=(t.b+this.b)/2,n=(t.a+this.a)/2;return new St(e,i,s,n)}equal(t){return this.toString()===t.toString()}toString(t="rgb"){switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(t){const e=t.toString(16);return 1===e.length?"0"+e:e}toHex(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}toRGBA(){const t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}toHSLA(){return Et.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new St(this.r,this.g,this.b,this.a)}static get Black(){return St.fromHex("#000000")}static get White(){return St.fromHex("#FFFFFF")}static get Gray(){return St.fromHex("#808080")}static get LightGray(){return St.fromHex("#D3D3D3")}static get DarkGray(){return St.fromHex("#A9A9A9")}static get Yellow(){return St.fromHex("#FFFF00")}static get Orange(){return St.fromHex("#FFA500")}static get Red(){return St.fromHex("#FF0000")}static get Vermilion(){return St.fromHex("#FF5B31")}static get Rose(){return St.fromHex("#FF007F")}static get Magenta(){return St.fromHex("#FF00FF")}static get Violet(){return St.fromHex("#7F00FF")}static get Blue(){return St.fromHex("#0000FF")}static get Azure(){return St.fromHex("#007FFF")}static get Cyan(){return St.fromHex("#00FFFF")}static get Viridian(){return St.fromHex("#59978F")}static get Green(){return St.fromHex("#00FF00")}static get Chartreuse(){return St.fromHex("#7FFF00")}static get Transparent(){return St.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return St.fromHex("#176BAA")}}class Et{constructor(t,e,i,s){this.h=t,this.s=e,this.l=i,this.a=s}static hue2rgb(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}static fromRGBA(t,e,i,s){t/=255,e/=255,i/=255;const n=Math.max(t,e,i),r=Math.min(t,e,i);let o,a;const l=(n+r)/2;if(n===r)o=a=0;else{const s=n-r;switch(a=l>.5?s/(2-n-r):s/(n+r),n){case t:o=(e-i)/s+(e<i?6:0);break;case e:o=(i-t)/s+2;break;case i:o=(t-e)/s+4}o/=6}return new Et(o,a,l,s)}toRGBA(){let t,e,i;if(0===this.s)t=e=i=this.l;else{const s=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,n=2*this.l-s;t=Et.hue2rgb(n,s,this.h+1/3),e=Et.hue2rgb(n,s,this.h),i=Et.hue2rgb(n,s,this.h-1/3)}return new St(255*t,255*e,255*i,this.a)}toString(){return`hsla(${this.h.toFixed(0)}, ${this.s.toFixed(0)}, ${this.l.toFixed(0)}, ${this.a.toFixed(0)})`}}var Pt,Tt,At,kt;(Tt=Pt||(Pt={})).None="None",Tt.Top="Top",Tt.Bottom="Bottom",Tt.Left="Left",Tt.Right="Right",function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){const i=[bt.Left,bt.Right,bt.Up,bt.Down],s=[t.Left,t.Right,t.Top,t.Bottom];let n=-Number.MAX_VALUE,r=-1;for(let t=0;t<i.length;t++)i[t].dot(e)>n&&(n=i[t].dot(e),r=t);return s[r]}}(Pt||(Pt={}));class Rt{constructor(t=0,e=0,i=0,s=0){"object"==typeof t?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):"number"==typeof t&&(this.left=t,this.top=e,this.right=i,this.bottom=s)}clone(){return new Rt(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?Pt.Right:Pt.Left:t.y<0?Pt.Bottom:Pt.Top:Pt.None}static fromPoints(t){let e=1/0,i=1/0,s=-1/0,n=-1/0;for(let r=0;r<t.length;r++)t[r].x<e&&(e=t[r].x),t[r].x>s&&(s=t[r].x),t[r].y<i&&(i=t[r].y),t[r].y>n&&(n=t[r].y);return new Rt(e,i,s,n)}static fromDimension(t,e,i=bt.Half,s=bt.Zero){return new Rt(-t*i.x+s.x,-e*i.y+s.y,t-t*i.x+s.x,e-e*i.y+s.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return 0===this.width||0===this.height}get center(){return new bt((this.left+this.right)/2,(this.top+this.bottom)/2)}translate(t){return new Rt(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)}rotate(t,e=bt.Zero){const i=this.getPoints().map((i=>i.rotate(t,e)));return Rt.fromPoints(i)}scale(t,e=bt.Zero){const i=this.translate(e);return new Rt(i.left*t.x,i.top*t.y,i.right*t.x,i.bottom*t.y)}transform(t){const e=t.data[0]*this.left,i=t.data[1]*this.left,s=t.data[0]*this.right,n=t.data[1]*this.right,r=t.data[2]*this.top,o=t.data[3]*this.top,a=t.data[2]*this.bottom,l=t.data[3]*this.bottom,h=t.getPosition(),c=Math.min(e,s)+Math.min(r,a)+h.x,u=Math.min(i,n)+Math.min(o,l)+h.y,d=Math.max(e,s)+Math.max(r,a)+h.x,p=Math.max(i,n)+Math.max(o,l)+h.y;return new Rt({left:c,top:u,right:d,bottom:p})}getPerimeter(){return 2*(this.width+this.height)}getPoints(){const t=[];return t.push(new bt(this.left,this.top)),t.push(new bt(this.right,this.top)),t.push(new bt(this.right,this.bottom)),t.push(new bt(this.left,this.bottom)),t}rayCast(t,e=1/0){let i=-1/0,s=1/0;const n=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,r=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*n,a=(this.right-t.pos.x)*n;i=Math.min(o,a),s=Math.max(o,a);const l=(this.top-t.pos.y)*r,h=(this.bottom-t.pos.y)*r;return i=Math.max(i,Math.min(l,h)),s=Math.min(s,Math.max(l,h)),s>=Math.max(0,i)&&i<e}rayCastTime(t,e=1/0){let i=-1/0,s=1/0;const n=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,r=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,o=(this.left-t.pos.x)*n,a=(this.right-t.pos.x)*n;i=Math.min(o,a),s=Math.max(o,a);const l=(this.top-t.pos.y)*r,h=(this.bottom-t.pos.y)*r;return i=Math.max(i,Math.min(l,h)),s=Math.min(s,Math.max(l,h)),s>=Math.max(0,i)&&i<e?i:-1}contains(t){return t instanceof bt?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof Rt&&(this.left<=t.left&&this.top<=t.top&&t.bottom<=this.bottom&&t.right<=this.right)}combine(t){return new Rt(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))}get dimensions(){return new bt(this.width,this.height)}overlaps(t,e){const i=e||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);const s=this.combine(t);return s.width+i<t.width+this.width&&s.height+i<t.height+this.height}intersect(t){const e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){let e=0;e=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;let i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(e)<Math.abs(i)?new bt(e,0):new bt(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){let e=0;e=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;let i=0;return i=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(e)<Math.abs(i)?new bt(e,0):new bt(0,i)}return null}intersectWithSide(t){const e=this.intersect(t);return Rt.getSideFromIntersection(e)}draw(t,e=St.Yellow){t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}class It{constructor(){this._isCompleted=!1,this.promise=new Promise(((t,e)=>{this._resolver=t,this._rejecter=e}))}get isCompleted(){return this._isCompleted}resolve(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}reject(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}function Dt(t){let e=0,i=0;const s=t=>{e+=t.offsetLeft,t.offsetParent&&s(t.offsetParent)},n=t=>{i+=t.offsetTop,t.offsetParent&&n(t.offsetParent)};return s(t),n(t),new bt(e,i)}function Mt(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function Ft(t,e){let i=-1;return(i=e.indexOf(t))>-1&&(e.splice(i,1),!0)}function Lt(t,e){for(let i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}function Bt(t){throw new Error(t)}function Ot(t,e){var i;const s=new It;return(null!==(i=null==e?void 0:e.schedule.bind(e))&&void 0!==i?i:setTimeout)((()=>{s.resolve()}),t),s.promise}(kt=At||(At={}))[kt.X=12]="X",kt[kt.Y=13]="Y";class zt{constructor(){this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}static ortho(t,e,i,s,n,r){const o=new zt;return o.data[0]=2/(e-t),o.data[1]=0,o.data[2]=0,o.data[3]=0,o.data[4]=0,o.data[5]=2/(s-i),o.data[6]=0,o.data[7]=0,o.data[8]=0,o.data[9]=0,o.data[10]=-2/(r-n),o.data[11]=0,o.data[12]=-(e+t)/(e-t),o.data[13]=-(s+i)/(s-i),o.data[14]=-(r+n)/(r-n),o.data[15]=1,o}clone(t){const e=t||new zt;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}toDOMMatrix(){return new DOMMatrix([...this.data])}static fromFloat32Array(t){const e=new zt;return e.data=t,e}static identity(){const t=new zt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}static translation(t,e){const i=zt.identity();return i.data[12]=t,i.data[13]=e,i}static scale(t,e){const i=zt.identity();return i.data[0]=t,i.data[5]=e,i.data[10]=1,i.data[15]=1,i}static rotation(t){const e=zt.identity();return e.data[0]=Math.cos(t),e.data[4]=-Math.sin(t),e.data[1]=Math.sin(t),e.data[5]=Math.cos(t),e}multiply(t,e){if(t instanceof bt){const i=e||new bt(0,0),s=t,n=s.x*this.data[0]+s.y*this.data[4]+this.data[12],r=s.x*this.data[1]+s.y*this.data[5]+this.data[13];return i.x=n,i.y=r,i}{const i=e||new zt,s=t,n=this.data[0],r=this.data[1],o=this.data[2],a=this.data[3],l=this.data[4],h=this.data[5],c=this.data[6],u=this.data[7],d=this.data[8],p=this.data[9],f=this.data[10],g=this.data[11],m=this.data[12],_=this.data[13],v=this.data[14],y=this.data[15],x=s.data[0],w=s.data[1],b=s.data[2],C=s.data[3],S=s.data[4],E=s.data[5],P=s.data[6],T=s.data[7],A=s.data[8],k=s.data[9],R=s.data[10],I=s.data[11],D=s.data[12],M=s.data[13],F=s.data[14],L=s.data[15];i.data[0]=n*x+l*w+d*b+m*C,i.data[1]=r*x+h*w+p*b+_*C,i.data[2]=o*x+c*w+f*b+v*C,i.data[3]=a*x+u*w+g*b+y*C,i.data[4]=n*S+l*E+d*P+m*T,i.data[5]=r*S+h*E+p*P+_*T,i.data[6]=o*S+c*E+f*P+v*T,i.data[7]=a*S+u*E+g*P+y*T,i.data[8]=n*A+l*k+d*R+m*I,i.data[9]=r*A+h*k+p*R+_*I,i.data[10]=o*A+c*k+f*R+v*I,i.data[11]=a*A+u*k+g*R+y*I,i.data[12]=n*D+l*M+d*F+m*L,i.data[13]=r*D+h*M+p*F+_*L,i.data[14]=o*D+c*M+f*F+v*L,i.data[15]=a*D+u*M+g*F+y*L;const B=this.getScale();return i._scaleSignX=ft(B.x)*ft(i._scaleSignX),i._scaleSignY=ft(B.y)*ft(i._scaleSignY),i}}translate(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7],c=this.data[8],u=this.data[9],d=this.data[10],p=this.data[11],f=this.data[12],g=this.data[13],m=this.data[14],_=this.data[15];return this.data[12]=i*t+o*e+0*c+1*f,this.data[13]=s*t+a*e+0*u+1*g,this.data[14]=n*t+l*e+0*d+1*m,this.data[15]=r*t+h*e+0*p+1*_,this}setPosition(t,e){this.data[12]=t,this.data[13]=e}getPosition(){return Ct(this.data[12],this.data[13])}rotate(t){const e=this.data[0],i=this.data[1],s=this.data[2],n=this.data[3],r=this.data[4],o=this.data[5],a=this.data[6],l=this.data[7],h=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+h*r,this.data[1]=c*i+h*o,this.data[2]=c*s+h*a,this.data[3]=c*n+h*l,this.data[4]=c*r-h*e,this.data[5]=c*o-h*i,this.data[6]=c*a-h*s,this.data[7]=c*l-h*n,this}scale(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],h=this.data[7];return this.data[0]=i*t,this.data[1]=s*t,this.data[2]=n*t,this.data[3]=r*t,this.data[4]=o*e,this.data[5]=a*e,this.data[6]=l*e,this.data[7]=h*e,this}setRotation(t){const e=this.getScale(),i=Math.sin(t),s=Math.cos(t);this.data[0]=s*e.x,this.data[1]=i*e.y,this.data[4]=-i*e.x,this.data[5]=s*e.y}getRotation(){return mt(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const t=Ct(this.data[0],this.data[4]).size;return this._scaleSignX*t}getScaleY(){const t=Ct(this.data[1],this.data[5]).size;return this._scaleSignY*t}getScale(){return Ct(this.getScaleX(),this.getScaleY())}setScaleX(t){if(this._scaleX===t)return;this._scaleSignX=ft(t);const e=Ct(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t,this._scaleX=t}setScaleY(t){if(this._scaleY===t)return;this._scaleSignY=ft(t);const e=Ct(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t,this._scaleY=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(t){const e=1/this.getBasisDeterminant(),i=this.data[0],s=this.data[4],n=this.data[1],r=this.data[5],o=t||zt.identity();o.data[0]=r*e,o.data[1]=-n*e,o.data[4]=-s*e,o.data[5]=i*e;const a=this.data[12],l=this.data[13];return o.data[12]=-(a*o.data[0]+l*o.data[4]),o.data[13]=-(a*o.data[1]+l*o.data[5]),o}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}toString(){return`\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`}}class Nt{constructor(){this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const t=new Nt;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}static translation(t,e){const i=Nt.identity();return i.data[4]=t,i.data[5]=e,i}static scale(t,e){const i=Nt.identity();return i.data[0]=t,i.data[3]=e,i._scale[0]=t,i._scale[1]=e,i}static rotation(t){const e=Nt.identity();return e.data[0]=Math.cos(t),e.data[1]=Math.sin(t),e.data[2]=-Math.sin(t),e.data[3]=Math.cos(t),e}setPosition(t,e){this.data[4]=t,this.data[5]=e}getPosition(){return Ct(this.data[4],this.data[5])}rotate(t){const e=this.data[0],i=this.data[1],s=this.data[2],n=this.data[3],r=Math.sin(t),o=Math.cos(t);return this.data[0]=o*e+r*s,this.data[1]=o*i+r*n,this.data[2]=o*s-r*e,this.data[3]=o*n-r*i,this}translate(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5];return this.data[4]=i*t+n*e+o,this.data[5]=s*t+r*e+a,this}scale(t,e){const i=this.data[0],s=this.data[1],n=this.data[2],r=this.data[3];return this.data[0]=i*t,this.data[1]=s*t,this.data[2]=n*e,this.data[3]=r*e,this._scale[0]=t,this._scale[1]=e,this}determinant(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}inverse(t){const e=1/this.determinant(),i=this.data[0],s=this.data[2],n=this.data[1],r=this.data[3],o=t||Nt.identity();o.data[0]=r*e,o.data[1]=-n*e,o.data[2]=-s*e,o.data[3]=i*e;const a=this.data[4],l=this.data[5];return o.data[4]=-(a*o.data[0]+l*o.data[2]),o.data[5]=-(a*o.data[1]+l*o.data[3]),o}multiply(t,e){if(t instanceof bt){const i=e||new bt(0,0),s=t,n=s.x*this.data[0]+s.y*this.data[2]+this.data[4],r=s.x*this.data[1]+s.y*this.data[3]+this.data[5];return i.x=n,i.y=r,i}{const i=e||new Nt,s=t,n=this.data[0],r=this.data[1],o=this.data[2],a=this.data[3],l=this.data[4],h=this.data[5],c=s.data[0],u=s.data[1],d=s.data[2],p=s.data[3],f=s.data[4],g=s.data[5];i.data[0]=n*c+o*u,i.data[1]=r*c+a*u,i.data[2]=n*d+o*p,i.data[3]=r*d+a*p,i.data[4]=n*f+o*g+l,i.data[5]=r*f+a*g+h;const m=this.getScale();return i._scaleSignX=ft(m.x)*ft(i._scaleSignX),i._scaleSignY=ft(m.y)*ft(i._scaleSignY),i}}to4x4(){const t=new zt;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}setRotation(t){const e=this.getScale(),i=Math.sin(t),s=Math.cos(t);this.data[0]=s*e.x,this.data[1]=i*e.y,this.data[2]=-i*e.x,this.data[3]=s*e.y}getRotation(){return mt(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const t=Ct(this.data[0],this.data[2]).distance();return this._scaleSignX*t}getScaleY(){const t=Ct(this.data[1],this.data[3]).distance();return this._scaleSignY*t}getScale(){return Ct(this.getScaleX(),this.getScaleY())}setScaleX(t){if(t===this._scale[0])return;this._scaleSignX=ft(t);const e=Ct(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[2]=e.y*t,this._scale[0]=t}setScaleY(t){if(t===this._scale[1])return;this._scaleSignY=ft(t);const e=Ct(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[3]=e.y*t,this._scale[1]=t}setScale(t){this.setScaleX(t.x),this.setScaleY(t.y)}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&1===this.data[3]&&0===this.data[4]&&0===this.data[5]}reset(){const t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}clone(t){const e=t||new Nt;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e}toString(){return`\n[${this.data[0]} ${this.data[2]} ${this.data[4]}]\n[${this.data[1]} ${this.data[3]} ${this.data[5]}]\n[0 0 1]\n`}}class Ut{constructor(){this._transforms=[],this._currentTransform=Nt.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(t,e){return this._currentTransform.translate(t,e)}rotate(t){return this._currentTransform.rotate(t)}scale(t,e){return this._currentTransform.scale(t,e)}set current(t){this._currentTransform=t}get current(){return this._currentTransform}}class Vt{constructor(){this._states=[],this._currentState=this._getDefaultState()}_getDefaultState(){return{opacity:1,z:0,tint:St.White,material:null}}_cloneState(){return{opacity:this._currentState.opacity,z:this._currentState.z,tint:this._currentState.tint.clone(),material:this._currentState.material}}save(){this._states.push(this._currentState),this._currentState=this._cloneState()}restore(){this._currentState=this._states.pop()}get current(){return this._currentState}set current(t){this._currentState=t}}const Ht={Complete:"complete",Load:"load",LoadStart:"loadstart",Progress:"progress",Error:"error"};class jt{constructor(t,e,i=!1){this.path=t,this.responseType=e,this.bustCache=i,this.data=null,this.logger=nt.getInstance(),this.events=new x}isLoaded(){return null!==this.data}_cacheBust(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}load(){return new Promise(((t,e)=>{if(null!==this.data)return this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),void t(this.data);const i=new XMLHttpRequest;i.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),i.responseType=this.responseType,i.addEventListener("loadstart",(t=>this.events.emit("loadstart",t))),i.addEventListener("progress",(t=>this.events.emit("progress",t))),i.addEventListener("error",(t=>this.events.emit("error",t))),i.addEventListener("load",(t=>this.events.emit("load",t))),i.addEventListener("load",(()=>{if(0!==i.status&&200!==i.status)return this.logger.error("Failed to load resource ",this.path," server responded with error code",i.status),this.events.emit("error",i.response),void e(new Error(i.statusText));this.data=i.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),t(this.data)})),i.send()}))}}function Wt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,s)=>(t[i]!==s&&(t[i]=s,"string"==typeof i&&"_"!==i[0]&&e(t)),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}function $t(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:(t,i,s)=>(t[i]=s,"string"==typeof i&&"_"!==i[0]&&e(t),!0),get:(t,e)=>"__isProxy"===e||t[e]}):t}class Gt{isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(t){this._flipHorizontal=t,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(t){this._flipVertical=t,this._transformStale=!0}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._transformStale=!0}get scale(){return this._scale}set scale(t){this._scale=Wt(t,(()=>{this._transformStale=!0})),this._transformStale=!0}get origin(){return this._origin}set origin(t){this._origin=Wt(t,(()=>{this._transformStale=!0})),this._transformStale=!0}constructor(t){var e,i,s,n,r,o;this.id=Gt._ID++,this.transform=Nt.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=bt.One,this._origin=null,this._width=0,this._height=0,t&&(this.origin=null!==(e=t.origin)&&void 0!==e?e:this.origin,this.flipHorizontal=null!==(i=t.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(s=t.flipVertical)&&void 0!==s?s:this.flipVertical,this.rotation=null!==(n=t.rotation)&&void 0!==n?n:this.rotation,this.opacity=null!==(r=t.opacity)&&void 0!==r?r:this.opacity,this.scale=null!==(o=t.scale)&&void 0!==o?o:this.scale)}cloneGraphicOptions(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(t){this._width=t,this._transformStale=!0}set height(t){this._height=t,this._transformStale=!0}get localBounds(){return Rt.fromDimension(this.width,this.height,bt.Zero)}draw(t,e,i){this._preDraw(t,e,i),this._drawImage(t,0,0),this._postDraw(t)}_preDraw(t,e,i){t.save(),t.translate(e,i),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}_rotate(t){var e;const i=this.scale.x>0?1:-1,s=this.scale.y>0?1:-1,n=null!==(e=this.origin)&&void 0!==e?e:Ct(this.width/2,this.height/2);t.translate(n.x,n.y),t.rotate(this.rotation),t.scale(i,s),t.translate(-n.x,-n.y)}_flip(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}_postDraw(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}Gt._ID=0;class qt extends Gt{static from(t){return new qt({image:t})}constructor(t){var e,i;super(t),this._logger=nt.getInstance(),this._dirty=!0,this._logNotLoadedWarning=!1,this.image=t.image;const{width:s,height:n}=t;this.sourceView=null!==(e=t.sourceView)&&void 0!==e?e:{x:0,y:0,width:null!=s?s:0,height:null!=n?n:0},this.destSize=null!==(i=t.destSize)&&void 0!==i?i:{width:null!=s?s:0,height:null!=n?n:0},this._updateSpriteDimensions(),this.image.ready.then((()=>{this._updateSpriteDimensions()}))}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(t){t/=Math.abs(this.scale.x),this.destSize.width=t,super.width=Math.ceil(this.destSize.width)}set height(t){t/=Math.abs(this.scale.y),this.destSize.height=t,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var t,e,i,s,n,r;const{width:o,height:a}=this.image;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||o,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||a,this.destSize.width=(null===(i=this.destSize)||void 0===i?void 0:i.width)||(null===(s=this.sourceView)||void 0===s?void 0:s.width)||o,this.destSize.height=(null===(n=this.destSize)||void 0===n?void 0:n.height)||(null===(r=this.sourceView)||void 0===r?void 0:r.height)||a,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(t,e,i){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(t,e,i)}_drawImage(t,e,i){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,i,this.destSize.width,this.destSize.height):(this._logNotLoadedWarning||this._logger.warn(`ImageSource ${this.image.path} is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\n\nRead https://excaliburjs.com/docs/imagesource for more information.`),this._logNotLoadedWarning=!0)}clone(){return new qt({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}var Xt,Kt;(Kt=Xt||(Xt={})).Pixel="Pixel",Kt.Blended="Blended";class Yt{constructor(t){this._textureMap=new Map,this._gl=t,Yt._MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE)}get(t){return this._textureMap.get(t)}has(t){return this._textureMap.has(t)}load(t,e,i=!1){const s=this._gl;if(!s)return null;let n=null;if(this.has(t)&&(n=this.get(t)),n)return i&&(s.bindTexture(s.TEXTURE_2D,n),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t)),n;n=s.createTexture(),Yt.checkImageSizeSupportedAndLog(t),s.bindTexture(s.TEXTURE_2D,n),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const r=null!=e?e:Yt.filtering;return s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,r===Xt.Pixel?s.NEAREST:s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,r===Xt.Pixel?s.NEAREST:s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t),this._textureMap.set(t,n),n}delete(t){const e=this._gl;if(!e)return null;let i=null;this.has(t)&&(i=this.get(t),e.deleteTexture(i))}static checkImageSizeSupportedAndLog(t){var e;const i=null!==(e=t.dataset.originalSrc)&&void 0!==e?e:"internal canvas bitmap";return t.width>Yt._MAX_TEXTURE_SIZE||t.height>Yt._MAX_TEXTURE_SIZE?(Yt._LOGGER.error(`The image [${i}] provided to Excalibur is too large for the device's maximum texture size of (${Yt._MAX_TEXTURE_SIZE}x${Yt._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.\n\nImages will likely render as black rectangles.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((t.width>4096||t.height>4096)&&Yt._LOGGER.warn(`The image [${i}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).\n\nImages will likely render as black rectangles on some mobile platforms.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}Yt._LOGGER=nt.getInstance(),Yt.filtering=Xt.Blended,Yt._MAX_TEXTURE_SIZE=4096;class Zt{get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}constructor(t,e=!1,i){this.path=t,this._logger=nt.getInstance(),this.data=new Image,this._readyFuture=new It,this.ready=this._readyFuture.promise,this._resource=new jt(t,"blob",e),this.filtering=i,(t.endsWith(".svg")||t.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${t}. Fully supported: jpg, bmp, and png`)}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){if(this.isLoaded())return this.data;try{let t;if(this.path.includes("data:image/"))t=this.path;else{const e=await this._resource.load();t=URL.createObjectURL(e)}const e=new Image,i=new It;e.onload=()=>i.resolve(),e.src=t,e.setAttribute("data-original-src",this.path),await i.promise,this.data=e,Yt.checkImageSizeSupportedAndLog(this.data)}catch(t){throw`Error loading ImageSource from path '${this.path}' with error [${t.message}]`}return this.data.setAttribute("filtering",this.filtering),this._readyFuture.resolve(this.data),this.data}toSprite(){return qt.from(this)}unload(){this.data=new Image}}class Qt{constructor(t){this._logger=nt.getInstance(),this.sprites=[];const{sprites:e,rows:i,columns:s}=t;this.sprites=e,this.rows=null!=i?i:1,this.columns=null!=s?s:this.sprites.length}getSprite(t,e){if(t>=this.columns||t<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), x: ${t} should be between 0 and ${this.columns-1}`),null;if(e>=this.rows||e<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${t}, ${e}), y: ${e} should be between 0 and ${this.rows-1}`),null;const i=t+e*this.columns;return this.sprites[i]}static fromImageSourceWithSourceViews(t){const e=t.sourceViews.map((e=>new qt({image:t.image,sourceView:e})));return new Qt({sprites:e})}static fromImageSource(t){var e;const i=[];t.spacing=null!==(e=t.spacing)&&void 0!==e?e:{};const{image:s,grid:{rows:n,columns:r,spriteWidth:o,spriteHeight:a},spacing:{originOffset:l,margin:h}}=t,c={x:0,y:0,...l},u={x:0,y:0,...h};for(let d=0;d<r;d++)for(let t=0;t<n;t++)i[d+t*r]=new qt({image:s,sourceView:{x:d*o+u.x*d+c.x,y:t*a+u.y*t+c.y,width:o,height:a},destSize:{height:a,width:o}});return new Qt({sprites:i,rows:n,columns:r})}clone(){return new Qt({sprites:this.sprites.map((t=>t.clone())),rows:this.rows,columns:this.columns})}}class Jt extends Gt{constructor(t){super(t),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this._logger=nt.getInstance(),this._alreadyWarnedAlphabet=!1,this._alreadyWarnedSpriteSheet=!1;const{alphabet:e,spriteSheet:i,caseInsensitive:s,spacing:n,shadow:r}=t;this.alphabet=e,this.spriteSheet=i,this.caseInsensitive=null!=s?s:this.caseInsensitive,this.spacing=null!=n?n:this.spacing,this.shadow=null!=r?r:this.shadow}_getCharacterSprites(t){const e=[],i=this.caseInsensitive?t.toLocaleLowerCase():t,s=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let n=0;n<i.length;n++){const t=i[n];let r=s.indexOf(t);-1===r&&(r=0,this._alreadyWarnedAlphabet||(this._logger.warn(`SpriteFont - Cannot find letter '${t}' in configured alphabet '${s}'.`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedAlphabet=!0));const o=this.spriteSheet.sprites[r];o?e.push(o):this._alreadyWarnedSpriteSheet||(this._logger.warn(`SpriteFont - Cannot find sprite for '${t}' at index '${r}' in configured SpriteSheet`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedSpriteSheet=!0)}return e}measureText(t,e){const i=this._getLinesFromText(t,e),s=i.reduce(((t,e)=>t.length>e.length?t:e)),n=this._getCharacterSprites(s);let r=0,o=0;for(const a of n)r+=a.width+this.spacing,o=Math.max(o,a.height);return Rt.fromDimension(r,o*i.length,bt.Zero)}_drawImage(t,e,i,s){let n=0,r=0,o=0;const a=this._getLinesFromText(this._text,s);for(const l of a){for(const s of this._getCharacterSprites(l))s.draw(t,e+n,i+r),n+=s.width+this.spacing,o=Math.max(o,s.height);n=0,r+=o}}render(t,e,i,s,n,r){this._text=e;const o=this.measureText(e,r);this.width=o.width,this.height=o.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this._preDraw(t,s,n),this._drawImage(t,0,0,r),this._postDraw(t),t.restore()),this._preDraw(t,s,n),this._drawImage(t,0,0,r),this._postDraw(t)}clone(){return new Jt({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}_getLinesFromText(t,e){if(this._cachedText===t&&this._cachedRenderWidth===e)return this._cachedLines;const i=t.split("\n");if(null==e)return i;for(let s=0;s<i.length;s++){let t=i[s],n="";if(this.measureText(t).width>e){for(;this.measureText(t).width>e;)n=t[t.length-1]+n,t=t.slice(0,-1);i[s]=t,i[s+1]=n}}return this._cachedText=t,this._cachedLines=i,this._cachedRenderWidth=e,i}}class te{constructor(){this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}load(){return this._imageSource=new Zt(this.fontSheet),this._imageSource.load().then((()=>{this._spriteSheet=Qt.fromImageSource({image:this._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Jt({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})}))}write(t,e,i){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,null,i.x,i.y)}}class ee{constructor(t,e){this._gl=t,this._texture=e}use(){const t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}disable(){const t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}class ie{constructor(t){this.width=t.width,this.height=t.height,this._gl=t.gl,this._setupFramebuffer()}setResolution(t,e){const i=this._gl;this.width=t,this.height=e,i.bindTexture(i.TEXTURE_2D,this._frameTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null)}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupFramebuffer(){const t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const e=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return new ee(this._gl,this._frameTexture)}use(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}disable(){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}function se(t,e){switch(e){case t.FLOAT:return 4;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.BYTE:case t.UNSIGNED_BYTE:default:return 1}}function ne(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:return 1;case t.FLOAT_VEC2:return 2;case t.FLOAT_VEC3:return 3;case t.FLOAT_VEC4:return 4;case t.BYTE:case t.UNSIGNED_BYTE:case t.UNSIGNED_SHORT:case t.SHORT:default:return 1}}function re(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return t.FLOAT;case t.BYTE:return t.BYTE;case t.UNSIGNED_BYTE:return t.UNSIGNED_BYTE;case t.SHORT:return t.SHORT;case t.UNSIGNED_SHORT:return t.UNSIGNED_SHORT;default:return t.FLOAT}}class oe{get compiled(){return this._compiled}constructor(t){this._logger=nt.getInstance(),this.uniforms={},this.attributes={},this._compiled=!1;const{gl:e,vertexSource:i,fragmentSource:s}=t;this._gl=e,this.vertexSource=i,this.fragmentSource=s}use(){this._gl.useProgram(this.program),oe._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return oe._ACTIVE_SHADER_INSTANCE===this}compile(){const t=this._gl,e=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),i=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,e,i);const s=this.getAttributes();for(const r of s)this.attributes[r.name]=r;const n=this.getUniforms();for(const r of n)this.uniforms[r.name]=r;return this._compiled=!0,this.program}getUniforms(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=[];for(let s=0;s<e;s++){const e=t.getActiveUniform(this.program,s),n=t.getUniformLocation(this.program,e.name);i.push({name:e.name,glType:e.type,location:n})}return i}getAttributes(){const t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=[];for(let s=0;s<e;s++){const e=t.getActiveAttrib(this.program,s),n=t.getAttribLocation(this.program,e.name);i.push({name:e.name,glType:re(t,e.type),size:ne(t,e.type),location:n,normalized:!1})}return i}setTexture(t,e){const i=this._gl;i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,e)}setUniformInt(t,e){this.setUniform("uniform1i",t,~~e)}trySetUniformInt(t,e){return this.trySetUniform("uniform1i",t,~~e)}setUniformIntArray(t,e){this.setUniform("uniform1iv",t,e)}trySetUniformIntArray(t,e){return this.trySetUniform("uniform1iv",t,e)}setUniformBoolean(t,e){this.setUniform("uniform1i",t,e?1:0)}trySetUniformBoolean(t,e){return this.trySetUniform("uniform1i",t,e?1:0)}setUniformFloat(t,e){this.setUniform("uniform1f",t,e)}trySetUniformFloat(t,e){return this.trySetUniform("uniform1f",t,e)}setUniformFloatArray(t,e){this.setUniform("uniform1fv",t,e)}trySetUniformFloatArray(t,e){return this.trySetUniform("uniform1fv",t,e)}setUniformFloatVector(t,e){this.setUniform("uniform2f",t,e.x,e.y)}trySetUniformFloatVector(t,e){return this.trySetUniform("uniform2f",t,e.x,e.y)}setUniformFloatColor(t,e){this.setUniform("uniform4f",t,e.r/255,e.g/255,e.b/255,e.a)}trySetUniformFloatColor(t,e){return this.trySetUniform("uniform4f",t,e.r/255,e.g/255,e.b/255,e.a)}setUniformMatrix(t,e){this.setUniform("uniformMatrix4fv",t,!1,e.data)}trySetUniformMatrix(t,e){return this.trySetUniform("uniformMatrix4fv",t,!1,e.data)}setUniform(t,e,...i){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${t}:${e}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const s=this._gl.getUniformLocation(this.program,e);if(!s)throw Error(`Uniform ${t}:${e} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`);{const e=[s,...i];this._gl[t].apply(this._gl,e)}}trySetUniform(t,e,...i){if(!this._compiled)return this._logger.warn(`Must compile shader before setting a uniform ${t}:${e}`),!1;if(!this.isCurrentlyBound())return this._logger.warn("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms"),!1;const s=this._gl.getUniformLocation(this.program,e);if(!s)return!1;{const e=[s,...i];this._gl[t].apply(this._gl,e)}return!0}_createProgram(t,e,i){const s=t.createProgram();if(null===s)throw Error("Could not create graphics shader program");t.attachShader(s,e),t.attachShader(s,i),t.linkProgram(s);if(!t.getProgramParameter(s,t.LINK_STATUS))throw Error(`Could not link the program: [${t.getProgramInfoLog(s)}]`);return s}_compileShader(t,e,i){const s=t.VERTEX_SHADER===i?"vertex":"fragment",n=t.createShader(i);if(null===n)throw Error(`Could not build shader: [${e}]`);t.shaderSource(n,e),t.compileShader(n);if(!t.getShaderParameter(n,t.COMPILE_STATUS)){const i=t.getShaderInfoLog(n);throw Error(`Could not compile ${s} shader:\n\n${i}${this._processSourceForError(e,i)}`)}return n}_processSourceForError(t,e){const i=t.split("\n"),s=e.search(/\d:\d/),n=e.indexOf(" ",s),[r,o]=e.slice(s,n).split(":").map((t=>Number(t)));for(let a=0;a<i.length;a++)i[a]=`${a+1}: ${i[a]}${o===a+1?" <----- ERROR!":""}`;return"\n\nSource:\n"+i.join("\n")}}oe._ACTIVE_SHADER_INSTANCE=null;class ae{constructor(t){this.type="dynamic";const{gl:e,size:i,type:s,data:n}=t;if(this._gl=e,this.buffer=this._gl.createBuffer(),!n&&!i)throw Error("Must either provide data or a size to the VertexBuffer");this.bufferData=n||new Float32Array(i),this.type=null!=s?s:this.type,e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}upload(t){const e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),t?e.bufferSubData(e.ARRAY_BUFFER,0,this.bufferData,0,t):e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}}class le{get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}constructor(t){this._logger=nt.getInstance(),this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0;const{gl:e,shader:i,vertexBuffer:s,attributes:n}=t;this._gl=e,this._vertexBuffer=s,this._attributes=n,this._shader=i,i&&this.initialize()}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}set shader(t){t&&this._shader!==t&&(this._shader=t,this.initialize())}get shader(){return this._shader}initialize(){if(!this._shader)return;if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._layout.length=0;const t=this._shader.attributes;for(const i of this._attributes){const e=t[i[0]];if(!e)throw Error(`The attribute named: ${i[0]} size ${i[1]} not found in the shader source code:\n ${this._shader.vertexSource}`);if(e.size!==i[1])throw Error(`VertexLayout size definition for attribute: [${i[0]}, ${i[1]}], doesnt match shader source size ${e.size}:\n ${this._shader.vertexSource}`);this._layout.push(e)}let e=0;for(const i of this._layout){const t=se(this._gl,i.glType);this._vertexTotalSizeBytes+=t*i.size,e+=i.size}this._vertexBuffer.bufferData.length%e!=0&&this._logger.warn(`The vertex component size (${e})  does divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`)}use(t=!1,e){if(!this._shader)throw Error("No shader is associated with this vertex layout, a shader must be set");const i=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(e);let s=0;for(const n of this._layout)i.vertexAttribPointer(n.location,n.size,n.glType,n.normalized,this.totalVertexSizeBytes,s),i.enableVertexAttribArray(n.location),s+=se(i,n.glType)*n.size}}class he{static clear(){he.DrawCallCount=0,he.DrawnImagesCount=0}}he.DrawCallCount=0,he.DrawnImagesCount=0;class ce{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new oe({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\n\r\nout lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Color\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  fragColor = v_color;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new ae({gl:t,size:12*this._maxLines,type:"dynamic"}),this._layout=new le({gl:t,vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}draw(t,e,i){this._isFull()&&this.flush(),this._lineCount++;const s=this._context.getTransform(),n=s.multiply(t),r=s.multiply(e),o=this._vertexBuffer.bufferData;o[this._vertexIndex++]=n.x,o[this._vertexIndex++]=n.y,o[this._vertexIndex++]=i.r/255,o[this._vertexIndex++]=i.g/255,o[this._vertexIndex++]=i.b/255,o[this._vertexIndex++]=i.a,o[this._vertexIndex++]=r.x,o[this._vertexIndex++]=r.y,o[this._vertexIndex++]=i.r/255,o[this._vertexIndex++]=i.g/255,o[this._vertexIndex++]=i.b/255,o[this._vertexIndex++]=i.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return 0!==this._lineCount}flush(){if(0===this._lineCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,2*this._lineCount),he.DrawnImagesCount+=this._lineCount,he.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}class ue{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new oe({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\nin float a_size;\r\nout lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}",fragmentSource:'#version 300 es\r\n\r\nprecision mediump float;\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n  // "premultiply" the color by alpha\r\n  vec4 color = v_color;\r\n  color.a = color.a * alpha;\r\n  color.rgb = color.rgb * color.a;\r\n  fragColor = color;\r\n}'}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new ae({gl:t,size:7*this._maxPoints,type:"dynamic"}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}draw(t,e,i){this._isFull()&&this.flush(),this._pointCount++;const s=this._context.getTransform(),n=this._context.opacity,r=this._context.snapToPixel,o=s.multiply(t);r&&(o.x=~~(o.x+we),o.y=~~(o.y+we));const a=this._buffer.bufferData;a[this._vertexIndex++]=o.x,a[this._vertexIndex++]=o.y,a[this._vertexIndex++]=e.r/255,a[this._vertexIndex++]=e.g/255,a[this._vertexIndex++]=e.b/255,a[this._vertexIndex++]=e.a*n,a[this._vertexIndex++]=i*Math.max(s.getScaleX(),s.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return 0!==this._pointCount}flush(){if(0===this._pointCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),he.DrawnImagesCount+=this._pointCount,he.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}class de{constructor(t){this._gl=t,this._shader=new oe({gl:t,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\nvoid main() {\r\n  gl_Position = vec4(a_position, 0.0, 1.0);\r\n\r\n  // Pass the texcoord to the fragment shader.\r\n  v_texcoord = a_texcoord;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// The texture.\r\nuniform sampler2D u_texture;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   fragColor = texture(u_texture, v_texcoord);\r\n}"}),this._shader.compile(),this._buffer=new ae({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(t){const e=this._gl;t.getShader().use(),t.getLayout().use(),e.drawArrays(e.TRIANGLES,0,6)}renderToScreen(){const t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}class pe{constructor(t,e,i){this._logger=nt.getInstance(),this._gl=t,this.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer);const s=6*e;if(i){const i=65535,n=Math.floor((i-1)/4);this.bufferGlType=t.UNSIGNED_SHORT,this.bufferData=new Uint16Array(s),e>n&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${n}) requested quads(${e})`)}else this.bufferData=new Uint32Array(s);let n=0;for(let r=0;r<s;r+=6)this.bufferData[r+0]=n+0,this.bufferData[r+1]=n+1,this.bufferData[r+2]=n+2,this.bufferData[r+3]=n+2,this.bufferData[r+4]=n+1,this.bufferData[r+5]=n+3,n+=4;t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}bind(){const t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}}class fe{constructor(){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);const i=this._transformFragmentSource("#version 300 es\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_texcoord;\r\n\r\n// Texture index\r\nin lowp float v_textureIndex;\r\n\r\n// Textures in the current draw\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nin vec4 v_tint;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color = vec4(1.0, 0, 0, 1.0);\r\n\r\n   // GLSL is templated out to pick the right texture and set the vec4 color\r\n   %%texture_picker%%\r\n\r\n   color.rgb = color.rgb * v_opacity;\r\n   color.a = color.a * v_opacity;\r\n   fragColor = color * v_tint;\r\n}",this._maxTextures);this._shader=new oe({gl:t,fragmentSource:i,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\n// UV coordinate\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\n// Texture number\r\nin lowp float a_textureIndex;\r\nout lowp float v_textureIndex;\r\n\r\nin vec4 a_tint;\r\nout vec4 v_tint;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the tint\r\n   v_tint = a_tint;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map(((t,e)=>e))),this._buffer=new ae({gl:t,size:40*this._maxImages,type:"dynamic"}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new pe(t,this._maxImages,!0)}_transformFragmentSource(t,e){let i=t.replace("%%count%%",e.toString()),s="";for(let n=0;n<e;n++)s+=0===n?`if (v_textureIndex <= ${n}.5) {\n`:`   else if (v_textureIndex <= ${n}.5) {\n`,s+=`      color = texture(u_textures[${n}], v_texcoord);\n`,s+="   }\n";return i=i.replace("%%texture_picker%%",s),i}_addImageAsTexture(t){const e=t.getAttribute("filtering");let i=null;e!==Xt.Blended&&e!==Xt.Pixel||(i=e);const s="true"===t.getAttribute("forceUpload"),n=this._context.textureLoader.load(t,i,s);t.removeAttribute("forceUpload"),-1===this._textures.indexOf(n)&&this._textures.push(n)}_bindTextures(t){for(let e=0;e<this._maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this._textures[e]||this._textures[0])}_getTextureIdForImage(t){if(t){const e=this._context.textureLoader.get(t);return this._textures.indexOf(e)}return-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}draw(t,e,i,s,n,r,o,a,l){var h,c,u,d;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);let p=(null==t?void 0:t.width)||s||0,f=(null==t?void 0:t.height)||n||0,g=[0,0,null!==(h=null!=s?s:null==t?void 0:t.width)&&void 0!==h?h:0,null!==(c=null!=n?n:null==t?void 0:t.height)&&void 0!==c?c:0],m=[null!=e?e:1,null!=i?i:1];void 0!==r&&void 0!==o&&void 0!==a&&void 0!==l&&(g=[null!=e?e:1,null!=i?i:1,null!==(u=null!=s?s:null==t?void 0:t.width)&&void 0!==u?u:0,null!==(d=null!=n?n:null==t?void 0:t.height)&&void 0!==d?d:0],m=[r,o],p=a,f=l),e=g[0],i=g[1];const _=g[2],v=g[3],y=this._context.getTransform(),x=this._context.opacity,w=this._context.snapToPixel;let b=Ct(m[0],m[1]),C=Ct(m[0]+p,m[1]),S=Ct(m[0],m[1]+f),E=Ct(m[0]+p,m[1]+f);b=y.multiply(b),C=y.multiply(C),S=y.multiply(S),E=y.multiply(E),w&&(b.x=~~(b.x+we),b.y=~~(b.y+we),C.x=~~(C.x+we),C.y=~~(C.y+we),S.x=~~(S.x+we),S.y=~~(S.y+we),E.x=~~(E.x+we),E.y=~~(E.y+we));const P=this._context.tint,T=this._getTextureIdForImage(t),A=t.width||p,k=t.height||f,R=e/A,I=i/k,D=(e+_-.01)/A,M=(i+v-.01)/k,F=this._layout.vertexBuffer.bufferData;F[this._vertexIndex++]=b.x,F[this._vertexIndex++]=b.y,F[this._vertexIndex++]=x,F[this._vertexIndex++]=R,F[this._vertexIndex++]=I,F[this._vertexIndex++]=T,F[this._vertexIndex++]=P.r/255,F[this._vertexIndex++]=P.g/255,F[this._vertexIndex++]=P.b/255,F[this._vertexIndex++]=P.a,F[this._vertexIndex++]=S.x,F[this._vertexIndex++]=S.y,F[this._vertexIndex++]=x,F[this._vertexIndex++]=R,F[this._vertexIndex++]=M,F[this._vertexIndex++]=T,F[this._vertexIndex++]=P.r/255,F[this._vertexIndex++]=P.g/255,F[this._vertexIndex++]=P.b/255,F[this._vertexIndex++]=P.a,F[this._vertexIndex++]=C.x,F[this._vertexIndex++]=C.y,F[this._vertexIndex++]=x,F[this._vertexIndex++]=D,F[this._vertexIndex++]=I,F[this._vertexIndex++]=T,F[this._vertexIndex++]=P.r/255,F[this._vertexIndex++]=P.g/255,F[this._vertexIndex++]=P.b/255,F[this._vertexIndex++]=P.a,F[this._vertexIndex++]=E.x,F[this._vertexIndex++]=E.y,F[this._vertexIndex++]=x,F[this._vertexIndex++]=D,F[this._vertexIndex++]=M,F[this._vertexIndex++]=T,F[this._vertexIndex++]=P.r/255,F[this._vertexIndex++]=P.g/255,F[this._vertexIndex++]=P.b/255,F[this._vertexIndex++]=P.a}hasPendingDraws(){return 0!==this._imageCount}flush(){if(0===this._imageCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0,40*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._imageCount,this._quads.bufferGlType,0),he.DrawnImagesCount+=this._imageCount,he.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0}}class ge{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new oe({gl:t,fragmentSource:"#version 300 es\r\n\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\nin vec2 v_size; // in pixels\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness; // in pixels\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n    vec2 uv = v_uv;\r\n    vec2 fragCoord = uv * v_size;\r\n    float maxX = v_size.x - v_strokeThickness;\r\n    float minX = v_strokeThickness;\r\n    float maxY = v_size.y - v_strokeThickness;\r\n    float minY = v_strokeThickness;\r\n\r\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\r\n        fragCoord.y < maxY && fragCoord.y > minY) {\r\n      fragColor = v_color;\r\n    } else {\r\n      fragColor = v_strokeColor;\r\n    }\r\n    fragColor.a *= v_opacity;\r\n    fragColor.rgb *= fragColor.a;\r\n\r\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r\n\r\n    // float fHalfBorderDist      = 0.0;\r\n    // float fHalfBorderThickness = 0.0;\r\n\r\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else\r\n    // {\r\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r\n        \r\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\r\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r\n            \r\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r\n    // }\r\n\r\n    // vec4 v4FromColor = v_strokeColor;\r\n    // v4FromColor.rgb *= v4FromColor.a;\r\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r\n    // if (fHalfBorderDist < 0.0) {\r\n    //     v4ToColor = v_color;\r\n    //     v4ToColor.rgb *= v4ToColor.a;\r\n    // }\r\n\r\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r\n\r\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r\n    // gl_FragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\nin vec2 a_size;\r\nout vec2 v_size;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through size\r\n   v_size = a_size;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new ae({gl:t,size:64*this._maxRectangles,type:"dynamic"}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new pe(t,this._maxRectangles,!0)}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...t){t[0]instanceof bt&&t[1]instanceof bt?this.drawLine.apply(this,t):this.drawRectangle.apply(this,t)}drawLine(t,e,i,s=1){this._isFull()&&this.flush(),this._rectangleCount++;const n=this._context.getTransform(),r=this._context.opacity,o=this._context.snapToPixel,a=e.sub(t),l=a.size,h=a.normalize().perpendicular(),c=s/2,u=n.multiply(h.scale(c).add(t)),d=n.multiply(h.scale(-c).add(t)),p=n.multiply(h.scale(c).add(e)),f=n.multiply(h.scale(-c).add(e));o&&(u.x=~~(u.x+we),u.y=~~(u.y+we),p.x=~~(p.x+we),p.y=~~(p.y+we),d.x=~~(d.x+we),d.y=~~(d.y+we),f.x=~~(f.x+we),f.y=~~(f.y+we));const g=St.Transparent,m=this._layout.vertexBuffer.bufferData;m[this._vertexIndex++]=u.x,m[this._vertexIndex++]=u.y,m[this._vertexIndex++]=0,m[this._vertexIndex++]=0,m[this._vertexIndex++]=l,m[this._vertexIndex++]=s,m[this._vertexIndex++]=r,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=g.r/255,m[this._vertexIndex++]=g.g/255,m[this._vertexIndex++]=g.b/255,m[this._vertexIndex++]=g.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=d.x,m[this._vertexIndex++]=d.y,m[this._vertexIndex++]=0,m[this._vertexIndex++]=1,m[this._vertexIndex++]=l,m[this._vertexIndex++]=s,m[this._vertexIndex++]=r,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=g.r/255,m[this._vertexIndex++]=g.g/255,m[this._vertexIndex++]=g.b/255,m[this._vertexIndex++]=g.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=p.x,m[this._vertexIndex++]=p.y,m[this._vertexIndex++]=1,m[this._vertexIndex++]=0,m[this._vertexIndex++]=l,m[this._vertexIndex++]=s,m[this._vertexIndex++]=r,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=g.r/255,m[this._vertexIndex++]=g.g/255,m[this._vertexIndex++]=g.b/255,m[this._vertexIndex++]=g.a,m[this._vertexIndex++]=0,m[this._vertexIndex++]=f.x,m[this._vertexIndex++]=f.y,m[this._vertexIndex++]=1,m[this._vertexIndex++]=1,m[this._vertexIndex++]=l,m[this._vertexIndex++]=s,m[this._vertexIndex++]=r,m[this._vertexIndex++]=i.r/255,m[this._vertexIndex++]=i.g/255,m[this._vertexIndex++]=i.b/255,m[this._vertexIndex++]=i.a,m[this._vertexIndex++]=g.r/255,m[this._vertexIndex++]=g.g/255,m[this._vertexIndex++]=g.b/255,m[this._vertexIndex++]=g.a,m[this._vertexIndex++]=0}drawRectangle(t,e,i,s,n=St.Transparent,r=0){this._isFull()&&this.flush(),this._rectangleCount++;const o=this._context.getTransform(),a=this._context.opacity,l=this._context.snapToPixel,h=o.multiply(t.add(Ct(0,0))),c=o.multiply(t.add(Ct(e,0))),u=o.multiply(t.add(Ct(e,i))),d=o.multiply(t.add(Ct(0,i)));l&&(h.x=~~(h.x+we),h.y=~~(h.y+we),c.x=~~(c.x+we),c.y=~~(c.y+we),d.x=~~(d.x+we),d.y=~~(d.y+we),u.x=~~(u.x+we),u.y=~~(u.y+we));const p=this._layout.vertexBuffer.bufferData;p[this._vertexIndex++]=h.x,p[this._vertexIndex++]=h.y,p[this._vertexIndex++]=0,p[this._vertexIndex++]=0,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=r,p[this._vertexIndex++]=d.x,p[this._vertexIndex++]=d.y,p[this._vertexIndex++]=0,p[this._vertexIndex++]=1,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=r,p[this._vertexIndex++]=c.x,p[this._vertexIndex++]=c.y,p[this._vertexIndex++]=1,p[this._vertexIndex++]=0,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=r,p[this._vertexIndex++]=u.x,p[this._vertexIndex++]=u.y,p[this._vertexIndex++]=1,p[this._vertexIndex++]=1,p[this._vertexIndex++]=e,p[this._vertexIndex++]=i,p[this._vertexIndex++]=a,p[this._vertexIndex++]=s.r/255,p[this._vertexIndex++]=s.g/255,p[this._vertexIndex++]=s.b/255,p[this._vertexIndex++]=s.a,p[this._vertexIndex++]=n.r/255,p[this._vertexIndex++]=n.g/255,p[this._vertexIndex++]=n.b/255,p[this._vertexIndex++]=n.a,p[this._vertexIndex++]=r}hasPendingDraws(){return 0!==this._rectangleCount}flush(){if(0===this._rectangleCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._rectangleCount,this._quads.bufferGlType,0),he.DrawnImagesCount+=this._rectangleCount,he.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}class me{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(t,e){this._gl=t,this._context=e,this._shader=new oe({gl:t,fragmentSource:"#version 300 es\r\nprecision highp float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness;\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  // make (0, 0) the center the uv \r\n  vec2 uv = v_uv * 2.0 - 1.0;\r\n\r\n  vec4 color = v_color;\r\n  vec4 strokeColor = v_strokeColor;\r\n\r\n  // circle border is at radius 1.0 \r\n  // dist is > 0 when inside the circle \r\n  float d = length(uv);\r\n  float dist = 1.0 - length(uv);\r\n\r\n  // Fade based on fwidth\r\n  float fade = fwidth(dot(uv, uv));\r\n\r\n  // if dist is greater than 0 step to 1;\r\n  // when we cross this 0 threshold add a smooth fade\r\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r\n\r\n  // if dist is greater than the stroke thickness step to 1\r\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r\n\r\n  strokeColor.a *= fill * stroke;\r\n  strokeColor.rgb *= strokeColor.a;\r\n\r\n  color.a *= fill * (1.0 - stroke);\r\n  color.rgb *= color.a;\r\n\r\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r\n  finalColor.rgb = finalColor.rgb * v_opacity;\r\n  finalColor.a = finalColor.a * v_opacity;\r\n  fragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new ae({gl:t,size:56*this._maxCircles,type:"dynamic"}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new pe(t,this._maxCircles,!0)}_isFull(){return this._circleCount>=this._maxCircles}draw(t,e,i,s=St.Transparent,n=0){this._isFull()&&this.flush(),this._circleCount++;const r=this._context.getTransform(),o=this._context.opacity,a=this._context.snapToPixel,l=r.multiply(t.add(Ct(-e,-e))),h=r.multiply(t.add(Ct(e,-e))),c=r.multiply(t.add(Ct(e,e))),u=r.multiply(t.add(Ct(-e,e)));a&&(l.x=~~(l.x+we),l.y=~~(l.y+we),h.x=~~(h.x+we),h.y=~~(h.y+we),u.x=~~(u.x+we),u.y=~~(u.y+we),c.x=~~(c.x+we),c.y=~~(c.y+we));const d=this._layout.vertexBuffer.bufferData;d[this._vertexIndex++]=l.x,d[this._vertexIndex++]=l.y,d[this._vertexIndex++]=0,d[this._vertexIndex++]=0,d[this._vertexIndex++]=o,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a,d[this._vertexIndex++]=s.r/255,d[this._vertexIndex++]=s.g/255,d[this._vertexIndex++]=s.b/255,d[this._vertexIndex++]=s.a,d[this._vertexIndex++]=n/e,d[this._vertexIndex++]=u.x,d[this._vertexIndex++]=u.y,d[this._vertexIndex++]=0,d[this._vertexIndex++]=1,d[this._vertexIndex++]=o,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a,d[this._vertexIndex++]=s.r/255,d[this._vertexIndex++]=s.g/255,d[this._vertexIndex++]=s.b/255,d[this._vertexIndex++]=s.a,d[this._vertexIndex++]=n/e,d[this._vertexIndex++]=h.x,d[this._vertexIndex++]=h.y,d[this._vertexIndex++]=1,d[this._vertexIndex++]=0,d[this._vertexIndex++]=o,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a,d[this._vertexIndex++]=s.r/255,d[this._vertexIndex++]=s.g/255,d[this._vertexIndex++]=s.b/255,d[this._vertexIndex++]=s.a,d[this._vertexIndex++]=n/e,d[this._vertexIndex++]=c.x,d[this._vertexIndex++]=c.y,d[this._vertexIndex++]=1,d[this._vertexIndex++]=1,d[this._vertexIndex++]=o,d[this._vertexIndex++]=i.r/255,d[this._vertexIndex++]=i.g/255,d[this._vertexIndex++]=i.b/255,d[this._vertexIndex++]=i.a,d[this._vertexIndex++]=s.r/255,d[this._vertexIndex++]=s.g/255,d[this._vertexIndex++]=s.b/255,d[this._vertexIndex++]=s.a,d[this._vertexIndex++]=n/e}hasPendingDraws(){return 0!==this._circleCount}flush(){if(0===this._circleCount)return;const t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._circleCount,this._quads.bufferGlType,0),he.DrawnImagesCount+=this._circleCount,he.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class _e{constructor(t,e,i=100){this.builder=t,this.recycler=e,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=nt.getInstance()}preallocate(){for(let t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}using(t){const e=t(this);return e?this.done(...e):this.done()}borrow(t){t(this.get()),this.index--}get(...t){if(this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects),this.objects[this.index])return this.recycler(this.objects[this.index++],...t);this.totalAllocations++;return this.objects[this.index++]=this.builder(...t)}done(...t){this.index=0;for(const e of t){const t=this.objects.indexOf(e);this.objects[t]=this.builder(),this.totalAllocations++}return t}}class ve{constructor(){this.z=0,this.priority=0,this.transform=Nt.identity(),this.state={z:0,opacity:1,tint:St.White,material:null}}}class ye{constructor(t){this._color=St.Transparent,this._initialized=!1;const{color:e,name:i,vertexSource:s,fragmentSource:n}=t;this._name=i,this._vertexSource=null!=s?s:"#version 300 es\nin vec2 a_position;\n\nin vec2 a_uv;\nout vec2 v_uv;\n\nuniform mat4 u_matrix;\nuniform mat4 u_transform;\n\nvoid main() {\n  // Set the vertex position using the ortho & transform matrix\n  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);\n\n  // Pass through the UV coord to the fragment shader\n  v_uv = a_uv;\n}\n",this._fragmentSource=n,this._color=null!=e?e:this._color}initialize(t,e){this._initialized||(this._shader=e.createShader({vertexSource:this._vertexSource,fragmentSource:this._fragmentSource}),this._shader.compile(),this._initialized=!0)}get name(){var t;return null!==(t=this._name)&&void 0!==t?t:"anonymous material"}getShader(){return this._shader}use(){if(!this._initialized)throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`);this._shader.use(),this._shader.trySetUniformFloatColor("u_color",this._color)}}class xe{constructor(){this.type="ex.material",this.priority=0,this._textures=[]}initialize(t,e){this._gl=t,this._context=e,this._buffer=new ae({gl:t,size:16,type:"dynamic"}),this._layout=new le({gl:t,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2]]}),this._quads=new pe(t,1,!0)}draw(t,e,i,s,n,r,o,a,l){var h,c,u,d;const p=this._gl,f=this._context.material;f.initialize(p,this._context);const g=this._context.getTransform(),m=this._context.opacity,_=f.getShader(),v=this._layout.vertexBuffer.bufferData;let y=0,x=(null==t?void 0:t.width)||s||0,w=(null==t?void 0:t.height)||n||0,b=[0,0,null!==(h=null!=s?s:null==t?void 0:t.width)&&void 0!==h?h:0,null!==(c=null!=n?n:null==t?void 0:t.height)&&void 0!==c?c:0],C=[null!=e?e:1,null!=i?i:1];void 0!==r&&void 0!==o&&void 0!==a&&void 0!==l&&(b=[null!=e?e:1,null!=i?i:1,null!==(u=null!=s?s:null==t?void 0:t.width)&&void 0!==u?u:0,null!==(d=null!=n?n:null==t?void 0:t.height)&&void 0!==d?d:0],C=[r,o],x=a,w=l),e=b[0],i=b[1];const S=b[2],E=b[3],P=Ct(C[0],C[1]),T=Ct(C[0]+x,C[1]),A=Ct(C[0],C[1]+w),k=Ct(C[0]+x,C[1]+w),R=t.width||x,I=t.height||w,D=e/R,M=i/I,F=(e+S-.01)/R,L=(i+E-.01)/I;v[y++]=P.x,v[y++]=P.y,v[y++]=D,v[y++]=M,v[y++]=A.x,v[y++]=A.y,v[y++]=D,v[y++]=L,v[y++]=T.x,v[y++]=T.y,v[y++]=F,v[y++]=M,v[y++]=k.x,v[y++]=k.y,v[y++]=F,v[y++]=L;const B=this._addImageAsTexture(t);f.use(),this._layout.shader=_,this._layout.use(!0),_.trySetUniformFloat("u_opacity",m),_.trySetUniformFloatVector("u_resolution",Ct(this._context.width,this._context.height)),_.trySetUniformFloatVector("u_size",Ct(S,E)),_.trySetUniformMatrix("u_matrix",this._context.ortho),_.trySetUniformMatrix("u_transform",g.to4x4()),p.activeTexture(p.TEXTURE0+0),p.bindTexture(p.TEXTURE_2D,B),_.trySetUniformInt("u_graphic",0),this._quads.bind(),p.drawElements(p.TRIANGLES,6,this._quads.bufferGlType,0)}_addImageAsTexture(t){const e=t.getAttribute("filtering");let i=null;e!==Xt.Blended&&e!==Xt.Pixel||(i=e);const s="true"===t.getAttribute("forceUpload"),n=this._context.textureLoader.load(t,i,s);return t.removeAttribute("forceUpload"),-1===this._textures.indexOf(n)&&this._textures.push(n),n}hasPendingDraws(){return!1}flush(){}}const we=1e-4;class be{constructor(t){this._webglCtx=t,this._debugText=new te}drawRect(t,e,i,s,n={color:St.Black}){this.drawLine(Ct(t,e),Ct(t+i,e),{...n}),this.drawLine(Ct(t+i,e),Ct(t+i,e+s),{...n}),this.drawLine(Ct(t+i,e+s),Ct(t,e+s),{...n}),this.drawLine(Ct(t,e+s),Ct(t,e),{...n})}drawLine(t,e,i={color:St.Black}){this._webglCtx.draw("ex.line",t,e,i.color)}drawPoint(t,e={color:St.Black,size:5}){this._webglCtx.draw("ex.point",t,e.color,e.size)}drawText(t,e){this._debugText.write(this._webglCtx,t,e)}}class Ce{get z(){return this._state.current.z}set z(t){this._state.current.z=t}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(t){let e=!0;return(t.width>4096||t.height>4096)&&(e=!1),e}constructor(t){this._logger=nt.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new _e((()=>new ve),(t=>(t.priority=0,t.z=0,t.renderer=void 0,t.args=void 0,t)),4e3),this._drawCalls=[],this._postProcessTargets=[],this._postprocessors=[],this._transform=new Ut,this._state=new Vt,this.snapToPixel=!1,this.smoothing=!1,this.backgroundColor=St.ExcaliburBlue,this._alreadyWarnedDrawLifecycle=!1,this.debug=new be(this),this._totalPostProcessorTime=0;const{canvasElement:e,enableTransparency:i,smoothing:s,snapToPixel:n,backgroundColor:r,useDrawSorting:o}=t;if(this.__gl=e.getContext("webgl2",{antialias:null!=s?s:this.smoothing,premultipliedAlpha:!1,alpha:null==i||i,depth:!0,powerPreference:"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");this.textureLoader=new Yt(this.__gl),this.snapToPixel=null!=n?n:this.snapToPixel,this.smoothing=null!=s?s:this.smoothing,this.backgroundColor=null!=r?r:this.backgroundColor,this.useDrawSorting=null!=o?o:this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}_init(){const t=this.__gl;this._ortho=zt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new fe),this.register(new xe),this.register(new ge),this.register(new me),this.register(new ue),this.register(new ce),this._screenRenderer=new de(t),this._renderTarget=new ie({gl:t,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new ie({gl:t,width:t.canvas.width,height:t.canvas.height}),new ie({gl:t,width:t.canvas.width,height:t.canvas.height})]}register(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}get(t){return this._renderers.get(t)}_isCurrentRenderer(t){return!this._currentRenderer||this._currentRenderer===t}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(t,...e){this._isDrawLifecycle||this._alreadyWarnedDrawLifecycle||(this._logger.warn("Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\nIf you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler."),this._alreadyWarnedDrawLifecycle=!0);const i=this._renderers.get(t);if(!i)throw Error(`No renderer with name ${t} has been registered`);if(this.useDrawSorting){const s=this._drawCallPool.get();s.z=this._state.current.z,s.priority=i.priority,s.renderer=t,this.getTransform().clone(s.transform),s.state.z=this._state.current.z,s.state.opacity=this._state.current.opacity,s.state.tint=this._state.current.tint,s.state.material=this._state.current.material,s.args=e,this._drawCalls.push(s)}else this._currentRenderer||(this._currentRenderer=i),this._isCurrentRenderer(i)||this._currentRenderer.flush(),i.draw(...e),this._currentRenderer=i}resetTransform(){this._transform.current=Nt.identity()}updateViewport(t){const e=this.__gl;this._ortho=this._ortho=zt.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[0].setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[1].setResolution(e.canvas.width,e.canvas.height)}drawImage(t,e,i,s,n,r,o,a,l){if(0!==s&&0!==n&&0!==a&&0!==l&&0!==t.width&&0!==t.height)return t?void(this._state.current.material?this.draw("ex.material",t,e,i,s,n,r,o,a,l):this.draw("ex.image",t,e,i,s,n,r,o,a,l)):(nt.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}drawLine(t,e,i,s=1){this.draw("ex.rectangle",t,e,i,s)}drawRectangle(t,e,i,s,n,r){this.draw("ex.rectangle",t,e,i,s,n,r)}drawCircle(t,e,i,s,n){this.draw("ex.circle",t,e,i,s,n)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(t,e){this._transform.translate(this.snapToPixel?~~(t+we):t,this.snapToPixel?~~(e+we):e)}rotate(t){this._transform.rotate(t)}scale(t,e){this._transform.scale(t,e)}transform(t){this._transform.current=t}getTransform(){return this._transform.current}multiply(t){this._transform.current.multiply(t,this._transform.current)}addPostProcessor(t){this._postprocessors.push(t),t.initialize(this.__gl)}removePostProcessor(t){const e=this._postprocessors.indexOf(t);-1!==e&&this._postprocessors.splice(e,1)}clearPostProcessors(){this._postprocessors.length=0}updatePostProcessors(t){for(const e of this._postprocessors){const i=e.getShader();i.use();const s=i.getUniforms();this._totalPostProcessorTime+=t,s.find((t=>"u_time_ms"===t.name))&&i.setUniformFloat("u_time_ms",this._totalPostProcessorTime),s.find((t=>"u_elapsed_ms"===t.name))&&i.setUniformFloat("u_elapsed_ms",t),s.find((t=>"u_resolution"===t.name))&&i.setUniformFloatVector("u_resolution",Ct(this.width,this.height)),e.onUpdate&&e.onUpdate(t)}}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){const e=new ye(t);return e.initialize(this.__gl,this),e}createShader(t){const e=this.__gl,{vertexSource:i,fragmentSource:s}=t,n=new oe({gl:e,vertexSource:i,fragmentSource:s});return n.compile(),n}clear(){const t=this.__gl;this._renderTarget.use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}flush(){const t=this.__gl;if(this._renderTarget.use(),this.useDrawSorting){const t=new Map;for(const[s]of this._renderers){const e=this._drawCalls.findIndex((t=>t.renderer===s));t.set(s,e)}this._drawCalls.sort(((e,i)=>{const s=e.z-i.z,n=t.get(e.renderer)-t.get(i.renderer),r=e.priority-i.priority;return 0===s?0===r?n:r:s}));const e=this._transform.current,i=this._state.current;if(this._drawCalls.length){let t=this._drawCalls[0].renderer,e=this._renderers.get(t);for(let i=0;i<this._drawCalls.length;i++)this._transform.current=this._drawCalls[i].transform,this._state.current=this._drawCalls[i].state,this._drawCalls[i].renderer!==t&&(e.flush(),t=this._drawCalls[i].renderer,e=this._renderers.get(t)),e.draw(...this._drawCalls[i].args);e.hasPendingDraws()&&e.flush()}this._transform.current=e,this._state.current=i,this._drawCallPool.done(),this._drawCalls.length=0}else for(const e of this._renderers.values())e.hasPendingDraws()&&e.flush();this._renderTarget.disable();this._renderTarget.toRenderSource().use();for(let e=0;e<this._postprocessors.length;e++)this._postProcessTargets[e%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[e]),this._postProcessTargets[e%2].toRenderSource().use();t.bindFramebuffer(t.FRAMEBUFFER,null),this._screenRenderer.renderToScreen()}}const Se=1e-4;class Ee{constructor(t){this._ex=t,this._debugText=new te}drawRect(t,e,i,s){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+Se):t,this._ex.snapToPixel?~~(e+Se):e,this._ex.snapToPixel?~~(i+Se):i,this._ex.snapToPixel?~~(s+Se):s),this._ex.__ctx.restore()}drawLine(t,e,i={color:St.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=i.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+Se):t.x,this._ex.snapToPixel?~~(t.y+Se):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(e.x+Se):e.x,this._ex.snapToPixel?~~(e.y+Se):e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(t,e={color:St.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+Se):t.x,this._ex.snapToPixel?~~(t.y+Se):t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(t,e){this._debugText.write(this._ex,t,e)}}class Pe{get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(t){this._state.current.opacity=t}get tint(){return this._state.current.tint}set tint(t){this._state.current.tint=t}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(t){this.__ctx.imageSmoothingEnabled=t}constructor(t){this.useDrawSorting=!1,this.z=0,this.backgroundColor=St.ExcaliburBlue,this._state=new Vt,this.snapToPixel=!1,this.debug=new Ee(this);const{canvasElement:e,enableTransparency:i,snapToPixel:s,smoothing:n,backgroundColor:r}=t;this.__ctx=e.getContext("2d",{alpha:null==i||i}),this.backgroundColor=null!=r?r:this.backgroundColor,this.snapToPixel=null!=s?s:this.snapToPixel,this.smoothing=null!=n?n:this.smoothing}resetTransform(){this.__ctx.resetTransform()}updateViewport(t){}drawImage(t,e,i,s,n,r,o,a,l){if(0===s||0===n)return;if(0===a||0===l)return;if(0===t.width||0===t.height)return;this.__ctx.globalAlpha=this.opacity;const h=[t,e,i,s,n,r,o,a,l].filter((t=>void 0!==t)).map((t=>"number"==typeof t&&this.snapToPixel?~~t:t));this.__ctx.drawImage.apply(this.__ctx,h),he.DrawCallCount++,he.DrawnImagesCount=1}drawLine(t,e,i,s=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=i.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y),this.__ctx.lineTo(this.snapToPixel?~~(e.x+Se):e.x,this.snapToPixel?~~(e.y+Se):e.y),this.__ctx.lineWidth=s,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(t,e,i,s){this.__ctx.save(),this.__ctx.fillStyle=s.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y,this.snapToPixel?~~(e+Se):e,this.snapToPixel?~~(i+Se):i),this.__ctx.restore()}drawCircle(t,e,i,s,n){this.__ctx.save(),this.__ctx.beginPath(),s&&(this.__ctx.strokeStyle=s.toString()),n&&(this.__ctx.lineWidth=n),this.__ctx.fillStyle=i.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+Se):t.x,this.snapToPixel?~~(t.y+Se):t.y,e,0,2*Math.PI),this.__ctx.fill(),s&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save()}restore(){this.__ctx.restore()}translate(t,e){this.__ctx.translate(this.snapToPixel?~~(t+Se):t,this.snapToPixel?~~(e+Se):e)}rotate(t){this.__ctx.rotate(t)}scale(t,e){this.__ctx.scale(t,e)}getTransform(){throw new Error("Not implemented")}multiply(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}addPostProcessor(t){}removePostProcessor(t){}clearPostProcessors(){}updatePostProcessors(t){}beginDrawLifecycle(){}endDrawLifecycle(){}set material(t){this._state.current.material=t}get material(){return this._state.current.material}createMaterial(t){return null}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),he.clear()}flush(){}}var Te,Ae;(Ae=Te||(Te={})).Fixed="Fixed",Ae.FitContainerAndFill="FitContainerAndFill",Ae.FitScreenAndFill="FitScreenAndFill",Ae.FitContainerAndZoom="FitContainerAndZoom",Ae.FitScreenAndZoom="FitScreenAndZoom",Ae.FitScreen="FitScreen",Ae.FillScreen="FillScreen",Ae.FitContainer="FitContainer",Ae.FillContainer="FillContainer";class ke{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}class Re{constructor(t){var e,i,s;this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=nt.getInstance(),this._fullscreenChangeHandler=()=>{this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen)},this._pixelRatioChangeHandler=()=>{this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport()},this._resizeHandler=()=>{const t=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(t),this.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this._contentArea=new Rt,this.viewport=t.viewport,this.resolution=null!==(e=t.resolution)&&void 0!==e?e:{...this.viewport},this._contentResolution=this.resolution,this._displayMode=null!==(i=t.displayMode)&&void 0!==i?i:Te.Fixed,this._canvas=t.canvas,this.graphicsContext=t.context,this._antialiasing=null!==(s=t.antialiasing)&&void 0!==s?s:this._antialiasing,this._browser=t.browser,this._pixelRatioOverride=t.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}_calculateDevicePixelRatio(){if(window.devicePixelRatio<1)return 1;return window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get isHiDpi(){return 1!==this.pixelRatio}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){switch(this.displayMode){case Te.FillContainer:case Te.FitContainer:case Te.FitContainerAndFill:case Te.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}get resolution(){return this._resolution}set resolution(t){this._resolution=t}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(t){this._viewport=t}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(t){this._camera=t}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}applyResolutionAndViewport(){if(this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this.graphicsContext instanceof Ce){this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio}) are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`))}this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof Pe&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}get antialiasing(){return this._antialiasing}set antialiasing(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(t){if(t){const e=document.getElementById(t);if(e)return e.requestFullscreen()}return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}pageToScreenCoordinates(t){let e=t.x,i=t.y;if(this._isFullScreen||(e-=Dt(this._canvas).x,i-=Dt(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio;i=(i-(window.innerHeight-t)/2)/t*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{const t=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-t)/2)/t*this.viewport.width,i=i/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,i=i/this.viewport.height*this.resolution.height,new bt(e,i)}screenToPageCoordinates(t){let e=t.x,i=t.y;if(e=e/this.resolution.width*this.viewport.width,i=i/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const t=window.innerWidth/this.aspectRatio,s=(window.innerHeight-t)/2;i=i/this.viewport.height*t+s,e=e/this.viewport.width*window.innerWidth}else{const t=window.innerHeight*this.aspectRatio,s=(window.innerWidth-t)/2;e=e/this.viewport.width*t+s,i=i/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=Dt(this._canvas).x,i+=Dt(this._canvas).y),new bt(e,i)}screenToWorldCoordinates(t){return this._camera?this._camera.inverse.multiply(t):t.sub(Ct(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(t){return this._camera?this._camera.transform.multiply(t):t.add(Ct(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(t){const e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}worldToPageCoordinates(t){const e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}getWorldBounds(){return Rt.fromDimension(this.resolution.width,this.resolution.height,bt.Half).scale(Ct(1/this._camera.zoom,1/this._camera.zoom)).rotate(this._camera.rotation).translate(this._camera.pos)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return Ct(this.halfDrawWidth,this.halfDrawHeight)}get contentArea(){return this._contentArea}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.aspectRatio;let e=0,i=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,i=window.innerWidth/t):(e=window.innerHeight*t,i=window.innerHeight),this.viewport={width:e,height:i},this._contentArea=Rt.fromDimension(this.resolution.width,this.resolution.height,bt.Zero)}_computeFitScreenAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndFill(t,e)}_computeFitContainerAndFill(){document.body.style.margin="0px",document.body.style.overflow="hidden";const t=this.canvas.parentElement,e=t.clientWidth,i=t.clientHeight;this._computeFitAndFill(e,i)}_computeFitAndFill(t,e){if(this.viewport={width:t,height:e},t/e<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*e/t};const i=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new Rt({top:i,left:0,right:this._contentResolution.width,bottom:this.resolution.height-i})}else{this.resolution={width:e*this._contentResolution.height/e*t/e,height:e*this._contentResolution.height/e};const i=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new Rt({top:0,left:i,right:this.resolution.width-i,bottom:this._contentResolution.height})}}_computeFitScreenAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=window.innerWidth,e=window.innerHeight;this._computeFitAndZoom(t,e)}_computeFitContainerAndZoom(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";const t=this.canvas.parentElement;t.style.position="relative",t.style.overflow="hidden";const e=t.clientWidth,i=t.clientHeight;this._computeFitAndZoom(e,i)}_computeFitAndZoom(t,e){const i=this.aspectRatio;let s=0,n=0;t/i<e?(s=t,n=t/i):(s=e*i,n=e);const r=t/s,o=e/n,a=Math.max(r,o),l=s*a,h=n*a;this.canvas.style.left=l>t?-(l-t)/2+"px":"",this.canvas.style.top=h>e?-(h-e)/2+"px":"",this.viewport={width:l,height:h};const c=Rt.fromDimension(this.viewport.width,this.viewport.height,bt.Zero);if(this.viewport.width>t){const e=(this.viewport.width-t)/this.viewport.width*this.resolution.width;c.top=0,c.left=e/2,c.right=this.resolution.width-e/2,c.bottom=this.resolution.height}if(this.viewport.height>e){const t=(this.viewport.height-e)/this.viewport.height*this.resolution.height;c.top=t/2,c.left=0,c.bottom=this.resolution.height-t/2,c.right=this.resolution.width}this._contentArea=c}_computeFitContainer(){const t=this.aspectRatio;let e=0,i=0;const s=this.canvas.parentElement;s.clientWidth/t<s.clientHeight?(e=s.clientWidth,i=s.clientWidth/t):(e=s.clientHeight*t,i=s.clientHeight),this.viewport={width:e,height:i},this._contentArea=Rt.fromDimension(this.resolution.width,this.resolution.height,bt.Zero)}_applyDisplayMode(){this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((()=>{this._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}_setResolutionAndViewportByDisplayMode(t){this.displayMode===Te.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===Te.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this._contentArea=Rt.fromDimension(this.resolution.width,this.resolution.height,bt.Zero),this.displayMode===Te.FitScreen&&this._computeFit(),this.displayMode===Te.FitContainer&&this._computeFitContainer(),this.displayMode===Te.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===Te.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===Te.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===Te.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}class Ie{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}Ie._INSTANCE=null;class De{static unlock(){return new Promise(((t,e)=>{if(De._UNLOCKED||!Ie.create())return t(!0);const i=setTimeout((()=>{nt.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),t(!1)}),200),s=Ie.create();s.resume().then((()=>{const e=s.createBuffer(1,1,22050),n=s.createBufferSource();let r=!1;n.buffer=e,n.connect(s.destination),n.onended=()=>r=!0,n.start(0),setTimeout((()=>{!function(t){return!!t.playbackState}(n)?(s.currentTime>0||r)&&(De._UNLOCKED=!0):n.playbackState!==n.PLAYING_STATE&&n.playbackState!==n.FINISHED_STATE||(De._UNLOCKED=!0)}),0),clearTimeout(i),t(!0)}),(()=>{e()}))}))}static isUnlocked(){return this._UNLOCKED}}function Me(t,e=St.Red,i,s,n,r,o=1,a="butt"){t.save(),t.beginPath(),t.lineWidth=o,t.lineCap=a,t.strokeStyle=e.toString(),t.moveTo(i,s),t.lineTo(n,r),t.closePath(),t.stroke(),t.restore()}function Fe(t,e=St.Red,i){t.beginPath(),t.strokeStyle=e.toString(),t.arc(i.x,i.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function Le(t,e,i,s,n=1){const r=e?e.toString():"blue",o=s.scale(n);t.beginPath(),t.strokeStyle=r,t.moveTo(i.x,i.y),t.lineTo(i.x+o.x,i.y+o.y),t.closePath(),t.stroke()}function Be(t,e,i,s,n,r=5,o=St.White,a=null){let l;if("number"==typeof r)l={tl:r,tr:r,br:r,bl:r};else{const t={tl:0,tr:0,br:0,bl:0};for(const e in t)if(t.hasOwnProperty(e)){const i=e;l[i]=r[i]||t[i]}}t.beginPath(),t.moveTo(e+l.tl,i),t.lineTo(e+s-l.tr,i),t.quadraticCurveTo(e+s,i,e+s,i+l.tr),t.lineTo(e+s,i+n-l.br),t.quadraticCurveTo(e+s,i+n,e+s-l.br,i+n),t.lineTo(e+l.bl,i+n),t.quadraticCurveTo(e,i+n,e,i+n-l.bl),t.lineTo(e,i+l.tl),t.quadraticCurveTo(e,i,e+l.tl,i),t.closePath(),a&&(t.fillStyle=a.toString(),t.fill()),o&&(t.strokeStyle=o.toString(),t.stroke())}function Oe(t,e,i,s,n=St.White,r=null){t.beginPath(),t.arc(e,i,s,0,2*Math.PI),t.closePath(),r&&(t.fillStyle=r.toString(),t.fill()),n&&(t.strokeStyle=n.toString(),t.stroke())}De._UNLOCKED=!1;var ze=Gx(1388);class Ne extends Gt{constructor(t){var e,i,s,n,r,o,a,l,h,c;super(t),this.filtering=null,this.lineCap="butt",this.quality=1,this._dirty=!0,this._smoothing=!1,this._color=Wt(St.Black,(()=>this.flagDirty())),this._lineWidth=1,this._lineDash=[],this._padding=0,t&&(this.quality=null!==(e=t.quality)&&void 0!==e?e:this.quality,this.color=null!==(i=t.color)&&void 0!==i?i:St.Black,this.strokeColor=null==t?void 0:t.strokeColor,this.smoothing=null!==(s=t.smoothing)&&void 0!==s?s:this.smoothing,this.lineWidth=null!==(n=t.lineWidth)&&void 0!==n?n:this.lineWidth,this.lineDash=null!==(r=t.lineDash)&&void 0!==r?r:this.lineDash,this.lineCap=null!==(o=t.lineCap)&&void 0!==o?o:this.lineCap,this.padding=null!==(a=t.padding)&&void 0!==a?a:this.padding,this.filtering=null!==(l=t.filtering)&&void 0!==l?l:this.filtering),this._bitmap=document.createElement("canvas");const u=null!==(h=null==t?void 0:t.width)&&void 0!==h?h:this._bitmap.width,d=null!==(c=null==t?void 0:t.height)&&void 0!==c?c:this._bitmap.height;this.width=u,this.height=d;const p=this._bitmap.getContext("2d");if(!p)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");this._ctx=p}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}_getTotalWidth(){var t;return 1*((null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding)}_getTotalHeight(){var t;return 1*((null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding)}get localBounds(){return Rt.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,bt.Zero)}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this.flagDirty()}get color(){return this._color}set color(t){this.flagDirty(),this._color=Wt(t,(()=>this.flagDirty()))}get strokeColor(){return this._strokeColor}set strokeColor(t){this.flagDirty(),this._strokeColor=Wt(t,(()=>this.flagDirty()))}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(t){this._lineDash=t,this.flagDirty()}get padding(){return this._padding}set padding(t){this._padding=t,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore()}_applyRasterProperties(t){var e,i,s;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,this._bitmap.setAttribute("filtering",this.filtering),this._bitmap.setAttribute("forceUpload","true"),t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=null===(s=this.color)||void 0===s?void 0:s.toString()}_drawImage(t,e,i){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,e,i)}}class Ue extends Ne{get ctx(){return this._ctx}constructor(t){super(t),this._options=t}clone(){return new Ue({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){var e,i;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(i=this._options)||void 0===i||i.draw(t)),this._options.cache||this.flagDirty()}}class Ve{}Ve.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class He{constructor(){this.states=new Map}get currentState(){return this._currentState}set currentState(t){this._currentState=t}static create(t,e){const i=new He;i.data=e;for(const s in t.states)i.states.set(s,{name:s,...t.states[s]});for(const s of i.states.values())for(const t of s.transitions)if("*"!==t&&!i.states.has(t))throw Error(`Invalid state machine, state [${s.name}] has a transition to another state that doesn't exist [${t}]`);return i.currentState=i.startState=i.states.get(t.start),i}in(t){return this.currentState.name===t}go(t,e){var i,s;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){const n=this.states.get(t);if(this.currentState.onExit){if(!1===(null===(i=this.currentState)||void 0===i?void 0:i.onExit({to:n.name,data:this.data})))return!1}if(null==n?void 0:n.onEnter){if(!1===(null==n?void 0:n.onEnter({from:this.currentState.name,eventData:e,data:this.data})))return!1}return this.currentState=n,(null===(s=this.currentState)||void 0===s?void 0:s.onState)&&this.currentState.onState(),!0}return!1}update(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}save(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}restore(t){const e=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(e.currentState),this.data=e.data}}class je{_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}_handleEnd(){this.loop||(this._instance.onended=()=>{this._playingResolve(!0)})}set loop(t){this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=()=>{this._playingResolve(!0)}))}get loop(){return this._loop}set volume(t){t=gt(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}get volume(){return this._volume}get duration(){var t;return null!==(t=this._duration)&&void 0!==t?t:this.getTotalPlaybackDuration()}set duration(t){this._duration=t}constructor(t){this._src=t,this._audioContext=Ie.create(),this._volumeNode=this._audioContext.createGain(),this._playingPromise=new Promise((t=>{this._playingResolve=t})),this._stateMachine=He.create({start:"STOPPED",states:{PLAYING:{onEnter:({data:t})=>{this._createNewBufferSource(),this._handleEnd(),this.loop?this._instance.start(0,t.pausedAt*this._playbackRate):this._instance.start(0,t.pausedAt*this._playbackRate,this.duration),t.startedAt=this._audioContext.currentTime-t.pausedAt,t.pausedAt=0},onState:()=>this._playStarted(),onExit:({to:t})=>{"STOPPED"===t&&this._playingResolve(!0),this._instance.onended=null,this._instance.disconnect(),this._instance.stop(0),this._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:({eventData:t,data:e})=>{e.pausedAt=(null!=t?t:0)/this._playbackRate,e.startedAt=0},transitions:["*"]},STOPPED:{onEnter:({data:t})=>{t.pausedAt=0,t.startedAt=0,this._playingResolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:({data:t})=>{t.pausedAt=this._audioContext.currentTime-t.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=()=>{},this._playbackRate=1,this._createNewBufferSource()}isPlaying(){return this._stateMachine.in("PLAYING")}isPaused(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}play(t=(()=>{})){return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingPromise}pause(){this._stateMachine.go("PAUSED")}stop(){this._stateMachine.go("STOPPED")}seek(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}getTotalPlaybackDuration(){return this._src.duration}getPlaybackPosition(){const{pausedAt:t,startedAt:e}=this._stateMachine.data;return t?t*this._playbackRate:e?(this._audioContext.currentTime-e)*this._playbackRate:0}set playbackRate(t){this._instance.playbackRate.value=this._playbackRate=t}get playbackRate(){return this._instance.playbackRate.value}}class We extends w{set bubbles(t){}get bubbles(){return!1}get _path(){return null}set _path(t){}constructor(t,e="MediaEvent"){super(),this.target=t,this._name=e}stopPropagation(){}action(){}propagate(){}layPath(t){}}class $e extends We{constructor(t,e){super(t,"NativeSoundEvent"),this.track=e}}class Ge extends We{constructor(t,e){super(t,"NativeSoundProcessedEvent"),this._processedData=e,this.data=this._processedData}}function qe(t){try{const e=new Audio,i=/.*\.([A-Za-z0-9]+)(?:(?:\?|\#).*)*$/,s=t.match(i)[1];return!!e.canPlayType("audio/"+s)}catch(Yy){return nt.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",Yy),!1}}const Xe={VolumeChange:"volumechange",Processed:"processed",Pause:"pause",Stop:"stop",PlaybackEnd:"playbackend",Resume:"resume",PlaybackStart:"playbackstart"};class Ke{set loop(t){this._loop=t;for(const e of this._tracks)e.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(t){this._volume=t;for(const e of this._tracks)e.volume=this._volume;this.events.emit("volumechange",new $e(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}set duration(t){this._duration=t}get instances(){return this._tracks}get path(){return this._resource.path}set path(t){this._resource.path=t}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}constructor(...t){this.events=new x,this.logger=nt.getInstance(),this._loop=!1,this._volume=1,this._isStopped=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._playbackRate=1,this._audioContext=Ie.create(),this._resource=new jt("",Ve.type.arraybuffer);for(const e of t)if(qe(e)){this.path=e;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",t.join(", ")),this.logger.warn("Attempting to use",t[0]),this.path=t[0])}isLoaded(){return!!this.data}async load(){var t,e;if(this.data)return this.data;const i=await this._resource.load(),s=await this.decodeAudio(i.slice(0));return this._duration=null!==(e=null!==(t=this._duration)&&void 0!==t?t:null==s?void 0:s.duration)&&void 0!==e?e:void 0,this.events.emit("processed",new Ge(this,s)),this.data=s}async decodeAudio(t){try{return await this._audioContext.decodeAudioData(t.slice(0))}catch(Yy){return this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(t){t&&(this._engine=t,this._engine.on("hidden",(()=>{t.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())})),this._engine.on("visible",(()=>{t.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)})),this._engine.on("start",(()=>{this._isStopped=!1})),this._engine.on("stop",(()=>{this.stop(),this._isStopped=!0})))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some((t=>t.isPlaying()))}isPaused(){return this._tracks.some((t=>t.isPaused()))}play(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const t of this._tracks)t.pause();this.events.emit("pause",new $e(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const t of this._tracks)t.stop();this.events.emit("stop",new $e(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._tracks.forEach((t=>{t.playbackRate=this._playbackRate}))}seek(t,e=0){0===this._tracks.length&&this._getTrackInstance(this.data),this._tracks[e].seek(t)}getTotalPlaybackDuration(){return this.data.duration}getPlaybackPosition(t=0){return this._tracks.length?this._tracks[t].getPlaybackPosition():0}getTrackId(t){return this._tracks.indexOf(t)}async _resumePlayback(){if(this.isPaused){const t=[];for(const e of this._tracks)t.push(e.play().then((()=>(this.events.emit("playbackend",new $e(this,e)),this._tracks.splice(this.getTrackId(e),1),!0))));this.events.emit("resume",new $e(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(t)}return!0}async _startPlayback(){const t=await this._getTrackInstance(this.data),e=await t.play((()=>{this.events.emit("playbackstart",new $e(this,t)),this.logger.debug("Playing new instance for sound",this.path)}));return this.events.emit("playbackend",new $e(this,t)),this._tracks.splice(this.getTrackId(t),1),e}_getTrackInstance(t){const e=new je(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,e.playbackRate=this._playbackRate,this._tracks.push(e),e}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}const Ye={};class Ze{get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}constructor(t){this.events=new x,this.canvas=new Ue({filtering:Xt.Blended,smoothing:!0,cache:!0,draw:this.draw.bind(this)}),this._resourceList=[],this._index=0,this._playButtonShown=!1,this._resourceCount=0,this._numLoaded=0,this._progressCounts={},this._totalCounts={},this.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=St.White,this.backgroundColor="#176BAA",this.suppressPlayButton=!1,this._playButtonStyles=ze.Z.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=this.playButtonText,t.style.display="none",t},this._loadingFuture=new It,t&&this.addResources(t)}wireEngine(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}addResource(t){const e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}addResources(t){let e=0;const i=t.length;for(;e<i;e++)this.addResource(t[e])}isLoaded(){return this._numLoaded===this._resourceCount}async showPlayButton(){var t,e;if(!this.suppressPlayButton){const t=()=>{this._positionPlayButton()};(null===(e=this._engine)||void 0===e?void 0:e.browser)&&this._engine.browser.window.on("resize",t),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(t=>{"Enter"===t.key&&this._playButton.click()})),this._positionPlayButton();const i=new Promise((e=>{const i=i=>{var s;i.stopPropagation(),this.hidePlayButton(),(null===(s=this._engine)||void 0===s?void 0:s.browser)&&this._engine.browser.window.off("resize",t),e()};this._playButton.addEventListener("click",i),this._playButton.addEventListener("touchend",i),this._playButton.addEventListener("pointerup",i)}));return await i}this.hidePlayButton(),await Ot(500,null===(t=this._engine)||void 0===t?void 0:t.clock)}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}update(t,e){}areResourcesLoaded(){return this._loadingFuture.promise}async load(){var t,e;await(null===(t=this._image)||void 0===t?void 0:t.decode()),this.canvas.flagDirty(),await Promise.all(this._resourceList.map((async t=>{await t.load().finally((()=>{this._numLoaded++,this.canvas.flagDirty()}))})));for(const i of this._resourceList)i instanceof Ke&&i.wireEngine(this._engine);return this._loadingFuture.resolve(),await Ot(200,null===(e=this._engine)||void 0===e?void 0:e.clock),this.canvas.flagDirty(),await this.showPlayButton(),await De.unlock(),this.data=this._resourceList}markResourceComplete(){this._numLoaded++}get progress(){return this._resourceCount>0?gt(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}_positionPlayButton(){if(this._engine){const t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){const i=this._engine.canvas.offsetLeft,s=this._engine.canvas.offsetTop,n=this._playButton.clientWidth,r=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=i+e/2-n/2+"px",this._playButtonRootElement.style.top=s+t/2-r/2+100+"px")}}}draw(t){const e=this._engine.canvasHeight/this._engine.pixelRatio,i=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,i,e);let s=e/2;const n=Math.min(this.logoWidth,.75*i);let r=i/2-n/2;this.logoPosition&&(r=this.logoPosition.x,s=this.logoPosition.y);const o=Math.floor(n*(this.logoHeight/this.logoWidth)),a=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,r,s,n,o):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,r,s-o-20,n,o),!this.suppressPlayButton&&this._playButtonShown)return void this._engine.setAntialiasing(a);let l=r,h=s;this.loadingBarPosition&&(l=this.loadingBarPosition.x,h=this.loadingBarPosition.y),t.lineWidth=2,Be(t,l,h,n,20,10,this.loadingBarColor);const c=n*this.progress-10;Be(t,l+5,h+5,c>10?c:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(a)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}const Qe={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class Je{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){const t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(Yy){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n";const e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();for(const s of Object.keys(Qe))i[s]?(t+="(%c%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+Qe[s]+"\n";e.unshift(t),console.log.apply(console,e)}_loadBrowserFeatures(){return{canvas:(()=>this._criticalTests.canvasSupport())(),arraybuffer:(()=>this._criticalTests.arrayBufferSupport())(),dataurl:(()=>this._criticalTests.dataUrlSupport())(),objecturl:(()=>this._criticalTests.objectUrlSupport())(),rgba:(()=>this._criticalTests.rgbaSupport())(),webaudio:(()=>this._warningTest.webAudioSupport())(),webgl:(()=>this._warningTest.webglSupport())(),gamepadapi:!!navigator.getGamepads}}test(){let t=!1;for(const e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),nt.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(const e in this._warningTest)this._warningTest[e]()||nt.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",e);return!0}}var ti,ei;(ei=ti||(ti={})).PreventCollision="PreventCollision",ei.Passive="Passive",ei.Active="Active",ei.Fixed="Fixed";const ii=5,si={},ni=()=>{for(const t in si)si[t]=0},ri=(t,e)=>{const i=v.isEnabled("suppress-obsolete-message");si[t]<ii&&!i&&(nt.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),si[t]++};function oi(t){return t={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...t},function(e,i,s){if(s&&"function"!=typeof s.value&&"function"!=typeof s.get&&"function"!=typeof s.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const n=`${`${e.name||""}${e.name&&i?".":""}${i||""}`} is marked obsolete: ${t.message}`+(t.alternateMethod?` Use ${t.alternateMethod} instead`:"");si[n]||(si[n]=0);const r=s?{...s}:e;if(!s){class e extends r{constructor(...e){ri(n,t),super(...e)}}return e}return s&&s.value?(r.value=function(){return ri(n,t),s.value.apply(this,arguments)},r):(s&&s.get&&(r.get=function(){return ri(n,t),s.get.apply(this,arguments)}),s&&s.set&&(r.set=function(){return ri(n,t),s.set.apply(this,arguments)}),r)}}var ai,li,hi,ci,ui,di,pi,fi;(li=ai||(ai={})).Arcade="arcade",li.Realistic="realistic",(ci=hi||(hi={}))[ci.DynamicAABBTree=0]="DynamicAABBTree",(di=ui||(ui={}))[di.Euler=0]="Euler";class gi{static get gravity(){return gi.acc}static set gravity(t){gi.acc=t}static useArcadePhysics(){gi.collisionResolutionStrategy=ai.Arcade}static useRealisticPhysics(){gi.collisionResolutionStrategy=ai.Realistic}static get dynamicTreeVelocityMultiplyer(){return gi.dynamicTreeVelocityMultiplier}static set dynamicTreeVelocityMultiplyer(t){gi.dynamicTreeVelocityMultiplier=t}}gi.acc=new bt(0,0),gi.enabled=!0,gi.broadphaseStrategy=hi.DynamicAABBTree,gi.collisionResolutionStrategy=ai.Arcade,gi.defaultMass=10,gi.integrator=ui.Euler,gi.dynamicTreeVelocityMultiplier=2,gi.boundsPadding=5,gi.positionIterations=3,gi.velocityIterations=8,gi.slop=1,gi.steeringFactor=.2,gi.warmStart=!0,gi.bodiesCanSleepByDefault=!1,gi.surfaceEpsilon=.1,gi.sleepEpsilon=.07,gi.wakeThreshold=3*gi.sleepEpsilon,gi.sleepBias=.9,gi.checkForFastBodies=!0,gi.disableMinimumSpeedForFastBody=!1,function(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);r>3&&o&&Object.defineProperty(e,i,o)}([oi({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],gi,"dynamicTreeVelocityMultiplyer",null),(fi=pi||(pi={})).World="world",fi.Screen="screen";class mi extends bt{constructor(t){super(0,0),this._getX=t.getX,this._getY=t.getY,this._setX=t.setX,this._setY=t.setY}get x(){return this._x=this._getX()}set x(t){this._setX(t),this._x=t}get y(){return this._y=this._getY()}set y(t){this._setY(t),this._y=t}}class _i extends bt{constructor(t,e){super(t.x,t.y),this.original=t,this.change=e}get x(){return this._x=this.original.x}set x(t){this.change(t,this._y),this._x=this.original.x=t}get y(){return this._y=this.original.y}set y(t){this.change(this._x,t),this._y=this.original.y=t}}class vi{constructor(){this._parent=null,this._children=[],this._pos=Ct(0,0),this._rotation=0,this._scale=Ct(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=Nt.identity(),this._inverse=Nt.identity()}get parent(){return this._parent}set parent(t){if(this._parent){const t=this._parent._children.indexOf(this);t>-1&&this._parent._children.splice(t,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}get children(){return this._children}set pos(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}get pos(){return new _i(this._pos,((t,e)=>{t===this._pos.x&&e===this._pos.y||this.flagDirty()}))}set globalPos(t){let e=t.clone();this.parent&&(e=this.parent.inverse.multiply(t)),e.equals(this._pos)||(this._pos=e,this.flagDirty())}get globalPos(){return new mi({getX:()=>this.matrix.data[4],getY:()=>this.matrix.data[5],setX:t=>{if(this.parent){const{x:e}=this.parent.inverse.multiply(Ct(t,this.pos.y));this.pos.x=e}else this.pos.x=t;t!==this.matrix.data[4]&&this.flagDirty()},setY:t=>{if(this.parent){const{y:e}=this.parent.inverse.multiply(Ct(this.pos.x,t));this.pos.y=e}else this.pos.y=t;t!==this.matrix.data[5]&&this.flagDirty()}})}set rotation(t){const e=mt(t);e!==this._rotation&&this.flagDirty(),this._rotation=e}get rotation(){return this._rotation}set globalRotation(t){let e=0;this.parent&&(e=this.parent.globalRotation);const i=mt(t+e);i!==this._rotation&&this.flagDirty(),this._rotation=i}get globalRotation(){return this.parent?this.matrix.getRotation():this.rotation}set scale(t){t.equals(this._scale)||(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}get scale(){return new _i(this._scale,((t,e)=>{t===this._scale.x&&e===this._scale.y||this.flagDirty()}))}set globalScale(t){let e=Ct(1,1);this.parent&&(e=this.parent.globalScale),this.scale=t.scale(Ct(1/e.x,1/e.y))}get globalScale(){return new mi({getX:()=>this.parent?this.matrix.getScaleX():this.scale.x,getY:()=>this.parent?this.matrix.getScaleY():this.scale.y,setX:t=>{if(this.parent){const e=this.parent.globalScale.x;this.scale.x=t/e}else this.scale.x=t},setY:t=>{if(this.parent){const e=this.parent.globalScale.y;this.scale.y=t/e}else this.scale.y=t}})}get matrix(){return this._isDirty&&(null===this.parent?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}get inverse(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}_calculateMatrix(){return Nt.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}flagDirty(){this._isDirty=!0,this._isInverseDirty=!0;for(let t=0;t<this._children.length;t++)this._children[t].flagDirty()}apply(t){return this.matrix.multiply(t)}applyInverse(t){return this.inverse.multiply(t)}setTransform(t,e,i){this._pos.x=t.x,this._pos.y=t.y,this._rotation=mt(e),this._scale.x=i.x,this._scale.y=i.y,this.flagDirty()}clone(t){const e=null!=t?t:new vi;return this._pos.clone(e._pos),e._rotation=this._rotation,this._scale.clone(e._scale),e.flagDirty(),e}}class yi{constructor(){this.owner=null}clone(){const t=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const s=this[i];(null==(e=s)?void 0:e.clone)&&"owner"!==i&&"clone"!==i?t[i]=s.clone():t[i]=s}var e;return t}}class xi extends yi{constructor(t,e){super(),this.type=t,this.value=e}}class wi{constructor(){this.observers=[],this.subscriptions=[]}register(t){this.observers.push(t)}subscribe(t){this.subscriptions.push(t)}unregister(t){const e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}unsubscribe(t){const e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}notifyAll(t){const e=this.observers.length;for(let s=0;s<e;s++)this.observers[s].notify(t);const i=this.subscriptions.length;for(let s=0;s<i;s++)this.subscriptions[s](t)}clear(){this.observers.length=0,this.subscriptions.length=0}}class bi extends yi{constructor(){super(...arguments),this.type="ex.transform",this._transform=new vi,this._addChildTransform=t=>{const e=t.get(bi);e&&(e._transform.parent=this._transform)},this.zIndexChanged$=new wi,this._z=0,this.coordPlane=pi.World}get(){return this._transform}onAdd(t){for(const e of t.children)this._addChildTransform(e);t.childrenAdded$.subscribe((t=>this._addChildTransform(t))),t.childrenRemoved$.subscribe((t=>{const e=t.get(bi);e&&(e._transform.parent=null)}))}onRemove(t){this._transform.parent=null}get z(){return this._z}set z(t){const e=this._z;this._z=t,e!==t&&this.zIndexChanged$.notifyAll(t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get globalPos(){return this._transform.globalPos}set globalPos(t){this._transform.globalPos=t}get rotation(){return this._transform.rotation}set rotation(t){this._transform.rotation=t}get globalRotation(){return this._transform.globalRotation}set globalRotation(t){this._transform.globalRotation=t}get scale(){return this._transform.scale}set scale(t){this._transform.scale=t}get globalScale(){return this._transform.globalScale}set globalScale(t){this._transform.globalScale=t}applyInverse(t){return this._transform.applyInverse(t)}apply(t){return this._transform.apply(t)}clone(){const t=new bi;return t._transform=this._transform.clone(),t._z=this._z,t}}class Ci extends yi{constructor(){super(...arguments),this.type="ex.motion",this.vel=bt.Zero,this.acc=bt.Zero,this.scaleFactor=bt.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class Si{constructor(t,e,i){this._name=t,this._category=e,this._mask=i}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(t){return 0!=(this.category&t.mask)&&0!=(t.category&this.mask)}invert(){return new Si("~("+this.name+")",~this.category,~this.mask)}static combine(t){const e=t.map((t=>t.name)).join("+"),i=t.reduce(((t,e)=>e.category|t),0);return new Si(e,i,~i)}static collidesWith(t){return Si.combine(t).invert()}}Si.All=new Si("Collide with all groups",-1,-1);class Ei{constructor(t,e){this.colliderA=t,this.colliderB=e,this.id=null,this.id=Ei.calculatePairHash(t.id,e.id)}static canCollide(t,e){var i,s;const n=null===(i=null==t?void 0:t.owner)||void 0===i?void 0:i.get(Gi),r=null===(s=null==e?void 0:e.owner)||void 0===s?void 0:s.get(Gi);return t.id!==e.id&&((!t.owner||!e.owner||t.owner.id!==e.owner.id)&&(!t.localBounds.hasZeroDimensions()&&!e.localBounds.hasZeroDimensions()&&(!(!n||!r)&&(!!n.group.canCollide(r.group)&&((n.collisionType!==ti.Fixed||r.collisionType!==ti.Fixed)&&(r.collisionType!==ti.PreventCollision&&n.collisionType!==ti.PreventCollision&&!(!n.active||!r.active)))))))}get canCollide(){const t=this.colliderA,e=this.colliderB;return Ei.canCollide(t,e)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(t){return t===this.colliderA||t===this.colliderB}static calculatePairHash(t,e){return t.value<e.value?`#${t.value}+${e.value}`:`#${e.value}+${t.value}`}}class Pi{constructor(t,e){this.min=t,this.max=e}overlaps(t){return this.max>t.min&&t.max>this.min}getOverlap(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}class Ti{constructor(t){this.parent=t,this.parent=t||null,this.data=null,this.bounds=new Rt,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class Ai{constructor(t=new Rt(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this.worldBounds=t,this.root=null,this.nodes={}}_insert(t){if(null===this.root)return this.root=t,void(this.root.parent=null);const e=t.bounds;let i=this.root;for(;!i.isLeaf();){const t=i.left,s=i.right,n=i.bounds.getPerimeter(),r=i.bounds.combine(e).getPerimeter(),o=2*r,a=2*(r-n);let l=0;const h=e.combine(t.bounds);let c,u;t.isLeaf()?l=h.getPerimeter()+a:(u=t.bounds.getPerimeter(),c=h.getPerimeter(),l=c-u+a);let d=0;const p=e.combine(s.bounds);if(s.isLeaf()?d=p.getPerimeter()+a:(u=s.bounds.getPerimeter(),c=p.getPerimeter(),d=c-u+a),o<l&&o<d)break;i=l<d?t:s}const s=i.parent,n=new Ti(s);n.bounds=e.combine(i.bounds),n.height=i.height+1,null!==s?(s.left===i?s.left=n:s.right=n,n.left=i,n.right=t,i.parent=n,t.parent=n):(n.left=i,n.right=t,i.parent=n,t.parent=n,this.root=n);let r=t.parent;for(;r;){if(r=this._balance(r),!r.left)throw new Error("Parent of current leaf cannot have a null left child"+r);if(!r.right)throw new Error("Parent of current leaf cannot have a null right child"+r);r.height=1+Math.max(r.left.height,r.right.height),r.bounds=r.left.bounds.combine(r.right.bounds),r=r.parent}}_remove(t){if(t===this.root)return void(this.root=null);const e=t.parent,i=e.parent;let s;if(s=e.left===t?e.right:e.left,i){i.left===e?i.left=s:i.right=s,s.parent=i;let t=i;for(;t;)t=this._balance(t),t.bounds=t.left.bounds.combine(t.right.bounds),t.height=1+Math.max(t.left.height,t.right.height),t=t.parent}else this.root=s,s.parent=null}trackCollider(t){const e=new Ti;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}updateCollider(t){var e;const i=this.nodes[t.id.value];if(!i)return!1;const s=t.bounds;if(!this.worldBounds.contains(s))return nt.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(i.bounds.contains(s))return!1;if(this._remove(i),s.left-=gi.boundsPadding,s.top-=gi.boundsPadding,s.right+=gi.boundsPadding,s.bottom+=gi.boundsPadding,t.owner){const i=null===(e=t.owner)||void 0===e?void 0:e.get(Gi);if(i){const t=32*i.vel.x/1e3*gi.dynamicTreeVelocityMultiplier,e=32*i.vel.y/1e3*gi.dynamicTreeVelocityMultiplier;t<0?s.left+=t:s.right+=t,e<0?s.top+=e:s.bottom+=e}}return i.bounds=s,this._insert(i),!0}untrackCollider(t){const e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}_balance(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;const e=t.left,i=t.right,s=t,n=e,r=i,o=e.left,a=e.right,l=i.left,h=i.right,c=r.height-n.height;if(c>1)return r.left=s,r.parent=s.parent,s.parent=r,r.parent?r.parent.left===s?r.parent.left=r:r.parent.right=r:this.root=r,l.height>h.height?(r.right=l,s.right=h,h.parent=s,s.bounds=n.bounds.combine(h.bounds),r.bounds=s.bounds.combine(l.bounds),s.height=1+Math.max(n.height,h.height),r.height=1+Math.max(s.height,l.height)):(r.right=h,s.right=l,l.parent=s,s.bounds=n.bounds.combine(l.bounds),r.bounds=s.bounds.combine(h.bounds),s.height=1+Math.max(n.height,l.height),r.height=1+Math.max(s.height,h.height)),r;if(c<-1){if(n.left=s,n.parent=s.parent,s.parent=n,n.parent)if(n.parent.left===s)n.parent.left=n;else{if(n.parent.right!==s)throw"Error rotating Dynamic Tree";n.parent.right=n}else this.root=n;return o.height>a.height?(n.right=o,s.left=a,a.parent=s,s.bounds=r.bounds.combine(a.bounds),n.bounds=s.bounds.combine(o.bounds),s.height=1+Math.max(r.height,a.height),n.height=1+Math.max(s.height,o.height)):(n.right=a,s.left=o,o.parent=s,s.bounds=r.bounds.combine(o.bounds),n.bounds=s.bounds.combine(a.bounds),s.height=1+Math.max(r.height,o.height),n.height=1+Math.max(s.height,a.height)),n}return t}getHeight(){return null===this.root?0:this.root.height}query(t,e){const i=t.bounds,s=n=>{if(n&&n.bounds.overlaps(i)){if(!n.isLeaf()||n.data===t)return s(n.left)||s(n.right);if(e.call(t,n.data))return!0}return!1};s(this.root)}rayCastQuery(t,e=1/0,i){const s=n=>{if(n&&n.bounds.rayCast(t,e)){if(!n.isLeaf())return s(n.left)||s(n.right);if(i.call(t,n.data))return!0}return!1};s(this.root)}getNodes(){const t=e=>e?[e].concat(t(e.left),t(e.right)):[];return t(this.root)}debug(t){const e=i=>{i&&(i.isLeaf()?i.bounds.draw(t,St.Green):i.bounds.draw(t,St.White),i.left&&e(i.left),i.right&&e(i.right))};e(this.root)}}class ki{constructor(t,e){this.pos=t,this.dir=e.normalize()}intersect(t){const e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;const i=this.dir.cross(t.getSlope());if(0===i)return-1;const s=e.cross(t.getSlope())/i;if(s>=0){const n=e.cross(this.dir)/i/t.getLength();if(n>=0&&n<=1)return s}return-1}intersectPoint(t){const e=this.intersect(t);return e<0?null:this.getPoint(e)}getPoint(t){return this.pos.add(this.dir.scale(t))}}class Ri{constructor(){this._dynamicCollisionTree=new Ai,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[]}getColliders(){return this._colliders}rayCast(t,e){var i,s,n;const r=[],o=null!==(i=null==e?void 0:e.maxDistance)&&void 0!==i?i:1/0,a=null!==(s=null==e?void 0:e.collisionGroup)&&void 0!==s?s:Si.All,l=null!==(n=null==e?void 0:e.searchAllColliders)&&void 0!==n&&n;return this._dynamicCollisionTree.rayCastQuery(t,o,(e=>{var i;const s=e.owner.get(Gi);if(a.mask!==Si.All.mask&&(null===(i=null==s?void 0:s.group)||void 0===i?void 0:i.mask)!==a.mask)return!1;const n=e.rayCast(t,o);return!(!n||(r.push({distance:n.sub(t.pos).distance(),point:n,collider:e,body:s}),l))})),r}track(t){if(t)if(t instanceof Di){const e=t.getColliders();for(const i of e)i.owner=t.owner,this._colliders.push(i),this._dynamicCollisionTree.trackCollider(i)}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else nt.getInstance().warn("Cannot track null collider")}untrack(t){if(t)if(t instanceof Di){const e=t.getColliders();for(const t of e){const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}}else{const e=this._colliders.indexOf(t);-1!==e&&this._colliders.splice(e,1),this._dynamicCollisionTree.untrackCollider(t)}else nt.getInstance().warn("Cannot untrack a null collider")}_pairExists(t,e){const i=Ei.calculatePairHash(t.id,e.id);return this._pairs.has(i)}broadphase(t,e,i){const s=e/1e3,n=t.filter((t=>{var e,i;const s=null===(e=t.owner)||void 0===e?void 0:e.get(Gi);return(null===(i=t.owner)||void 0===i?void 0:i.active)&&s.collisionType!==ti.PreventCollision}));let r;this._collisionPairCache=[],this._pairs.clear();for(let o=0,a=n.length;o<a;o++)r=n[o],this._dynamicCollisionTree.query(r,(t=>{if(!this._pairExists(r,t)&&Ei.canCollide(r,t)){const e=new Ei(r,t);this._pairs.add(e.id),this._collisionPairCache.push(e)}return!1}));if(i&&(i.physics.pairs=this._collisionPairCache.length),gi.checkForFastBodies)for(const o of n){const t=o.owner.get(Gi);if(t.collisionType!==ti.Active)continue;const e=t.vel.size*s+.5*t.acc.size*s*s,n=Math.min(o.bounds.height,o.bounds.width);if(gi.disableMinimumSpeedForFastBody||e>n/2){i&&i.physics.fastBodies++;const s=t.globalPos.sub(t.oldPos),n=o.center,r=o.getFurthestPoint(t.vel),a=r.sub(s),l=new ki(a,t.vel);let h;l.pos=l.pos.add(l.dir.scale(-2*gi.surfaceEpsilon));let c=new bt(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(l,e+2*gi.surfaceEpsilon,(t=>{if(!this._pairExists(o,t)&&Ei.canCollide(o,t)){const i=t.rayCast(l,e+10*gi.surfaceEpsilon);if(i){const e=i.sub(a);e.size<c.size&&(c=e,h=t)}}return!1})),h&&bt.isValid(c)){const e=new Ei(o,h);this._pairs.has(e.id)||(this._pairs.add(e.id),this._collisionPairCache.push(e));const s=n.sub(r);t.globalPos=a.add(s).add(c).add(l.dir.scale(10*gi.surfaceEpsilon)),o.update(t.transform.get()),i&&i.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(t,e){let i=[];for(let s=0;s<t.length;s++){const n=t[s].collide();if(i=i.concat(n),e&&n.length>0)for(const t of n)e.physics.contacts.set(t.id,t)}return e&&(e.physics.collisions+=i.length),i}update(t){let e=0;const i=t.length;for(let s=0;s<i;s++)this._dynamicCollisionTree.updateCollider(t[s])&&e++;return e}debug(t){this._dynamicCollisionTree.debug(t)}}class Ii{constructor(){this.id=y("collider",Ii._ID++),this.__compositeColliderId=null,this.events=new x}touching(t){return!!this.collide(t)}}Ii._ID=0;class Di extends Ii{constructor(t){super(),this._collisionProcessor=new Ri,this._dynamicAABBTree=new Ai,this._colliders=[];for(const e of t)this.addCollider(e)}clearColliders(){this._colliders=[]}addCollider(t){t.events.pipe(this.events),t.__compositeColliderId=this.id,this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}removeCollider(t){t.events.pipe(this.events),t.__compositeColliderId=null,Ft(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}getColliders(){return this._colliders}get worldPos(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:bt.Zero}get center(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:bt.Zero}get bounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.bounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new Rt).translate(this.worldPos))}get localBounds(){var t,e;const i=this.getColliders();return i.reduce(((t,e)=>t.combine(e.localBounds)),null!==(e=null===(t=i[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new Rt)}get axes(){const t=this.getColliders();let e=[];for(const i of t)e=e.concat(i.axes);return e}getFurthestPoint(t){const e=this.getColliders(),i=[];for(const r of e)i.push(r.getFurthestPoint(t));let s=i[0],n=-Number.MAX_VALUE;for(const r of i){const e=r.dot(t);e>n&&(s=r,n=e)}return s}getInertia(t){const e=this.getColliders();let i=0;for(const s of e)i+=s.getInertia(t);return i}collide(t){let e=[t];t instanceof Di&&(e=t.getColliders());const i=[];for(const n of e)this._dynamicAABBTree.query(n,(t=>(i.push(new Ei(n,t)),!1)));let s=[];for(const n of i)s=s.concat(n.collide());return s}getClosestLineBetween(t){const e=this.getColliders(),i=[];if(t instanceof Di){const s=t.getColliders();for(const t of e)for(const e of s){const s=t.getClosestLineBetween(e);s&&i.push(s)}}else for(const s of e){const e=t.getClosestLineBetween(s);e&&i.push(e)}if(i.length){let t=i[0].getLength(),e=i[0];for(const s of i){const i=s.getLength();i<t&&(t=i,e=s)}return e}return null}contains(t){const e=this.getColliders();for(const i of e)if(i.contains(t))return!0;return!1}rayCast(t,e){const i=this.getColliders(),s=[];for(const n of i){const i=n.rayCast(t,e);i&&s.push(i)}if(s.length){let e=s[0],i=e.dot(t.dir);for(const n of s){const s=t.dir.dot(n);s<i&&(e=n,i=s)}return e}return null}project(t){const e=this.getColliders(),i=[];for(const s of e){const e=s.project(t);e&&i.push(e)}if(i.length){const t=new Pi(i[0].min,i[0].max);for(const e of i)t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max);return t}return null}update(t){if(t){const e=this.getColliders();for(const i of e)i.owner=this.owner,i.update(t)}}debug(t,e){const i=this.getColliders();for(const s of i)s.debug(t,e)}clone(){return new Di(this._colliders.map((t=>t.clone())))}}class Mi{constructor(t,e){this.begin=t,this.end=e}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}dir(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){if(this._slope)return this._slope;const t=this.begin,e=this.end,i=t.distance(e);return this._slope=e.sub(t).scale(1/i)}getEdge(){const t=this.begin;return this.end.sub(t)}getLength(){if(this._length)return this._length;const t=this.begin,e=this.end,i=t.distance(e);return this._length=i}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new Mi(this.end,this.begin)}below(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}clip(t,e){let i=t;i=i.normalize();const s=i.dot(this.begin)-e,n=i.dot(this.end)-e,r=[];if(s<=0&&r.push(this.begin),n<=0&&r.push(this.end),s*n<0){const t=s/(s-n);r.push(this.begin.add(this.end.sub(this.begin).scale(t)))}return 2!==r.length?null:new Mi(r[0],r[1])}distanceToPoint(t,e=!1){const i=t.x,s=t.y,n=this.getLength(),r=((this.end.y-this.begin.y)*i-(this.end.x-this.begin.x)*s+this.end.x*this.begin.y-this.end.y*this.begin.x)/n;return e?r:Math.abs(r)}findVectorToPoint(t){const e=this.begin.sub(t),i=this.getSlope();return e.sub(i.scale(e.dot(i)))}findPoint(t=null,e=null){const i=this.slope,s=this.intercept;if(null!==t)return new bt(t,i*t+s);if(null!==e)return new bt((e-s)/i,e);throw new Error("You must provide an X or a Y value")}hasPoint(){let t,e=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])t=new bt(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof bt))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}const i=t.x-this.begin.x,s=t.y-this.begin.y,n=this.end.x-this.begin.x,r=this.end.y-this.begin.y,o=i*r-s*n;return!(Math.abs(o)>e)&&(Math.abs(n)>=Math.abs(r)?n>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:r>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}function Fi(t,e,i,s){const n=t.sub(i),r=e.dot(e),o=e.dot(s),a=s.dot(s),l=e.dot(n),h=s.dot(n),c=r*a-o*o;let u=c,d=c;if(0===c||c<=.01){const e=l/o;return new Mi(t,i.add(s.scale(e)))}let p=o*h-a*l,f=r*h-o*l;return p<0?(p=0,f=h,d=a):p>u&&(p=u,f=h+o,d=a),f<0?(f=0,-l<0?p=0:-l>r?p=u:(p=-l,u=r)):f>d&&(f=d,-l+o<0?p=0:-l+o>r?p=u:(p=-l+o,u=r)),p=Math.abs(p)<.001?0:p/u,f=Math.abs(f)<.001?0:f/d,new Mi(t.add(e.scale(p)),i.add(s.scale(f)))}const Li={PolygonPolygonClosestLine(t,e){const i=e.worldPos,s=i.sub(t.worldPos),n=s.negate(),r=new ki(t.worldPos,s),o=new ki(i,n),a=t.rayCast(r).add(r.dir.scale(.1)),l=e.rayCast(o).add(o.dir.scale(.1)),h=t.getClosestFace(a),c=e.getClosestFace(l);return Fi(h.face.begin,h.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),s=new ki(t.worldPos,i),n=t.rayCast(s).add(s.dir.scale(.1)),r=t.getClosestFace(n),o=r.face.begin,a=r.face.getEdge(),l=e.asLine();return Fi(o,a,l.begin,l.getEdge())},PolygonCircleClosestLine(t,e){const i=e.worldPos,s=i.sub(t.worldPos),n=new ki(t.worldPos,s.normalize()),r=t.rayCast(n).add(n.dir.scale(.1)),o=t.getClosestFace(r),a=o.face.begin,l=o.face.getEdge();let h=(l.x*(i.x-a.x)+l.y*(i.y-a.y))/(l.x*l.x+l.y*l.y);h>1?h=1:h<0&&(h=0);const c=Math.sqrt(Math.pow(a.x+l.x*h-i.x,2)+Math.pow(a.y+l.y*h-i.y,2))-e.radius,u=(a.x+l.x*h-i.x)*e.radius/(e.radius+c),d=(a.y+l.y*h-i.y)*e.radius/(e.radius+c);return new Mi(l.scale(h).add(a),new bt(i.x+u,i.y+d))},CircleCircleClosestLine(t,e){const i=e.worldPos.sub(t.worldPos),s=t.worldPos.sub(e.worldPos),n=new ki(t.worldPos,i),r=new ki(e.worldPos,s),o=t.rayCast(n),a=e.rayCast(r);return new Mi(o,a)},CircleEdgeClosestLine(t,e){const i=t.worldPos,s=e.asLine(),n=s.begin,r=s.getEdge();let o=(r.x*(i.x-n.x)+r.y*(i.y-n.y))/(r.x*r.x+r.y*r.y);o>1?o=1:o<0&&(o=0);const a=Math.sqrt(Math.pow(n.x+r.x*o-i.x,2)+Math.pow(n.y+r.y*o-i.y,2))-t.radius,l=(n.x+r.x*o-i.x)*t.radius/(t.radius+a),h=(n.y+r.y*o-i.y)*t.radius/(t.radius+a);return new Mi(r.scale(o).add(n),new bt(i.x+l,i.y+h))},EdgeEdgeClosestLine(t,e){const i=t.asLine(),s=i.begin,n=i.getEdge(),r=e.asLine();return Fi(s,n,r.begin,r.getEdge())}};class Bi extends Ii{get worldPos(){return this._globalMatrix.getPosition()}get radius(){var t;const e=this._transform,i=null!==(t=null==e?void 0:e.globalScale)&&void 0!==t?t:bt.One;return this._naturalRadius*Math.min(i.x,i.y)}set radius(t){var e;const i=this._transform,s=null!==(e=null==i?void 0:i.globalScale)&&void 0!==e?e:bt.One;this._naturalRadius=t/Math.min(s.x,s.y)}constructor(t){super(),this.offset=bt.Zero,this._globalMatrix=Nt.identity(),this.offset=t.offset||bt.Zero,this.radius=t.radius||0,this._globalMatrix.translate(this.offset.x,this.offset.y)}clone(){return new Bi({offset:this.offset.clone(),radius:this.radius})}get center(){return this._globalMatrix.getPosition()}contains(t){var e,i;return(null!==(i=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==i?i:this.offset).distance(t)<=this.radius}rayCast(t,e=1/0){const i=this.center,s=t.dir,n=t.pos,r=Math.sqrt(Math.pow(s.dot(n.sub(i)),2)-Math.pow(n.sub(i).distance(),2)+Math.pow(this.radius,2));if(r<0)return null;{let o=0;if(0===r)return o=-s.dot(n.sub(i)),o>0&&o<e?t.getPoint(o):null;{const o=-s.dot(n.sub(i))+r,a=-s.dot(n.sub(i))-r,l=[];o>=0&&l.push(o),a>=0&&l.push(a);const h=Math.min(...l);return h<=e?t.getPoint(h):null}}}getClosestLineBetween(t){if(t instanceof Bi)return Li.CircleCircleClosestLine(this,t);if(t instanceof Vi)return Li.PolygonCircleClosestLine(t,this).flip();if(t instanceof Ui)return Li.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Bi)return Ni.CollideCircleCircle(this,t);if(t instanceof Vi)return Ni.CollideCirclePolygon(this,t);if(t instanceof Ui)return Ni.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){return this.center.add(t.normalize().scale(this.radius))}getFurthestLocalPoint(t){return t.normalize().scale(this.radius)}get bounds(){var t,e,i;const s=this._transform,n=null!==(t=null==s?void 0:s.globalScale)&&void 0!==t?t:bt.One,r=null!==(e=null==s?void 0:s.globalRotation)&&void 0!==e?e:0,o=null!==(i=null==s?void 0:s.globalPos)&&void 0!==i?i:bt.Zero;return new Rt(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(r).scale(n).translate(o)}get localBounds(){return new Rt(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(t){return t*this.radius*this.radius/2}update(t){var e;this._transform=t;(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],i=this.center.dot(t);return e.push(i),e.push(i+this.radius),e.push(i-this.radius),new Pi(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){var i,s,n,r;const o=this._transform,a=null!==(i=null==o?void 0:o.globalScale)&&void 0!==i?i:bt.One,l=null!==(s=null==o?void 0:o.globalRotation)&&void 0!==s?s:0,h=null!==(n=null==o?void 0:o.globalPos)&&void 0!==n?n:bt.Zero;t.save(),t.translate(h.x,h.y),t.rotate(l),t.scale(a.x,a.y),t.drawCircle(null!==(r=this.offset)&&void 0!==r?r:bt.Zero,this._naturalRadius,St.Transparent,e,2),t.restore()}}class Oi{constructor(t,e,i,s,n,r,o,a){var l,h;this._canceled=!1,this.colliderA=t,this.colliderB=e,this.mtv=i,this.normal=s,this.tangent=n,this.points=r,this.localPoints=o,this.info=a,this.id=Ei.calculatePairHash(t.id,e.id),(t.__compositeColliderId||e.__compositeColliderId)&&(this.id+="|"+Ei.calculatePairHash(null!==(l=t.__compositeColliderId)&&void 0!==l?l:t.id,null!==(h=e.__compositeColliderId)&&void 0!==h?h:e.id))}matchAwake(){const t=this.colliderA.owner.get(Gi),e=this.colliderB.owner.get(Gi);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==ti.Fixed&&e.sleepMotion>=gi.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==ti.Fixed&&t.sleepMotion>=gi.wakeThreshold&&e.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class zi{static findPolygonPolygonSeparation(t,e){let i=-Number.MAX_VALUE,s=null,n=null,r=-1,o=null;const a=t.getSides(),l=t.getLocalSides();for(let h=0;h<a.length;h++){const t=a[h],l=t.normal(),c=e.getFurthestPoint(l.negate()),u=t.distanceToPoint(c,!0);u>i&&(i=u,s=t,n=l,r=h,o=c)}return{collider:t,separation:n?i:99,axis:n,side:s,localSide:l[r],sideId:r,point:o,localPoint:n?e.getFurthestLocalPoint(n.negate()):null}}static findCirclePolygonSeparation(t,e){const i=e.axes,s=e.center.sub(t.worldPos),n=e.getFurthestPoint(s.negate());i.push(n.sub(t.worldPos).normalize());let r=Number.MAX_VALUE,o=null,a=-1;for(let l=0;l<i.length;l++){const s=e.project(i[l]),n=t.project(i[l]),h=s.getOverlap(n);if(h<=0)return null;h<r&&(r=h,o=i[l],a=l)}return a<0?null:o.normalize().scale(r)}}const Ni={CollideCircleCircle(t,e){const i=t.worldPos,s=e.worldPos,n=t.radius+e.radius,r=i.distance(s);if(r>n)return[];const o=n-r,a=s.sub(i).normalize(),l=a.perpendicular(),h=a.scale(o),c=t.getFurthestPoint(a),u=t.getFurthestLocalPoint(a);return[new Oi(t,e,h,a,l,[c],[u],{collider:t,separation:o,axis:a,point:c})]},CollideCirclePolygon(t,e){var i,s;let n=zi.findCirclePolygonSeparation(t,e);if(!n)return[];const r=n.dot(e.center.sub(t.center));n=r<0?n.negate():n;const o=t.getFurthestPoint(n),a=(null!==(s=null===(i=t.owner)||void 0===i?void 0:i.get(bi))&&void 0!==s?s:new bi).applyInverse(o),l=n.normalize(),h={collider:t,separation:-n.size,axis:l,point:o,localPoint:a,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Oi(t,e,n,l,l.perpendicular(),[o],[a],h)]},CollideCircleEdge(t,e){const i=t.center,s=e.asLine(),n=s.end.sub(s.begin),r=n.dot(s.end.sub(i)),o=n.dot(i.sub(s.begin)),a=e.asLine(),l=e.asLocalLine();if(o<=0){const n=s.begin.sub(i),r=n.dot(n);if(r>t.radius*t.radius)return[];const o=n.normalize(),h=t.radius-Math.sqrt(r),c={collider:t,separation:h,axis:o,point:a.begin,side:a,localSide:l};return[new Oi(t,e,o.scale(h),o,o.perpendicular(),[a.begin],[l.begin],c)]}if(r<=0){const n=s.end.sub(i),r=n.dot(n);if(r>t.radius*t.radius)return[];const o=n.normalize(),h=t.radius-Math.sqrt(r),c={collider:t,separation:h,axis:o,point:a.end,side:a,localSide:l};return[new Oi(t,e,o.scale(h),o,o.perpendicular(),[a.end],[l.end],c)]}const h=n.dot(n),c=s.begin.scale(r).add(s.end.scale(o)).scale(1/h),u=i.sub(c),d=u.dot(u);if(d>t.radius*t.radius)return[];let p=n.perpendicular();p.dot(i.sub(s.begin))<0&&(p.x=-p.x,p.y=-p.y),p=p.normalize();const f=t.radius-Math.sqrt(d),g=p.scale(f),m={collider:t,separation:f,axis:p,point:c,side:a,localSide:l};return[new Oi(t,e,g,p.negate(),p.negate().perpendicular(),[c],[c.sub(e.worldPos)],m)]},CollideEdgeEdge:()=>[],CollidePolygonEdge(t,e){var i;const s=t.center,n=e.center.sub(s).normalize(),r=new Vi({points:[e.begin,e.end,e.end.add(n.scale(100)),e.begin.add(n.scale(100))],offset:e.offset});r.owner=e.owner;(null===(i=e.owner)||void 0===i?void 0:i.get(bi))&&r.update(e.owner.get(bi).get());const o=this.CollidePolygonPolygon(t,r);return o.length&&(o[0].colliderB=e,o[0].id=Ei.calculatePairHash(t.id,e.id)),o},CollidePolygonPolygon(t,e){var i,s,n,r;const o=zi.findPolygonPolygonSeparation(t,e);if(o.separation>0)return[];const a=zi.findPolygonPolygonSeparation(e,t);if(a.separation>0)return[];const l=o.separation>a.separation?o:a,h=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,u=c.dir().normalize(),d=h.clip(u.negate(),-u.dot(c.begin));let p=null;if(d&&(p=d.clip(u,u.dot(c.end))),p){const o=p.getPoints().filter((t=>c.below(t)));let a=l.axis,h=a.perpendicular();e.center.sub(t.center).dot(a)<0&&(a=a.negate(),h=a.perpendicular());let u=[];if(l.collider===t){const t=null!==(s=null===(i=e.owner)||void 0===i?void 0:i.get(bi))&&void 0!==s?s:new bi;u=o.map((e=>t.applyInverse(e)))}else{const e=null!==(r=null===(n=t.owner)||void 0===n?void 0:n.get(bi))&&void 0!==r?r:new bi;u=o.map((t=>e.applyInverse(t)))}return[new Oi(t,e,a.scale(-l.separation),a,h,o,u,l)]}return[]},FindContactSeparation(t,e){var i,s,n,r;const o=t.colliderA,a=null!==(s=null===(i=t.colliderA.owner)||void 0===i?void 0:i.get(bi))&&void 0!==s?s:new bi,l=t.colliderB,h=null!==(r=null===(n=t.colliderB.owner)||void 0===n?void 0:n.get(bi))&&void 0!==r?r:new bi;if(o instanceof Bi&&l instanceof Bi){return-(o.radius+l.radius-a.pos.distance(h.pos))}if(o instanceof Vi&&l instanceof Vi&&t.info.localSide){let i,s;return t.info.collider===o?(i=new Mi(a.apply(t.info.localSide.begin),a.apply(t.info.localSide.end)),s=h.apply(e)):(i=new Mi(h.apply(t.info.localSide.begin),h.apply(t.info.localSide.end)),s=a.apply(e)),i.distanceToPoint(s,!0)}if(o instanceof Vi&&l instanceof Bi||l instanceof Vi&&o instanceof Bi){const i=a.apply(e);if(t.info.side)return t.info.side.distanceToPoint(i,!0)}if(o instanceof Ui&&l instanceof Vi||l instanceof Ui&&o instanceof Vi){let i;if(i=t.info.collider===o?h.apply(e):a.apply(e),t.info.side)return t.info.side.distanceToPoint(i,!0)}if(o instanceof Bi&&l instanceof Ui||l instanceof Bi&&o instanceof Ui){const i=h.apply(e);let s;o instanceof Bi&&(s=o.getFurthestPoint(t.normal));const n=i.distance(s);if(t.info.side)return n>0?-n:0}return 0}};class Ui extends Ii{constructor(t){var e;super(),this._globalMatrix=Nt.identity(),this.begin=t.begin||bt.Zero,this.end=t.end||bt.Zero,this.offset=null!==(e=t.offset)&&void 0!==e?e:bt.Zero}clone(){return new Ui({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var t;const e=this._transform;return null!==(t=null==e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}get center(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.average(e)}_getTransformedBegin(){return this._globalMatrix.multiply(this.begin)}_getTransformedEnd(){return this._globalMatrix.multiply(this.end)}getSlope(){const t=this._getTransformedBegin(),e=this._getTransformedEnd(),i=t.distance(e);return e.sub(t).scale(1/i)}getLength(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}contains(){return!1}rayCast(t,e=1/0){const i=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==i.cross(t.dir))return null;const s=t.dir.cross(this.getSlope());if(0===s)return null;const n=i.cross(this.getSlope())/s;if(n>=0&&n<=e){const e=i.cross(t.dir)/s/this.getLength();if(e>=0&&e<=1)return t.getPoint(n)}return null}getClosestLineBetween(t){if(t instanceof Bi)return Li.CircleEdgeClosestLine(t,this);if(t instanceof Vi)return Li.PolygonEdgeClosestLine(t,this).flip();if(t instanceof Ui)return Li.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Bi)return Ni.CollideCircleEdge(t,this);if(t instanceof Vi)return Ni.CollidePolygonEdge(t,this);if(t instanceof Ui)return Ni.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this._getTransformedBegin(),i=this._getTransformedEnd();return t.dot(e)>0?e:i}_boundsFromBeginEnd(t,e,i=10){return new Rt(Math.min(t.x,e.x)-i,Math.min(t.y,e.y)-i,Math.max(t.x,e.x)+i,Math.max(t.y,e.y)+i)}get bounds(){const t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new Mi(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new Mi(this.begin,this.end)}get axes(){const t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}getInertia(t){const e=this.end.sub(this.begin).distance()/2;return t*e*e}update(t){var e;this._transform=t;(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}project(t){const e=[],i=[this._getTransformedBegin(),this._getTransformedEnd()],s=i.length;for(let n=0;n<s;n++)e.push(i[n].dot(t));return new Pi(Math.min.apply(Math,e),Math.max.apply(Math,e))}debug(t,e){const i=this._getTransformedBegin(),s=this._getTransformedEnd();t.drawLine(i,s,e,2),t.drawCircle(i,2,e),t.drawCircle(s,2,e)}}class Vi extends Ii{set points(t){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._sidesDirty=!0,this._points=t}get points(){return this._points}constructor(t){var e,i;super(),this._logger=nt.getInstance(),this._transformedPoints=[],this._sides=[],this._localSides=[],this._globalMatrix=Nt.identity(),this._transformedPointsDirty=!0,this._sidesDirty=!0,this._localSidesDirty=!0,this._localBoundsDirty=!0,this.offset=null!==(e=t.offset)&&void 0!==e?e:bt.Zero,this._globalMatrix.translate(this.offset.x,this.offset.y),this.points=null!==(i=t.points)&&void 0!==i?i:[];this._isCounterClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isCounterClockwiseWinding(t){let e=0;for(let i=0;i<t.length;i++)e+=(t[(i+1)%t.length].x-t[i].x)*(t[(i+1)%t.length].y+t[i].y);return e<0}isConvex(){if(this.points.length<3)return!1;let t=this.points[this.points.length-2],e=this.points[this.points.length-1],i=Math.atan2(e.y-t.y,e.x-t.x),s=0,n=0,r=0;for(const[o,a]of this.points.entries()){if(t=e,s=i,e=a,i=Math.atan2(e.y-t.y,e.x-t.x),t.equals(e))return!1;let l=i-s;if(l<=-Math.PI?l+=2*Math.PI:l>Math.PI&&(l-=2*Math.PI),0===o){if(0===l)return!1;n=l>0?1:-1}else if(n*l<=0)return!1;r+=l}return 1===Math.abs(Math.round(r/(2*Math.PI)))}tessellate(){const t=[];for(let e=1;e<this.points.length-2;e++)t.push([this.points[0],this.points[e+1],this.points[e+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new Di(t.map((t=>Hi.Polygon(t))))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");function t(t,e){return t>=e.length?e[t%e.length]:t<0?e[t%e.length+e.length]:e[t]}function e(t,e,i,s){const n=i.sub(e),r=s.sub(i),o=e.sub(s),a=t.sub(e),l=t.sub(i),h=t.sub(s),c=n.cross(a),u=r.cross(l),d=o.cross(h);return!(c>0||u>0||d>0)}const i=[],s=[...this.points],n=yt(0,this.points.length-1);for(;n.length>3;)for(let r=0;r<n.length;r++){const o=n[r],a=t(r-1,n),l=t(r+1,n),h=s[o],c=s[a],u=s[l],d=c.sub(h);if(!(u.sub(h).cross(d)>0))continue;let p=!0;for(let t=0;t<n.length;t++){const i=n[t];if(i===o||i===a||i===l)continue;if(e(s[i],c,h,u)){p=!1;break}}if(p){i.push([c,h,u]),n.splice(r,1);break}}return i.push([s[n[0]],s[n[1]],s[n[2]]]),new Di(i.map((t=>Hi.Polygon(t))))}clone(){return new Vi({offset:this.offset.clone(),points:this.points.map((t=>t.clone()))})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const t=this.points,e=t.length;this._transformedPoints.length=0;for(let i=0;i<e;i++)this._transformedPoints[i]=this._globalMatrix.multiply(t[i].clone())}getTransformedPoints(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}getSides(){if(this._sidesDirty){const t=[],e=this.getTransformedPoints(),i=e.length;for(let s=0;s<i;s++)t.push(new Mi(e[s],e[(s+1)%i]));this._sides=t,this._sidesDirty=!1}return this._sides}getLocalSides(){if(this._localSidesDirty){const t=[],e=this.points,i=e.length;for(let s=0;s<i;s++)t.push(new Mi(e[s],e[(s+1)%i]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}findSide(t){const e=this.getSides();let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=e[n],o=r.normal().dot(t);o>s&&(i=r,s=o)}return i}findLocalSide(t){const e=this.getLocalSides();let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=e[n],o=r.normal().dot(t);o>s&&(i=r,s=o)}return i}get axes(){const t=[],e=this.getSides();for(let i=0;i<e.length;i++)t.push(e[i].normal());return t}update(t){var e;if(t){this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0;(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}}contains(t){const e=new ki(t,new bt(1,0));return this.getSides().reduce((function(t,i){return e.intersect(i)>=0?t+1:t}),0)%2!=0}getClosestLineBetween(t){if(t instanceof Bi)return Li.PolygonCircleClosestLine(this,t);if(t instanceof Vi)return Li.PolygonPolygonClosestLine(this,t);if(t instanceof Ui)return Li.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}collide(t){if(t instanceof Bi)return Ni.CollideCirclePolygon(t,this);if(t instanceof Vi)return Ni.CollidePolygonPolygon(this,t);if(t instanceof Ui)return Ni.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof t)}getFurthestPoint(t){const e=this.getTransformedPoints();let i=null,s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=t.dot(e[n]);r>s&&(s=r,i=e[n])}return i}getFurthestLocalPoint(t){const e=this.points;let i=e[0],s=-Number.MAX_VALUE;for(let n=0;n<e.length;n++){const r=t.dot(e[n]);r>s&&(s=r,i=e[n])}return i}getClosestFace(t){const e=this.getSides();let i=Number.POSITIVE_INFINITY,s=-1,n=-1;for(let r=0;r<e.length;r++){const o=e[r].distanceToPoint(t);o<i&&(i=o,s=r,n=o)}return-1!==s?{distance:e[s].normal().scale(n),face:e[s]}:null}get bounds(){return this.localBounds.transform(this._globalMatrix)}get localBounds(){return this._localBoundsDirty&&(this._localBounds=Rt.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}getInertia(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;let e=0,i=0;const s=this.points;for(let n=0;n<s.length;n++){const t=(n+1)%s.length,r=s[t].cross(s[n]);e+=r*(s[n].dot(s[n])+s[n].dot(s[t])+s[t].dot(s[t])),i+=r}return this._cachedMass=t,this._cachedInertia=t/6*(e/i)}rayCast(t,e=1/0){const i=this.getSides(),s=i.length;let n=Number.MAX_VALUE,r=-1;for(let o=0;o<s;o++){const s=t.intersect(i[o]);s>=0&&s<n&&s<=e&&(n=s,r=o)}return r>=0?t.getPoint(n):null}project(t){const e=this.getTransformedPoints(),i=e.length;let s=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<i;r++){const i=e[r].dot(t);s=Math.min(s,i),n=Math.max(n,i)}return new Pi(s,n)}debug(t,e){const i=this.getTransformedPoints()[0],s=[i,...this.getTransformedPoints(),i];for(let n=0;n<s.length-1;n++)t.drawLine(s[n],s[n+1],e,2),t.drawCircle(s[n],2,e),t.drawCircle(s[n+1],2,e)}}class Hi{static Box(t,e,i=bt.Half,s=bt.Zero){return new Vi({points:new Rt(-t*i.x,-e*i.y,t-t*i.x,e-e*i.y).getPoints(),offset:s})}static Polygon(t,e=bt.Zero){return new Vi({points:t,offset:e})}static Circle(t,e=bt.Zero){return new Bi({radius:t,offset:e})}static Edge(t,e){return new Ui({begin:t,end:e})}static Capsule(t,e,i=bt.Zero){const s=nt.getInstance();t===e&&s.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider");if(e>=t){return new Di([Hi.Circle(t/2,Ct(0,-e/2+t/2).add(i)),Hi.Box(t,e-t,bt.Half,i),Hi.Circle(t/2,Ct(0,e/2-t/2).add(i))])}return new Di([Hi.Circle(e/2,Ct(-t/2+e/2,0).add(i)),Hi.Box(t-e,e,bt.Half,i),Hi.Circle(e/2,Ct(t/2-e/2,0).add(i))])}}class ji extends yi{constructor(t){super(),this.type="ex.collider",this.events=new x,this.$colliderAdded=new wi,this.$colliderRemoved=new wi,this.set(t)}get(){return this._collider}set(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,t.events.pipe(this.events),this.$colliderAdded.notifyAll(t),this.update()),t}clear(){this._collider&&(this._collider.events.unpipe(this.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}clone(){return new ji(this._collider.clone())}get bounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new Rt}get localBounds(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new Rt}update(){var t;const e=null===(t=this.owner)||void 0===t?void 0:t.get(bi);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e.get()))}collide(t){let e=this._collider,i=t._collider;if(!e||!i)return[];let s=!1;if(i instanceof Di&&(e=i,i=this._collider,s=!0),this._collider){const n=e.collide(i);return n?(s&&n.forEach((e=>{e.mtv=e.mtv.negate(),e.normal=e.normal.negate(),e.tangent=e.normal.perpendicular(),e.colliderA=this._collider,e.colliderB=t._collider})),n):[]}return[]}onAdd(t){this._collider&&this.update(),this.events.on("precollision",(e=>{const i=e;t.events.emit("precollision",new V(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("postcollision",(e=>{const i=e;t.events.emit("postcollision",new H(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("collisionstart",(e=>{const i=e;t.events.emit("collisionstart",new q(i.target.owner,i.other.owner,i.contact))})),this.events.on("collisionend",(e=>{const i=e;t.events.emit("collisionend",new X(i.target.owner,i.other.owner))}))}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(t,e,i=bt.Half,s=bt.Zero){const n=Hi.Box(t,e,i,s);return this.set(n)}usePolygonCollider(t,e=bt.Zero){const i=Hi.Polygon(t,e);return this.set(i)}useCircleCollider(t,e=bt.Zero){const i=Hi.Circle(t,e);return this.set(i)}useEdgeCollider(t,e){const i=Hi.Edge(t,e);return this.set(i)}useCompositeCollider(t){return this.set(new Di(t))}}var Wi,$i;($i=Wi||(Wi={})).Rotation="rotation",$i.X="x",$i.Y="y";class Gi extends yi{constructor(t){var e,i,s;super(),this.type="ex.body",this.dependencies=[bi,Ci],this.id=y("body",Gi._ID++),this.events=new x,this._oldTransform=new vi,this.__oldTransformCaptured=!1,this.enableFixedUpdateInterpolate=!0,this.collisionType=ti.PreventCollision,this.group=Si.All,this._mass=gi.defaultMass,this.sleepMotion=5*gi.sleepEpsilon,this.canSleep=gi.bodiesCanSleepByDefault,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldVel=new bt(0,0),this.oldAcc=bt.Zero,t&&(this.collisionType=null!==(e=t.type)&&void 0!==e?e:this.collisionType,this.group=null!==(i=t.group)&&void 0!==i?i:this.group,this.useGravity=null!==(s=t.useGravity)&&void 0!==s?s:this.useGravity)}get matrix(){return this.transform.get().matrix}get mass(){return this._mass}set mass(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}get inverseMass(){return this.collisionType===ti.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(t){this._sleeping=t,t?(this.vel=bt.Zero,this.acc=bt.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*gi.sleepEpsilon}updateMotion(){this._sleeping&&this.setSleeping(!0);const t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=gi.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=gt(this.sleepMotion,0,10*gi.sleepEpsilon),this.canSleep&&this.sleepMotion<gi.sleepEpsilon&&this.setSleeping(!0)}get inertia(){if(this._cachedInertia)return this._cachedInertia;const t=this.owner.get(ji);if(t){t.$colliderAdded.subscribe((()=>{this._cachedInertia=null})),t.$colliderRemoved.subscribe((()=>{this._cachedInertia=null}));const e=t.get();if(e)return this._cachedInertia=e.getInertia(this.mass)}return 0}get inverseInertia(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===ti.Fixed?0:1/this.inertia}get active(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}get center(){return this.globalPos}get transform(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(bi)}get motion(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(Ci)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t}get globalPos(){return this.transform.globalPos}set globalPos(t){this.transform.globalPos=t}get oldPos(){return this._oldTransform.pos}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t}get torque(){return this.motion.torque}set torque(t){this.motion.torque=t}get oldRotation(){return this._oldTransform.rotation}get rotation(){return this.transform.globalRotation}set rotation(t){this.transform.globalRotation=t}get scale(){return this.transform.globalScale}set scale(t){this.transform.globalScale=t}get oldScale(){return this._oldTransform.scale}get scaleFactor(){return this.motion.scaleFactor}set scaleFactor(t){this.motion.scaleFactor=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}applyImpulse(t,e){if(this.collisionType!==ti.Active)return;const i=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Wi.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(Wi.Y)&&(i.y=0),this.vel.addEqual(i),!this.limitDegreeOfFreedom.includes(Wi.Rotation)){const i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}applyLinearImpulse(t){if(this.collisionType!==ti.Active)return;const e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Wi.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Wi.Y)&&(e.y=0),this.vel=this.vel.add(e)}applyAngularImpulse(t,e){if(this.collisionType===ti.Active&&!this.limitDegreeOfFreedom.includes(Wi.Rotation)){const i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}captureOldTransform(){this.__oldTransformCaptured=!0,this.transform.get().clone(this._oldTransform),this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}clone(){return super.clone()}}Gi._ID=0;class qi{constructor(t){this.data=t,this.type="Component Added"}}function Xi(t){return!!t&&"Component Added"===t.type}class Ki{constructor(t){this.data=t,this.type="Component Removed"}}function Yi(t){return!!t&&"Component Removed"===t.type}const Zi={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class Qi{constructor(t,e){if(this.events=new x,this.id=Qi._ID++,this.scene=null,this._name="anonymous",this.active=!0,this._componentsToRemove=[],this._componentTypeToInstance=new Map,this._componentStringToInstance=new Map,this._tagsMemo=[],this._typesMemo=[],this.componentAdded$=new wi,this.componentRemoved$=new wi,this._parent=null,this.childrenAdded$=new wi,this.childrenRemoved$=new wi,this._children=[],this._isInitialized=!1,this._setName(e),t)for(const i of t)this.addComponent(i)}_setName(t){t&&(this._name=t)}get name(){return this._name}kill(){this.active&&(this.active=!1,this.unparent())}isKilled(){return!this.active}get tags(){return this._tagsMemo}hasTag(t){return this.tags.includes(t)}addTag(t){return this.addComponent(new xi(t))}removeTag(t,e=!1){return this.removeComponent(t,e)}get types(){return this._typesMemo}_rebuildMemos(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((t=>t instanceof xi)).map((t=>t.type)),this._typesMemo=Array.from(this._componentStringToInstance.keys())}getComponents(){return Array.from(this._componentStringToInstance.values())}_notifyAddComponent(t){this._rebuildMemos();const e=new qi({component:t,entity:this});this.componentAdded$.notifyAll(e)}_notifyRemoveComponent(t){const e=new Ki({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}removeChild(t){return t.parent===this&&(Ft(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}removeAllChildren(){for(let t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}getAncestors(){const t=[this];let e=this.parent;for(;e;)t.push(e),e=e.parent;return t.reverse()}getDescendants(){let t=[this],e=[this];for(;e.length>0;){const i=e.pop();e=e.concat(i.children),t=t.concat(i.children)}return t}clone(){const t=new Qi;for(const e of this.types)t.addComponent(this.get(e).clone());for(const e of this.children)t.addChild(e.clone());return t}addTemplate(t,e=!1){for(const i of t.getComponents())this.addComponent(i.clone(),e);for(const i of t.children)this.addChild(i.clone().addTemplate(i));return this}addComponent(t,e=!1){if(this.has(t.type)){if(!e)return this;this.removeComponent(t,!0)}if(t.dependencies&&t.dependencies.length)for(const s of t.dependencies)this.addComponent(new s);t.owner=this;const i=t.constructor;return this._componentTypeToInstance.set(i,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}removeComponent(t,e=!1){return e?"string"==typeof t?this._removeComponentByType(t):t instanceof yi&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}clearComponents(){const t=this.getComponents();for(const e of t)this.removeComponent(e)}_removeComponentByType(t){if(this.has(t)){const e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);const i=e.constructor;this._componentTypeToInstance.delete(i),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}processComponentRemoval(){for(const t of this._componentsToRemove){const e="string"==typeof t?t:t.type;this._removeComponentByType(e)}this._componentsToRemove.length=0}has(t){return"string"==typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}get(t){return"string"==typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.onInitialize(t),this.events.emit("initialize",new K(t,this)),this._isInitialized=!0)}_preupdate(t,e){this.events.emit("preupdate",new I(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.events.emit("postupdate",new D(t,e,this)),this.onPostUpdate(t,e)}onInitialize(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}update(t,e){this._initialize(t),this._preupdate(t,e);for(const i of this.children)i.update(t,e);this._postupdate(t,e)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}function Ji(t){return!!t.tick}Qi._ID=0;class ts{constructor(t,e){this._options=t,this._graphics=e,this.graphics=[]}get name(){return this._options.name}hide(t){if(t){let e=null;e=t instanceof Gt?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((t=>t.graphic!==e)),this._graphics.recalculateBounds()}else this.graphics.length=0}show(t,e){let i;return e={...e},t instanceof Gt?i=this._graphics.copyGraphics?t.clone():t:(i=this._graphics.getGraphic(t),i||nt.getInstance().error(`No such graphic added to component named ${t}. These named graphics are available: `,this._graphics.getNames())),i?(this.graphics.push({graphic:i,options:e}),this._graphics.recalculateBounds(),i):null}use(t,e){return e={...e},this.hide(),this.show(t,e)}get order(){return this._options.order}set order(t){this._options.order=t}get offset(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:bt.Zero}set offset(t){this._options.offset=t}get currentKeys(){var t;return null!==(t=this.name)&&void 0!==t?t:"anonymous"}clone(t){const e=new ts({...this._options},t);return e.graphics=[...this.graphics.map((t=>({graphic:t.graphic.clone(),options:{...t.options}})))],e}}class es{constructor(t){this._component=t,this._layers=[],this._layerMap={},this.default=new ts({name:"default",order:0},t),this._maybeAddLayer(this.default)}create(t){const e=new ts(t,this._component);return this._maybeAddLayer(e)}get(t){return t?this._getLayer(t):this._layers}currentKeys(){const t=[];for(const e of this._layers)t.push(e.currentKeys);return t}has(t){return t in this._layerMap}_maybeAddLayer(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort(((t,e)=>t.order-e.order)),t)}_getLayer(t){return this._layerMap[t]}clone(t){const e=new es(t);e._layerMap={},e._layers=[],e.default=this.default.clone(t),e._maybeAddLayer(e.default);const i=this._layers.filter((t=>"default"!==t.name)).map((e=>e.clone(t)));return i.forEach((t=>e._maybeAddLayer(t))),e}}class is extends yi{getGraphic(t){return this._graphics[t]}getNames(){return Object.keys(this._graphics)}constructor(t){super(),this.type="ex.graphics",this._graphics={},this.visible=!0,this.opacity=1,this.offset=bt.Zero,this.anchor=bt.Half,this.flipHorizontal=!1,this.flipVertical=!1,this.copyGraphics=!1,this._localBounds=null,t={visible:this.visible,...t};const{current:e,anchor:i,opacity:s,visible:n,graphics:r,offset:o,copyGraphics:a,onPreDraw:l,onPostDraw:h}=t;this._graphics=r||{},this.offset=null!=o?o:this.offset,this.opacity=null!=s?s:this.opacity,this.anchor=null!=i?i:this.anchor,this.copyGraphics=null!=a?a:this.copyGraphics,this.onPreDraw=null!=l?l:this.onPreDraw,this.onPostDraw=null!=h?h:this.onPostDraw,this.visible=!!n,this.layers=new es(this),e&&this._graphics[e]&&this.show(this._graphics[e])}get current(){return this.layers.default.graphics}get graphics(){return this._graphics}add(t,e){let i="default",s=null;return"string"==typeof t?(i=t,s=e):s=t,this._graphics[i]=this.copyGraphics?s.clone():s,"default"===i&&this.show("default"),s}show(t,e){const i=this.layers.default.show(t,e);return this.recalculateBounds(),i}use(t,e){const i=this.layers.default.use(t,e);return this.recalculateBounds(),i}hide(t){this.layers.default.hide(t)}set localBounds(t){this._localBounds=t}recalculateBounds(){let t=new Rt;for(const e of this.layers.get())for(const{graphic:i,options:s}of e.graphics){let n=this.anchor,r=this.offset;(null==s?void 0:s.anchor)&&(n=s.anchor),(null==s?void 0:s.offset)&&(r=s.offset);const o=i.localBounds,a=-o.width*n.x+r.x,l=-o.height*n.y+r.y;t=null==i?void 0:i.localBounds.translate(Ct(a+e.offset.x,l+e.offset.y)).combine(t)}this._localBounds=t}get localBounds(){return this._localBounds&&!this._localBounds.hasZeroDimensions()||this.recalculateBounds(),this._localBounds}update(t,e=0){for(const i of this.layers.get())for(const{graphic:s}of i.graphics)Ji(s)&&(null==s||s.tick(t,e))}clone(){const t=new is;return t._graphics={...this._graphics},t.offset=this.offset.clone(),t.opacity=this.opacity,t.anchor=this.anchor.clone(),t.copyGraphics=this.copyGraphics,t.onPreDraw=this.onPreDraw,t.onPostDraw=this.onPostDraw,t.visible=this.visible,t.layers=this.layers.clone(t),t}}class ss extends Ne{constructor(t){super(t),this.width=t.width,this.height=t.height,this.rasterize()}clone(){return new ss({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}class ns extends Ne{get radius(){return this._radius}set radius(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}constructor(t){var e,i,s;super(t),this._radius=0;const n=null!==(e=t.lineWidth)&&void 0!==e?e:t.strokeColor?1:0;this.padding=null!==(i=t.padding)&&void 0!==i?i:2+n/2,this.radius=t.radius,this.filtering=null!==(s=t.filtering)&&void 0!==s?s:Xt.Blended,this.rasterize()}clone(){return new ns({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}class rs extends yi{constructor(){super(...arguments),this.type="ex.pointer",this.useColliderShape=!0,this.useGraphicsBounds=!1}}class os{static CreateReversibleEasingFunction(t){return(e,i,s,n)=>s<i?i-(t(e,s,i,n)-s):t(e,i,s,n)}static CreateVectorEasingFunction(t){return(e,i,s,n)=>new bt(t(e,i.x,s.x,n),t(e,i.y,s.y,n))}}os.Linear=os.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*t/s+e)),os.EaseInQuad=os.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*(t/=s)*t+e)),os.EaseOutQuad=os.CreateReversibleEasingFunction(((t,e,i,s)=>-(i-=e)*(t/=s)*(t-2)+e)),os.EaseInOutQuad=os.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e,(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e))),os.EaseInCubic=os.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e)*(t/=s)*t*t+e)),os.EaseOutCubic=os.CreateReversibleEasingFunction(((t,e,i,s)=>(t/=s,(i-=e)*(--t*t*t+1)+e))),os.EaseInOutCubic=os.CreateReversibleEasingFunction(((t,e,i,s)=>(i-=e,(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e)));class as{constructor(t){this._actions=[],this._completedActions=[],this._entity=t}add(t){this._actions.push(t)}remove(t){const e=this._actions.indexOf(t);this._actions.splice(e,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return 0===this._actions.length}reset(){this._actions=this.getActions();const t=this._actions.length;for(let e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}update(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}class ls{constructor(t,e,i){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new Os(t),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}update(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class hs{constructor(t,e){this._stopped=!1,this._repeatBuilder=e,this._repeatContext=new Os(t),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class cs{constructor(t,e,i,s){if(this._started=!1,this._stopped=!1,this._entity=t,this._tx=t.get(bi),this._motion=t.get(Ci),this._speed=s,this._offset=new bt(e,i),s<=0)throw nt.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+s),new Error("Speed must be greater than 0 pixels per second")}update(t){this._started||(this._started=!0,this._start=new bt(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=Ct(this._end.x,this._end.y),this._motion.vel=Ct(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(t){const e=t.get(bi);return this._stopped||e.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class us{constructor(t,e,i,s){this.entity=t,this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._end=new bt(e,i),this._speed=s}update(t){this._started||(this._started=!0,this._start=new bt(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const e=this._dir.scale(this._speed);this._motion.vel=Ct(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=Ct(this._end.x,this._end.y),this._motion.vel=Ct(0,0))}isComplete(t){const e=t.get(bi);return this._stopped||new bt(e.pos.x,e.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}var ds,ps,fs,gs,ms,_s,vs,ys,xs,ws,bs,Cs;(ps=ds||(ds={}))[ps.ShortestPath=0]="ShortestPath",ps[ps.LongestPath=1]="LongestPath",ps[ps.Clockwise=2]="Clockwise",ps[ps.CounterClockwise=3]="CounterClockwise";class Ss{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._end=e,this._speed=i,this._rotationType=s||ds.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const t=Math.abs(this._end-this._start),e=dt-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+dt)%dt>=Math.PI,this._rotationType){case ds.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ds.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ds.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ds.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Es{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._speed=i,this._offset=e,this._rotationType=s||ds.ShortestPath}update(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const t=Math.abs(this._end-this._start),e=dt-t;switch(t>e?(this._shortDistance=e,this._longDistance=t):(this._shortDistance=t,this._longDistance=e),this._shortestPathIsPositive=(this._start-this._end+dt)%dt>=Math.PI,this._rotationType){case ds.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case ds.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case ds.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case ds.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}class Ps{constructor(t,e,i,s,n){this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._endX=e,this._endY=i,this._speedX=s,this._speedY=n}update(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*t}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const t=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*t}this.isComplete()&&(this._tx.scale=Ct(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Ts{constructor(t,e,i,s){this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._offset=new bt(e,i),this._speedX=this._speedY=s}update(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class As{constructor(t){this._method=null,this._hasBeenCalled=!1,this._method=t}update(t){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class ks{constructor(t,e,i,s,n){this.easingFcn=n,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new bt(0,0),this._lerpEnd=new bt(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._lerpDuration=s,this._lerpEnd=new bt(e,i)}_initialize(){this._lerpStart=new bt(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=Ct((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=Ct(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=bt.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}}class Rs{constructor(t,e,i,s,n){this.easingFcn=n,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new bt(0,0),this._lerpEnd=new bt(0,0),this._initialized=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._lerpDuration=s,this._offset=new bt(e,i)}_initialize(){this._lerpStart=new bt(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}update(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;let e=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=Ct((e-this._tx.pos.x)/(t/1e3),(i-this._tx.pos.y)/(t/1e3))):(this._tx.pos=Ct(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=bt.Zero)}isComplete(){return this._stopped||this._currentLerpTime>=this._lerpDuration}reset(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}}class Is{constructor(t,e,i,s=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=t.get(is),this._timeVisible=e,this._timeNotVisible=i,this._duration=(e+i)*s}update(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}class Ds{constructor(t,e,i){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=t.get(is),this._endOpacity=e,this._speed=this._ogspeed=i}update(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),nt.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1,this._stopped=!1}}class Ms{constructor(t){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=t}update(t){this._started||(this._started=!0),this._elapsedTime+=t}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}class Fs{constructor(t){this._stopped=!1,this._entity=t}update(t){this._entity.get(zs).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class Ls{constructor(t,e,i){this._started=!1,this._stopped=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._followTx=e.get(bi),this._followMotion=e.get(Ci),this._current=new bt(this._tx.pos.x,this._tx.pos.y),this._end=new bt(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==e&&(this._speed=e),this._current=Ct(this._tx.pos.x,this._tx.pos.y),this._end=Ct(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const t=this._dir.scale(this._speed);this._motion.vel=Ct(t.x,t.y)}else this._motion.vel=Ct(0,0);this.isComplete()&&(this._tx.pos=Ct(this._end.x,this._end.y),this._motion.vel=Ct(0,0))}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1,this._stopped=!1}}class Bs{constructor(t,e,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=t.get(bi),this._motion=t.get(Ci),this._meetTx=e.get(bi),this._meetMotion=e.get(Ci),this._current=new bt(this._tx.pos.x,this._tx.pos.y),this._end=new bt(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}update(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=Ct(this._tx.pos.x,this._tx.pos.y),this._end=Ct(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const i=this._dir.scale(this._speed);this._motion.vel=Ct(i.x,i.y),this.isComplete()&&(this._tx.pos=Ct(this._end.x,this._end.y),this._motion.vel=Ct(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=Ct(0,0),this._stopped=!0}reset(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}class Os{constructor(t){this._entity=t,this._queue=new as(t)}getQueue(){return this._queue}update(t){this._queue.update(t)}clearActions(){this._queue.clearActions()}runAction(t){return t.reset(),this._queue.add(t),this}easeTo(...t){var e,i;let s=0,n=0,r=0,o=os.Linear;return t[0]instanceof bt?(s=t[0].x,n=t[0].y,r=t[1],o=null!==(e=t[2])&&void 0!==e?e:o):(s=t[0],n=t[1],r=t[2],o=null!==(i=t[3])&&void 0!==i?i:o),this._queue.add(new ks(this._entity,s,n,r,o)),this}easeBy(...t){var e,i;let s=0,n=0,r=0,o=os.Linear;return t[0]instanceof bt?(s=t[0].x,n=t[0].y,r=t[1],o=null!==(e=t[2])&&void 0!==e?e:o):(s=t[0],n=t[1],r=t[2],o=null!==(i=t[3])&&void 0!==i?i:o),this._queue.add(new Rs(this._entity,s,n,r,o)),this}moveTo(t,e,i){let s=0,n=0,r=0;return t instanceof bt?(s=t.x,n=t.y,r=e):(s=t,n=e,r=i),this._queue.add(new us(this._entity,s,n,r)),this}moveBy(t,e,i){let s=0,n=0,r=0;return t instanceof bt?(s=t.x,n=t.y,r=e):(s=t,n=e,r=i),this._queue.add(new cs(this._entity,s,n,r)),this}rotateTo(t,e,i){return this._queue.add(new Ss(this._entity,t,e,i)),this}rotateBy(t,e,i){return this._queue.add(new Es(this._entity,t,e,i)),this}scaleTo(t,e,i,s){let n=1,r=1,o=0,a=0;return t instanceof bt&&e instanceof bt&&(n=t.x,r=t.y,o=e.x,a=e.y),"number"==typeof t&&"number"==typeof e&&(n=t,r=e,o=i,a=s),this._queue.add(new Ps(this._entity,n,r,o,a)),this}scaleBy(t,e,i){let s=1,n=1;return t instanceof bt&&(s=t.x,n=t.y,i=e),"number"==typeof t&&"number"==typeof e&&(s=t,n=e),this._queue.add(new Ts(this._entity,s,n,i)),this}blink(t,e,i=1){return this._queue.add(new Is(this._entity,t,e,i)),this}fade(t,e){return this._queue.add(new Ds(this._entity,t,e)),this}delay(t){return this._queue.add(new Ms(t)),this}die(){return this._queue.add(new Fs(this._entity)),this}callMethod(t){return this._queue.add(new As(t)),this}repeat(t,e){return e?(this._queue.add(new ls(this._entity,t,e)),this):(this.repeatForever(t),this)}repeatForever(t){return this._queue.add(new hs(this._entity,t)),this}follow(t,e){return void 0===e?this._queue.add(new Ls(this._entity,t)):this._queue.add(new Ls(this._entity,t,e)),this}meet(t,e){return void 0===e?this._queue.add(new Bs(this._entity,t)):this._queue.add(new Bs(this._entity,t,e)),this}toPromise(){return new Promise((t=>{this._queue.add(new As((()=>{t()})))}))}}class zs extends yi{constructor(){super(...arguments),this.type="ex.actions",this.dependencies=[bi,Ci]}onAdd(t){this._ctx=new Os(t)}onRemove(){this._ctx=null}getQueue(){var t;return null===(t=this._ctx)||void 0===t?void 0:t.getQueue()}runAction(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.runAction(t)}update(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.update(t)}clearActions(){var t;null===(t=this._ctx)||void 0===t||t.clearActions()}easeTo(...t){return this._ctx.easeTo.apply(this._ctx,t)}easeBy(...t){return this._ctx.easeBy.apply(this._ctx,t)}moveTo(t,e,i){return this._ctx.moveTo.apply(this._ctx,[t,e,i])}moveBy(t,e,i){return this._ctx.moveBy.apply(this._ctx,[t,e,i])}rotateTo(t,e,i){return this._ctx.rotateTo(t,e,i)}rotateBy(t,e,i){return this._ctx.rotateBy(t,e,i)}scaleTo(t,e,i,s){return this._ctx.scaleTo.apply(this._ctx,[t,e,i,s])}scaleBy(t,e,i){return this._ctx.scaleBy.apply(this._ctx,[t,e,i])}blink(t,e,i){return this._ctx.blink(t,e,i)}fade(t,e){return this._ctx.fade(t,e)}delay(t){return this._ctx.delay(t)}die(){return this._ctx.die()}callMethod(t){return this._ctx.callMethod(t)}repeat(t,e){return this._ctx.repeat(t,e)}repeatForever(t){return this._ctx.repeatForever(t)}follow(t,e){return this._ctx.follow(t,e)}meet(t,e){return this._ctx.meet(t,e)}toPromise(){return this._ctx.toPromise()}}(gs=fs||(fs={})).Em="em",gs.Rem="rem",gs.Px="px",gs.Pt="pt",gs.Percent="%",(_s=ms||(ms={})).Left="left",_s.Right="right",_s.Center="center",_s.Start="start",_s.End="end",(ys=vs||(vs={})).Top="top",ys.Hanging="hanging",ys.Middle="middle",ys.Alphabetic="alphabetic",ys.Ideographic="ideographic",ys.Bottom="bottom",(ws=xs||(xs={})).Normal="normal",ws.Italic="italic",ws.Oblique="oblique",(Cs=bs||(bs={})).LeftToRight="ltr",Cs.RightToLeft="rtl";class Ns{constructor(t,e,i,s){this.font=t,this.text=e,this.color=i,this.maxWidth=s,this._textFragments=[],this.disposed=!1,this._dirty=!0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.dimensions=this.measureText(e),this._setDimension(this.dimensions,this.ctx),this._lastHashCode=this.getHashCode()}measureText(t,e){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);let i=null;i=null!=e?this._getLinesFromText(t,e):t.split("\n");const s=i.reduce(((t,e)=>t.length>e.length?t:e));this._applyFont(this.ctx);const n=this.ctx.measureText(s);let r=Math.abs(n.actualBoundingBoxAscent)+Math.abs(n.actualBoundingBoxDescent);const o=r*i.length;r=o;const a=o-Math.abs(n.actualBoundingBoxAscent);return new Rt({left:0-Math.abs(n.actualBoundingBoxLeft)-this.font.padding,top:0-Math.abs(n.actualBoundingBoxAscent)-this.font.padding,bottom:0+a+this.font.padding,right:0+Math.abs(n.actualBoundingBoxRight)+this.font.padding})}_setDimension(t,e){e.canvas.width=2*(t.width+2*this.font.padding)*this.font.quality,e.canvas.height=2*(t.height+2*this.font.padding)*this.font.quality}static getHashCode(t,e,i){var s;return e+"__hashcode__"+t.fontString+t.showDebug+t.textAlign+t.baseAlign+t.direction+JSON.stringify(t.shadow)+(t.padding.toString()+t.smoothing.toString()+t.lineWidth.toString()+t.lineDash.toString()+(null===(s=t.strokeColor)||void 0===s?void 0:s.toString())+(i?i.toString():t.color.toString()))}getHashCode(t=!0){return Ns.getHashCode(this.font,this.text,t?this.color:void 0)}_applyRasterProperties(t){var e,i;t.translate(this.font.padding,this.font.padding),t.imageSmoothingEnabled=this.font.smoothing,t.lineWidth=this.font.lineWidth,t.setLineDash(null!==(e=this.font.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(i=this.font.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=this.color.toString()}_applyFont(t){t.resetTransform(),t.translate(this.font.padding+t.canvas.width/2,this.font.padding+t.canvas.height/2),t.scale(this.font.quality,this.font.quality),t.textAlign=this.font.textAlign,t.textBaseline=this.font.baseAlign,t.font=this.font.fontString,t.direction=this.font.direction,this.font.shadow&&(t.shadowColor=this.font.shadow.color.toString(),t.shadowBlur=this.font.shadow.blur,t.shadowOffsetX=this.font.shadow.offset.x,t.shadowOffsetY=this.font.shadow.offset.y)}_drawText(t,e,i){this._applyRasterProperties(t),this._applyFont(t);for(let s=0;s<e.length;s++){const n=e[s];this.color&&t.fillText(n,0,s*i),this.font.strokeColor&&t.strokeText(n,0,s*i)}this.font.showDebug&&(Me(t,St.Green,-t.canvas.width/2,0,t.canvas.width/2,0,2),Me(t,St.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}_splitTextBitmap(t){const e=[];let i=0,s=0;const n=Math.min(4096,t.canvas.width),r=Math.min(4096,t.canvas.height);for(;i<t.canvas.width;){for(;s<t.canvas.height;){const o=document.createElement("canvas");o.width=n,o.height=r;o.getContext("2d").drawImage(t.canvas,i,s,n,r,0,0,n,r),e.push({x:i,y:s,canvas:o}),s+=r}i+=n,s=0}return e}flagDirty(){this._dirty=!0}render(t,e,i,s){if(this.disposed)throw Error("Accessing disposed text instance! "+this.text);this._ex=t;const n=this.getHashCode();if(this._lastHashCode!==n&&(this._dirty=!0),this._dirty){this.dimensions=this.measureText(this.text,s),this._setDimension(this.dimensions,this.ctx);const e=this._getLinesFromText(this.text,s),i=this.dimensions.height/e.length;if(this._drawText(this.ctx,e,i),t instanceof Ce)for(const s of this._textFragments)t.textureLoader.delete(s.canvas);if(this._textFragments=this._splitTextBitmap(this.ctx),t instanceof Ce)for(const s of this._textFragments)t.textureLoader.load(s.canvas,this.font.filtering,!0);this._lastHashCode=n,this._dirty=!1}for(const r of this._textFragments)t.drawImage(r.canvas,0,0,r.canvas.width,r.canvas.height,r.x/this.font.quality+e-this.ctx.canvas.width/this.font.quality/2,r.y/this.font.quality+i-this.ctx.canvas.height/this.font.quality/2,r.canvas.width/this.font.quality,r.canvas.height/this.font.quality)}dispose(){if(this.disposed=!0,this.dimensions=void 0,this.canvas=void 0,this.ctx=void 0,this._ex instanceof Ce)for(const t of this._textFragments)this._ex.textureLoader.delete(t.canvas);this._textFragments.length=0}_getLinesFromText(t,e){if(this._chachedText===t&&this._cachedRenderWidth===e)return this._chachedLines;const i=t.split("\n");if(null==e)return i;for(let s=0;s<i.length;s++){let t=i[s],n="";if(this.measureText(t).width>e){for(;this.measureText(t).width>e;)n=t[t.length-1]+n,t=t.slice(0,-1);i[s]=t,i[s+1]=n}}return this._chachedText=t,this._chachedLines=i,this._cachedRenderWidth=e,i}}class Us{static measureText(t,e,i){const s=Ns.getHashCode(e,t);if(Us._MEASURE_CACHE.has(s))return Us._MEASURE_CACHE.get(s);Us._LOGGER.debug("Font text measurement cache miss");const n=e.measureTextWithoutCache(t,i);return Us._MEASURE_CACHE.set(s,n),n}static getTextInstance(t,e,i){const s=Ns.getHashCode(e,t,i);let n=Us._TEXT_CACHE.get(s);return n||(n=new Ns(e,t,i),Us._TEXT_CACHE.set(s,n),Us._LOGGER.debug("Font text instance cache miss")),Us._TEXT_USAGE.set(n,performance.now()),n}static checkAndClearCache(){const t=[],e=new Set;for(const[s,n]of Us._TEXT_USAGE.entries())if(n+100<performance.now())Us._LOGGER.debug(`Text cache entry timed out ${s.text}`),t.push(s),s.dispose();else{const t=s.getHashCode(!1);e.add(t)}t.forEach((t=>{Us._TEXT_USAGE.delete(t)})),this._TEXT_CACHE.clear();for(const[s]of this._TEXT_USAGE.entries())this._TEXT_CACHE.set(s.getHashCode(),s);const i=new Map;for(const s of e)Us._MEASURE_CACHE.has(s)&&i.set(s,Us._MEASURE_CACHE.get(s));this._MEASURE_CACHE.clear(),this._MEASURE_CACHE=i}static get cacheSize(){return Us._TEXT_USAGE.size}static clearCache(){for(const[t]of Us._TEXT_USAGE.entries())t.dispose();Us._TEXT_USAGE.clear(),Us._TEXT_CACHE.clear(),Us._MEASURE_CACHE.clear()}}Us._LOGGER=nt.getInstance(),Us._TEXT_USAGE=new Map,Us._TEXT_CACHE=new Map,Us._MEASURE_CACHE=new Map;class Vs extends Gt{constructor(t={}){var e,i,s,n,r,o,a,l,h,c,u,d,p,f,g,m,_,v,y;super(t),this.filtering=Xt.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=St.Black,this.family="sans-serif",this.style=xs.Normal,this.bold=!1,this.unit=fs.Px,this.textAlign=ms.Left,this.baseAlign=vs.Alphabetic,this.direction=bs.LeftToRight,this.size=10,this.shadow=null,this._textBounds=new Rt,this._textMeasurement=new Ns(this,"",St.Black),this.smoothing=null!==(e=null==t?void 0:t.smoothing)&&void 0!==e?e:this.smoothing,this.padding=null!==(i=null==t?void 0:t.padding)&&void 0!==i?i:this.padding,this.color=null!==(s=null==t?void 0:t.color)&&void 0!==s?s:this.color,this.strokeColor=null!==(n=null==t?void 0:t.strokeColor)&&void 0!==n?n:this.strokeColor,this.lineDash=null!==(r=null==t?void 0:t.lineDash)&&void 0!==r?r:this.lineDash,this.lineWidth=null!==(o=null==t?void 0:t.lineWidth)&&void 0!==o?o:this.lineWidth,this.filtering=null!==(a=null==t?void 0:t.filtering)&&void 0!==a?a:this.filtering,this.family=null!==(l=null==t?void 0:t.family)&&void 0!==l?l:this.family,this.style=null!==(h=null==t?void 0:t.style)&&void 0!==h?h:this.style,this.bold=null!==(c=null==t?void 0:t.bold)&&void 0!==c?c:this.bold,this.size=null!==(u=null==t?void 0:t.size)&&void 0!==u?u:this.size,this.unit=null!==(d=null==t?void 0:t.unit)&&void 0!==d?d:this.unit,this.textAlign=null!==(p=null==t?void 0:t.textAlign)&&void 0!==p?p:this.textAlign,this.baseAlign=null!==(f=null==t?void 0:t.baseAlign)&&void 0!==f?f:this.baseAlign,this.direction=null!==(g=null==t?void 0:t.direction)&&void 0!==g?g:this.direction,this.quality=null!==(m=null==t?void 0:t.quality)&&void 0!==m?m:this.quality,(null==t?void 0:t.shadow)&&(this.shadow={},this.shadow.blur=null!==(_=t.shadow.blur)&&void 0!==_?_:this.shadow.blur,this.shadow.offset=null!==(v=t.shadow.offset)&&void 0!==v?v:this.shadow.offset,this.shadow.color=null!==(y=t.shadow.color)&&void 0!==y?y:this.shadow.color)}clone(){return new Vs({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(t,e,i){}_rotate(t){var e;const i=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(i.x,i.y),t.rotate(this.rotation),t.translate(-i.x,-i.y)}_flip(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}measureTextWithoutCache(t,e){return this._textMeasurement.measureText(t,e)}measureText(t,e){return Us.measureText(t,this,e)}_postDraw(t){t.restore()}render(t,e,i,s,n,r){const o=Us.getTextInstance(e,this,i);this._textBounds=o.dimensions,this._preDraw(t,s,n),o.render(t,s,n,r),this._postDraw(t)}}class Hs extends Gt{constructor(t){var e,i;super(t),this._text="",this._textWidth=0,this._textHeight=0,this.font=null!==(e=t.font)&&void 0!==e?e:new Vs,this.color=null!==(i=t.color)&&void 0!==i?i:this.color,this.text=t.text,this.maxWidth=t.maxWidth}clone(){var t,e;return new Hs({text:this.text.slice(),color:null!==(e=null===(t=this.color)||void 0===t?void 0:t.clone())&&void 0!==e?e:St.Black,font:this.font.clone(),maxWidth:this.maxWidth})}get text(){return this._text}set text(t){this._text=t,this._calculateDimension()}get font(){return this._font}set font(t){this._font=t}get width(){return 0===this._textWidth&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return 0===this._textHeight&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:t,height:e}=this.font.measureText(this._text,this.maxWidth);this._textWidth=t,this._textHeight=e}get localBounds(){return this.font.measureText(this._text,this.maxWidth).scale(this.scale)}_rotate(t){}_flip(t){}_preDraw(t,e,i){(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint,super._preDraw(t,e,i)}_drawImage(t,e,i){var s;let n=St.Black;this.font instanceof Vs&&(n=null!==(s=this.color)&&void 0!==s?s:this.font.color);const{width:r,height:o}=this.font.measureText(this._text,this.maxWidth);this._textWidth=r,this._textHeight=o,this.font.render(t,this._text,n,e,i,this.maxWidth),this.font.showDebug&&(t.debug.drawRect(e-r,i-o,2*r,2*o),null!=this.maxWidth&&t.debug.drawRect(e,i,this.maxWidth,this.height,{color:St.Yellow}))}}class js extends Qi{get body(){return this.get(Gi)}get transform(){return this.get(bi)}get motion(){return this.get(Ci)}get graphics(){return this.get(is)}get collider(){return this.get(ji)}get pointer(){return this.get(rs)}get actions(){return this.get(zs)}get pos(){return this.transform.pos}set pos(t){this.transform.pos=t.clone()}get oldPos(){return this.body.oldPos}set oldPos(t){this.body.oldPos.setTo(t.x,t.y)}get vel(){return this.motion.vel}set vel(t){this.motion.vel=t.clone()}get oldVel(){return this.body.oldVel}set oldVel(t){this.body.oldVel.setTo(t.x,t.y)}get acc(){return this.motion.acc}set acc(t){this.motion.acc=t.clone()}set oldAcc(t){this.body.oldAcc.setTo(t.x,t.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(t){this.motion.angularVelocity=t}get scale(){return this.get(bi).scale}set scale(t){this.get(bi).scale=t}get anchor(){return this._anchor}set anchor(t){this._anchor=Wt(t,(t=>this._handleAnchorChange(t))),this._handleAnchorChange(t)}_handleAnchorChange(t){this.graphics&&(this.graphics.anchor=t)}get isOffScreen(){return this.hasTag("ex.offscreen")}get draggable(){return this._draggable}set draggable(t){t&&(t&&!this._draggable?(this.events.on("pointerdragstart",this._pointerDragStartHandler),this.events.on("pointerdragend",this._pointerDragEndHandler),this.events.on("pointerdragmove",this._pointerDragMoveHandler),this.events.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.events.off("pointerdragstart",this._pointerDragStartHandler),this.events.off("pointerdragend",this._pointerDragEndHandler),this.events.off("pointerdragmove",this._pointerDragMoveHandler),this.events.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}get color(){return this._color}set color(t){var e;this._color=t.clone();const i=null===(e=this.graphics.layers.default.graphics[0])||void 0===e?void 0:e.graphic;(i instanceof Ne||i instanceof Hs)&&(i.color=this._color)}constructor(t){super(),this.events=new x,this._anchor=Wt(bt.Half,(t=>this._handleAnchorChange(t))),this.logger=nt.getInstance(),this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=t=>{this._dragging&&(this.pos=t.worldPos)},this._pointerDragLeaveHandler=t=>{this._dragging&&(this.pos=t.worldPos)};const{name:e,x:i,y:s,pos:n,coordPlane:r,scale:o,width:a,height:l,radius:h,collider:c,vel:u,acc:d,rotation:p,angularVelocity:f,z:g,color:m,visible:_,anchor:v,collisionType:y,collisionGroup:w}={...t};this._setName(e),this.anchor=null!=v?v:js.defaults.anchor.clone();const b=new bi;this.addComponent(b),this.pos=null!=n?n:Ct(null!=i?i:0,null!=s?s:0),this.rotation=null!=p?p:0,this.scale=null!=o?o:Ct(1,1),this.z=null!=g?g:0,b.coordPlane=null!=r?r:pi.World,this.addComponent(new rs),this.addComponent(new is({anchor:this.anchor})),this.addComponent(new Ci),this.vel=null!=u?u:bt.Zero,this.acc=null!=d?d:bt.Zero,this.angularVelocity=null!=f?f:0,this.addComponent(new zs),this.addComponent(new Gi),this.body.collisionType=null!=y?y:ti.Passive,w&&(this.body.group=w),c?this.addComponent(new ji(c)):h?this.addComponent(new ji(Hi.Circle(h))):a>0&&l>0?this.addComponent(new ji(Hi.Box(a,l,this.anchor))):this.addComponent(new ji),this.graphics.visible=null==_||_,m&&(this.color=m,a&&l?this.graphics.add(new ss({color:m,width:a,height:l})):h&&this.graphics.add(new ns({color:m,radius:h})))}clone(){const t=new js({color:this.color.clone(),anchor:this.anchor.clone()});t.clearComponents(),t.processComponentRemoval();const e=this.getComponents();for(const i of e)t.addComponent(i.clone(),!0);return t}onInitialize(t){}_initialize(t){super._initialize(t);for(const e of this.children)e._initialize(t)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}_prekill(t){this.events.emit("prekill",new C(this)),this.onPreKill(t)}onPreKill(t){}_postkill(t){this.events.emit("postkill",new S(this)),this.onPostKill(t)}onPostKill(t){}kill(){this.scene?(this._prekill(this.scene),this.events.emit("kill",new b(this)),super.kill(),this._postkill(this.scene)):this.logger.warn(`Cannot kill actor named "${this.name}", it was never added to the Scene`)}unkill(){this.active=!0}isKilled(){return!this.active}get z(){return this.get(bi).z}set z(t){this.get(bi).z=t}get center(){const t=this.getGlobalPos();return new bt(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new bt(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(bi).globalRotation}getGlobalPos(){return this.get(bi).globalPos}getGlobalScale(){return this.get(bi).globalScale}contains(t,e,i=!1){const s=Ct(t,e),n=this.get(ji);n.update();const r=n.get();if(!r)return!1;const o=r.contains(s);return i?o||this.children.some((i=>i.contains(t,e,!0))):o}within(t,e){const i=this.get(ji),s=t.get(ji),n=i.get(),r=s.get();return!(!n||!r)&&n.getClosestLineBetween(r).getLength()<=e}update(t,e){this._initialize(t),this._preupdate(t,e),this._postupdate(t,e)}onPreUpdate(t,e){}onPostUpdate(t,e){}_preupdate(t,e){this.events.emit("preupdate",new I(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.events.emit("postupdate",new D(t,e,this)),this.onPostUpdate(t,e)}}function Ws(t){return t instanceof $s}js.defaults={anchor:bt.Half};class $s extends js{constructor(t){var e,i;super({...t}),this.get(bi).coordPlane=pi.Screen,this.anchor=null!==(e=null==t?void 0:t.anchor)&&void 0!==e?e:Ct(0,0),this.body.collisionType=null!==(i=null==t?void 0:t.collisionType)&&void 0!==i?i:ti.PreventCollision,this.pointer.useGraphicsBounds=!0,this.pointer.useColliderShape=!1,!(null==t?void 0:t.collider)&&(null==t?void 0:t.width)>0&&(null==t?void 0:t.height)>0&&this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(t){this._engine=t,super._initialize(t)}contains(t,e,i=!0){if(i)return super.contains(t,e);const s=this._engine.worldToScreenCoordinates(new bt(t,e));return super.contains(s.x,s.y)}}class Gs{get complete(){return this._complete}constructor(t,e,i,s,n,r){if(this._logger=nt.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=()=>this._baseInterval+this.random.integer(this.randomRange[0],this.randomRange[1]),this._complete=!1,this.scene=null,"function"!=typeof t){const o=t;t=o.fcn,e=o.interval,i=o.repeats,s=o.numberOfRepeats,n=o.randomRange,r=o.random}if(s&&s>=0&&(this.maxNumberOfRepeats=s,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=Gs._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=e,n){if(n[0]>n[1])throw new Error("min value must be lower than max value for range");this.random=null!=r?r:new ut,this.randomRange=n,this.interval=this._generateRandomInterval(),this.on((()=>{this.interval=this._generateRandomInterval()}))}this.repeats=i||this.repeats,t&&this.on(t)}on(t){this._callbacks.push(t)}off(t){const e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}update(t){this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((t=>{t.call(this)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}reset(t,e){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}Gs._MAX_ID=0;class qs extends yi{constructor(t){super(),this.type="ex.parallax",this.parallaxFactor=Ct(1,1),this.parallaxFactor=null!=t?t:this.parallaxFactor}}class Xs extends yi{constructor(t,e=!0){super(),this.draw=t,this.useTransform=e,this.type="ex.debuggraphics"}}const Ks={PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw"};class Ys extends Qi{flagCollidersDirty(){this._collidersDirty=!0}flagTilesDirty(){for(let t=0;t<this.tiles.length;t++)this.tiles[t]&&this.tiles[t].flagDirty()}get x(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0}set x(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(bi).pos=Ct(t,this.y))}get y(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0}set y(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=Ct(this.x,t))}get z(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0}set z(t){this._transform&&(this._transform.z=t)}get rotation(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0}set rotation(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}get scale(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:bt.One}set scale(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}get pos(){return this._transform.pos}set pos(t){this._transform.pos=t}get vel(){return this._motion.vel}set vel(t){this._motion.vel=t}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}constructor(t){var e,i;super(null,t.name),this.events=new x,this._token=0,this.logger=nt.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this.renderFromTopOfGraphic=!1,this._collidersDirty=!0,this._originalOffsets=new WeakMap,this.addComponent(new bi),this.addComponent(new Ci),this.addComponent(new Gi({type:ti.Fixed})),this.addComponent(new is({onPostDraw:(t,e)=>this.draw(t,e)})),this.addComponent(new Xs((t=>this.debug(t)))),this.addComponent(new ji),this._graphics=this.get(is),this._transform=this.get(bi),this._motion=this.get(Ci),this._collider=this.get(ji),this._composite=this._collider.useCompositeCollider([]),this._transform.pos=null!==(e=t.pos)&&void 0!==e?e:bt.Zero,this._oldPos=this._transform.pos.clone(),this._oldScale=this._transform.scale.clone(),this.renderFromTopOfGraphic=null!==(i=t.renderFromTopOfGraphic)&&void 0!==i?i:this.renderFromTopOfGraphic,this.tileWidth=t.tileWidth,this.tileHeight=t.tileHeight,this.rows=t.rows,this.columns=t.columns,this.tiles=new Array(this.rows*this.columns),this._rows=new Array(this.rows),this._cols=new Array(this.columns);let s=[];for(let n=0;n<this.columns;n++){for(let t=0;t<this.rows;t++){const e=new Zs({x:n,y:t,map:this});e.map=this,this.tiles[n+t*this.columns]=e,s.push(e),this._rows[t]||(this._rows[t]=[]),this._rows[t].push(e)}this._cols[n]=s,s=[]}this._graphics.localBounds=new Rt({left:0,top:0,right:this.columns*this.tileWidth*this.scale.x,bottom:this.rows*this.tileHeight*this.scale.y})}_initialize(t){super._initialize(t),this._engine=t}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}_updateColliders(){this._collider.$colliderRemoved.notifyAll(this._composite),this._composite.clearColliders();const t=[];let e;this._composite=this._collider.useCompositeCollider([]);for(let i=0;i<this.columns;i++){for(let s=0;s<this.rows;s++){0===s&&(e=null);const n=this.tiles[i+s*this.columns];if(n.solid)if(n.getColliders().length>0){for(const t of n.getColliders()){const e=this._getOrSetColliderOriginalOffset(t);t.offset=Ct(n.x*this.tileWidth*this.scale.x,n.y*this.tileHeight*this.scale.y).add(e),t.owner=this,this._composite.addCollider(t)}e&&t.push(e),e=null}else e=e?e.combine(n.bounds):n.bounds;else e&&t.push(e),e=null}if(e){const i=t[t.length-1];i&&i.top===e.top&&i.bottom===e.bottom?t[t.length-1]=i.combine(e):t.push(e)}}for(const i of t){const t=Hi.Box(i.width,i.height,bt.Zero,Ct(i.left-this.pos.x,i.top-this.pos.y));t.owner=this,this._composite.addCollider(t)}this._collider.update(),this._collider.$colliderAdded.notifyAll(this._composite)}getTileByIndex(t){return this.tiles[t]}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=Math.floor((t.x-this.pos.x)/(this.tileWidth*this.scale.x)),i=Math.floor((t.y-this.pos.y)/(this.tileHeight*this.scale.y)),s=this.getTile(e,i);return e>=0&&i>=0&&e<this.columns&&i<this.rows&&s?s:null}getRows(){return this._rows}getColumns(){return this._cols}update(t,e){this.onPreUpdate(t,e),this.emit("preupdate",new I(t,e,this)),this._oldPos.equals(this.pos)&&this._oldScale.equals(this.scale)||(this.flagCollidersDirty(),this.flagTilesDirty()),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++,this.pos.clone(this._oldPos),this.scale.clone(this._oldScale),this._transform.pos=this.pos,this.onPostUpdate(t,e),this.emit("postupdate",new D(t,e,this))}draw(t,e){this.emit("predraw",new T(t,e,this));let i=this._engine.screen.getWorldBounds(),s=0;const n=this.columns;let r=0;const o=this.rows;let a,l,h;const c=this.get(qs);if(c){let t=this.pos;const e=bt.One.sub(c.parallaxFactor),s=this._engine.currentScene.camera.pos.scale(e);t=t.sub(s),i=i.translate(t)}let u;for(;s<n;s++){for(;r<o;r++)if(u=this.getTile(s,r),i.overlaps(u.bounds))for(a=this.getTile(s,r).getGraphics(),l=0,h=a.length;l<h;l++){const i=a[l];if(i){Ji(i)&&(null==i||i.tick(e,this._token));const n=this.renderFromTopOfGraphic?0:i.height-this.tileHeight;i.draw(t,s*this.tileWidth,r*this.tileHeight-n)}}r=0}this.emit("postdraw",new A(t,e,this))}debug(t){const e=this.tileWidth*this.columns,i=this.tileHeight*this.rows,s=bt.Zero;for(let r=0;r<this.rows+1;r++){const i=Ct(0,r*this.tileHeight);t.drawLine(s.add(i),s.add(Ct(e,i.y)),St.Red,2)}for(let r=0;r<this.columns+1;r++){const e=Ct(r*this.tileWidth,0);t.drawLine(s.add(e),s.add(Ct(e.x,i)),St.Red,2)}const n=this._composite.getColliders();for(const r of n){const e=St.Gray;e.a=.5;const i=r.localBounds,s=r.worldPos.sub(this.pos);t.drawRectangle(s,i.width,i.height,e)}}}class Zs extends Qi{get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get width(){return this._width}get height(){return this._height}get solid(){return this._solid}set solid(t){var e;null===(e=this.map)||void 0===e||e.flagCollidersDirty(),this._solid=t}getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t)}removeGraphic(t){Ft(t,this._graphics)}clearGraphics(){this._graphics.length=0}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}constructor(t){var e,i;super(),this._posDirty=!1,this._solid=!1,this._graphics=[],this._colliders=[],this.data=new Map,this.x=t.x,this.y=t.y,this.map=t.map,this._width=t.map.tileWidth*this.map.scale.x,this._height=t.map.tileHeight*this.map.scale.y,this.solid=null!==(e=t.solid)&&void 0!==e?e:this.solid,this._graphics=null!==(i=t.graphics)&&void 0!==i?i:[],this._recalculate()}flagDirty(){return this._posDirty=!0}_recalculate(){this._width=this.map.tileWidth*this.map.scale.x,this._height=this.map.tileHeight*this.map.scale.y,this._pos=this.map.pos.add(Ct(this.x*this._width,this.y*this._height)),this._bounds=new Rt(this._pos.x,this._pos.y,this._pos.x+this._width,this._pos.y+this._height),this._posDirty=!1}get bounds(){return this._posDirty&&this._recalculate(),this._bounds}get center(){return this._posDirty&&this._recalculate(),new bt(this._pos.x+this._width/2,this._pos.y+this._height/2)}}class Qs{constructor(t){this.camera=t}lockToActor(t){this.camera.addStrategy(new en(t))}lockToActorAxis(t,e){this.camera.addStrategy(new sn(t,e))}elasticToActor(t,e,i){this.camera.addStrategy(new nn(t,e,i))}radiusAroundActor(t,e){this.camera.addStrategy(new rn(t,e))}limitCameraBounds(t){this.camera.addStrategy(new on(t))}}var Js,tn;(tn=Js||(Js={}))[tn.X=0]="X",tn[tn.Y=1]="Y";class en{constructor(t){this.target=t,this.action=(t,e,i,s)=>t.center}}class sn{constructor(t,e){this.target=t,this.axis=e,this.action=(t,e,i,s)=>{const n=t.center,r=e.getFocus();return this.axis===Js.X?new bt(n.x,r.y):new bt(r.x,n.y)}}}class nn{constructor(t,e,i){this.target=t,this.cameraElasticity=e,this.cameraFriction=i,this.action=(t,e,i,s)=>{const n=t.center;let r=e.getFocus(),o=e.vel.clone();const a=n.sub(r).scale(this.cameraElasticity);o=o.add(a);const l=o.scale(-1).scale(this.cameraFriction);return o=o.add(l),r=r.add(o),r}}}class rn{constructor(t,e){this.target=t,this.radius=e,this.action=(t,e,i,s)=>{const n=t.center,r=e.getFocus(),o=n.sub(r),a=o.size;if(a>=this.radius){const t=a-this.radius;return r.add(o.normalize().scale(t))}return r}}}class on{constructor(t){this.target=t,this.boundSizeChecked=!1,this.action=(t,e,i,s)=>{const n=e.getFocus();this.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&nt.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let r=n.x,o=n.y;return n.x<t.left+i.halfDrawWidth?r=t.left+i.halfDrawWidth:n.x>t.right-i.halfDrawWidth&&(r=t.right-i.halfDrawWidth),n.y<t.top+i.halfDrawHeight?o=t.top+i.halfDrawHeight:n.y>t.bottom-i.halfDrawHeight&&(o=t.bottom-i.halfDrawHeight),Ct(r,o)}}}const an={Initialize:"initialize",PreUpdate:"preupdate",PostUpdate:"postupdate"};class ln{constructor(){this.events=new x,this.transform=Nt.identity(),this.inverse=Nt.identity(),this._cameraStrategies=[],this.strategy=new Qs(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this._angularVelocity=0,this._posChanged=!1,this._pos=$t(bt.Zero,(()=>this._posChanged=!0)),this.vel=bt.Zero,this.acc=bt.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=os.EaseInOutCubic,this._easing=os.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1}get zoom(){return this._z}set zoom(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t}get pos(){return this._pos}set pos(t){this._pos=$t(t,(()=>this._posChanged=!0)),this._posChanged=!0}get x(){return this.pos.x}set x(t){this._follow||this._cameraMoving||(this.pos=Ct(t,this.pos.y))}get y(){return this.pos.y}set y(t){this._follow||this._cameraMoving||(this.pos=Ct(this.pos.x,t))}get dx(){return this.vel.x}set dx(t){this.vel=Ct(t,this.vel.y)}get dy(){return this.vel.y}set dy(t){this.vel=Ct(this.vel.x,t)}get ax(){return this.acc.x}set ax(t){this.acc=Ct(t,this.acc.y)}get ay(){return this.acc.y}set ay(t){this.acc=Ct(this.acc.x,t)}getFocus(){return this.pos}move(t,e,i=os.EaseInOutCubic){if("function"!=typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((t=>{this._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}shake(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i}zoomOverTime(t,e=0,i=os.EaseInOutCubic){return this._zoomPromise=new Promise((t=>{this._zoomResolve=t})),e?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=e,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}get viewport(){return this._viewport?this._viewport:new Rt(0,0,0,0)}addStrategy(t){this._cameraStrategies.push(t)}removeStrategy(t){Ft(t,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(t,e){this.events.emit("preupdate",new I(t,e,this)),this.onPreUpdate(t,e)}onPreUpdate(t,e){}_postupdate(t,e){this.events.emit("postupdate",new D(t,e,this)),this.onPostUpdate(t,e)}onPostUpdate(t,e){}get isInitialized(){return this._isInitialized}_initialize(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;const e=this._screen.contentArea;let i=Ct(e.width/2,e.height/2);if(!this._engine.loadingComplete){const t=this._screen.peekResolution();t&&(i=Ct(t.width/2,t.height/2))}this._halfWidth=i.x,this._halfHeight=i.y,this._posChanged||(this.pos=i),this.updateTransform(),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(),this.onInitialize(t),this.events.emit("initialize",new K(t,this)),this._isInitialized=!0}}onInitialize(t){}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}runStrategies(t,e){for(const i of this._cameraStrategies)this.pos=i.action.call(i,i.target,this,t,e)}updateViewport(){this._viewport=new Rt(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const t=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=t,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const t=os.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=t,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;const t=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(t)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0)),this.runStrategies(t,e),this.updateViewport(),this.updateTransform(),this._postupdate(t,e)}draw(t){t.multiply(this.transform)}updateTransform(){const t=this._screen.resolution.width/this.zoom,e=this._screen.resolution.height/this.zoom,i=Ct(-this.x+t/2+this._xShake,-this.y+e/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(t/2,e/2),this.transform.rotate(this.rotation),this.transform.translate(-t/2,-e/2),this.transform.translate(i.x,i.y),this.transform.inverse(this.inverse)}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}const hn={ExitTrigger:"exittrigger",EnterTrigger:"entertrigger"},cn={pos:bt.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class un extends js{constructor(t){super({x:t.pos.x,y:t.pos.y,width:t.width,height:t.height}),this.events=new x,this.action=()=>{},this.filter=()=>!0,this.repeat=-1,t={...cn,...t},this.filter=t.filter||this.filter,this.repeat=t.repeat||this.repeat,this.action=t.action||this.action,t.target&&(this.target=t.target),this.graphics.visible=t.visible,this.body.collisionType=ti.Passive,this.events.on("collisionstart",(t=>{this.filter(t.other)&&(this.emit("enter",new tt(this,t.other)),this._dispatchAction(),0===this.repeat&&this.kill())})),this.events.on("collisionend",(t=>{this.filter(t.other)&&this.emit("exit",new et(this,t.other))}))}set target(t){this._target=t,this.filter=e=>e===t}get target(){return this._target}_initialize(t){super._initialize(t)}_dispatchAction(){0!==this.repeat&&(this.action.call(this),this.repeat--)}}var dn,pn;(pn=dn||(dn={})).Update="update",pn.Draw="draw";class fn{constructor(){this.priority=0}notify(t){}}class gn{constructor(t){this.data=t,this.type="Entity Added"}}function mn(t){return!!t&&"Entity Added"===t.type}class _n{constructor(t){this.data=t,this.type="Entity Removed"}}function vn(t){return!!t&&"Entity Removed"===t.type}class yn{constructor(t){this._world=t,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(t,e){for(const i of this.entities)i.update(t.engine,e),i.active||this.removeEntity(i)}findEntitiesForRemoval(){for(const t of this.entities)t.active||this.removeEntity(t)}notify(t){Xi(t)&&this._world.queryManager.addEntity(t.data.entity),Yi(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}addEntity(t){t.active=!0,t.scene=this._world.context,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((e=>{e.scene=t.scene,this.addEntity(e)})),t.childrenAdded$.register({notify:t=>{this.addEntity(t)}}),t.childrenRemoved$.register({notify:t=>{this.removeEntity(t,!1)}}))}removeEntity(t,e=!0){var i;let s=0;s=t instanceof Qi?t.id:t;const n=this._entityIndex[s];n&&n.active&&(n.active=!1),n&&e?this._entitiesToRemove.push(n):(delete this._entityIndex[s],n&&(n.scene=null,Ft(n,this.entities),this._world.queryManager.removeEntity(n),n.componentAdded$.unregister(this),n.componentRemoved$.unregister(this),n.children.forEach((t=>{t.scene=null,this.removeEntity(t,e)})),n.childrenAdded$.clear(),n.childrenRemoved$.clear(),(null===(i=this._world.context)||void 0===i?void 0:i.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}processEntityRemovals(){for(const t of this._entitiesToRemove)t.active||this.removeEntity(t,!1);this._entitiesToRemove.length=0}processComponentRemovals(){for(const t of this.entities)t.processComponentRemoval()}getById(t){return this._entityIndex[t]}getByName(t){return this.entities.filter((e=>e.name===t))}clear(){for(const t of this.entities)this.removeEntity(t)}}const xn=t=>{const e=[...t].sort(((t,e)=>t.localeCompare(e))).join("+");return e};class wn extends wi{get key(){return this._key?this._key:this._key=xn(this.types)}constructor(t){super(),this._entities=[],t[0]instanceof Function?this.types=t.map((t=>(new t).type)):this.types=t}getEntities(t){return t&&this._entities.sort(t),this._entities}addEntity(t){!Lt(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new gn(t)))}removeEntity(t){Ft(t,this._entities)&&this.notifyAll(new _n(t))}clear(){this._entities.length=0;for(const t of this.observers)this.unregister(t)}matches(t){let e=[];e=t instanceof Qi?t.types:t;let i=!0;for(const s of this.types)if(i=i&&e.indexOf(s)>-1,!i)return!1;return i}contain(t){return this.types.indexOf(t)>-1}}class bn{constructor(t){this._world=t,this._queries={}}_addQuery(t){this._queries[xn(t.types)]=t;for(const e of this._world.entityManager.entities)t.addEntity(e)}maybeRemoveQuery(t){0===t.observers.length&&(t.clear(),delete this._queries[xn(t.types)])}addEntity(t){for(const e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}removeComponent(t,e){for(const i in this._queries)this._queries[i].contain(e.type)&&this._queries[i].removeEntity(t)}removeEntity(t){for(const e in this._queries)this._queries[e].removeEntity(t)}createQuery(t){const e=this.getQuery(t);if(e)return e;const i=new wn(t);return this._addQuery(i),i}getQuery(t){const e=xn(t);return this._queries[e]?this._queries[e]:null}}class Cn{constructor(t){this._world=t,this.systems=[],this.initialized=!1}get(t){return this.systems.find((e=>e instanceof t))}addSystem(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");const e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort(((t,e)=>t.priority-e.priority)),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}removeSystem(t){Ft(t,this.systems);const e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}initialize(){if(!this.initialized){this.initialized=!0;for(const t of this.systems)t.initialize&&t.initialize(this._world.context)}}updateSystems(t,e,i){const s=this.systems.filter((e=>e.systemType===t));for(const n of s)n.preupdate&&n.preupdate(e,i);for(const n of s){const t=this._world.queryManager.getQuery(n.types).getEntities(n.sort);if(e instanceof er)for(const i of t)i._initialize(null==e?void 0:e.engine);n.update(t,i)}for(const n of s)n.postupdate&&n.postupdate(e,i)}clear(){for(const t of this.systems)this.removeSystem(t)}}class Sn{constructor(t){this.context=t,this.queryManager=new bn(this),this.entityManager=new yn(this),this.systemManager=new Cn(this)}update(t,e){t===dn.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(t){t instanceof Qi&&this.entityManager.addEntity(t),t instanceof fn&&this.systemManager.addSystem(t)}remove(t,e=!0){t instanceof Qi&&this.entityManager.removeEntity(t,e),t instanceof fn&&this.systemManager.removeSystem(t)}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class En{static integrate(t,e,i,s){const n=s/1e3;e.vel.addEqual(i.scale(n,En._ACC)),t.pos.add(e.vel.scale(n,En._VEL),En._POS).addEqual(i.scale(.5*n*n,En._VEL_ACC)),e.angularVelocity+=e.torque*(1/e.inertia)*n;const r=t.rotation+e.angularVelocity*n;t.scale.add(e.scaleFactor.scale(n,this._SCALE_FACTOR),En._SCALE);t.get().setTransform(En._POS,r,En._SCALE)}}En._POS=new bt(0,0),En._SCALE=new bt(1,1),En._ACC=new bt(0,0),En._VEL=new bt(0,0),En._VEL_ACC=new bt(0,0),En._SCALE_FACTOR=new bt(0,0);class Pn extends fn{constructor(){super(...arguments),this.types=["ex.transform","ex.motion"],this.systemType=dn.Update,this.priority=-1}update(t,e){let i,s;for(let n=0;n<t.length;n++){i=t[n].get(bi),s=t[n].get(Ci);const r=t[n].get(Gi);if(null==r?void 0:r.sleeping)continue;const o=s.acc.clone();(null==r?void 0:r.collisionType)===ti.Active&&(null==r?void 0:r.useGravity)&&o.addEqual(gi.gravity),null==r||r.captureOldTransform(),En.integrate(i,s,o,e)}}}class Tn{constructor(){this.directionMap=new Map,this.distanceMap=new Map}solve(t){this.preSolve(t),(t=t.filter((t=>!t.isCanceled()))).sort(((t,e)=>this.distanceMap.get(t.id)-this.distanceMap.get(e.id)));for(const e of t)this.solvePosition(e),this.solveVelocity(e);return this.postSolve(t),t}preSolve(t){const e=1e-4;for(const i of t){if(Math.abs(i.mtv.x)<e&&Math.abs(i.mtv.y)<e){i.cancel();continue}const t=Pt.fromDirection(i.mtv),s=i.mtv.negate(),n=i.colliderA.worldPos.squareDistance(i.colliderB.worldPos);this.distanceMap.set(i.id,n),i.colliderA.events.emit("precollision",new V(i.colliderA,i.colliderB,t,s)),i.colliderB.events.emit("precollision",new V(i.colliderB,i.colliderA,Pt.getOpposite(t),s.negate()))}}postSolve(t){var e,i;for(const s of t){if(s.isCanceled())continue;const t=s.colliderA,n=s.colliderB,r=null===(e=t.owner)||void 0===e?void 0:e.get(Gi),o=null===(i=n.owner)||void 0===i?void 0:i.get(Gi);if(r&&o&&(r.collisionType===ti.Passive||o.collisionType===ti.Passive))continue;const a=Pt.fromDirection(s.mtv),l=s.mtv.negate();s.colliderA.events.emit("postcollision",new H(s.colliderA,s.colliderB,a,l)),s.colliderB.events.emit("postcollision",new H(s.colliderB,s.colliderA,Pt.getOpposite(a),l.negate()))}}solvePosition(t){var e,i;const s=1e-4;if(!t.colliderA.bounds.overlaps(t.colliderB.bounds,s))return void t.cancel();if(Math.abs(t.mtv.x)<s&&Math.abs(t.mtv.y)<s)return void t.cancel();let n=t.mtv;const r=t.colliderA,o=t.colliderB,a=null===(e=r.owner)||void 0===e?void 0:e.get(Gi),l=null===(i=o.owner)||void 0===i?void 0:i.get(Gi);if(a&&l){if(a.collisionType===ti.Passive||l.collisionType===ti.Passive)return;a.collisionType===ti.Active&&l.collisionType===ti.Active&&(n=n.scale(.5)),a.collisionType===ti.Active&&(a.globalPos.x-=n.x,a.globalPos.y-=n.y,r.update(a.transform.get())),l.collisionType===ti.Active&&(l.globalPos.x+=n.x,l.globalPos.y+=n.y,o.update(l.transform.get()))}}solveVelocity(t){var e,i;if(t.isCanceled())return;const s=t.colliderA,n=t.colliderB,r=null===(e=s.owner)||void 0===e?void 0:e.get(Gi),o=null===(i=n.owner)||void 0===i?void 0:i.get(Gi);if(r&&o){if(r.collisionType===ti.Passive||o.collisionType===ti.Passive)return;const e=t.normal,i=e.negate();if(r.collisionType===ti.Active&&r.vel.normalize().dot(i)<0){const t=e.scale(e.dot(r.vel.negate()));r.vel=r.vel.add(t)}if(o.collisionType===ti.Active&&o.vel.normalize().dot(e)<0){const t=i.scale(i.dot(o.vel.negate()));o.vel=o.vel.add(t)}}}}class An{constructor(t,e,i){this.point=t,this.local=e,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new bt(0,0),this.bToContact=new bt(0,0),this.originalVelocityAndRestitution=0,this.update()}update(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(Gi),s=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(Gi);if(i&&s){const t=this.contact.normal,e=this.contact.tangent;this.aToContact=this.point.sub(i.globalPos),this.bToContact=this.point.sub(s.globalPos);const n=this.aToContact.cross(t),r=this.bToContact.cross(t);this.normalMass=i.inverseMass+s.inverseMass+i.inverseInertia*n*n+s.inverseInertia*r*r;const o=this.aToContact.cross(e),a=this.bToContact.cross(e);this.tangentMass=i.inverseMass+s.inverseMass+i.inverseInertia*o*o+s.inverseInertia*a*a}return this}getRelativeVelocity(){var t,e;const i=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(Gi),s=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(Gi);if(i&&s){const t=i.vel.add(bt.cross(i.angularVelocity,this.aToContact));return s.vel.add(bt.cross(s.angularVelocity,this.bToContact)).sub(t)}return bt.Zero}}class kn{constructor(){this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}solve(t){return this.preSolve(t),t=t.filter((t=>!t.isCanceled())),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}preSolve(t){var e,i,s;const n=1e-4;for(const o of t){if(Math.abs(o.mtv.x)<n&&Math.abs(o.mtv.y)<n){o.cancel();continue}const t=Pt.fromDirection(o.mtv);o.colliderA.events.emit("precollision",new V(o.colliderA,o.colliderB,t,o.mtv)),o.colliderA.events.emit("beforecollisionresolve",new $(o.colliderA,o.colliderB,t,o.mtv,o)),o.colliderB.events.emit("precollision",new V(o.colliderB,o.colliderA,Pt.getOpposite(t),o.mtv.negate())),o.colliderB.events.emit("beforecollisionresolve",new $(o.colliderB,o.colliderA,Pt.getOpposite(t),o.mtv.negate(),o)),o.matchAwake()}const r=Array.from(this.idToContactConstraint.keys());for(const o of t){const t=r.indexOf(o.id);t>-1&&r.splice(t,1);const n=null!==(e=this.idToContactConstraint.get(o.id))&&void 0!==e?e:[];let a=0;const l=o.colliderA.owner.get(Gi),h=o.colliderB.owner.get(Gi);if(l&&h)for(const e of o.points){const t=o.normal,r=o.tangent,c=e.sub(l.globalPos),u=e.sub(h.globalPos),d=c.cross(t),p=u.cross(t),f=l.inverseMass+h.inverseMass+l.inverseInertia*d*d+h.inverseInertia*p*p,g=c.cross(r),m=u.cross(r),_=l.inverseMass+h.inverseMass+l.inverseInertia*g*g+h.inverseInertia*m*m;n[a]&&(null===(s=null===(i=n[a])||void 0===i?void 0:i.point)||void 0===s?void 0:s.squareDistance(e))<4?(n[a].point=e,n[a].local=o.localPoints[a]):n[a]=new An(e,o.localPoints[a],o),n[a].aToContact=c,n[a].bToContact=u,n[a].normalMass=1/f,n[a].tangentMass=1/_;const v=l.bounciness>h.bounciness?l.bounciness:h.bounciness,y=o.normal.dot(n[a].getRelativeVelocity());n[a].originalVelocityAndRestitution=0,y<-.1&&(n[a].originalVelocityAndRestitution=-v*y),a++}this.idToContactConstraint.set(o.id,n)}for(const o of r)this.idToContactConstraint.delete(o);if(gi.warmStart)this.warmStart(t);else for(const o of t){const t=this.getContactConstraints(o.id);for(const e of t)e.normalImpulse=0,e.tangentImpulse=0}}postSolve(t){for(const e of t){const t=e.colliderA.owner.get(Gi),i=e.colliderB.owner.get(Gi);if(t&&i){if(t.collisionType===ti.Passive||i.collisionType===ti.Passive)continue;t.updateMotion(),i.updateMotion()}const s=Pt.fromDirection(e.mtv);e.colliderA.events.emit("postcollision",new H(e.colliderA,e.colliderB,s,e.mtv)),e.colliderA.events.emit("aftercollisionresolve",new G(e.colliderA,e.colliderB,s,e.mtv,e)),e.colliderB.events.emit("postcollision",new H(e.colliderB,e.colliderA,Pt.getOpposite(s),e.mtv.negate())),e.colliderB.events.emit("aftercollisionresolve",new G(e.colliderB,e.colliderA,Pt.getOpposite(s),e.mtv.negate(),e))}this.lastFrameContacts.clear();for(const e of t)this.lastFrameContacts.set(e.id,e)}warmStart(t){var e,i,s;for(const n of t){const t=null===(e=n.colliderA.owner)||void 0===e?void 0:e.get(Gi),r=null===(i=n.colliderB.owner)||void 0===i?void 0:i.get(Gi);if(t&&r){const e=null!==(s=this.idToContactConstraint.get(n.id))&&void 0!==s?s:[];for(const i of e)if(gi.warmStart){const e=n.normal.scale(i.normalImpulse),s=n.tangent.scale(i.tangentImpulse),o=e.add(s);t.applyImpulse(i.point,o.negate()),r.applyImpulse(i.point,o)}else i.normalImpulse=0,i.tangentImpulse=0}}}solvePosition(t){var e,i,s;for(let n=0;n<gi.positionIterations;n++)for(const r of t){const t=null===(e=r.colliderA.owner)||void 0===e?void 0:e.get(Gi),n=null===(i=r.colliderB.owner)||void 0===i?void 0:i.get(Gi);if(t&&n){if(t.collisionType===ti.Passive||n.collisionType===ti.Passive)continue;const e=null!==(s=this.idToContactConstraint.get(r.id))&&void 0!==s?s:[];for(const i of e){const e=r.normal,s=Ni.FindContactSeparation(r,i.local),o=-5,a=gt(gi.steeringFactor*(s+gi.slop),o,0),l=e.scale(-a*i.normalMass);if(t.collisionType===ti.Active){const e=l.negate().scale(t.inverseMass);t.limitDegreeOfFreedom.includes(Wi.X)&&(e.x=0),t.limitDegreeOfFreedom.includes(Wi.Y)&&(e.y=0),t.globalPos=t.globalPos.add(e),t.limitDegreeOfFreedom.includes(Wi.Rotation)||(t.rotation-=i.aToContact.cross(l)*t.inverseInertia)}if(n.collisionType===ti.Active){const t=l.scale(n.inverseMass);n.limitDegreeOfFreedom.includes(Wi.X)&&(t.x=0),n.limitDegreeOfFreedom.includes(Wi.Y)&&(t.y=0),n.globalPos=n.globalPos.add(t),n.limitDegreeOfFreedom.includes(Wi.Rotation)||(n.rotation+=i.bToContact.cross(l)*n.inverseInertia)}}}}}solveVelocity(t){var e,i,s;for(let n=0;n<gi.velocityIterations;n++)for(const r of t){const t=null===(e=r.colliderA.owner)||void 0===e?void 0:e.get(Gi),n=null===(i=r.colliderB.owner)||void 0===i?void 0:i.get(Gi);if(t&&n){if(t.collisionType===ti.Passive||n.collisionType===ti.Passive)continue;const e=Math.min(t.friction,n.friction),i=null!==(s=this.idToContactConstraint.get(r.id))&&void 0!==s?s:[];for(const s of i){let i=-s.getRelativeVelocity().dot(r.tangent)*s.tangentMass;const o=e*s.normalImpulse,a=gt(s.tangentImpulse+i,-o,o);i=a-s.tangentImpulse,s.tangentImpulse=a;const l=r.tangent.scale(i);t.applyImpulse(s.point,l.negate()),n.applyImpulse(s.point,l)}for(const s of i){const e=s.getRelativeVelocity().dot(r.normal);let i=-s.normalMass*(e-s.originalVelocityAndRestitution);const o=Math.max(s.normalImpulse+i,0);i=o-s.normalImpulse,s.normalImpulse=o;const a=r.normal.scale(i);t.applyImpulse(s.point,a.negate()),n.applyImpulse(s.point,a)}}}}}class Rn extends fn{constructor(t){super(),this.types=["ex.transform","ex.motion","ex.collider"],this.systemType=dn.Update,this.priority=-1,this._realisticSolver=new kn,this._arcadeSolver=new Tn,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._processor=t.collisionProcessor,this._trackCollider=t=>this._processor.track(t),this._untrackCollider=t=>this._processor.untrack(t)}notify(t){if(mn(t)){const e=t.data.get(ji);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);const i=e.get();i&&this._processor.track(i)}else{const e=t.data.get(ji),i=e.get();e&&i&&this._processor.untrack(i)}}initialize(t){this._engine=t.engine}update(t,e){var i,s,n,r;if(!gi.enabled)return;let o=[];for(const h of t){const t=h.get(ji),e=null==t?void 0:t.get();if(t&&(null===(i=t.owner)||void 0===i?void 0:i.active)&&e)if(t.update(),e instanceof Di){const t=e.getColliders();o=o.concat(t)}else o.push(e)}this._processor.update(o);const a=this._processor.broadphase(o,e);this._currentFrameContacts.clear();let l=this._processor.narrowphase(a,null===(r=null===(n=null===(s=this._engine)||void 0===s?void 0:s.debug)||void 0===n?void 0:n.stats)||void 0===r?void 0:r.currFrame);l=this.getSolver().solve(l);for(const h of l){const t=h.id.indexOf("|");if(t>0){const e=h.id.substring(t+1);this._currentFrameContacts.set(e,h)}else this._currentFrameContacts.set(h.id,h)}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}getSolver(){return gi.collisionResolutionStrategy===ai.Realistic?this._realisticSolver:this._arcadeSolver}debug(t){this._processor.debug(t)}runContactStartEnd(){for(const[t,e]of this._currentFrameContacts)if(!this._lastFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionstart",new q(t,i,e)),t.events.emit("contactstart",new j(t,i,e)),i.events.emit("collisionstart",new q(i,t,e)),i.events.emit("contactstart",new j(i,t,e))}for(const[t,e]of this._lastFrameContacts)if(!this._currentFrameContacts.has(t)){const t=e.colliderA,i=e.colliderB;t.events.emit("collisionend",new X(t,i)),t.events.emit("contactend",new W(t,i)),i.events.emit("collisionend",new X(i,t)),i.events.emit("contactend",new W(i,t))}}}var In,Dn,Mn,Fn;(Dn=In||(In={})).Forward="forward",Dn.Backward="backward",(Fn=Mn||(Mn={})).End="end",Fn.Loop="loop",Fn.PingPong="pingpong",Fn.Freeze="freeze";const Ln={Frame:"frame",Loop:"loop",Ended:"ended"};class Bn extends Gt{constructor(t){var e,i;super(t),this.events=new x,this.frames=[],this.strategy=Mn.Loop,this.frameDuration=100,this.timeScale=1,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._pingPongDirection=1,this._done=!1,this._playing=!0,this._reversed=!1,this.frames=t.frames,this.strategy=null!==(e=t.strategy)&&void 0!==e?e:this.strategy,this.frameDuration=t.totalDuration?t.totalDuration/this.frames.length:null!==(i=t.frameDuration)&&void 0!==i?i:this.frameDuration,t.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new Bn({frames:this.frames.map((t=>({...t}))),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}get height(){const t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}static fromSpriteSheet(t,e,i,s=Mn.Loop){const n=t.sprites.length-1,r=e.filter((t=>t<0||t>n));return r.length&&Bn._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${r.join(",")} no frame will be shown`),new Bn({frames:t.sprites.filter(((t,i)=>e.indexOf(i)>-1)).map((t=>({graphic:t,duration:i}))),strategy:s})}static fromSpriteSheetCoordinates(t){const{spriteSheet:e,frameCoordinates:i,durationPerFrameMs:s,strategy:n,reverse:r}=t,o=null!=s?s:100,a=[];for(const l of i){const{x:t,y:i,duration:s}=l,n=e.getSprite(t,i);n?a.push({graphic:n,duration:null!=s?s:o}):Bn._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${t}, ${i}), please check your SpriteSheet to confirm that sprite exists`)}return new Bn({frames:a,strategy:n,reverse:r})}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return!(!this._reversed||1!==this._pingPongDirection)?In.Backward:In.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0}get canFinish(){switch(this.strategy){case Mn.End:case Mn.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(t){this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;const e=this.frames[this._currentFrame];e&&!this._done&&(this._timeLeftInFrame=(null==e?void 0:e.duration)||this.frameDuration,this.events.emit("frame",{...e,frameIndex:this.currentFrameIndex}))}_nextFrame(){const t=this._currentFrame;if(this._done)return t;let e=-1;switch(this.strategy){case Mn.Loop:e=(t+1)%this.frames.length,0===e&&this.events.emit("loop",this);break;case Mn.End:e=t+1,e>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case Mn.Freeze:e=gt(t+1,0,this.frames.length-1),e>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case Mn.PingPong:t+this._pingPongDirection>=this.frames.length&&(this._pingPongDirection=-1,this.events.emit("loop",this)),t+this._pingPongDirection<0&&(this._pingPongDirection=1,this.events.emit("loop",this)),e=t+this._pingPongDirection%this.frames.length}return e}tick(t,e=0){this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",{...this.currentFrame,frameIndex:this.currentFrameIndex})),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(t,e,i){this.currentFrame&&this.currentFrame.graphic.draw(t,e,i)}}Bn._LOGGER=nt.getInstance();class On extends Gt{constructor(t){super(t),this.members=[],this.members=t.members,this._updateDimensions()}clone(){return new On({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){let t=new Rt;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return this.width=t.width,this.height=t.height,t}get localBounds(){let t=new Rt;for(const{graphic:e,pos:i}of this.members)t=e.localBounds.translate(i).combine(t);return t}_isAnimationOrGroup(t){return t instanceof Bn||t instanceof On}tick(t,e){for(const i of this.members){const s=i.graphic;this._isAnimationOrGroup(s)&&s.tick(t,e)}}reset(){for(const t of this.members){const e=t.graphic;this._isAnimationOrGroup(e)&&e.reset()}}_preDraw(t,e,i){this._updateDimensions(),super._preDraw(t,e,i)}_drawImage(t,e,i){for(const s of this.members)t.save(),t.translate(e,i),s.graphic.draw(t,s.pos.x,s.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}function zn(t){return class extends t{assign(t){for(const e in t)"function"!=typeof this[e]&&(this[e]=t[e])}constructor(...t){super(...t);1!==t.filter((function(t){return void 0!==t})).length||!t[0]||"object"!=typeof t[0]||t[0]instanceof Array||this.assign(t[0])}}}var Nn,Un,Vn,Hn;(Un=Nn||(Nn={}))[Un.Circle=0]="Circle",Un[Un.Rectangle=1]="Rectangle";class jn extends Qi{constructor(t,e,i,s,n,r,o,a,l,h){super(),this.position=new bt(0,0),this.velocity=new bt(0,0),this.acceleration=new bt(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=St.White,this.endColor=St.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=St.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let c=t;if(c&&!(t instanceof $n)){const u=t;c=u.emitter,e=u.life,i=u.opacity,n=u.endColor,s=u.beginColor,r=u.position,o=u.velocity,a=u.acceleration,l=u.startSize,h=u.endSize}if(this.emitter=c,this.life=e||this.life,this.opacity=i||this.opacity,this.endColor=n||this.endColor.clone(),this.beginColor=s||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.emitter.particleTransform===Vn.Global){const t=this.emitter.transform.globalPos;this.position=(r||this.position).add(t),this.velocity=(o||this.velocity).rotate(this.emitter.transform.globalRotation)}else this.velocity=o||this.velocity,this.position=r||this.position;this.acceleration=a||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=l||0,this.endSize=h||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new bi),this.addComponent(this.graphics=new is),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=Ct(1,1),this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(this.particleSprite)):(this.graphics.localBounds=Rt.fromDimension(this.particleSize,this.particleSize,bt.Half),this.graphics.onPostDraw=t=>{t.save(),this.graphics.opacity=this.opacity;const e=this._currentColor.clone();e.a=1,t.debug.drawPoint(Ct(0,0),{color:e,size:this.particleSize}),t.restore()})}kill(){this.emitter.removeParticle(this)}update(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=gt(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=gt(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=gt(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=gt(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=gt(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=gt(this.opacity,1e-4,1),this.focus){const t=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(t)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=Ct(1,1),this.graphics.opacity=this.opacity}}class Wn extends(zn(jn)){constructor(t,e,i,s,n,r,o,a,l,h){super(t,e,i,s,n,r,o,a,l,h)}}(Hn=Vn||(Vn={})).Global="global",Hn.Local="local";class $n extends js{get opacity(){return super.graphics.opacity}set opacity(t){super.graphics.opacity=t}get particleSprite(){return this._sprite}set particleSprite(t){t&&(this._sprite=t)}constructor(t){var e,i;super({width:null!==(e=t.width)&&void 0!==e?e:0,height:null!==(i=t.height)&&void 0!==i?i:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new bt(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=St.White,this.endColor=St.White,this._sprite=null,this.emitterType=Nn.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1,this.particleTransform=Vn.Global;const{x:s,y:n,pos:r,isEmitting:o,minVel:a,maxVel:l,acceleration:h,minAngle:c,maxAngle:u,emitRate:d,particleLife:p,opacity:f,fadeFlag:g,focus:m,focusAccel:_,startSize:v,endSize:y,minSize:x,maxSize:w,beginColor:b,endColor:C,particleSprite:S,emitterType:E,radius:P,particleRotationalVelocity:T,particleTransform:A,randomRotation:k,random:R}={...t};this.pos=null!=r?r:Ct(null!=s?s:0,null!=n?n:0),this.isEmitting=null!=o?o:this.isEmitting,this.minVel=null!=a?a:this.minVel,this.maxVel=null!=l?l:this.maxVel,this.acceleration=null!=h?h:this.acceleration,this.minAngle=null!=c?c:this.minAngle,this.maxAngle=null!=u?u:this.maxAngle,this.emitRate=null!=d?d:this.emitRate,this.particleLife=null!=p?p:this.particleLife,this.opacity=null!=f?f:this.opacity,this.fadeFlag=null!=g?g:this.fadeFlag,this.focus=null!=m?m:this.focus,this.focusAccel=null!=_?_:this.focusAccel,this.startSize=null!=v?v:this.startSize,this.endSize=null!=y?y:this.endSize,this.minSize=null!=x?x:this.minSize,this.maxSize=null!=w?w:this.maxSize,this.beginColor=null!=b?b:this.beginColor,this.endColor=null!=C?C:this.endColor,this.particleSprite=null!=S?S:this.particleSprite,this.emitterType=null!=E?E:this.emitterType,this.radius=null!=P?P:this.radius,this.particleRotationalVelocity=null!=T?T:this.particleRotationalVelocity,this.randomRotation=null!=k?k:this.randomRotation,this.particleTransform=null!=A?A:this.particleTransform,this.body.collisionType=ti.PreventCollision,this.random=null!=R?R:new ut}removeParticle(t){this.deadParticles.push(t)}emitParticles(t){var e;for(let i=0;i<t;i++){const t=this._createParticle();this.particles.push(t),(null===(e=null==this?void 0:this.scene)||void 0===e?void 0:e.world)&&(this.particleTransform===Vn.Global?this.scene.world.add(t):this.addChild(t))}}clearParticles(){this.particles.length=0}_createParticle(){let t=0,e=0;const i=xt(this.minAngle,this.maxAngle,this.random),s=xt(this.minVel,this.maxVel,this.random),n=this.startSize||xt(this.minSize,this.maxSize,this.random),r=s*Math.cos(i),o=s*Math.sin(i);if(this.emitterType===Nn.Rectangle)t=xt(0,this.width,this.random),e=xt(0,this.height,this.random);else if(this.emitterType===Nn.Circle){const s=xt(0,this.radius,this.random);t=s*Math.cos(i),e=s*Math.sin(i)}const a=new Wn(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new bt(t,e),new bt(r,o),this.acceleration,this.startSize,this.endSize);return a.fadeFlag=this.fadeFlag,a.particleSize=n,this.particleSprite&&(a.particleSprite=this.particleSprite,a.graphics.opacity=this.opacity,a.graphics.use(this._sprite)),a.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(a.currentRotation=xt(0,2*Math.PI,this.random)),this.focus&&(a.focus=this.focus.add(new bt(this.pos.x,this.pos.y)),a.focusAccel=this.focusAccel),a}update(t,e){var i;super.update(t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let s=0;s<this.deadParticles.length;s++)Ft(this.deadParticles[s],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[s],!1);this.deadParticles.length=0}}class Gn extends fn{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=dn.Draw,this.priority=0,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}get sortedTransforms(){return this._sortedTransforms}initialize(t){this._camera=t.camera,this._engine=t.engine}preupdate(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort(((t,e)=>t.z-e.z)),this._zHasChanged=!1)}notify(t){if(mn(t)){const e=t.data.get(bi);this._sortedTransforms.push(e),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(bi);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&this._sortedTransforms.splice(i,1)}}update(t,e){let i;this._token++,Us.checkAndClearCache(),this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const s of this._sortedTransforms){const t=s.owner;if(t.hasTag("ex.offscreen"))continue;if(i=t.get(is),!i.visible)continue;s.coordPlane===pi.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),s.coordPlane===pi.Screen&&this._graphicsContext.translate(this._engine.screen.contentArea.left,this._engine.screen.contentArea.top),i.update(e,this._token);const n=t.get(qs);if(n){const t=bt.One.sub(n.parallaxFactor),e=this._camera.pos.scale(t);this._graphicsContext.translate(e.x,e.y)}this._applyTransform(t),i.material&&(this._graphicsContext.material=i.material),i.onPreDraw&&i.onPreDraw(this._graphicsContext,e);const r=t instanceof Wn?t.opacity:1;this._graphicsContext.opacity*=i.opacity*r,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),s.coordPlane===pi.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}this._graphicsContext.restore()}_drawGraphicsComponent(t){var e,i;if(t.visible){const s=t.flipHorizontal,n=t.flipVertical;for(const r of t.layers.get())for(const{graphic:o,options:a}of r.graphics){let l=t.anchor,h=t.offset;(null==a?void 0:a.anchor)&&(l=a.anchor),(null==a?void 0:a.offset)&&(h=a.offset);const c=-o.width*l.x+h.x,u=-o.height*l.y+h.y,d=o.flipHorizontal,p=o.flipVertical;if((s||n)&&(o.flipHorizontal=s?!d:d,o.flipVertical=n?!p:p),null==o||o.draw(this._graphicsContext,c+r.offset.x,u+r.offset.y),(s||n)&&(o.flipHorizontal=d,o.flipVertical=p),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){const t=Ct(c+r.offset.x,u+r.offset.y);if(o instanceof On)for(const e of o.members)null===(i=e.graphic)||void 0===i||i.localBounds.translate(t.add(e.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor);else null==o||o.localBounds.translate(t).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}}_applyTransform(t){const e=t.getAncestors();for(const i of e){const t=null==i?void 0:i.get(bi),e=null==i?void 0:i.get(Gi);let s=t.pos,n=t.scale,r=t.rotation;if(e&&this._engine.fixedUpdateFps&&e.__oldTransformCaptured&&e.enableFixedUpdateInterpolate){const i=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);s=t.pos.scale(i).add(e.oldPos.scale(1-i)),n=t.scale.scale(i).add(e.oldScale.scale(1-i));const o=(1-i)*Math.cos(e.oldRotation)+i*Math.cos(t.rotation),a=(1-i)*Math.sin(e.oldRotation)+i*Math.sin(t.rotation);r=Math.atan2(a,o)}t&&(this._graphicsContext.z=t.z,this._graphicsContext.translate(s.x,s.y),this._graphicsContext.scale(n.x,n.y),this._graphicsContext.rotate(r))}}}class qn extends fn{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=dn.Draw,this.priority=999}initialize(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(Rn)}update(t,e){var i;if(!this._engine.isDebug)return;const s=this._engine.debug.filter;let n,r;const o=this._engine.debug.entity;let a;const l=this._engine.debug.transform;let h;const c=this._engine.debug.motion;let u;const d=this._engine.debug.collider,p=this._engine.debug.physics;let f;const g=this._engine.debug.graphics;let m,_;const v=this._engine.debug.body,y=this._engine.debug.camera;for(const x of t){if(x.hasTag("offscreen"))continue;if(x instanceof Wn)continue;if(s.useFilter){if(!(0===s.ids.length||s.ids.includes(x.id)))continue;if(!(""===s.nameQuery||x.name.includes(s.nameQuery)))continue}let t=bt.Zero;const e=Ct(0,16);if(n=x.id,r=x.name,a=x.get(bi),this._pushCameraTransform(a),this._graphicsContext.save(),this._applyTransform(x),a&&((l.showAll||l.showPosition)&&this._graphicsContext.debug.drawPoint(bt.Zero,{size:4,color:l.positionColor}),(l.showAll||l.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${a.pos.toString(2)}`,t),t=t.add(e)),(l.showAll||l.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${a.z.toFixed(1)})`,t),t=t.add(e)),(o.showAll||o.showId)&&(this._graphicsContext.debug.drawText(`id(${n}) ${x.parent?"child of id("+(null===(i=x.parent)||void 0===i?void 0:i.id)+")":""}`,t),t=t.add(e)),(o.showAll||o.showName)&&(this._graphicsContext.debug.drawText(`name(${r})`,t),t=t.add(e)),(l.showAll||l.showRotation)&&(this._graphicsContext.drawLine(bt.Zero,bt.fromAngle(a.rotation).scale(50).add(bt.Zero),l.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${_t(a.rotation).toFixed(2)})`,t),t=t.add(e)),(l.showAll||l.showScale)&&this._graphicsContext.drawLine(bt.Zero,a.scale.add(bt.Zero),l.scaleColor,2)),f=x.get(is),f&&(g.showAll||g.showBounds)){f.localBounds.draw(this._graphicsContext,g.boundsColor)}if(m=x.get(Xs),m&&(m.useTransform||this._graphicsContext.restore(),m.draw(this._graphicsContext),m.useTransform||(this._graphicsContext.save(),this._applyTransform(x))),_=x.get(Gi),_&&((v.showAll||v.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${_.group.name})`,t),t=t.add(e)),(v.showAll||v.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${_.collisionType})`,t),t=t.add(e)),(v.showAll||v.showMass)&&(this._graphicsContext.debug.drawText(`mass(${_.mass})`,t),t=t.add(e)),(v.showAll||v.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${_.sleepMotion})`,t),t=t.add(e)),(v.showAll||v.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${_.canSleep?_.sleeping:"cant sleep"})`,t),t=t.add(e))),this._graphicsContext.restore(),h=x.get(Ci),h&&((c.showAll||c.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${h.vel.toString(2)}`,t.add(a.globalPos)),this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(h.vel),c.velocityColor,2),t=t.add(e)),(c.showAll||c.showAcceleration)&&this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(h.acc),c.accelerationColor,2)),u=x.get(ji),u){const t=u.get();if((d.showAll||d.showGeometry)&&t&&t.debug(this._graphicsContext,d.geometryColor),d.showAll||d.showBounds)if(t instanceof Di){const e=t.getColliders();for(const t of e){const e=t.bounds,i=Ct(e.left,e.top);this._graphicsContext.debug.drawRect(i.x,i.y,e.width,e.height,{color:d.boundsColor}),(d.showAll||d.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${t.owner.id})`,i)}u.bounds.draw(this._graphicsContext,d.boundsColor)}else if(t){const t=u.bounds,e=Ct(t.left,t.top);this._graphicsContext.debug.drawRect(e.x,e.y,t.width,t.height,{color:d.boundsColor}),(d.showAll||d.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${u.owner.id})`,e)}}this._popCameraTransform(a)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(p.showAll||p.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),p.showAll||p.showCollisionContacts||p.showCollisionNormals)for(const[x,w]of this._engine.debug.stats.currFrame.physics.contacts){if(p.showAll||p.showCollisionContacts)for(const t of w.points)this._graphicsContext.debug.drawPoint(t,{size:5,color:p.collisionContactColor});if(p.showAll||p.showCollisionNormals)for(const t of w.points)this._graphicsContext.debug.drawLine(t,w.normal.scale(30).add(t),{color:p.collisionNormalColor})}this._graphicsContext.restore(),y&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(y.showAll||y.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,y.focusColor),(y.showAll||y.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}_applyTransform(t){const e=t.getAncestors();for(const i of e){const t=null==i?void 0:i.get(bi);t&&(this._graphicsContext.translate(t.pos.x,t.pos.y),this._graphicsContext.scale(t.scale.x,t.scale.y),this._graphicsContext.rotate(t.rotation))}}_pushCameraTransform(t){t.coordPlane===pi.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(t){t.coordPlane===pi.World&&this._graphicsContext.restore()}}class Xn extends fn{constructor(){super(...arguments),this.types=["ex.transform","ex.pointer"],this.systemType=dn.Update,this.priority=-1,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}initialize(t){this._engine=t.engine}preupdate(){this._receiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort(((t,e)=>e.z-t.z)),this._sortedEntities=this._sortedTransforms.map((t=>t.owner)),this._zHasChanged=!1)}notify(t){if(mn(t)){const e=t.data.get(bi);this._sortedTransforms.push(e),this._sortedEntities.push(e.owner),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const e=t.data.get(bi);e.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(e);i>-1&&(this._sortedTransforms.splice(i,1),this._sortedEntities.splice(i,1))}}entityCurrentlyUnderPointer(t,e){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(e)}entityWasUnderPointer(t,e){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(e)}entered(t,e){return this.entityCurrentlyUnderPointer(t,e)&&!this.lastFrameEntityToPointers.has(t.id)}left(t,e){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,e)}addPointerToEntity(t,e){if(!this.currentFrameEntityToPointers.has(t.id))return void this.currentFrameEntityToPointers.set(t.id,[e]);const i=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,i.concat(e))}update(t){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receiver.update(),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receiver.clear()}_processPointerToEntity(t){var e;let i,s,n,r;for(const o of t){if(i=o.get(bi),r=null!==(e=o.get(rs))&&void 0!==e?e:new rs,s=o.get(ji),s&&(r.useColliderShape||this.overrideUseColliderShape)){s.update();const t=s.get();if(t)for(const[e,s]of this._receiver.currentFramePointerCoords.entries())t.contains(i.coordPlane===pi.World?s.worldPos:s.screenPos)&&this.addPointerToEntity(o,e)}if(n=o.get(is),n&&(r.useGraphicsBounds||this.overrideUseGraphicsBounds)){const t=n.localBounds.transform(i.get().matrix);for(const[e,s]of this._receiver.currentFramePointerCoords.entries())t.contains(i.coordPlane===pi.World?s.worldPos:s.screenPos)&&this.addPointerToEntity(o,e)}}}_processDownAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameDown)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerdown",i),this._receiver.isDragStart(i.pointerId)&&t.events.emit("pointerdragstart",i)),e.set(i.pointerId,i);return e}_processUpAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameUp)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointerup",i),this._receiver.isDragEnd(i.pointerId)&&t.events.emit("pointerdragend",i)),e.set(i.pointerId,i);return e}_processMoveAndEmit(t){const e=new Map;for(const i of this._receiver.currentFrameMove)i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&(t.events.emit("pointermove",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragmove",i)),e.set(i.pointerId,i);return e}_processEnterLeaveAndEmit(t,e){for(const i of e){if(i.active&&t.active&&this.entered(t,i.pointerId)){t.events.emit("pointerenter",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragenter",i);break}if(i.active&&t.active&&(this.left(t,i.pointerId)||this.entityCurrentlyUnderPointer(t,i.pointerId)&&"up"===i.type)){t.events.emit("pointerleave",i),this._receiver.isDragging(i.pointerId)&&t.events.emit("pointerdragleave",i);break}}}_processCancelAndEmit(t){for(const e of this._receiver.currentFrameCancel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,e.pointerId)&&t.events.emit("pointercancel",e)}_processWheelAndEmit(t){for(const e of this._receiver.currentFrameWheel)e.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",e)}_dispatchEvents(t){const e=new Set(this.lastFrameEntityToPointers.keys()),i=new Set(this.currentFrameEntityToPointers.keys()),s=t.filter((t=>e.has(t.id)||i.has(t.id)));let n,r,o;for(const a of s){o=this._processDownAndEmit(a),r=this._processUpAndEmit(a),n=this._processMoveAndEmit(a);const t=[...n.values(),...o.values(),...r.values()];this._processEnterLeaveAndEmit(a,t),this._processCancelAndEmit(a),this._processWheelAndEmit(a)}}}class Kn extends fn{constructor(){super(...arguments),this.types=["ex.actions"],this.systemType=dn.Update,this.priority=-1,this._actions=[]}notify(t){if(mn(t)){const e=t.data.get(zs);this._actions.push(e)}else{const e=t.data.get(zs),i=this._actions.indexOf(e);i>-1&&this._actions.splice(i,1)}}update(t,e){for(const i of this._actions)i.update(e)}}class Yn extends yi{constructor(t){super(),this.type="ex.isometricentity",this.elevation=0,this.map=t}}class Zn extends fn{constructor(){super(...arguments),this.types=["ex.transform","ex.isometricentity"],this.systemType=dn.Update,this.priority=99}update(t,e){let i,s;for(const n of t){i=n.get(bi),s=n.get(Yn);const t=Math.max(s.map.columns*s.map.tileWidth,s.map.rows*s.map.tileHeight)*s.elevation+i.pos.y;i.z=t}}}class Qn extends fn{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=dn.Draw,this.priority=-1}initialize(t){this._camera=t.camera,this._screen=t.engine.screen}update(t){let e,i,s;this._worldBounds=this._screen.getWorldBounds();for(const n of t){let t;if(i=n.get(is),e=n.get(bi),s=n.get(qs),s){const e=bt.One.sub(s.parallaxFactor);t=this._camera.pos.scale(e)}const r=this._isOffscreen(e,i,t);r&&!n.hasTag("ex.offscreen")&&(n.events.emit("exitviewport",new Q(n)),n.addTag("ex.offscreen")),!r&&n.hasTag("ex.offscreen")&&(n.events.emit("enterviewport",new J(n)),n.removeTag("ex.offscreen"))}}_isOffscreen(t,e,i){if(t.coordPlane===pi.World){let s=e.localBounds;i&&(s=s.translate(i));const n=s.transform(t.get().matrix);return!this._worldBounds.overlaps(n)}return!1}}class Jn{constructor(){this.collisionProcessor=new Ri}rayCast(t,e){return this.collisionProcessor.rayCast(t,e)}}const tr={Initialize:"initialize",Activate:"activate",Deactivate:"deactivate",PreUpdate:"preupdate",PostUpdate:"postupdate",PreDraw:"predraw",PostDraw:"postdraw",PreDebugDraw:"predebugdraw",PostDebugDraw:"postdebugdraw"};class er{get actors(){return this.world.entityManager.entities.filter((t=>t instanceof js))}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter((t=>t instanceof un))}get tileMaps(){return this.world.entityManager.entities.filter((t=>t instanceof Ys))}get timers(){return this._timers}constructor(){this._logger=nt.getInstance(),this.events=new x,this.camera=new ln,this.world=new Sn(this),this.physics=new Jn,this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(new Kn),this.world.add(new Pn),this.world.add(new Rn(this.physics)),this.world.add(new Xn),this.world.add(new Zn),this.world.add(new Qn),this.world.add(new Gn),this.world.add(new qn)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}onInitialize(t){}onActivate(t){}onDeactivate(t){}onPreUpdate(t,e){}onPostUpdate(t,e){}onPreDraw(t,e){}onPostDraw(t,e){}_initializeChildren(){for(const t of this.entities)t._initialize(this.engine)}get isInitialized(){return this._isInitialized}_initialize(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.world.systemManager.initialize(),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.events.emit("initialize",new K(t,this)),this._isInitialized=!0)}_activate(t){this._logger.debug("Scene.onActivate",this),this.onActivate(t)}_deactivate(t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t)}_preupdate(t,e){this.emit("preupdate",new I(t,e,this)),this.onPreUpdate(t,e)}_postupdate(t,e){this.emit("postupdate",new D(t,e,this)),this.onPostUpdate(t,e)}_predraw(t,e){this.emit("predraw",new T(t,e,this)),this.onPreDraw(t,e)}_postdraw(t,e){this.emit("postdraw",new A(t,e,this)),this.onPostDraw(t,e)}update(t,e){let i,s;for(this._preupdate(t,e),i=0,s=this._cancelQueue.length;i<s;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;for(const n of this._timers)n.update(e);this.world.update(dn.Update,e),this.camera&&this.camera.update(t,e),this._collectActorStats(t),this._postupdate(t,e)}draw(t,e){var i;this._predraw(t,e),this.world.update(dn.Draw,e),(null===(i=this.engine)||void 0===i?void 0:i.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}debugDraw(t){this.emit("predebugdraw",new k(t,this)),this.emit("postdebugdraw",new R(t,this))}contains(t){return this.actors.indexOf(t)>-1}add(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Gs&&(Lt(this._timers,t)||this.addTimer(t))}transfer(t){let e;t instanceof Qi&&t.scene&&t.scene!==this&&(e=t.scene,t.scene.world.remove(t,!1)),t instanceof Gs&&t.scene&&(e=t.scene,t.scene.removeTimer(t)),null==e||e.emit("entityremoved",{target:t}),this.add(t)}remove(t){t instanceof Qi&&(this.emit("entityremoved",{target:t}),t.active&&t.kill(),this.world.remove(t)),t instanceof Gs&&this.removeTimer(t)}clear(t=!0){for(const e of this.entities)this.world.remove(e,t);for(const e of this.timers)this.removeTimer(e)}addTimer(t){return this._timers.push(t),t.scene=this,t}removeTimer(t){const e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}cancelTimer(t){return this._cancelQueue.push(t),t}isTimerActive(t){return this._timers.indexOf(t)>-1&&!t.complete}isCurrentScene(){return!!this.engine&&this.engine.currentScene===this}_collectActorStats(t){const e=this.actors.filter((t=>t instanceof $s));for(const i of e)t.stats.currFrame.actors.ui++;for(const i of this.actors){t.stats.currFrame.actors.alive++;for(const e of i.children)Ws(e)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}}var ir,sr;(sr=ir||(ir={})).Protanope="Protanope",sr.Deuteranope="Deuteranope",sr.Tritanope="Tritanope";class nr{constructor(t,e){this._shader=new oe({gl:t,vertexSource:"#version 300 es\n      in vec2 a_position;\n      in vec2 a_texcoord;\n      out vec2 v_texcoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        // Pass the texcoord to the fragment shader.\n        v_texcoord = a_texcoord;\n      }",fragmentSource:e}),this._shader.compile(),this._buffer=new ae({gl:t,type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new le({gl:t,shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class rr{constructor(t,e=!1){this._colorBlindnessMode=t,this._simulate=!1,this._simulate=e}initialize(t){this._shader=new nr(t,"#version 300 es\r\nprecision mediump float;\r\n// our texture\r\nuniform sampler2D u_image;\r\n// the texCoords passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// color blind type\r\nuniform int u_type;\r\n\r\n// simulation?\r\nuniform bool u_simulate;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  vec4 o =  texture(u_image, v_texcoord);\r\n  // RGB to LMS matrix conversion\r\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r\n  // Simulate color blindness\r\n  float l;\r\n  float m;\r\n  float s;\r\n  //MODE CODE//\r\n  if (u_type == 0) {\r\n    // Protanope\r\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r\n  } else if (u_type == 1) {\r\n    // Deuteranope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\r\n  } else if (u_type == 2) {\r\n    // Tritanope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r\n  }\r\n\r\n  // LMS to RGB matrix conversion\r\n  vec4 error; // simulate the colors\r\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r\n  error.a = 1.0;\r\n  vec4 diff = o - error;\r\n  vec4 correction; // correct the colors\r\n  correction.r = 0.0;\r\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r\n  correction = o + correction;\r\n  correction.a = o.a;\r\n  //SIMULATE//\r\n\r\n  // sim \r\n  if (u_simulate) {\r\n    fragColor = error.rgba;\r\n  } else {\r\n    fragColor = correction.rgba;\r\n  }\r\n}"),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(t){if(this._colorBlindnessMode=t,this._shader){const t=this._shader.getShader();t.use(),this._colorBlindnessMode===ir.Protanope?t.setUniformInt("u_type",0):this._colorBlindnessMode===ir.Deuteranope?t.setUniformInt("u_type",1):this._colorBlindnessMode===ir.Tritanope&&t.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(t){if(this._simulate=t,this._shader){const e=this._shader.getShader();e.use(),e.setUniformBoolean("u_simulate",t)}}get simulate(){return this._simulate}}class or{constructor(t){this._engine=t,this._colorBlindPostProcessor=new rr(ir.Protanope)}correct(t){this._engine.graphicsContext instanceof Ce&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(t){this._engine.graphicsContext instanceof Ce&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class ar{constructor(t){this.stats={currFrame:new lr,prevFrame:new lr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,showPositionLabel:!1,positionColor:St.Yellow,showZIndex:!1,showScale:!1,scaleColor:St.Green,showRotation:!1,rotationColor:St.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:St.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:St.Blue,showOwner:!1,showGeometry:!0,geometryColor:St.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:St.Cyan,showCollisionContacts:!0,collisionContactColor:St.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:St.Yellow,showAcceleration:!1,accelerationColor:St.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:St.Red,showZoom:!1},this._engine=t,this.colorBlindMode=new or(this._engine)}useTestClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toTestClock();return e&&i.start(),this._engine.clock=i,i}useStandardClock(){const t=this._engine.clock,e=t.isRunning();t.stop();const i=t.toStandardClock();return e&&i.start(),this._engine.clock=i,i}}class lr{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new hr,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const t=new lr;return t.reset(this),t}get id(){return this._id}set id(t){this._id=t}get delta(){return this._delta}set delta(t){this._delta=t}get fps(){return this._fps}set fps(t){this._fps=t}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class hr{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const t=new hr;return t.reset(this),t}get pairs(){return this._pairs}set pairs(t){this._pairs=t}get collisions(){return this._collisions}set collisions(t){this._collisions=t}get contacts(){return this._contacts}set contacts(t){this._contacts=t}get fastBodies(){return this._fastBodies}set fastBodies(t){this._fastBodies=t}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(t){this._fastBodyCollisions=t}get broadphase(){return this._broadphase}set broadphase(t){this._broadphase=t}get narrowphase(){return this._narrowphase}set narrowphase(t){this._narrowphase=t}}class cr{on(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}off(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}_decorate(t){return e=>{this._paused||t(e)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const t in this._nativeHandlers)this.off(t)}constructor(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}}class ur{constructor(t,e){this._windowGlobal=t,this._documentGlobal=e,this._windowComponent=new cr(this._windowGlobal),this._documentComponent=new cr(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}class dr{static fromPagePosition(t,e,i){let s,n,r,o;3===arguments.length?(s=t,n=e,r=new bt(s,n),o=i):(r=t,s=r.x,n=r.y,o=e);const a=o.screen.pageToScreenCoordinates(r),l=o.screen.screenToWorldCoordinates(a);return new dr(l,r,a)}constructor(t,e,i){this.worldPos=t,this.pagePos=e,this.screenPos=i}}class pr{cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}constructor(t,e,i,s,n,r){this.type=t,this.pointerId=e,this.button=i,this.pointerType=s,this.coordinates=n,this.nativeEvent=r,this.active=!0}}class fr{cancel(){this.active=!1}constructor(t,e,i,s,n,r,o,a,l,h,c,u){this.x=t,this.y=e,this.pageX=i,this.pageY=s,this.screenX=n,this.screenY=r,this.index=o,this.deltaX=a,this.deltaY=l,this.deltaZ=h,this.deltaMode=c,this.ev=u,this.active=!0}}class gr{constructor(){this.events=new x,this.lastPagePos=bt.Zero,this.lastScreenPos=bt.Zero,this.lastWorldPos=bt.Zero,this._onPointerMove=t=>{this.lastPagePos=new bt(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new bt(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new bt(t.worldPos.x,t.worldPos.y)},this._onPointerDown=t=>{this.lastPagePos=new bt(t.pagePos.x,t.pagePos.y),this.lastScreenPos=new bt(t.screenPos.x,t.screenPos.y),this.lastWorldPos=new bt(t.worldPos.x,t.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}}var mr,_r,vr,yr,xr,wr,br,Cr;(_r=mr||(mr={})).Pixel="Pixel",_r.Line="Line",_r.Page="Page",(yr=vr||(vr={}))[yr.NoButton=-1]="NoButton",yr[yr.Left=0]="Left",yr[yr.Middle=1]="Middle",yr[yr.Right=2]="Right",yr[yr.Unknown=3]="Unknown",(wr=xr||(xr={})).Left="Left",wr.Middle="Middle",wr.Right="Right",wr.Unknown="Unknown",wr.NoButton="NoButton",(Cr=br||(br={})).Touch="Touch",Cr.Mouse="Mouse",Cr.Pen="Pen",Cr.Unknown="Unknown";class Sr{constructor(t,e){this.target=t,this.engine=e,this.events=new x,this.primary=new gr,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}recreate(t,e){const i=new Sr(t,e);return i.primary=this.primary,i._pointers=this._pointers,i}at(t){if(t>=this._pointers.length)for(let e=this._pointers.length-1,i=t;e<i;e++)this._pointers.push(new gr);return this._pointers[t]}count(){return this._pointers.length}isDown(t){var e;return null!==(e=this.currentFramePointerDown.get(t))&&void 0!==e&&e}wasDown(t){var e;return null!==(e=this.lastFramePointerDown.get(t))&&void 0!==e&&e}isDragging(t){return this.isDown(t)}isDragStart(t){return this.isDown(t)&&!this.wasDown(t)}isDragEnd(t){return!this.isDown(t)&&this.wasDown(t)}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const t of this.currentFrameDown){this.emit("down",t);this.at(t.pointerId).emit("down",t),this.primary.emit("pointerdown",t)}for(const t of this.currentFrameUp){this.emit("up",t);this.at(t.pointerId).emit("up",t)}for(const t of this.currentFrameMove){this.emit("move",t);this.at(t.pointerId).emit("move",t)}for(const t of this.currentFrameCancel){this.emit("cancel",t);this.at(t.pointerId).emit("cancel",t)}for(const t of this.currentFrameWheel)this.emit("wheel",t),this.primary.emit("pointerwheel",t)}clear(){for(const t of this.currentFrameUp){this.currentFramePointerCoords.delete(t.pointerId);const e=this._activeNativePointerIdsToNormalized.entries();for(const[i,s]of e)s===t.pointerId&&this._activeNativePointerIdsToNormalized.delete(i)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(t){var e;this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const i={passive:!(this.engine.pageScrollPreventionMode===Mr.All||this.engine.pageScrollPreventionMode===Mr.Canvas)};"onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,i):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel,i):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,i);if((null===(e=null==t?void 0:t.grabWindowFocus)||void 0===e||e)&&at()){const t=()=>{window.focus()};window.PointerEvent?this.target.addEventListener("pointerdown",t):(this.target.addEventListener("touchstart",t),this.target.addEventListener("mousedown",t))}}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(t){this._activeNativePointerIdsToNormalized.set(t,-1);const e=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort(((t,e)=>t-e)),i=e.findIndex((e=>e===t));return this._activeNativePointerIdsToNormalized.set(t,i),i}_handle(t){t.preventDefault();const e=new Map;let i,s;if(n=t,globalThis.TouchEvent&&n instanceof globalThis.TouchEvent){i=xr.Unknown,s=br.Touch;for(let i=0;i<t.changedTouches.length;i++){const s=t.changedTouches[i],n=dr.fromPagePosition(s.pageX,s.pageY,this.engine),r=i+1,o=this._normalizePointerId(r);this.currentFramePointerCoords.set(o,n),e.set(o,n)}}else{i=this._nativeButtonToPointerButton(t.button),s=br.Mouse;const n=dr.fromPagePosition(t.pageX,t.pageY,this.engine);let r=1;(function(t){return globalThis.PointerEvent&&t instanceof globalThis.PointerEvent})(t)&&(r=t.pointerId,s=this._stringToPointerType(t.pointerType));const o=this._normalizePointerId(r);this.currentFramePointerCoords.set(o,n),e.set(o,n)}var n;for(const[r,o]of e.entries())switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new pr("down",r,i,s,o,t)),this.currentFramePointerDown.set(r,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new pr("up",r,i,s,o,t)),this.currentFramePointerDown.set(r,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new pr("move",r,i,s,o,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new pr("cancel",r,i,s,o,t))}}_handleWheel(t){(this.engine.pageScrollPreventionMode===Mr.All||this.engine.pageScrollPreventionMode===Mr.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();const e=this.engine.screen.pageToScreenCoordinates(Ct(t.pageX,t.pageY)),i=this.engine.screen.screenToWorldCoordinates(e),s=-1/40,n=t.deltaX||t.wheelDeltaX*s||0,r=t.deltaY||t.wheelDeltaY*s||t.wheelDelta*s||t.detail||0,o=t.deltaZ||0;let a=mr.Pixel;t.deltaMode&&(1===t.deltaMode?a=mr.Line:2===t.deltaMode&&(a=mr.Page));const l=new fr(i.x,i.y,t.pageX,t.pageY,e.x,e.y,0,n,r,o,a,t);this.currentFrameWheel.push(l)}triggerEvent(t,e){const i=this.engine.screen.worldToPageCoordinates(e);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:i.x,clientY:i.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:i.x,clientY:i.y}));const s=this.engine.currentScene.world.systemManager.get(Xn),n=this.engine.currentScene.world.queryManager.createQuery(s.types);s.preupdate(),s.update(n.getEntities())}_nativeButtonToPointerButton(t){switch(t){case vr.NoButton:return xr.NoButton;case vr.Left:return xr.Left;case vr.Middle:return xr.Middle;case vr.Right:return xr.Right;case vr.Unknown:return xr.Unknown;default:return Bt(t)}}_stringToPointerType(t){switch(t){case"touch":return br.Touch;case"mouse":return br.Mouse;case"pen":return br.Pen;default:return br.Unknown}}}class Er{constructor(t){var e;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=t.initialFps,this._samplePeriod=null!==(e=t.samplePeriod)&&void 0!==e?e:this._samplePeriod,this._currentFrameTime=1e3/t.initialFps,this._nowFn=t.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=1e3*this._frames/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class Pr{constructor(t){var e,i,s;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=t,this.tick=t.tick,this._lastTime=null!==(e=this.now())&&void 0!==e?e:0,this._maxFps=null!==(i=t.maxFps)&&void 0!==i?i:this._maxFps,this._onFatalException=null!==(s=t.onFatalException)&&void 0!==s?s:this._onFatalException,this.fpsSampler=new Er({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new Ar({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new Tr({...this._options})}setFatalExceptionHandler(t){this._onFatalException=t}schedule(t,e=0){const i=this._totalElapsed+e;this._scheduledCbs.push([t,i])}_runScheduledCbs(){for(let t=this._scheduledCbs.length-1;t>-1;t--)this._scheduledCbs[t][1]<=this._totalElapsed&&(this._scheduledCbs[t][0](),this._scheduledCbs.splice(t,1))}update(t){try{this.fpsSampler.start();const e=this.now();let i=e-this._lastTime||1;const s=1e3/this._maxFps;if(i>=s){let n=0;0!==s&&(n=i%s,i-=n),i>200&&(i=1),this._elapsed=t||i,this._totalElapsed+=this._elapsed,this._runScheduledCbs(),this.tick(t||i),this._lastTime=0!==s?e-n:e,this.fpsSampler.end()}}catch(Yy){this._onFatalException(Yy),this.stop()}}}class Tr extends Pr{constructor(t){super(t),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const t=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(t),this.update()}catch(Yy){throw window.cancelAnimationFrame(this._requestId),Yy}};t()}stop(){this._running=!1}}class Ar extends Pr{constructor(t){super({...t}),this._logger=nt.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=t.defaultUpdateMs}now(){var t;return null!==(t=this._currentTime)&&void 0!==t?t:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(t){const e=null!=t?t:this._updateMs;this._running?(this.update(e),this._currentTime+=e):this._logger.warn("The clock is not running, no step will be performed")}run(t,e){for(let i=0;i<t;i++)this.step(null!=e?e:this._updateMs)}}var kr=Gx(7379);class Rr{constructor(){this._toasterCss=kr.Z.toString(),this._isInitialized=!1}_initialize(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}dispose(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}_createFragment(t){const e=document.createElement("span");return e.innerText=t,e}toast(t,e,i){this._initialize();const s=document.createElement("div");s.className="ex-toast-message";const n=t.split("[LINK]").map((t=>this._createFragment(t)));if(e){const t=document.createElement("a");t.href=e,t.innerText=i||e,n.splice(1,0,t)}const r=document.createElement("div");n.forEach((t=>{r.appendChild(t)})),s.appendChild(r);const o=document.createElement("button");o.innerText="x",o.addEventListener("click",(()=>{this._container.removeChild(s)})),s.appendChild(o);const a=t=>{if("Escape"===t.key)try{this._container.removeChild(s)}catch(_b){}document.removeEventListener("keydown",a)};document.addEventListener("keydown",a);const l=this._container.firstChild;this._container.insertBefore(s,l)}}class Ir{constructor(t){this.inputs=t,this._handlers=new Map}execute(){for(const[t,e]of this._handlers.entries()){const i=t(this.inputs);i&&e(i)}}on(t,e){this._handlers.set(t,e)}}_();const Dr={FallbackGraphicsContext:"fallbackgraphicscontext",Initialize:"initialize",Visible:"visible",Hidden:"hidden",Start:"start",Stop:"stop",PreUpdate:"preupdate",PostUpdate:"postupdate",PreFrame:"preframe",PostFrame:"postframe",PreDraw:"predraw",PostDraw:"postdraw"};var Mr,Fr;(Fr=Mr||(Mr={}))[Fr.None=0]="None",Fr[Fr.Canvas=1]="Canvas",Fr[Fr.All=2]="All";class Lr{get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(t){this.graphicsContext.snapToPixel=t}emit(t,e){this.events.emit(t,e)}on(t,e){return this.events.on(t,e)}once(t,e){return this.events.once(t,e)}off(t,e){this.events.off(t,e)}constructor(t){var e,i,s,n,r,o;this.events=new x,this.maxFps=Number.POSITIVE_INFINITY,this.scenes={},this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.enableCanvasTransparency=!0,this.onFatalException=t=>{nt.getInstance().fatal(t)},this._toaster=new Rr,this._timescale=1,this._isInitialized=!1,this._deferredGoTo=null,this._originalOptions={},this._performanceThresholdTriggered=!1,this._fpsSamples=[],this._loadingComplete=!1,this._isReady=!1,this._isReadyPromise=new Promise((t=>{this._isReadyResolve=t})),this.currentFrameElapsedMs=0,this.currentFrameLagMs=0,this._lagMs=0,this._screenShotRequests=[],t={...Lr._DEFAULT_ENGINE_OPTIONS,...t},this._originalOptions=t,v.freeze(),this.browser=new ur(window,document);const a=new Je;if(!t.suppressMinimumBrowserFeatureDetection&&!(this._compatible=a.test())){const e=document.createElement("div");if(e.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(e),a.failedTests.forEach((function(t){const e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){const e=document.getElementById(t.canvasElementId);e&&e.parentElement.removeChild(e)}return}this._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${oo})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=nt.getInstance(),this._logger.defaultLevel===c.Debug&&a.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=t.canvasElementId,t.canvasElementId?(this._logger.debug("Using Canvas element specified: "+t.canvasElementId),this.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(this._logger.debug("Using Canvas element specified:",t.canvasElement),this.canvas=t.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let l=null!==(e=t.displayMode)&&void 0!==e?e:Te.Fixed;t.width&&t.height||t.viewport?(void 0===t.displayMode&&(l=Te.Fixed),this._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(this._logger.debug("Engine viewport is fit"),l=Te.FitScreen),this._originalDisplayMode=l;let h=v.isEnabled("use-canvas-context");if(!h)try{this.graphicsContext=new Ce({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})}catch(Yy){this._logger.warn(`Excalibur could not load webgl for some reason (${Yy.message}) and loaded a Canvas 2D fallback. Some features of Excalibur will not work in this mode. \n\nRead more about this issue at https://excaliburjs.com/docs/webgl`),h=!0}h&&(this.graphicsContext=new Pe({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),this.screen=new Re({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(i=t.antialiasing)||void 0===i||i,browser:this.browser,viewport:null!==(s=t.viewport)&&void 0!==s?s:t.width&&t.height?{width:t.width,height:t.height}:ke.SVGA,resolution:t.resolution,displayMode:l,pixelRatio:t.suppressHiDPIScaling?1:null!==(n=t.pixelRatio)&&void 0!==n?n:null}),Yt.filtering=t.antialiasing?Xt.Blended:Xt.Pixel,t.backgroundColor&&(this.backgroundColor=t.backgroundColor.clone()),this.maxFps=null!==(r=t.maxFps)&&void 0!==r?r:this.maxFps,this.fixedUpdateFps=null!==(o=t.fixedUpdateFps)&&void 0!==o?o:this.fixedUpdateFps,this.clock=new Tr({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:t=>this.onFatalException(t)}),this.enableCanvasTransparency=t.enableCanvasTransparency,this._loader=new Ze,this._loader.wireEngine(this),this.debug=new ar(this),this._initialize(t),this.rootScene=this.currentScene=new er,this.addScene("root",this.rootScene),window.___EXCALIBUR_DEVTOOL=this}_monitorPerformanceThresholdAndTriggerFallback(){const{allow:t}=this._originalOptions.configurePerformanceCanvas2DFallback;let{threshold:e,showPlayerMessage:i}=this._originalOptions.configurePerformanceCanvas2DFallback;if(void 0===e&&(e=Lr._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),void 0===i&&(i=Lr._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!v.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===e.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);let t=0;for(let e=0;e<this._fpsSamples.length;e++)t+=this._fpsSamples[e];const s=t/this._fpsSamples.length;this._fpsSamples.length===e.numberOfFrames&&s<=e.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn('Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\nthis might mean your browser doesn\'t have webgl enabled or hardware acceleration is unavailable.\n\nIf in Chrome:\n  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.\n  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"\nIf in Firefox, visit about:config\n  * Ensure webgl.disabled = false\n  * Ensure webgl.force-enabled = true\n  * Ensure layers.acceleration.force-enabled = true\n\nRead more about this issue at https://excaliburjs.com/docs/performance'),i&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}useCanvas2DFallback(){var t,e,i;const s=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(s,this.canvas),this.canvas=s;const n=this._originalOptions,r=this._originalDisplayMode;this.graphicsContext=new Pe({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:n.antialiasing,backgroundColor:n.backgroundColor,snapToPixel:n.snapToPixel,useDrawSorting:n.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new Re({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(t=n.antialiasing)||void 0===t||t,browser:this.browser,viewport:null!==(e=n.viewport)&&void 0!==e?e:n.width&&n.height?{width:n.width,height:n.height}:ke.SVGA,resolution:n.resolution,displayMode:r,pixelRatio:n.suppressHiDPIScaling?1:null!==(i=n.pixelRatio)&&void 0!==i?i:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();const o=n&&n.pointerScope===f.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(o,this),this.input.pointers.init()}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(t){t<=0?nt.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}addTimer(t){return this.currentScene.addTimer(t)}removeTimer(t){return this.currentScene.removeTimer(t)}addScene(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}removeScene(t){if(t instanceof er)for(const e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"==typeof t&&delete this.scenes[t]}add(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}remove(t){t instanceof Qi&&this.currentScene.remove(t),t instanceof er&&this.removeScene(t),"string"==typeof t&&this.removeScene(t)}goToScene(t,e){if(this.isInitialized)if(this.scenes[t]){const i=this.currentScene,s=this.scenes[t];if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){const t={engine:this,previousScene:i,nextScene:s};this.currentScene._deactivate.apply(this.currentScene,[t,s]),this.currentScene.events.emit("deactivate",new Z(t,this.currentScene))}this.currentScene=s,this.screen.setCurrentCamera(s.camera),this.currentScene._initialize(this);const n={engine:this,previousScene:i,nextScene:s,data:e};this.currentScene._activate.apply(this.currentScene,[n,s]),this.currentScene.events.emit("activate",new Y(n,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}screenToWorldCoordinates(t){return this.screen.screenToWorldCoordinates(t)}worldToScreenCoordinates(t){return this.screen.worldToScreenCoordinates(t)}_initialize(t){var e,i,s,n;this.pageScrollPreventionMode=t.scrollPreventionMode;const r=t&&t.pointerScope===f.Document?document:this.canvas;this.input={keyboard:new ht,pointers:new Sr(r,this),gamepads:new it},this.input.keyboard.init({grabWindowFocus:null===(i=null===(e=this._originalOptions)||void 0===e?void 0:e.grabWindowFocus)||void 0===i||i}),this.input.pointers.init({grabWindowFocus:null===(n=null===(s=this._originalOptions)||void 0===s?void 0:s.grabWindowFocus)||void 0===n||n}),this.input.gamepads.init(),this.inputMapper=new Ir(this.input),this.browser.document.on("visibilitychange",(()=>{"hidden"===document.visibilityState?(this.events.emit("hidden",new U(this)),this._logger.debug("Window hidden")):"visible"===document.visibilityState&&(this.events.emit("visible",new N(this)),this._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}onInitialize(t){}setAntialiasing(t){this.screen.antialiasing=t}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}_overrideInitialize(t){if(!this.isInitialized)if(this.onInitialize(t),this.events.emit("initialize",new K(t,this)),this._isInitialized=!0,this._deferredGoTo){const t=this._deferredGoTo;this._deferredGoTo=null,this.goToScene(t)}else this.goToScene("root")}_update(t){if(!this.ready)return this._loader.update(this,t),this.input.keyboard.update(),this.input.gamepads.update(),void this.inputMapper.execute();this._preupdate(t),this.currentScene.update(this,t),this.graphicsContext.updatePostProcessors(t),this._postupdate(t),this.input.keyboard.update(),this.input.gamepads.update(),this.inputMapper.execute()}_preupdate(t){this.emit("preupdate",new I(this,t,this)),this.onPreUpdate(this,t)}onPreUpdate(t,e){}_postupdate(t){this.emit("postupdate",new D(this,t,this)),this.onPostUpdate(this,t)}onPostUpdate(t,e){}_draw(t){if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this._predraw(this.graphicsContext,t),!this._isReady)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(t,e){this.emit("predraw",new T(t,e,this)),this.onPreDraw(t,e)}onPreDraw(t,e){}_postdraw(t,e){this.emit("postdraw",new A(t,e,this)),this.onPostDraw(t,e)}onPostDraw(t,e){}showDebug(t){this._isDebug=t}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return this._loadingComplete}get ready(){return this._isReady}isReady(){return this._isReadyPromise}async start(t){if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");return t&&(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this._loader=t,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this)),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),t&&(await this.load(this._loader),this._loadingComplete=!0,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport()),this._loadingComplete=!0,this._overrideInitialize(this),this._isReady=!0,this._isReadyResolve(),this.emit("start",new E(this)),this._isReadyPromise}_mainloop(t){this.emit("preframe",new M(this,this.stats.prevFrame));const e=t*this.timescale;this.currentFrameElapsedMs=e;const i=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=i,this.stats.currFrame.delta=e,this.stats.currFrame.fps=this.clock.fpsSampler.fps,he.clear();const s=this.clock.now(),n=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=e;this._lagMs>=n;)this._update(n),this._lagMs-=n;else this._update(e);const r=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(e);const o=this.clock.now();this.stats.currFrame.duration.update=r-s,this.stats.currFrame.duration.draw=o-r,this.stats.currFrame.graphics.drawnImages=he.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=he.DrawCallCount,this.emit("postframe",new F(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()}stop(){this.clock.isRunning()&&(this.emit("stop",new P(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isRunning(){return this.clock.isRunning()}screenshot(t=!1){return new Promise((e=>{this._screenShotRequests.push({preserveHiDPIResolution:t,resolve:e})}))}_checkForScreenShots(){for(const t of this._screenShotRequests){const e=t.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,i=t.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,s=document.createElement("canvas");s.width=e,s.height=i;const n=s.getContext("2d");n.imageSmoothingEnabled=this.screen.antialiasing,n.drawImage(this.canvas,0,0,e,i);const r=new Image,o=s.toDataURL("image/png");r.src=o,t.resolve(r)}this._screenShotRequests.length=0}async load(t){try{await t.load()}catch(Yy){this._logger.error("Error loading resources, things may not behave properly",Yy),await Promise.resolve()}}}Lr._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!0,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:f.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,grabWindowFocus:!0,scrollPreventionMode:Mr.Canvas,backgroundColor:St.fromHex("#2185d0")};class Br{constructor(){this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}_processDeferredHandlerRemovals(){for(const t of this._deferedHandlerRemovals)this._removeHandler(t.name,t.handler);this._deferedHandlerRemovals.length=0}emit(t,e){if(this._processDeferredHandlerRemovals(),!t)return;let i,s;if(t=t.toLowerCase(),null==e&&(e=new w),this._handlers[t])for(i=0,s=this._handlers[t].length;i<s;i++)this._handlers[t][i](e);for(i=0,s=this._wiredEventDispatchers.length;i<s;i++)this._wiredEventDispatchers[i].emit(t,e)}on(t,e){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)}off(t,e){this._deferedHandlerRemovals.push({name:t,handler:e})}_removeHandler(t,e){t=t.toLowerCase();const i=this._handlers[t];if(i)if(e){const s=i.indexOf(e);s>-1&&this._handlers[t].splice(s,1)}else this._handlers[t].length=0}once(t,e){this._processDeferredHandlerRemovals();const i=s=>{const n=s||new w;this.off(t,i),e(n)};this.on(t,i)}wire(t){t._wiredEventDispatchers.push(this)}unwire(t){const e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}class Or extends js{get font(){return this._font}set font(t){this._font=t,this._text.font=t}get text(){return this._text.text}set text(t){this._text.text=t}get color(){return this._text.color}set color(t){this._text&&(this._text.color=t)}get opacity(){return this._text.opacity}set opacity(t){this._text.opacity=t}get spriteFont(){return this._spriteFont}set spriteFont(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}constructor(t){super(t),this._font=new Vs,this._text=new Hs({text:"",font:this._font});const{text:e,pos:i,x:s,y:n,spriteFont:r,font:o,color:a}=t;this.pos=null!=i?i:s&&n?Ct(s,n):this.pos,this.text=null!=e?e:this.text,this.font=null!=o?o:this.font,this.spriteFont=null!=r?r:this.spriteFont,this._text.color=null!=a?a:this.color;const l=this.get(is);l.anchor=bt.Zero,l.use(this._text)}_initialize(t){super._initialize(t)}getTextWidth(){return this._text.width}}class zr extends Qi{getGraphics(){return this._graphics}addGraphic(t){this._graphics.push(t),this._gfx.visible=!0,this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let t=this._tileBounds.clone();for(const e of this._graphics){const i=Ct(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:e.height-this.map.tileHeight));t=t.combine(e.localBounds.translate(i))}return t}removeGraphic(t){const e=this._graphics.indexOf(t);e>-1&&this._graphics.splice(e,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(t){this._colliders.push(t),this.map.flagCollidersDirty()}removeCollider(t){const e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(Ct(this.x,this.y))}get center(){return this.pos.add(Ct(0,this.map.tileHeight/2))}constructor(t,e,i,s){super([new bi,new is({offset:null!=i?i:bt.Zero,onPostDraw:(t,e)=>this.draw(t,e)}),new Yn(s)]),this.solid=!1,this._tileBounds=new Rt,this._graphics=[],this._colliders=[],this.x=t,this.y=e,this.map=s,this._transform=this.get(bi),this._isometricEntityComponent=this.get(Yn);const n=this.map.tileWidth/2,r=this.map.tileHeight/2,o=(this.x-this.y)*n,a=(this.x+this.y)*r;this._transform.pos=Ct(o,a),this._isometricEntityComponent.elevation=0,this._gfx=this.get(is),this._gfx.visible=!1;const l=this.map.tileWidth,h=this.map.tileHeight,c=Ct(0,this.map.renderFromTopOfGraphic?h:0);this._gfx.localBounds=this._tileBounds=new Rt({left:-l/2,top:-h,right:l/2,bottom:h}).translate(c)}draw(t,e){const i=this.map.tileWidth/2;t.save(),t.translate(-i,0);for(const s of this._graphics)s.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:s.height-this.map.tileHeight));t.restore()}}class Nr extends Qi{constructor(t){super([new bi,new Gi({type:ti.Fixed}),new ji,new Xs((t=>this.debug(t)),!1)],t.name),this.renderFromTopOfGraphic=!1,this.graphicsOffset=Ct(0,0),this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:e,tileWidth:i,tileHeight:s,columns:n,rows:r,renderFromTopOfGraphic:o,graphicsOffset:a}=t;this.transform=this.get(bi),e&&(this.transform.pos=e),this.collider=this.get(ji),this.collider&&this.collider.set(this._composite=new Di([])),this.renderFromTopOfGraphic=null!=o?o:this.renderFromTopOfGraphic,this.graphicsOffset=null!=a?a:this.graphicsOffset,this.tileWidth=i,this.tileHeight=s,this.columns=n,this.rows=r,this.tiles=new Array(n*r);for(let l=0;l<r;l++)for(let t=0;t<n;t++){const e=new zr(t,l,this.graphicsOffset,this);this.tiles[t+l*n]=e,this.addChild(e)}}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);{const e=t.offset;return this._originalOffsets.set(t,e),e}}updateColliders(){this._composite.clearColliders();const t=this.get(bi).pos;for(const e of this.tiles)if(e.solid)for(const i of e.getColliders()){const s=this._getOrSetColliderOriginalOffset(i);i.offset=this.tileToWorld(Ct(e.x,e.y)).sub(t).add(s).sub(Ct(this.tileWidth/2,this.tileHeight)),i.owner=this,this._composite.addCollider(i)}this.collider.update()}worldToTile(t){t=t.sub(this.transform.globalPos);const e=this.tileWidth/2,i=this.tileHeight/2;return Ct(~~((t.x/e+t.y/i)/2),~~((t.y/i-t.x/e)/2))}tileToWorld(t){const e=this.tileWidth/2,i=this.tileHeight/2;return Ct((t.x-t.y)*e,(t.x+t.y)*i).add(this.transform.pos)}getTile(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}getTileByPoint(t){const e=this.worldToTile(t);return this.getTile(e.x,e.y)}_getMaxZIndex(){let t=Number.NEGATIVE_INFINITY;for(const e of this.tiles){const i=e.get(bi).z;i>t&&(t=i)}return t}debug(t){t.save(),t.z=this._getMaxZIndex()+.5;for(let e=0;e<this.rows+1;e++){const i=this.tileToWorld(Ct(0,e)),s=this.tileToWorld(Ct(this.columns,e));t.drawLine(i,s,St.Red,2)}for(let e=0;e<this.columns+1;e++){const i=this.tileToWorld(Ct(e,0)),s=this.tileToWorld(Ct(e,this.rows));t.drawLine(i,s,St.Red,2)}for(const e of this.tiles)t.drawCircle(this.tileToWorld(Ct(e.x,e.y)),3,St.Yellow);t.restore()}}class Ur{constructor(t,e){this._stopped=!1,this._sequenceBuilder=e,this._sequenceContext=new Os(t),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}update(t){this._actionQueue.update(t)}isComplete(){return this._stopped||this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._stopped=!1,this._actionQueue.reset()}clone(t){return new Ur(t,this._sequenceBuilder)}}class Vr{constructor(t){this._actions=t}update(t){for(let e=0;e<this._actions.length;e++)this._actions[e].update(t)}isComplete(t){return this._actions.every((e=>e.isComplete(t)))}reset(){this._actions.forEach((t=>t.reset()))}stop(){this._actions.forEach((t=>t.stop()))}}class Hr{static create(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(t))throw new Error(`Collision group ${t} already exists`);const i=new Si(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,i),i}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(t){return this._GROUPS.get(t)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}function jr(t){return!!t._initialize}function Wr(t){return!!t.onInitialize}function $r(t){return!!t._preupdate}function Gr(t){return!!t.onPreUpdate}function qr(t){return!!t.onPostUpdate}function Xr(t){return!!t.onPostUpdate}function Kr(t){return!!t.onPreDraw}function Yr(t){return!!t.onPostDraw}Hr._STARTING_BIT=1,Hr._MAX_GROUPS=32,Hr._CURRENT_GROUP=1,Hr._CURRENT_BIT=Hr._STARTING_BIT,Hr._GROUPS=new Map;class Zr{constructor(t,e=St.Magenta,i=!1){this.path=t,this.color=e,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new jt(t,"arraybuffer",i),this._transparentColor=e}get bustCache(){return this._resource.bustCache}set bustCache(t){this._resource.bustCache=t}async load(){const t=await this._resource.load();this._stream=new to(t),this._gif=new eo(this._stream,this._transparentColor);const e=this._gif.images.map((t=>new Zt(t.src,!1)));return await Promise.all(e.map((t=>t.load()))),this.data=this._textures=e}isLoaded(){return!!this.data}toSprite(t=0){return this._textures[t].toSprite()}toSpriteSheet(){const t=this._textures.map((t=>t.toSprite()));return new Qt({sprites:t})}toAnimation(t){const e=this.toSpriteSheet(),i=e.sprites.length;return this._animation=Bn.fromSpriteSheet(e,yt(0,i),t),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const Qr=t=>t.reduce((function(t,e){return 2*t+e}),0),Jr=t=>{const e=[];for(let i=7;i>=0;i--)e.push(!!(t&1<<i));return e};class to{constructor(t){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=t=>{const e=[];for(let i=0;i<t;i++)e.push(this.readByte());return e},this.read=t=>{let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},this.readUnsigned=()=>{const t=this.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(t),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")}}class eo{constructor(t,e=St.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=t=>{const e=[];for(let i=0;i<t;i++){const t="#"+this._st.readBytes(3).map((t=>{const e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(t)}return e},this.readSubBlocks=()=>{let t,e;e="";do{t=this._st.readByte(),e+=this._st.read(t)}while(0!==t);return e},this.parseHeader=()=>{const t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=this._st.read(3),t.ver=this._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=Jr(this._st.readByte());t.gctFlag=e.shift(),t.colorRes=Qr(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=Qr(e.splice(0,3)),t.bgColor=this._st.readByte(),t.pixelAspectRatio=this._st.readByte(),t.gctFlag&&(t.globalColorTable=this.parseColorTable(1<<t.globalColorTableSize+1),this.globalColorTable=t.globalColorTable),this._handler.hdr&&this._handler.hdr(t)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=t=>{const e=t=>{this.checkBytes.push(this._st.readByte());const e=Jr(this._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=Qr(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=this._st.readUnsigned(),t.transparencyIndex=this._st.readByte(),t.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(t)&&this.checkBytes.push(this._handler.gce)},i=t=>{t.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(t)&&this.checkBytes.push(this._handler.com)},s=t=>{this.checkBytes.push(this._st.readByte()),t.ptHeader=this._st.readBytes(12),t.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(t)&&this.checkBytes.push(this._handler.pte)},n=t=>{const e=t=>{this.checkBytes.push(this._st.readByte()),t.unknown=this._st.readByte(),t.iterations=this._st.readUnsigned(),t.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(t)&&this.checkBytes.push(this._handler.app)},i=t=>{t.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[t.identifier]&&this._handler.app[t.identifier](t)&&this.checkBytes.push(this._handler.app[t.identifier])};if(this.checkBytes.push(this._st.readByte()),t.identifier=this._st.read(8),t.authCode=this._st.read(3),"NETSCAPE"===t.identifier)e(t);else i(t)},r=t=>{t.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(t)&&this.checkBytes.push(this._handler.unknown)};switch(t.label=this._st.readByte(),t.label){case 249:t.extType="gce",e(t);break;case 254:t.extType="com",i(t);break;case 1:t.extType="pte",s(t);break;case 255:t.extType="app",n(t);break;default:t.extType="unknown",r(t)}},this.parseImg=t=>{t.leftPos=this._st.readUnsigned(),t.topPos=this._st.readUnsigned(),t.width=this._st.readUnsigned(),t.height=this._st.readUnsigned();const e=Jr(this._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=Qr(e.splice(0,3)),t.lctFlag&&(t.lct=this.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=this._st.readByte();const i=this.readSubBlocks();t.pixels=function(t,e){let i=0;const s=function(t){let s=0;for(let n=0;n<t;n++)e.charCodeAt(i>>3)&1<<(7&i)&&(s|=1<<n),i++;return s},n=[],r=1<<t,o=r+1;let a=t+1,l=[];const h=function(){l=[],a=t+1;for(let t=0;t<r;t++)l[t]=[t];l[r]=[],l[o]=null};let c,u;for(;;)if(u=c,c=s(a),c!==r){if(c===o)break;if(c<l.length)u!==r&&l.push(l[u].concat(l[c][0]));else{if(c!==l.length)throw new Error("Invalid LZW code.");l.push(l[u].concat(l[u][0]))}n.push.apply(n,l[c]),l.length===1<<a&&a<12&&a++}else h();return n}(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=((t,e)=>{const i=new Array(t.length),s=t.length/e,n=(s,n)=>{const r=t.slice(n*e,(n+1)*e);i.splice.apply(i,[s*e,e].concat(r))},r=[0,4,2,1],o=[8,8,4,2];let a=0;for(let l=0;l<4;l++)for(let t=r[l];t<s;t+=o[l])n(t,a),a++;return i})(t.pixels,t.width)),this.frames.push(t),this.arrayToImage(t),this._handler.img&&this._handler.img(t)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const t={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",this.parseExt(t);break;case",":t.type="img",this.parseImg(t);break;case";":t.type="eof",this._handler.eof&&this._handler.eof(t)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&this.parseBlock()},this.arrayToImage=t=>{let e=0;const i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;const s=i.getContext("2d");let n=0,r=0;for(let a=0;a<t.pixels.length;a++)r%t.width==0&&(n++,r=0),this.globalColorTable[t.pixels[a]]===this._transparentColor.toHex()?s.fillStyle="rgba(0, 0, 0, 0)":s.fillStyle=this.globalColorTable[t.pixels[a]],s.fillRect(r,n,1,1),r++;const o=new Image;o.src=i.toDataURL(),this.images.push(o)},this._st=t,this._handler={},this._transparentColor=e,this.parseHeader(),this.parseBlock()}}class io extends Gt{constructor(t){super(),this.color=St.Black,this.thickness=1;const{start:e,end:i,color:s,thickness:n}=t;this.start=e,this.end=i,this.color=null!=s?s:this.color,this.thickness=null!=n?n:this.thickness;const{width:r,height:o}=Rt.fromPoints([e,i]);this.width=r,this.height=o}_drawImage(t,e,i){t.drawLine(this.start,this.end,this.color,this.thickness)}clone(){return new io({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}class so extends Ne{get points(){return this._points}set points(t){this._points=t;const e=this.minPoint;this.width=this._points.reduce(((t,e)=>Math.max(e.x,t)),0)-e.x,this.height=this._points.reduce(((t,e)=>Math.max(e.y,t)),0)-e.y,this.flagDirty()}get minPoint(){return Ct(this._points.reduce(((t,e)=>Math.min(e.x,t)),1/0),this._points.reduce(((t,e)=>Math.min(e.y,t)),1/0))}constructor(t){super(t),this.points=t.points,this.filtering=Xt.Blended,this.rasterize()}clone(){return new so({points:this.points.map((t=>t.clone())),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(t){if(this.points&&this.points.length){t.beginPath();const e=this.minPoint.negate(),i=this.points[0].add(e);t.moveTo(i.x,i.y),this.points.forEach((i=>{t.lineTo(i.x+e.x,i.y+e.y)})),t.lineTo(i.x,i.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}class no{constructor(){this._queue=[]}get length(){return this._queue.length}enqueue(){const t=new It;return this._queue.push(t),t.promise}dequeue(t){this._queue.shift().resolve(t)}}class ro{constructor(t){this._count=t,this._waitQueue=new no}get count(){return this._count}get waiting(){return this._waitQueue.length}async enter(){return 0!==this._count?(this._count--,Promise.resolve()):this._waitQueue.enqueue()}exit(t=1){if(0!==t){for(;0!==t&&0!==this._waitQueue.length;)this._waitQueue.dequeue(null),t--;this._count+=t}}}const oo="0.28.0";_()})();var Xx=qx.vtX,Kx=qx.fwF,Yx=qx.RDh,Zx=qx.kBf,Qx=qx.v2G,Jx=qx.Ilk,tw=qx.d1Y,ew=qx.q8b,iw=qx.D4V,sw=qx.cXo,nw=qx.IIB,rw=qx.aNw,ow=qx.wIZ,aw=qx.bnF,lw=qx.MFA,hw=qx.jyi,cw=qx.OWs,uw=qx.Bhw;const dw={neneIdle:new sw("/2023/nene/assets/nene_idle-e442b347.png"),neneRun1:new sw("/2023/nene/assets/nene_running_1-941ed1a3.png"),neneRun2:new sw("/2023/nene/assets/nene_running_2-3639975d.png"),neneJump:new sw("/2023/nene/assets/nene_jump-adeb89e1.png")},pw={idleLeft:dw.neneIdle.toSprite(),idleRight:new hw({image:dw.neneIdle,flipHorizontal:!0}),runLeft:new Kx({frames:[{graphic:dw.neneRun1.toSprite(),duration:150},{graphic:dw.neneRun2.toSprite(),duration:150}]}),runRight:new Kx({frames:[{graphic:dw.neneRun1.toSprite(),duration:200},{graphic:dw.neneRun2.toSprite(),duration:200}],flipHorizontal:!0}),jumpLeft:dw.neneJump.toSprite(),jumpRight:new hw({image:dw.neneJump,flipHorizontal:!0})};for(const vb of Object.values(pw))vb.scale=new cw(.3,.3);const fw=new rw;fw.backgroundColor="transparent",fw.suppressPlayButton=!0;for(const vb of Object.values(dw))fw.addResource(vb);const gw=Hx(null),mw=Hx(null),_w=Hx(null),vw=Hx(0),yw=Hx([]),xw=Hx("intro"),ww=Hx((()=>{}));function bw(){yw.set(["intro","messages","art","cake"].map((t=>({section:t,left:document.getElementById(t).offsetLeft}))))}const Cw=t=>{return t[(e=0,i=t.length-1,Math.floor(Math.random()*(i-e+1)+e))];var e,i};function Sw(){const[t,e]=N.useState(0),[i,s]=N.useState(999),n=jx(gw),r=t>=i,o=()=>e((t=>t+1));return N.useEffect((()=>{const t=setTimeout((()=>{const t=document.querySelectorAll("img");s(t.length),t.forEach((t=>{t.onload=o,t.complete&&o()}))}),1e3);return()=>{clearTimeout(t);document.querySelectorAll("img").forEach((t=>{t.removeEventListener("load",o)}))}}),[]),N.useEffect((()=>{r&&n&&(null==n||n.start(fw),bw())}),[t,n,r,i]),r?K.jsx(K.Fragment,{}):K.jsxs("div",{className:"fixed inset-0 z-50 bg-other flex flex-col justify-center items-center",children:[K.jsx("img",{src:"/logo.png",alt:"",className:"w-full max-w-[40%] mb-20"}),K.jsxs("h2",{className:"text-5xl text-white",children:[t,"/",i," resources loaded"]})]})}const Ew=N.lazy((()=>function(t,e,i){if(!e||0===e.length)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map((t=>{if((t=function(t){return"/2023/nene/"+t}(t))in dd)return;dd[t]=!0;const e=t.endsWith(".css"),n=e?'[rel="stylesheet"]':"";if(i)for(let i=s.length-1;i>=0;i--){const n=s[i];if(n.href===t&&(!e||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${t}"]${n}`))return;const r=document.createElement("link");return r.rel=e?"stylesheet":"modulepreload",e||(r.as="script",r.crossOrigin=""),r.href=t,document.head.appendChild(r),e?new Promise(((e,i)=>{r.addEventListener("load",e),r.addEventListener("error",(()=>i(new Error(`Unable to preload CSS for ${t}`))))})):void 0}))).then((()=>t()))}((()=>import("./index-f9a86fda.js")),["assets/index-f9a86fda.js","assets/index-6cee73fd.css"])));function Pw(){const{i18n:t}=Ux(),e=Gu();return N.useEffect((()=>{const e=localStorage.getItem("opt_lang");e&&t.changeLanguage(e.toLowerCase())}),[]),K.jsxs("div",{className:"h-full",children:[K.jsx(wy,{mode:"wait",children:K.jsx(od,{location:e,children:K.jsx(nd,{path:"/",element:K.jsx(Tw,{Element:Ew})})},e.pathname)}),K.jsx(Sw,{}),K.jsx(Sx,{})]})}function Tw({Element:t}){return K.jsx(fy.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut",duration:.5},className:"h-full",children:K.jsx(N.Suspense,{fallback:K.jsxs(K.Fragment,{children:[K.jsxs(fy.div,{className:"fixed inset-0 bg-paper flex justify-center items-center",children:[K.jsxs("svg",{"aria-hidden":"true",className:"w-24 h-24 text-white animate-spin fill-sky-400",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[K.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),K.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),K.jsx("span",{className:"sr-only",children:"Loading..."})]}),K.jsx("div",{className:"h-screen"})]}),children:K.jsx(t,{})})})}function Aw(){return K.jsx("div",{className:"-translate-x-full -translate-y-full translate-x-full sr-only"})}const kw={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};class Rw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||kw,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,i,s){return s&&!this.debug?null:("string"==typeof t[0]&&(t[0]=`${i}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new Rw(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new Rw(this.logger,t)}}var Iw=new Rw;class Dw{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach((t=>{this.observers[t]=this.observers[t]||[],this.observers[t].push(e)})),this}off(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((t=>t!==e)):delete this.observers[t])}emit(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];if(this.observers[t]){[].concat(this.observers[t]).forEach((t=>{t(...i)}))}if(this.observers["*"]){[].concat(this.observers["*"]).forEach((e=>{e.apply(e,[t,...i])}))}}}function Mw(){let t,e;const i=new Promise(((i,s)=>{t=i,e=s}));return i.resolve=t,i.reject=e,i}function Fw(t){return null==t?"":""+t}function Lw(t,e,i){function s(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function n(){return!t||"string"==typeof t}const r="string"!=typeof e?[].concat(e):e.split(".");for(;r.length>1;){if(n())return{};const e=s(r.shift());!t[e]&&i&&(t[e]=new i),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{}}return n()?{}:{obj:t,k:s(r.shift())}}function Bw(t,e,i){const{obj:s,k:n}=Lw(t,e,Object);s[n]=i}function Ow(t,e){const{obj:i,k:s}=Lw(t,e);if(i)return i[s]}function zw(t,e,i){for(const s in e)"__proto__"!==s&&"constructor"!==s&&(s in t?"string"==typeof t[s]||t[s]instanceof String||"string"==typeof e[s]||e[s]instanceof String?i&&(t[s]=e[s]):zw(t[s],e[s],i):t[s]=e[s]);return t}function Nw(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Uw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Vw(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(t=>Uw[t])):t}const Hw=[" ",",","?","!",";"];function jw(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e])return t[e];const s=e.split(i);let n=t;for(let r=0;r<s.length;++r){if(!n)return;if("string"==typeof n[s[r]]&&r+1<s.length)return;if(void 0===n[s[r]]){let t=2,o=s.slice(r,r+t).join(i),a=n[o];for(;void 0===a&&s.length>r+t;)t++,o=s.slice(r,r+t).join(i),a=n[o];if(void 0===a)return;if(null===a)return null;if(e.endsWith(o)){if("string"==typeof a)return a;if(o&&"string"==typeof a[o])return a[o]}const l=s.slice(r+t).join(i);return l?jw(a,l,i):void 0}n=n[s[r]]}return n}function Ww(t){return t&&t.indexOf("_")>0?t.replace("_","-"):t}class $w extends Dw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=void 0!==s.keySeparator?s.keySeparator:this.options.keySeparator,r=void 0!==s.ignoreJSONStructure?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o=[t,e];i&&"string"!=typeof i&&(o=o.concat(i)),i&&"string"==typeof i&&(o=o.concat(n?i.split(n):i)),t.indexOf(".")>-1&&(o=t.split("."));const a=Ow(this.data,o);return a||!r||"string"!=typeof i?a:jw(this.data&&this.data[t]&&this.data[t][e],i,n)}addResource(t,e,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const r=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator;let o=[t,e];i&&(o=o.concat(r?i.split(r):i)),t.indexOf(".")>-1&&(o=t.split("."),s=e,e=o[1]),this.addNamespaces(e),Bw(this.data,o,s),n.silent||this.emit("added",t,e,i,s)}addResources(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const n in i)"string"!=typeof i[n]&&"[object Array]"!==Object.prototype.toString.apply(i[n])||this.addResource(t,e,n,i[n],{silent:!0});s.silent||this.emit("added",t,e,i)}addResourceBundle(t,e,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},o=[t,e];t.indexOf(".")>-1&&(o=t.split("."),s=i,i=e,e=o[1]),this.addNamespaces(e);let a=Ow(this.data,o)||{};s?zw(a,i,n):a={...a,...i},Bw(this.data,o,a),r.silent||this.emit("added",t,e,i)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?{...this.getResource(t,e)}:this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find((t=>e[t]&&Object.keys(e[t]).length>0))}toJSON(){return this.data}}var Gw={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,i,s,n){return t.forEach((t=>{this.processors[t]&&(e=this.processors[t].process(e,i,s,n))})),e}};const qw={};class Xw extends Dw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),function(t,e,i){t.forEach((t=>{e[t]&&(i[t]=e[t])}))}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=Iw.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;const i=this.resolve(t,e);return i&&void 0!==i.res}extractFromKey(t,e){let i=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");const s=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator;let n=e.ns||this.options.defaultNS||[];const r=i&&t.indexOf(i)>-1,o=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||function(t,e,i){e=e||"",i=i||"";const s=Hw.filter((t=>e.indexOf(t)<0&&i.indexOf(t)<0));if(0===s.length)return!0;const n=new RegExp(`(${s.map((t=>"?"===t?"\\?":t)).join("|")})`);let r=!n.test(t);if(!r){const e=t.indexOf(i);e>0&&!n.test(t.substring(0,e))&&(r=!0)}return r}(t,i,s));if(r&&!o){const e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:n};const r=t.split(i);(i!==s||i===s&&this.options.ns.indexOf(r[0])>-1)&&(n=r.shift()),t=r.join(s)}return"string"==typeof n&&(n=[n]),{key:t,namespaces:n}}translate(t,e,i){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);const s=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,n=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:r,namespaces:o}=this.extractFromKey(t[t.length-1],e),a=o[o.length-1],l=e.lng||this.language,h=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(h){const t=e.nsSeparator||this.options.nsSeparator;return s?{res:`${a}${t}${r}`,usedKey:r,exactUsedKey:r,usedLng:l,usedNS:a}:`${a}${t}${r}`}return s?{res:r,usedKey:r,exactUsedKey:r,usedLng:l,usedNS:a}:r}const c=this.resolve(t,e);let u=c&&c.res;const d=c&&c.usedKey||r,p=c&&c.exactUsedKey||r,f=Object.prototype.toString.apply(u),g=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject;if(m&&u&&("string"!=typeof u&&"boolean"!=typeof u&&"number"!=typeof u)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(f)<0&&("string"!=typeof g||"[object Array]"!==f)){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,u,{...e,ns:o}):`key '${r} (${this.language})' returned an object instead of string.`;return s?(c.res=t,c):t}if(n){const t="[object Array]"===f,i=t?[]:{},s=t?p:d;for(const r in u)if(Object.prototype.hasOwnProperty.call(u,r)){const t=`${s}${n}${r}`;i[r]=this.translate(t,{...e,joinArrays:!1,ns:o}),i[r]===t&&(i[r]=u[r])}u=i}}else if(m&&"string"==typeof g&&"[object Array]"===f)u=u.join(g),u&&(u=this.extendTranslation(u,t,e,i));else{let s=!1,o=!1;const h=void 0!==e.count&&"string"!=typeof e.count,d=Xw.hasDefaultValue(e),p=h?this.pluralResolver.getSuffix(l,e.count,e):"",f=e.ordinal&&h?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",g=e[`defaultValue${p}`]||e[`defaultValue${f}`]||e.defaultValue;!this.isValidLookup(u)&&d&&(s=!0,u=g),this.isValidLookup(u)||(o=!0,u=r);const m=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:u,_=d&&g!==u&&this.options.updateMissing;if(o||s||_){if(this.logger.log(_?"updateKey":"missingKey",l,a,r,_?g:u),n){const t=this.resolve(r,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[];const i=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&i&&i[0])for(let e=0;e<i.length;e++)t.push(i[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);const s=(t,i,s)=>{const n=d&&s!==u?s:m;this.options.missingKeyHandler?this.options.missingKeyHandler(t,a,i,n,_,e):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(t,a,i,n,_,e),this.emit("missingKey",t,a,i,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?t.forEach((t=>{this.pluralResolver.getSuffixes(t,e).forEach((i=>{s([t],r+i,e[`defaultValue${i}`]||g)}))})):s(t,r,g))}u=this.extendTranslation(u,t,e,c,i),o&&u===r&&this.options.appendNamespaceToMissingKey&&(u=`${a}:${r}`),(o||s)&&this.options.parseMissingKeyHandler&&(u="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${a}:${r}`:r,s?u:void 0):this.options.parseMissingKeyHandler(u))}return s?(c.res=u,c):u}extendTranslation(t,e,i,s,n){var r=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...i},s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const o="string"==typeof t&&(i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let a;if(o){const e=t.match(this.interpolator.nestingRegexp);a=e&&e.length}let l=i.replace&&"string"!=typeof i.replace?i.replace:i;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,i.lng||this.language,i),o){const e=t.match(this.interpolator.nestingRegexp);a<(e&&e.length)&&(i.nest=!1)}!i.lng&&"v1"!==this.options.compatibilityAPI&&s&&s.res&&(i.lng=s.usedLng),!1!==i.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return n&&n[0]===s[0]&&!i.context?(r.logger.warn(`It seems you are nesting recursively key: ${s[0]} in key: ${e[0]}`),null):r.translate(...s,e)}),i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,a="string"==typeof o?[o]:o;return null!=t&&a&&a.length&&!1!==i.applyPostProcessor&&(t=Gw.handle(a,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:s,...i}:i,this)),t}resolve(t){let e,i,s,n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((t=>{if(this.isValidLookup(e))return;const a=this.extractFromKey(t,o),l=a.key;i=l;let h=a.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const c=void 0!==o.count&&"string"!=typeof o.count,u=c&&!o.ordinal&&0===o.count&&this.pluralResolver.shouldUseIntlApi(),d=void 0!==o.context&&("string"==typeof o.context||"number"==typeof o.context)&&""!==o.context,p=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);h.forEach((t=>{this.isValidLookup(e)||(r=t,!qw[`${p[0]}-${t}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(r)&&(qw[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${i}" for languages "${p.join(", ")}" won't get resolved as namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((i=>{if(this.isValidLookup(e))return;n=i;const r=[l];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(r,l,i,t,o);else{let t;c&&(t=this.pluralResolver.getSuffix(i,o.count,o));const e=`${this.options.pluralSeparator}zero`,s=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(r.push(l+t),o.ordinal&&0===t.indexOf(s)&&r.push(l+t.replace(s,this.options.pluralSeparator)),u&&r.push(l+e)),d){const i=`${l}${this.options.contextSeparator}${o.context}`;r.push(i),c&&(r.push(i+t),o.ordinal&&0===t.indexOf(s)&&r.push(i+t.replace(s,this.options.pluralSeparator)),u&&r.push(i+e))}}let a;for(;a=r.pop();)this.isValidLookup(e)||(s=a,e=this.getResource(i,t,a,o))})))}))})),{res:e,usedKey:i,exactUsedKey:s,usedLng:n,usedNS:r}}isValidLookup(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}getResource(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,i,s):this.resourceStore.getResource(t,e,i,s)}static hasDefaultValue(t){const e="defaultValue";for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e===i.substring(0,12)&&void 0!==t[i])return!0;return!1}}function Kw(t){return t.charAt(0).toUpperCase()+t.slice(1)}class Yw{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Iw.create("languageUtils")}getScriptPartFromCode(t){if(!(t=Ww(t))||t.indexOf("-")<0)return null;const e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}getLanguagePartFromCode(t){if(!(t=Ww(t))||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if("string"==typeof t&&t.indexOf("-")>-1){const e=["hans","hant","latn","cyrl","cans","mong","arab"];let i=t.split("-");return this.options.lowerCaseLng?i=i.map((t=>t.toLowerCase())):2===i.length?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=Kw(i[1].toLowerCase()))):3===i.length&&(i[0]=i[0].toLowerCase(),2===i[1].length&&(i[1]=i[1].toUpperCase()),"sgn"!==i[0]&&2===i[2].length&&(i[2]=i[2].toUpperCase()),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=Kw(i[1].toLowerCase())),e.indexOf(i[2].toLowerCase())>-1&&(i[2]=Kw(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach((t=>{if(e)return;const i=this.formatLanguageCode(t);this.options.supportedLngs&&!this.isSupportedCode(i)||(e=i)})),!e&&this.options.supportedLngs&&t.forEach((t=>{if(e)return;const i=this.getLanguagePartFromCode(t);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find((t=>t===i?t:t.indexOf("-")<0&&i.indexOf("-")<0?void 0:0===t.indexOf(i)?t:void 0))})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];let i=t[e];return i||(i=t[this.getScriptPartFromCode(e)]),i||(i=t[this.formatLanguageCode(e)]),i||(i=t[this.getLanguagePartFromCode(e)]),i||(i=t.default),i||[]}toResolveHierarchy(t,e){const i=this.getFallbackCodes(e||this.options.fallbackLng||[],t),s=[],n=t=>{t&&(this.isSupportedCode(t)?s.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return"string"==typeof t&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(t))):"string"==typeof t&&n(this.formatLanguageCode(t)),i.forEach((t=>{s.indexOf(t)<0&&n(this.formatLanguageCode(t))})),s}}let Zw=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Qw={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}};const Jw=["v1","v2","v3"],tb=["v4"],eb={zero:0,one:1,two:2,few:3,many:4,other:5};class ib{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=Iw.create("pluralResolver"),this.options.compatibilityJSON&&!tb.includes(this.options.compatibilityJSON)||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=function(){const t={};return Zw.forEach((e=>{e.lngs.forEach((i=>{t[i]={numbers:e.nr,plurals:Qw[e.fc]}}))})),t}()}addRule(t,e){this.rules[t]=e}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Ww(t),{type:e.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this.getRule(t,e);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,i).map((t=>`${e}${t}`))}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this.getRule(t,e);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort(((t,e)=>eb[t]-eb[e])).map((t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`)):i.numbers.map((i=>this.getSuffix(t,i,e))):[]}getSuffix(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=this.getRule(t,i);return s?this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${s.select(e)}`:this.getSuffixRetroCompatible(s,e):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,e){const i=t.noAbs?t.plurals(e):t.plurals(Math.abs(e));let s=t.numbers[i];this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]&&(2===s?s="plural":1===s&&(s=""));const n=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return"v1"===this.options.compatibilityJSON?1===s?"":"number"==typeof s?`_plural_${s.toString()}`:n():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]?n():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!Jw.includes(this.options.compatibilityJSON)}}function sb(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=function(t,e,i){const s=Ow(t,i);return void 0!==s?s:Ow(e,i)}(t,e,i);return!r&&n&&"string"==typeof i&&(r=jw(t,i,s),void 0===r&&(r=jw(e,i,s))),r}class nb{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Iw.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(t=>t),this.init(t)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const e=t.interpolation;this.escape=void 0!==e.escape?e.escape:Vw,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?Nw(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?Nw(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?Nw(e.nestingPrefix):e.nestingPrefixEscaped||Nw("$t("),this.nestingSuffix=e.nestingSuffix?Nw(e.nestingSuffix):e.nestingSuffixEscaped||Nw(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(t,"g");const e=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(e,"g");const i=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(i,"g")}interpolate(t,e,i,s){let n,r,o;const a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(t){return t.replace(/\$/g,"$$$$")}const h=t=>{if(t.indexOf(this.formatSeparator)<0){const n=sb(e,a,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,i,{...s,...e,interpolationkey:t}):n}const n=t.split(this.formatSeparator),r=n.shift().trim(),o=n.join(this.formatSeparator).trim();return this.format(sb(e,a,r,this.options.keySeparator,this.options.ignoreJSONStructure),o,i,{...s,...e,interpolationkey:r})};this.resetRegExp();const c=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,u=s&&s.interpolation&&void 0!==s.interpolation.skipOnVariables?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>l(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?l(this.escape(t)):l(t)}].forEach((e=>{for(o=0;n=e.regex.exec(t);){const i=n[1].trim();if(r=h(i),void 0===r)if("function"==typeof c){const e=c(t,n,s);r="string"==typeof e?e:""}else if(s&&Object.prototype.hasOwnProperty.call(s,i))r="";else{if(u){r=n[0];continue}this.logger.warn(`missed to pass in variable ${i} for interpolating ${t}`),r=""}else"string"==typeof r||this.useRawValueToEscape||(r=Fw(r));const a=e.safeValue(r);if(t=t.replace(n[0],a),u?(e.regex.lastIndex+=r.length,e.regex.lastIndex-=n[0].length):e.regex.lastIndex=0,o++,o>=this.maxReplaces)break}})),t}nest(t,e){let i,s,n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function o(t,e){const i=this.nestingOptionsSeparator;if(t.indexOf(i)<0)return t;const s=t.split(new RegExp(`${i}[ ]*{`));let r=`{${s[1]}`;t=s[0],r=this.interpolate(r,n);const o=r.match(/'/g),a=r.match(/"/g);(o&&o.length%2==0&&!a||a.length%2!=0)&&(r=r.replace(/'/g,'"'));try{n=JSON.parse(r),e&&(n={...e,...n})}catch(Yy){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,Yy),`${t}${i}${r}`}return delete n.defaultValue,t}for(;i=this.nestingRegexp.exec(t);){let a=[];n={...r},n=n.replace&&"string"!=typeof n.replace?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let l=!1;if(-1!==i[0].indexOf(this.formatSeparator)&&!/{.*}/.test(i[1])){const t=i[1].split(this.formatSeparator).map((t=>t.trim()));i[1]=t.shift(),a=t,l=!0}if(s=e(o.call(this,i[1].trim(),n),n),s&&i[0]===t&&"string"!=typeof s)return s;"string"!=typeof s&&(s=Fw(s)),s||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),s=""),l&&(s=a.reduce(((t,e)=>this.format(t,e,r.lng,{...r,interpolationkey:i[1].trim()})),s.trim())),t=t.replace(i[0],s),this.regexp.lastIndex=0}return t}}function rb(t){const e={};return function(i,s,n){const r=s+JSON.stringify(n);let o=e[r];return o||(o=t(s,n),e[r]=o),o(i)}}class ob{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Iw.create("formatter"),this.options=t,this.formats={number:rb(((t,e)=>{const i=new Intl.NumberFormat(t,{...e});return t=>i.format(t)})),currency:rb(((t,e)=>{const i=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>i.format(t)})),datetime:rb(((t,e)=>{const i=new Intl.DateTimeFormat(t,{...e});return t=>i.format(t)})),relativetime:rb(((t,e)=>{const i=new Intl.RelativeTimeFormat(t,{...e});return t=>i.format(t,e.range||"day")})),list:rb(((t,e)=>{const i=new Intl.ListFormat(t,{...e});return t=>i.format(t)}))},this.init(t)}init(t){const e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=rb(e)}format(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=e.split(this.formatSeparator).reduce(((t,e)=>{const{formatName:n,formatOptions:r}=function(t){let e=t.toLowerCase().trim();const i={};if(t.indexOf("(")>-1){const s=t.split("(");e=s[0].toLowerCase().trim();const n=s[1].substring(0,s[1].length-1);"currency"===e&&n.indexOf(":")<0?i.currency||(i.currency=n.trim()):"relativetime"===e&&n.indexOf(":")<0?i.range||(i.range=n.trim()):n.split(";").forEach((t=>{if(!t)return;const[e,...s]=t.split(":"),n=s.join(":").trim().replace(/^'+|'+$/g,"");i[e.trim()]||(i[e.trim()]=n),"false"===n&&(i[e.trim()]=!1),"true"===n&&(i[e.trim()]=!0),isNaN(n)||(i[e.trim()]=parseInt(n,10))}))}return{formatName:e,formatOptions:i}}(e);if(this.formats[n]){let e=t;try{const o=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},a=o.locale||o.lng||s.locale||s.lng||i;e=this.formats[n](t,a,{...r,...s,...o})}catch(o){this.logger.warn(o)}return e}return this.logger.warn(`there was no format function for ${n}`),t}),t);return n}}class ab extends Dw{constructor(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=i,this.languageUtils=i.languageUtils,this.options=s,this.logger=Iw.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,s.backend,s)}queueLoad(t,e,i,s){const n={},r={},o={},a={};return t.forEach((t=>{let s=!0;e.forEach((e=>{const o=`${t}|${e}`;!i.reload&&this.store.hasResourceBundle(t,e)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===r[o]&&(r[o]=!0):(this.state[o]=1,s=!1,void 0===r[o]&&(r[o]=!0),void 0===n[o]&&(n[o]=!0),void 0===a[e]&&(a[e]=!0)))})),s||(o[t]=!0)})),(Object.keys(n).length||Object.keys(r).length)&&this.queue.push({pending:r,pendingCount:Object.keys(r).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(n),pending:Object.keys(r),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(a)}}loaded(t,e,i){const s=t.split("|"),n=s[0],r=s[1];e&&this.emit("failedLoading",n,r,e),i&&this.store.addResourceBundle(n,r,i),this.state[t]=e?-1:2;const o={};this.queue.forEach((i=>{!function(t,e,i,s){const{obj:n,k:r}=Lw(t,e,Object);n[r]=n[r]||[],s&&(n[r]=n[r].concat(i)),s||n[r].push(i)}(i.loaded,[n],r),function(t,e){void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)}(i,t),e&&i.errors.push(e),0!==i.pendingCount||i.done||(Object.keys(i.loaded).forEach((t=>{o[t]||(o[t]={});const e=i.loaded[t];e.length&&e.forEach((e=>{void 0===o[t][e]&&(o[t][e]=!0)}))})),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((t=>!t.done))}read(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,r=arguments.length>5?arguments[5]:void 0;if(!t.length)return r(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:t,ns:e,fcName:i,tried:s,wait:n,callback:r});this.readingCalls++;const o=(o,a)=>{if(this.readingCalls--,this.waitingReads.length>0){const t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}o&&a&&s<this.maxRetries?setTimeout((()=>{this.read.call(this,t,e,i,s+1,2*n,r)}),n):r(o,a)},a=this.backend[i].bind(this.backend);if(2!==a.length)return a(t,e,o);try{const i=a(t,e);i&&"function"==typeof i.then?i.then((t=>o(null,t))).catch(o):o(null,i)}catch(l){o(l)}}prepareLoading(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);const n=this.queueLoad(t,e,i,s);if(!n.toLoad.length)return n.pending.length||s(),null;n.toLoad.forEach((t=>{this.loadOne(t)}))}load(t,e,i){this.prepareLoading(t,e,{},i)}reload(t,e,i){this.prepareLoading(t,e,{reload:!0},i)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=t.split("|"),s=i[0],n=i[1];this.read(s,n,"read",void 0,void 0,((i,r)=>{i&&this.logger.warn(`${e}loading namespace ${n} for language ${s} failed`,i),!i&&r&&this.logger.log(`${e}loaded namespace ${n} for language ${s}`,r),this.loaded(t,i,r)}))}saveMissing(t,e,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e))this.logger.warn(`did not save key "${i}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=i&&""!==i){if(this.backend&&this.backend.create){const l={...r,isUpdate:n},h=this.backend.create.bind(this.backend);if(h.length<6)try{let n;n=5===h.length?h(t,e,i,s,l):h(t,e,i,s),n&&"function"==typeof n.then?n.then((t=>o(null,t))).catch(o):o(null,n)}catch(a){o(a)}else h(t,e,i,s,o,l)}t&&t[0]&&this.store.addResource(t[0],e,i,s)}}}function lb(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let e={};if("object"==typeof t[1]&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){const i=t[3]||t[2];Object.keys(i).forEach((t=>{e[t]=i[t]}))}return e},interpolation:{escapeValue:!0,format:(t,e,i,s)=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function hb(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function cb(){}class ub extends Dw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;var i;if(super(),this.options=hb(t),this.services={},this.logger=Iw,this.modules={external:[]},i=this,Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach((t=>{"function"==typeof i[t]&&(i[t]=i[t].bind(i))})),e&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,e),this;setTimeout((()=>{this.init(t,e)}),0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;"function"==typeof e&&(i=e,e={}),!e.defaultNS&&!1!==e.defaultNS&&e.ns&&("string"==typeof e.ns?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const s=lb();function n(t){return t?"function"==typeof t?new t:t:null}if(this.options={...s,...this.options,...hb(e)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator),!this.options.isClone){let e;this.modules.logger?Iw.init(n(this.modules.logger),this.options):Iw.init(null,this.options),this.modules.formatter?e=this.modules.formatter:"undefined"!=typeof Intl&&(e=ob);const i=new Yw(this.options);this.store=new $w(this.options.resources,this.options);const r=this.services;r.logger=Iw,r.resourceStore=this.store,r.languageUtils=i,r.pluralResolver=new ib(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format||(r.formatter=n(e),r.formatter.init(r,this.options),this.options.interpolation.format=r.formatter.format.bind(r.formatter)),r.interpolator=new nb(this.options),r.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},r.backendConnector=new ab(n(this.modules.backend),r.resourceStore,r,this.options),r.backendConnector.on("*",(function(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),n=1;n<i;n++)s[n-1]=arguments[n];t.emit(e,...s)})),this.modules.languageDetector&&(r.languageDetector=n(this.modules.languageDetector),r.languageDetector.init&&r.languageDetector.init(r,this.options.detection,this.options)),this.modules.i18nFormat&&(r.i18nFormat=n(this.modules.i18nFormat),r.i18nFormat.init&&r.i18nFormat.init(this)),this.translator=new Xw(this.services,this.options),this.translator.on("*",(function(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),n=1;n<i;n++)s[n-1]=arguments[n];t.emit(e,...s)})),this.modules.external.forEach((t=>{t.init&&t.init(this)}))}if(this.format=this.options.interpolation.format,i||(i=cb),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=function(){return t.store[e](...arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=function(){return t.store[e](...arguments),t}}));const r=Mw(),o=()=>{const t=(t,e)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),r.resolve(e),i(t,e)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initImmediate?o():setTimeout(o,0),r}loadResources(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cb;const i="string"==typeof t?t:this.language;if("function"==typeof t&&(e=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return e();const t=[],s=e=>{if(!e)return;this.services.languageUtils.toResolveHierarchy(e).forEach((e=>{t.indexOf(e)<0&&t.push(e)}))};if(i)s(i);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((t=>s(t)))}this.options.preload&&this.options.preload.forEach((t=>s(t))),this.services.backendConnector.load(t,this.options.ns,(t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),e(t)}))}else e(null)}reloadResources(t,e,i){const s=Mw();return t||(t=this.languages),e||(e=this.options.ns),i||(i=cb),this.services.backendConnector.reload(t,e,(t=>{s.resolve(),i(t)})),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&Gw.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(t,e){var i=this;this.isLanguageChangingTo=t;const s=Mw();this.emit("languageChanging",t);const n=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},r=(t,r)=>{r?(n(r),this.translator.changeLanguage(r),this.isLanguageChangingTo=void 0,this.emit("languageChanged",r),this.logger.log("languageChanged",r)):this.isLanguageChangingTo=void 0,s.resolve((function(){return i.t(...arguments)})),e&&e(t,(function(){return i.t(...arguments)}))},o=e=>{t||e||!this.services.languageDetector||(e=[]);const i="string"==typeof e?e:this.services.languageUtils.getBestMatchFromCodes(e);i&&(this.language||n(i),this.translator.language||this.translator.changeLanguage(i),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(i)),this.loadResources(i,(t=>{r(t,i)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t):o(this.services.languageDetector.detect()),s}getFixedT(t,e,i){var s=this;const n=function(t,e){let r;if("object"!=typeof e){for(var o=arguments.length,a=new Array(o>2?o-2:0),l=2;l<o;l++)a[l-2]=arguments[l];r=s.options.overloadTranslationOptionHandler([t,e].concat(a))}else r={...e};r.lng=r.lng||n.lng,r.lngs=r.lngs||n.lngs,r.ns=r.ns||n.ns,r.keyPrefix=r.keyPrefix||i||n.keyPrefix;const h=s.options.keySeparator||".";let c;return c=r.keyPrefix&&Array.isArray(t)?t.map((t=>`${r.keyPrefix}${h}${t}`)):r.keyPrefix?`${r.keyPrefix}${h}${t}`:t,s.t(c,r)};return"string"==typeof t?n.lng=t:n.lngs=t,n.ns=e,n.keyPrefix=i,n}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=e.lng||this.resolvedLanguage||this.languages[0],s=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;const r=(t,e)=>{const i=this.services.backendConnector.state[`${t}|${e}`];return-1===i||2===i};if(e.precheck){const t=e.precheck(this,r);if(void 0!==t)return t}return!!this.hasResourceBundle(i,t)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!r(i,t)||s&&!r(n,t)))}loadNamespaces(t,e){const i=Mw();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((t=>{this.options.ns.indexOf(t)<0&&this.options.ns.push(t)})),this.loadResources((t=>{i.resolve(),e&&e(t)})),i):(e&&e(),Promise.resolve())}loadLanguages(t,e){const i=Mw();"string"==typeof t&&(t=[t]);const s=this.options.preload||[],n=t.filter((t=>s.indexOf(t)<0));return n.length?(this.options.preload=s.concat(n),this.loadResources((t=>{i.resolve(),e&&e(t)})),i):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const e=this.services&&this.services.languageUtils||new Yw(lb());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(e.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new ub(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cb;const i=t.forkResourceStore;i&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},n=new ub(s);void 0===t.debug&&void 0===t.prefix||(n.logger=n.logger.clone(t));return["store","services","language"].forEach((t=>{n[t]=this[t]})),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},i&&(n.store=new $w(this.store.data,s),n.services.resourceStore=n.store),n.translator=new Xw(n.services,s),n.translator.on("*",(function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];n.emit(t,...i)})),n.init(s,e),n.translator.options=s,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const db=ub.createInstance();db.createInstance=ub.createInstance,db.createInstance,db.dir,db.init,db.loadResources,db.reloadResources,db.use,db.changeLanguage,db.getFixedT,db.t,db.exists,db.setDefaultNamespace,db.hasLoadedNamespace,db.loadNamespaces,db.loadLanguages;db.use(Bx).init({resources:{en:{translation:{nav:{intro:"Intro",messages:"Messages",art:"Art",cake:"Cake",credits:"Credits",langChange:"Language changed to English"},credits:{check:"Also check out",nepolabo:"Nepolabo 2023 Anniversary",lamy:"Lamy Anniversary"}}},jp:{translation:{nav:{intro:"",messages:"",art:"",cake:"",credits:"",langChange:""},credits:{check:"",nepolabo:"",lamy:""}}}},lng:"jp",interpolation:{escapeValue:!1}});const pb="/2023/nene/assets/artlogo-482f588e.png",fb="/2023/nene/assets/cakelogo-cc662378.png",gb="/2023/nene/assets/logo2-9d3a3df4.png",mb="/2023/nene/assets/messageslogo-6ebe3700.png";Y.createRoot(document.getElementById("root")).render(K.jsx(U.StrictMode,{children:K.jsxs(hd,{basename:"/2023/nene",children:[K.jsx(Pw,{}),K.jsx(Aw,{}),K.jsx("img",{src:gb,className:"sr-only",alt:""}),K.jsx("img",{src:mb,className:"sr-only",alt:""}),K.jsx("img",{src:pb,className:"sr-only",alt:""}),K.jsx("img",{src:fb,className:"sr-only",alt:""})]})}));export{xw as $,wy as A,cw as B,fb as C,Yx as D,Zx as E,bw as F,gb as L,mb as M,U as R,Xx as _,ou as a,jx as b,pb as c,Cw as d,Jx as e,Qx as f,aw as g,lw as h,nw as i,K as j,vw as k,_w as l,fy as m,pw as n,yw as o,Ex as p,ww as q,N as r,gw as s,uw as t,Ux as u,ew as v,mw as w,iw as x,tw as y,ow as z};
